<div class="control-flipper clock-key-control-flipper {{~#unless (test clockKey.isVisible "&&" clockKey.isInCurrentScene)}} controls-flipped{{/unless}}" data-clock-key-id="{{clockKey.id}}">

  {{#if clockKey.isOnDisplay}}
  <div class="clock-key-control-panel controls-front">
    {{!-- Pull Key Animation --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-control-pull-key"
      buttonClass="fa-duotone fa-circle-up-left"
      buttonStyle="--fa-primary-color: var(--blades-red-bright); --fa-secondary-color: var(--blades-black); --fa-secondary-opacity: 1;"
      action="pull-clock-key"
    }}

    {{!-- Toggle Name Visibility --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-toggle-name-visible"
      toggleIconKey="signature"
      toggleIconValue=clockKey.isNameVisible
      action="toggle-name-visibility"
    }}

    {{!-- Toggle Spotlight --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-toggle-spotlit"
      toggleIconKey="message"
      toggleIconValue=clockKey.isSpotlit
      action="toggle-spotlight"
    }}

    {{!-- Name --}}
    <input type="text" class="clock-key-input clock-key-input-name" {{~#if clockKey.isNameVisible}} readonly{{/if}}
      data-target-prop="name"
      value="{{clockKey.name}}"
    />
  </div>
  {{else}}
  <div class="clock-key-control-panel controls-back">
    {{#if isSceneTab}}
    {{!-- Drop Key --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-control-drop-key"
      buttonClass="fa-duotone fa-circle-down"
      buttonStyle="--fa-primary-color: var(--blades-green-bright); --fa-secondary-color: var(--blades-black); --fa-secondary-opacity: 1;"
      action="drop-clock-key"
      targetId=clockKey.id
    }}
    {{!-- Select Overlay Position --}}
    {{!-- Spawns a draggable targeting reticule on GM's overlay, deleted once its position is retrieved and the key is dropped --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-spawn-position-dragger"
      buttonClass="fa-sharp fa-regular fa-arrows-up-down-left-right"
      action="spawn-position-dragger"
    }}
    {{else}}
    {{!-- Add to Scene --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-control-add-key-to-scene"
      buttonClass="fa-sharp fa-solid fa-film"
      action="add-key-to-scene"
    }}
    {{/if}}

    {{!-- Toggle Name Visibility --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-toggle-name-visible"
      toggleIconKey="signature"
      toggleIconValue=clockKey.isNameVisible
      action="toggle-name-visibility"
    }}

    {{!-- Add Clock --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-control-add-clock-to-key"
      buttonClass="fa-sharp fa-solid fa-octagon-plus"
      action="add-clock-to-key"
      targetId=clockKey.id
    }}

    {{!-- Name --}}
    <input type="text" class="clock-key-input clock-key-input-name"
      data-target-prop="name"
      value="{{clockKey.name}}"
    />

    {{#if isSceneTab}}
    {{#if isClockKeeperKey}}
    {{!-- Delete Key --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-control-delete-key"
      buttonClass="fa-sharp fa-solid fa-trash-can-xmark"
      action="delete-clock-key"
      targetId=clockKey.id
    }}
    {{else}}
    {{!-- Remove from Scene --}}
    {{> "systems/eunos-blades/templates/components/button-icon.hbs"
      blockClass="clock-control-button clock-control-remove-key-from-scene"
      buttonClass="fa-sharp fa-regular fa-film-slash"
      action="remove-key-from-scene"
    }}
    {{/if}}
    {{/if}}
  </div>
  {{/if}}

</div>

{{#each clockKey.clocks as |clock|}}
  {{> "systems/eunos-blades/templates/parts/clock-sheet-clock-controls.hbs"
    clockKey = ../clockKey
    clock = clock
  }}
{{/each}}
