{"version":3,"sources":["../../ts/blades.ts"],"names":[],"mappings":"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","file":"blades.js","sourcesContent":["// #region ▮▮▮▮▮▮▮ IMPORTS ▮▮▮▮▮▮▮ ~\r\nimport C, {BladesActorType, BladesItemType, Tag, Playbook, RollType, Action} from \"./core/constants.js\";\r\nimport registerSettings, {initTinyMCEStyles, initCanvasStyles, initFonts} from \"./core/settings.js\";\r\nimport {registerHandlebarHelpers, preloadHandlebarsTemplates} from \"./core/helpers.js\";\r\nimport BladesPushController from \"./blades-push-notifications.js\";\r\nimport U from \"./core/utilities.js\";\r\nimport registerDebugger from \"./core/logger.js\";\r\nimport G, {Initialize as GsapInitialize} from \"./core/gsap.js\";\r\n\r\nimport BladesActor from \"./blades-actor.js\";\r\n\r\nimport BladesActorProxy from \"./documents/blades-actor-proxy.js\";\r\nimport BladesItemProxy, {BladesItem, BladesClockKeeper, BladesGMTracker, BladesLocation, BladesScore} from \"./documents/blades-item-proxy.js\";\r\n\r\nimport BladesItemSheet from \"./sheets/item/blades-item-sheet.js\";\r\nimport BladesActorSheet from \"./sheets/actor/blades-actor-sheet.js\";\r\nimport BladesCrewSheet from \"./sheets/actor/blades-crew-sheet.js\";\r\nimport BladesNPCSheet from \"./sheets/actor/blades-npc-sheet.js\";\r\nimport BladesFactionSheet from \"./sheets/actor/blades-faction-sheet.js\";\r\nimport BladesRollCollab, {ApplyRollEffects, ApplyDescriptions} from \"./blades-roll-collab.js\";\r\n\r\nimport {bladesRoll, simpleRollPopup} from \"./blades-roll.js\";\r\nimport BladesSelectorDialog, {SelectionCategory} from \"./blades-dialog.js\";\r\nimport BladesActiveEffect from \"./blades-active-effect.js\";\r\nimport BladesTrackerSheet from \"./sheets/item/blades-tracker-sheet.js\";\r\nimport BladesClockKeeperSheet from \"./sheets/item/blades-clock-keeper-sheet.js\";\r\nimport {UpdateClaims, UpdateContacts, UpdateOps} from \"./data-import/data-import.js\";\r\n\r\nCONFIG.debug.logging = false;\r\n/*DEVCODE*/CONFIG.debug.logging = true; /*!DEVCODE*/\r\n\r\nlet socket: Socket; //~ SocketLib interface\r\nregisterDebugger();\r\n// #endregion ▮▮▮▮[IMPORTS]▮▮▮▮\r\n\r\n// #region Globals: Exposing Functionality to Global Scope ~\r\n/*DEVCODE*/Object.assign(\r\n  globalThis,\r\n  {\r\n    UpdateClaims,\r\n    UpdateContacts,\r\n    UpdateOps,\r\n    BladesActor,\r\n    BladesActorSheet,\r\n    BladesCrewSheet,\r\n    BladesFactionSheet,\r\n    BladesNPCSheet,\r\n    BladesActiveEffect,\r\n    BladesPushController,\r\n    BladesRollCollab,\r\n    ApplyRollEffects,\r\n    ApplyDescriptions,\r\n    bladesRoll,\r\n    simpleRollPopup,\r\n    G,\r\n    U,\r\n    C,\r\n    BladesItem,\r\n    BladesClockKeeper,\r\n    BladesGMTracker,\r\n    BladesLocation,\r\n    BladesItemSheet,\r\n    BladesClockKeeperSheet,\r\n    BladesTrackerSheet,\r\n    MutateItems: () => {\r\n      const patternParts = {\r\n        strong: [\r\n          {\r\n            items: [\"all\"],\r\n            patterns: [\r\n              \"(?:[^ a-zA-Z]<>)?\\\\d+d\",\r\n              ...[\r\n                \"effect\",\r\n                \"result level\",\r\n                \"faction status(?:es)?\",\r\n                \"dot\",\r\n                \"stash\",\r\n                \"(?:free )?load\",\r\n                \"drain\",\r\n                \"armor\",\r\n                \"scale\",\r\n                \"potency\",\r\n                \"coin\",\r\n                \"quality\",\r\n                \"quality\",\r\n                \"xp\",\r\n                \"stress(?: box)?\",\r\n                \"rep\",\r\n                \"trauma(?: box)?\"\r\n              ].map((pat) => `!B(?:[^ a-zA-Z<>])?\\\\d+ ${pat}`),\r\n              ...[\"Hunt\", \"Study\", \"Survey\", \"Tinker\", \"Finesse\", \"Prowl\", \"Skirmish\", \"Wreck\", \"Attune\", \"Command\", \"Consort\", \"Sway\", \"Insight\", \"Prowess\", \"Resolve\"],\r\n              ...[\r\n                \"crew xp\",\r\n                \"special armor\",\r\n                \"push yourself\",\r\n                \"gather info\",\r\n                \"cohorts?\",\r\n                \"xp trigger\",\r\n                \"downtime\",\r\n                \"one tick\",\r\n                \"two ticks\",\r\n                \"long-?term project\",\r\n                \"Tier(?:\\\\s*[^ a-zA-Z]\\\\d+)?\",\r\n                \"acquire an asset\",\r\n                \"!B(?:(?:[^ a-zA-Z<>])?\\\\d+ )?(?:reduce\\\\s*)?heat\",\r\n                \"incarcerated\",\r\n                \"gather information\",\r\n                \"engagement(?: roll)?\",\r\n                \"hull\",\r\n                \"hollow\",\r\n                \"half the coin\",\r\n                \"entanglements\",\r\n                \"group action\",\r\n                \"teamwork(?:\\\\s* maneuvers)?\",\r\n                \"rep\",\r\n                \"wanted level\",\r\n                \"resistance)(\\\\s*rolls?\",\r\n                \"healing)(\\\\s*(?:treatment\\\\s*)?rolls?\"\r\n              ]\r\n            ]\r\n          },\r\n          {patterns: [\"Hunt\", \"Study\", \"Survey\", \"Tinker\", \"Finesse\", \"Prowl\", \"Skirmish\", \"Wreck\", \"Attune\", \"Command\", \"Consort\", \"Sway\", \"Insight\", \"Prowess\", \"Resolve\"]\r\n            .map((str) => str.toLowerCase()),\r\n           items: [\"Physicker\", \"Occultist\", \"Possess\", \"Interface\"]},\r\n          {patterns: [\"protect\"],\r\n           items: [\"Bodyguard\"]},\r\n          {patterns: [\"potency\", \"quality\", \"magnitude\", \"potent\"],\r\n           items: [\"The Good Stuff\", \"Ghost Fighter\", \"Ghost Hunter (Arrow-Swift)\", \"Ghost Hunter (Ghost Form)\", \"Ghost Hunter (Mind Link)\", \"Infiltrator\", \"Ghost Voice\", \"Electroplasmic Projectors\", \"Undead\", \"Like Part of the Family\"]},\r\n          {patterns: [\"invent\", \"craft\"],\r\n           items: [\"Alchemist\"]},\r\n          {patterns: [\"assist\", \"\\\\d*\\\\s*drain\", \"gloom\", \"compel\"],\r\n           items: [\"Foresight\", \"Ghost Form\", \"Manifest\"]},\r\n          {patterns: [\"load\", \"armor\", \"functions\", \"drain\"],\r\n           items: [\"Automaton\", \"Reavers\"]},\r\n          {patterns: [\"items\"],\r\n           items: [\"Compartments\"]},\r\n          {patterns: [\"frame\", \"frames\", \"feature\"],\r\n           items: [\"Secondary Hull\"]},\r\n          {patterns: [\"turf\"],\r\n           items: [\"Accord\", \"Fiends\"]},\r\n          {patterns: [\"heat\", \"rep\"],\r\n           items: [\"Crow's Veil\"]},\r\n          {patterns: [\"Vice\", \"assist\"],\r\n           items: [\"Conviction\", \"Vault\"]},\r\n          {patterns: [\"workshop\", \"coin\"],\r\n           items: [\"Ritual Sanctum in Lair\"]},\r\n          {patterns: [\"quality rating\", \"Documents\", \"Gear\", \"Arcane Implements\", \"Subterfuge Supplies\", \"Tools\", \"Weapons\"],\r\n           items: [\"Quality\"]}\r\n        ],\r\n        em: [\r\n          {\r\n            items: [\"all\"],\r\n            patterns: [\r\n              ...[\r\n                \"Thugs\",\r\n                \"Skulks\",\r\n                \"Adepts\",\r\n                \"Rovers\",\r\n                \"Rooks\",\r\n                \"!BYou got payback against someone who harmed you or someone you care about.!B\"\r\n              ],\r\n              ...[\r\n                \"alchemical)(\\\\s*features\",\r\n                \"spark-craft)(\\\\s*features\",\r\n                \"arcane)(\\\\s*features\"\r\n              ],\r\n              ...[\r\n                \"This factors into effect\\\\.\"\r\n              ],\r\n              \"!B\\\\([^)]+\\\\)!B\"\r\n            ]\r\n          },\r\n          {patterns: [\"Whenever you would.+instead\"],\r\n           items: [\"Ghost Form\", \"Automaton\"]},\r\n          {patterns: [\"feature\"],\r\n           items: [\"Frame Upgrade\"]},\r\n          {patterns: [\"Worship\"],\r\n           items: [\"Conviction\"]},\r\n          {patterns: [\"savage\", \"unreliable\", \"wild\"],\r\n           items: [\"Hooked\"]}\r\n        ]\r\n      };\r\n\r\n      function getPattern(patStr: string): RegExp {\r\n        return new RegExp(`\\\\b(${patStr})\\\\b`\r\n          .replace(/^\\\\b\\(!B/, \"(\")\r\n          .replace(/!B\\)\\\\b$/, \")\"), \"g\");\r\n      }\r\n\r\n      const patterns = {\r\n        strong: patternParts.strong.map(({items, patterns}) => ({\r\n          items: items.map(getWorldName),\r\n          patterns: patterns.map((pat) => getPattern(pat))\r\n        })),\r\n        em: patternParts.em.map(({items, patterns}) => ({\r\n          items: items.map(getWorldName),\r\n          patterns: patterns.map((pat) => getPattern(pat))\r\n        }))\r\n      };\r\n\r\n      function getWorldName(name: string) {\r\n        return name\r\n          .replace(/[^A-Za-z_0-9 ]/g, \"\")\r\n          .trim()\r\n          .replace(/ /g, \"_\");\r\n      }\r\n      function getPrimaryName(name: string) {\r\n        return name\r\n          .replace(/^\\s*\\d+\\s*|\\s*\\d+\\s*$/g, \"\")\r\n          .replace(/:.*$/, \"\")\r\n          .replace(/\\(.*?\\)/g, \"\")\r\n          .trim();\r\n      }\r\n\r\n      game.items\r\n        .forEach((i: BladesItem) => {\r\n          const updateData: Record<string,any> = {};\r\n          let ruleString = i.system.rules;\r\n          if (ruleString) {\r\n            // ruleString = `<p>${ruleString\r\n            //   .replace(/<\\/?[^ >]+>/g, \"\")\r\n            //   .replace(/[<>]/g, \"\")}</p>`;\r\n\r\n            ruleString = ruleString\r\n              .replace(/<strong>|<\\/strong>|<em>|<\\/em>/g, \"\");\r\n            updateData[\"system.description\"] = ruleString;\r\n            for (const [wrapper, patParts] of Object.entries(patterns)) {\r\n              for (const {items, patterns} of patParts) {\r\n                if (items.includes(\"all\") || items.includes(i.system.world_name) || items.includes(getPrimaryName(i.name!)) || items.includes(getWorldName(getPrimaryName(i.name!)))) {\r\n                  patterns.forEach((patr) => {\r\n                    ruleString = ruleString\r\n                      .trim()\r\n                      .replace(/-(\\d+)/g, \"−$1\")\r\n                      .replace(patr, `<${wrapper}>$1</${wrapper}>$2`)\r\n                      .replace(/\\$2/g, \"\")\r\n                      .replace(new RegExp(`(<${wrapper}>)+`, \"g\"), `<${wrapper}>`)\r\n                      .replace(new RegExp(`(</${wrapper}>)+`, \"g\"), `</${wrapper}>`)\r\n                      .replace(/<(strong|em)>( +)/g, \"$2<$1>\" )\r\n                      .replace(/( +)<\\/(strong|em)>/g, \"</$2>$1\" )\r\n                      .replace(/ +/g, \" \")\r\n                      .trim();\r\n                  });\r\n                }\r\n              }\r\n            }\r\n            updateData[\"system.rules\"] = ruleString;\r\n          }\r\n\r\n          i.update(updateData);\r\n        });\r\n    },\r\n    DebugPC: async () => {\r\n      // const {clientTop, clientLeft, clientHeight, clientWidth} = document.documentElement;\r\n      // const positions = {\r\n      //   pc: () => ({top: clientTop, left: clientLeft}),\r\n      //   crew: ({pcSheetElem}: {pcSheetElem?: JQuery<HTMLElement>}) => ({top: clientTop, left: (pcSheetElem?.position()?.left ?? 0) + (pcSheetElem?.width() ?? 0)}),\r\n      //   npc: ({height, width}: {height: number, width: number}) => ({top: (clientTop + clientHeight) - height, left: (clientLeft + clientWidth) - width})\r\n      // };\r\n      // const pc = BladesActor.GetTypeWithTags(BladesActorType.pc).shift();\r\n      // const crew = BladesActor.GetTypeWithTags(BladesActorType.crew).shift();\r\n      // const npc = BladesActor.GetTypeWithTags(BladesActorType.npc).shift();\r\n\r\n      // if (pc) {\r\n      //   Object.assign(globalThis, {pc});\r\n      //   if (pc.sheet) {\r\n      //     pc.sheet.render(true);\r\n      //   }\r\n      // }\r\n      // if (crew) {\r\n      //   Object.assign(globalThis, {crew});\r\n      //   if (crew.sheet) {\r\n      //     crew.sheet.render(true);\r\n      //   }\r\n      // }\r\n      // if (npc) {\r\n      //   Object.assign(globalThis, {npc});\r\n      //   if (npc.sheet) {\r\n      //     npc.sheet.render(true);\r\n      //   }\r\n      // }\r\n      // setTimeout(() => {\r\n      //   if (pc?.sheet) {\r\n      //     pc.sheet.setPosition(positions.pc());\r\n      //   }\r\n      //   if (npc?.sheet) {\r\n      //     const height = $(npc.sheet.element).height()!;\r\n      //     const width = $(npc.sheet.element).width()!;\r\n      //     npc.sheet.setPosition(positions.npc({height, width}));\r\n      //   }\r\n      //   if (crew?.sheet) {\r\n      //     crew.sheet.setPosition(positions.crew({pcSheetElem: pc?.sheet?.element}));\r\n      //   }\r\n      // }, 2000);\r\n    }\r\n  }\r\n);/*!DEVCODE*/\r\n// #endregion Globals\r\n\r\n// #region ████████ SYSTEM INITIALIZATION: Initializing Blades In The Dark System on 'Init' Hook ████████\r\nHooks.once(\"init\", async () => {\r\n  // Register System Settings\r\n  registerSettings();\r\n  eLog.display(\"Initializing Blades In the Dark System\");\r\n\r\n  // Initialize Fonts & Gsap Animations\r\n  GsapInitialize();\r\n  initFonts();\r\n\r\n  CONFIG.Item.documentClass = BladesItemProxy as any;\r\n  CONFIG.Actor.documentClass = BladesActorProxy as any;\r\n\r\n  // Register sheet application classes\r\n  Actors.unregisterSheet(\"core\", ActorSheet);\r\n  Actors.registerSheet(\"blades\", BladesCrewSheet, {types: [\"crew\"], makeDefault: true});\r\n  Actors.registerSheet(\"blades\", BladesFactionSheet, {types: [\"faction\"], makeDefault: true});\r\n  Actors.registerSheet(\"blades\", BladesNPCSheet, {types: [\"npc\"], makeDefault: true});\r\n\r\n  Items.unregisterSheet(\"core\", ItemSheet);\r\n  Items.registerSheet(\"blades\", BladesItemSheet, {types: C.ItemTypes, makeDefault: true});\r\n\r\n  // Initialize subclasses\r\n  await Promise.all([\r\n    BladesActorSheet.Initialize(),\r\n    BladesActiveEffect.Initialize(),\r\n    BladesTrackerSheet.Initialize(),\r\n    BladesScore.Initialize(),\r\n    BladesSelectorDialog.Initialize(),\r\n    BladesClockKeeperSheet.Initialize(),\r\n    BladesPushController.Initialize(),\r\n    BladesRollCollab.Initialize(),\r\n    preloadHandlebarsTemplates()\r\n  ]);\r\n\r\n  registerHandlebarHelpers();\r\n});\r\n\r\nHooks.once(\"ready\", async () => {\r\n  initCanvasStyles();\r\n  initTinyMCEStyles();\r\n  // BladesRollCollab.NewRoll({\r\n  //   rollSource: U.randElem(BladesActor.GetTypeWithTags(BladesActorType.pc)),\r\n  //   rollType: RollType.Action,\r\n  //   rollTrait: U.randElem(Object.values(Action))\r\n  // });\r\n  // @ts-expect-error Just never bothered to declare it's a global\r\n  DebugPC();\r\n});\r\n// #endregion ▄▄▄▄▄ SYSTEM INITIALIZATION ▄▄▄▄▄\r\n\r\n// #region ░░░░░░░[SocketLib]░░░░ SocketLib Initialization ░░░░░░░ ~\r\nHooks.once(\"socketlib.ready\", () => {\r\n  socket = socketlib.registerSystem(\"eunos-blades\");\r\n  /*DEVCODE*/Object.assign(\r\n    globalThis,\r\n    {socket, socketlib}\r\n  );/*!DEVCODE*/\r\n\r\n  BladesRollCollab.InitSockets();\r\n\r\n  let clockOverlayUp: boolean, pushControllerUp: boolean;\r\n  function InitOverlaySockets() {\r\n    setTimeout(() => {\r\n      clockOverlayUp = clockOverlayUp || BladesClockKeeperSheet.InitSockets();\r\n      pushControllerUp = clockOverlayUp || BladesPushController.InitSockets();\r\n      if (clockOverlayUp && pushControllerUp) { return }\r\n      InitOverlaySockets();\r\n    }, 2000);\r\n  }\r\n  InitOverlaySockets();\r\n});\r\n// #endregion ░░░░[SocketLib]░░░░\r\n\r\n// #region ░░░░░░░[Roll Controller]░░░░ Add Dice Roller to Scene Control Sidebar ░░░░░░░ ~\r\nHooks.once(\"renderSceneControls\", async (app: unknown, html: JQuery<HTMLElement>) => {\r\n  const dice_roller = $('<li class=\"scene-control\" title=\"Dice Roll\"><i class=\"fas fa-dice\"></i></li>');\r\n  dice_roller.click(async () => {\r\n    await simpleRollPopup();\r\n  });\r\n  if (!foundry.utils.isNewerVersion(\"9\", game.version ?? game.data.version)) {\r\n    html.children().first().append(dice_roller);\r\n  } else {\r\n    html.append(dice_roller);\r\n  }\r\n});\r\n// #endregion ░░░░[Dice Roll Controller]░░░░\r\n\r\n// #region ░░░░░░░[Dice So Nice]░░░░ Dice So Nice Integration ░░░░░░░ ~\r\nHooks.once(\"diceSoNiceReady\", (dice3d: Record<any, any>) => {\r\n  dice3d.addSystem({id: \"eunos-blades\", name: \"Euno's Blades\"}, \"preferred\");\r\n  dice3d.addDicePreset({\r\n    type: \"d6\",\r\n    labels: [1, 2, 3, 4, 5, 6].map((num) => `systems/eunos-blades/assets/dice/faces/${num}.webp`),\r\n    system: \"eunos-blades\",\r\n    bumpMaps: [1, 2, 3, 4, 5, 6].map((num) => `systems/eunos-blades/assets/dice/bump-maps/${num}.webp`),\r\n    emissiveMaps: [, , , , , \"systems/eunos-blades/assets/dice/emission-maps/6.webp\"], // eslint-disable-line no-sparse-arrays\r\n    emissive: \"#d89300\"\r\n  });\r\n});\r\n// #endregion ░░░░[Dice So Nice]░░░░"]}