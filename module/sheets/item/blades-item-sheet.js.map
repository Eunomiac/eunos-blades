{"version":3,"sources":["../../ts/sheets/item/blades-item-sheet.ts"],"names":[],"mappings":"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","file":"blades-item-sheet.js","sourcesContent":["import C, {BladesActorType, BladesItemType, BladesPhase, Tag, Factor} from \"../../core/constants.js\";\r\nimport U from \"../../core/utilities.js\";\r\nimport G, {ApplyTooltipListeners} from \"../../core/gsap.js\";\r\nimport BladesActor from \"../../blades-actor.js\";\r\nimport BladesItem from \"../../blades-item.js\";\r\nimport BladesActiveEffect from \"../../blades-active-effect.js\";\r\n\r\nimport Tags from \"../../core/tags.js\";\r\n\r\nclass BladesItemSheet extends ItemSheet {\r\n\r\n  static override get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      classes: [\"eunos-blades\", \"sheet\", \"item\"],\r\n      width: 560,\r\n      height: 500,\r\n      tabs: [{navSelector: \".sheet-tabs\", contentSelector: \".sheet-body\", initial: \"description\"}]\r\n    }) as ItemSheet.Options;\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  // constructor(item: BladesItem, options: Partial<ItemSheet.Options> = {}) {\r\n  //   options.classes = [...options.classes ?? [], \"eunos-blades\", \"sheet\", \"item\", item.type];\r\n  //   super(item, options);\r\n  // }\r\n\r\n  // override async getData() {\r\n\r\n  override getData() {\r\n    const context = super.getData();\r\n\r\n    const sheetData: Partial<BladesItemSheetData> = {\r\n      cssClass: this.item.type,\r\n      editable: this.options.editable,\r\n      isGM: (game.eunoblades.Tracker!.system.is_spoofing_player ? false : Boolean(game.user.isGM)) as boolean,\r\n      isEmbeddedItem: Boolean(this.item.parent),\r\n      item: this.item,\r\n      system: this.item.system,\r\n      tierTotal: this.item.getFactorTotal(Factor.tier) > 0 ? U.romanizeNum(this.item.getFactorTotal(Factor.tier)) : \"0\",\r\n      activeEffects: Array.from(this.item.effects) as BladesActiveEffect[]\r\n    };\r\n\r\n    return this._getTypedItemData[this.item.type]!({...context, ...sheetData} as BladesItemSheetData);\r\n  }\r\n\r\n  _getTypedItemData: Record<BladesItemType, (context: BladesItemSheetData) => BladesItemSheetData> = {\r\n    [BladesItemType.ability]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.ability)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.ability> = {};\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.background]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.background)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.background> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.clock_keeper]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.clock_keeper)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.ability> = {\r\n        phases: Object.values(BladesPhase)\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.cohort_gang]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.cohort_gang, BladesItemType.cohort_expert)) { return undefined as never }\r\n      context.tierTotal = this.item.system.quality > 0 ? U.romanizeNum(this.item.system.quality) : \"0\";\r\n      context.system.subtypes ??= {};\r\n      context.system.elite_subtypes ??= {};\r\n      const sheetData: Partial<BladesItemDataOfType<BladesItemType.cohort_gang>> = {\r\n        tierData: {\r\n          \"class\": \"comp-tier comp-vertical comp-teeth\",\r\n          \"dotline\": {\r\n            data: this.item.system.tier,\r\n            target: \"system.tier.value\",\r\n            iconEmpty: \"dot-empty.svg\",\r\n            iconEmptyHover: \"dot-empty-hover.svg\",\r\n            iconFull: \"dot-full.svg\",\r\n            iconFullHover: \"dot-full-hover.svg\"\r\n          }\r\n        }\r\n      };\r\n\r\n      sheetData.edgeData = Object.fromEntries(Object.values(context.system.edges ?? [])\r\n        .filter((edge) => /[A-Za-z]/.test(edge))\r\n        .map((edge) => [edge.trim(), C.EdgeTooltips[edge as KeyOf<typeof C[\"EdgeTooltips\"]>]]));\r\n      sheetData.flawData = Object.fromEntries(Object.values(context.system.flaws ?? [])\r\n        .filter((flaw) => /[A-Za-z]/.test(flaw))\r\n        .map((flaw) => [flaw.trim(), C.FlawTooltips[flaw as KeyOf<typeof C[\"FlawTooltips\"]>]]));\r\n\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.cohort_expert]: (context) => this._getTypedItemData[BladesItemType.cohort_gang](context),\r\n    [BladesItemType.crew_ability]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.crew_ability)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.crew_ability> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.crew_reputation]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.crew_reputation)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.crew_reputation> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.crew_playbook]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.crew_playbook)) { return undefined as never }\r\n      if (context.isGM) {\r\n        const expClueData: Record<string, string> = {};\r\n        [...Object.values(context.system.experience_clues ?? []).filter((clue) => /[A-Za-z]/.test(clue)), \" \"].forEach((clue, i) => { expClueData[(i + 1).toString()] = clue });\r\n        context.system.experience_clues = expClueData as any;\r\n      }\r\n      // if (!context.isGM && context.system.experience_clues) {\r\n      //   delete context.system.experience_clues[Object.keys(context.system.experience_clues).length];\r\n      // }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.crew_playbook> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.crew_upgrade]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.crew_upgrade)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.crew_upgrade> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.feature]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.feature)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.feature> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.gm_tracker]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.gm_tracker)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.gm_tracker> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.heritage]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.heritage)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.heritage> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.gear]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.gear)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.gear> = {\r\n        tierData: {\r\n          \"class\": \"comp-tier comp-vertical comp-teeth\",\r\n          \"label\": \"Quality\",\r\n          \"labelClass\": \"filled-label full-width\",\r\n          \"dotline\": {\r\n            data: this.item.system.tier,\r\n            target: \"system.tier.value\",\r\n            iconEmpty: \"dot-empty.svg\",\r\n            iconEmptyHover: \"dot-empty-hover.svg\",\r\n            iconFull: \"dot-full.svg\",\r\n            iconFullHover: \"dot-full-hover.svg\"\r\n          }\r\n        }\r\n      };\r\n\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.playbook]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.playbook)) { return undefined as never }\r\n      if (context.isGM) {\r\n        const expClueData: Record<string, string> = {};\r\n        [...Object.values(context.system.experience_clues ?? []).filter((clue) => /[A-Za-z]/.test(clue)), \" \"].forEach((clue, i) => { expClueData[(i + 1).toString()] = clue });\r\n        context.system.experience_clues = expClueData as any;\r\n        const gatherInfoData: Record<string, string> = {};\r\n        [...Object.values(context.system.gather_info_questions ?? []).filter((question) => /[A-Za-z]/.test(question)), \" \"].forEach((question, i) => { gatherInfoData[(i + 1).toString()] = question });\r\n        context.system.gather_info_questions = gatherInfoData as any;\r\n      }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.playbook> = {};\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.preferred_op]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.preferred_op)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.preferred_op> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.stricture]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.stricture)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.stricture> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.vice]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.vice)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.vice> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.project]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.project)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.project> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.ritual]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.ritual)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.ritual> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.design]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.design)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.design> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.location]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.location)) { return undefined as never }\r\n      const sheetData: BladesItemDataOfType<BladesItemType.location> = {\r\n      };\r\n      return {\r\n        ...context,\r\n        ...sheetData\r\n      };\r\n    },\r\n    [BladesItemType.score]: (context) => {\r\n      if (!BladesItem.IsType(this.item, BladesItemType.score)) { return undefined as never }\r\n      return context;\r\n    }\r\n  };\r\n\r\n  override get template() {\r\n    const pathComps = [\r\n      \"systems/eunos-blades/templates/items\"\r\n    ];\r\n    if (C.SimpleItemTypes.includes(this.item.type)) {\r\n      pathComps.push(\"simple-sheet.hbs\");\r\n    } else {\r\n      pathComps.push(`${this.item.type}-sheet.hbs`);\r\n    }\r\n    return pathComps.join(\"/\");\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  override activateListeners(html: JQuery<HTMLElement>) {\r\n    super.activateListeners(html);\r\n    const self = this;\r\n\r\n    Tags.InitListeners(html, this.item);\r\n    ApplyTooltipListeners(html);\r\n\r\n    // Everything below here is only needed if the sheet is editable\r\n    if (!this.options.editable) {return}\r\n\r\n    // Add dotline functionality\r\n    html.find(\".dotline\").each((_, elem) => {\r\n      if ($(elem).hasClass(\"locked\")) { return }\r\n\r\n      const targetDoc: BladesActor | BladesItem = this.item;\r\n      const targetField = $(elem).data(\"target\");\r\n\r\n      const comp$ = $(elem).closest(\"comp\");\r\n\r\n      const curValue = U.pInt($(elem).data(\"value\"));\r\n      $(elem)\r\n        .find(\".dot\")\r\n        .each((j, dot) => {\r\n          $(dot).on(\"click\", (event: ClickEvent) => {\r\n            event.preventDefault();\r\n            const thisValue = U.pInt($(dot).data(\"value\"));\r\n            if (thisValue !== curValue) {\r\n              if (\r\n                comp$.hasClass(\"comp-coins\")\r\n                || comp$.hasClass(\"comp-stash\")\r\n              ) {\r\n                G.effects\r\n                  .fillCoins($(dot).prevAll(\".dot\"))\r\n                  .then(() => targetDoc.update({[targetField]: thisValue}));\r\n              } else {\r\n                targetDoc.update({[targetField]: thisValue});\r\n              }\r\n            }\r\n          });\r\n          $(dot).on(\"contextmenu\", (event: ContextMenuEvent) => {\r\n            event.preventDefault();\r\n            const thisValue = U.pInt($(dot).data(\"value\")) - 1;\r\n            if (thisValue !== curValue) {\r\n              targetDoc.update({[targetField]: thisValue});\r\n            }\r\n          });\r\n        });\r\n    });\r\n\r\n    // Harm Bar Functionality for Cohorts\r\n    if (BladesItem.IsType(this.item, BladesItemType.cohort_expert, BladesItemType.cohort_gang)) {\r\n      html.find(\"[data-harm-click]\").on({\r\n        click: (event) => {\r\n          event.preventDefault();\r\n          const harmLevel = U.pInt($(event.currentTarget).data(\"harmClick\"));\r\n          if ((<BladesItemOfType<BladesItemType.cohort_expert|BladesItemType.cohort_gang>>this.item).system.harm.value !== harmLevel) {\r\n            this.item.update({\"system.harm.value\": harmLevel});\r\n          }\r\n        },\r\n        contextmenu: (event) => {\r\n          event.preventDefault();\r\n          const harmLevel = Math.max(0, U.pInt($(event.currentTarget).data(\"harmClick\")) - 1);\r\n          if ((<BladesItemOfType<BladesItemType.cohort_expert|BladesItemType.cohort_gang>>this.item).system.harm.value !== harmLevel) {\r\n            this.item.update({\"system.harm.value\": harmLevel});\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // This is a workaround until is being fixed in FoundryVTT.\r\n    if (this.options.submitOnChange) {\r\n      html.on(\"change\", \"textarea\", this._onChangeInput.bind(this)); // Use delegated listener on the form\r\n    }\r\n\r\n    html.find(\".effect-control\").on(\"click\", (ev) => {\r\n      if ( self.item.isOwned ) {\r\n        ui.notifications!.warn(game.i18n.localize(\"BITD.EffectWarning\"));\r\n        return;\r\n      }\r\n      BladesActiveEffect.onManageActiveEffect(ev, self.item);\r\n    });\r\n\r\n    html.find(\"[data-action=\\\"toggle-turf-connection\\\"\").on(\"click\", this.toggleTurfConnection.bind(this));\r\n  }\r\n\r\n  toggleTurfConnection(event: ClickEvent) {\r\n    const button$ = $(event.currentTarget);\r\n    const connector$ = button$.parent();\r\n    const turfNum = parseInt(connector$.data(\"index\") ?? 0);\r\n    const turfDir = connector$.data(\"dir\");\r\n    if (!turfNum || !turfDir) { return }\r\n    const toggleState = connector$.hasClass(\"no-connect\");\r\n    const updateData = {\r\n      [`system.turfs.${turfNum}.connects.${turfDir}`]: toggleState\r\n    };\r\n    const partner = connector$.data(\"partner\");\r\n    if (typeof partner === \"string\" && /-/.test(partner)) {\r\n      const [partnerNum, partnerDir] = partner.split(\"-\");\r\n      updateData[`system.turfs.${partnerNum}.connects.${partnerDir}`] = toggleState;\r\n    }\r\n    this.item.update(updateData);\r\n  }\r\n\r\n}\r\n\r\ndeclare interface BladesItemSheet {\r\n  get item(): BladesItem\r\n}\r\n\r\nexport default BladesItemSheet;"]}