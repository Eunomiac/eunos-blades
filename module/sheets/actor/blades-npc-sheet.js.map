{"version":3,"sources":["../../ts/sheets/actor/blades-npc-sheet.ts"],"names":[],"mappings":"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","file":"blades-npc-sheet.js","sourcesContent":["\r\nimport BladesSheet from \"./blades-sheet.js\";\r\nimport U from \"../../core/utilities.js\";\r\nclass BladesNPCSheet extends BladesSheet {\r\n\r\n  static override get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      classes: [\"eunos-blades\", \"sheet\", \"actor\", \"npc\"],\r\n      template: \"systems/eunos-blades/templates/npc-sheet.hbs\",\r\n      width: 500,\r\n      height: 400,\r\n      // height: \"auto\",\r\n      tabs: [{navSelector: \".nav-tabs\", contentSelector: \".tab-content\", initial: \"description\"}]\r\n    });\r\n  }\r\n\r\n  override getData() {\r\n    const context = super.getData() as ReturnType<BladesSheet[\"getData\"]> & {\r\n      [key: string]: any\r\n    };\r\n\r\n    context.isSubActor = context.actor.isSubActor;\r\n    context.parentActor = context.actor.parentActor;\r\n    context.persona = context.actor.system.persona;\r\n    context.random = context.actor.system.random;\r\n    context.secret = context.actor.system.secret;\r\n\r\n    const rStatus: Record<string, {size: \"third\"|\"half\"|number, label: string|null}> = {\r\n      name: {size: 3, label: \"Name\"},\r\n      gender: {size: \"half\", label: \"Gender\"},\r\n\r\n      heritage: {size: \"third\", label: \"Heritage\"},\r\n      background: {size: \"third\", label: \"Background\"},\r\n      profession: {size: \"third\", label: \"Profession\"},\r\n\r\n      appearance: {size: 2, label: \"Appearance\"},\r\n      style: {size: 2, label: \"Style\"},\r\n      quirk: {size: 4, label: \"Quirk\"},\r\n\r\n      goal: {size: 2, label: \"Goal\"},\r\n      method: {size: 2, label: \"Method\"},\r\n\r\n      interests: {size: 4, label: \"Interests\"},\r\n\r\n      trait: {size: \"half\", label: \"Trait\"},\r\n      trait1: {size: \"half\", label: null},\r\n      trait2: {size: \"half\", label: null},\r\n      trait3: {size: \"half\", label: null}\r\n    };\r\n    for (const cat of [\"persona\", \"random\", \"secret\"]) {\r\n      for (const [key] of Object.entries(context[cat])) {\r\n        if (key in rStatus) {\r\n          Object.assign(\r\n            context[cat][key],\r\n            rStatus[key]\r\n          );\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log({persona: context.persona, random: context.random, secret: context.secret});\r\n\r\n    return context;\r\n  }\r\n\r\n  override activateListeners(html: JQuery<HTMLElement>) {\r\n    super.activateListeners(html);\r\n\r\n    // Everything below here is only needed if the sheet is editable\r\n    if (!this.options.editable) {return}\r\n\r\n    html.find(\".gm-alert-header\").on(\"click\", async (event) => {\r\n      event.preventDefault();\r\n\r\n      this.actor.clearParentActor();\r\n    });\r\n\r\n    //~ Configure Tagify input elements\r\n    // const inputElement = document.querySelector('input[name=\"system.harm.heavy.one\"]');\r\n    // if (inputElement instanceof HTMLInputElement) { new Tagify(inputElement, {}) } else { console.log(\"Not an HTMLInputElement\")}\r\n\r\n    //~ Enable Randomize Button for NPCs\r\n    html.find(\"[data-action=\\\"randomize\\\"\").on(\"click\", (event) => {\r\n      this.actor.updateRandomizers();\r\n    });\r\n\r\n    //~ Enable status toggles for NPC subactors\r\n    html.find(\".comp-status-toggle\")\r\n      .on(\"click\", () => {\r\n        const {tags} = this.actor;\r\n        if (this.actor.system.status === 1) {\r\n          U.remove(tags, \"Friend\");\r\n          tags.push(\"Rival\");\r\n          this.actor.update({\r\n            \"system.status\": -1,\r\n            \"system.tags\": U.unique(tags)\r\n          });\r\n        } else {\r\n          U.remove(tags, \"Rival\");\r\n          tags.push(\"Friend\");\r\n          this.actor.update({\r\n            \"system.status\": 1,\r\n            \"system.tags\": U.unique(tags)\r\n          });\r\n        }\r\n      })\r\n      .on(\"contextmenu\", () => {\r\n        this.actor.update({\"system.status\": 0});\r\n      });\r\n\r\n  }\r\n}\r\n\r\nexport default BladesNPCSheet;"]}