var $g = Object.defineProperty;
var Ng = (r, e, t) => e in r ? $g(r, e, { enumerable: !0, configurable: !0, writable: !0, value: t }) : r[e] = t;
var J = (r, e, t) => (Ng(r, typeof e != "symbol" ? e + "" : e, t), t), Bg = (r, e, t) => {
  if (!e.has(r))
    throw TypeError("Cannot " + t);
};
var ya = (r, e, t) => {
  if (e.has(r))
    throw TypeError("Cannot add the same private member more than once");
  e instanceof WeakSet ? e.add(r) : e.set(r, t);
};
var Dr = (r, e, t) => (Bg(r, e, "access private method"), t);
var Hg = ((r) => (r[r.NONE = CONST.DOCUMENT_PERMISSION_LEVELS.NONE] = "NONE", r[r.BASIC = CONST.DOCUMENT_PERMISSION_LEVELS.LIMITED] = "BASIC", r[r.FULL = CONST.DOCUMENT_PERMISSION_LEVELS.OBSERVER] = "FULL", r[r.OWNER = CONST.DOCUMENT_PERMISSION_LEVELS.OWNER] = "OWNER", r))(Hg || {}), z = /* @__PURE__ */ ((r) => (r.pc = "pc", r.npc = "npc", r.crew = "crew", r.faction = "faction", r))(z || {}), A = /* @__PURE__ */ ((r) => (r.ability = "ability", r.background = "background", r.clock_keeper = "clock_keeper", r.cohort_gang = "cohort_gang", r.cohort_expert = "cohort_expert", r.crew_ability = "crew_ability", r.crew_reputation = "crew_reputation", r.crew_playbook = "crew_playbook", r.crew_upgrade = "crew_upgrade", r.feature = "feature", r.gm_tracker = "gm_tracker", r.heritage = "heritage", r.gear = "gear", r.playbook = "playbook", r.preferred_op = "preferred_op", r.stricture = "stricture", r.vice = "vice", r.project = "project", r.ritual = "ritual", r.design = "design", r.location = "location", r.score = "score", r))(A || {}), Ko = /* @__PURE__ */ ((r) => (r.HasActiveItem = "HasActiveItem", r.HasActiveItemsByTag = "HasActiveItemByTag", r.AdvancedPlaybook = "AdvancedPlaybook", r.HasAllTags = "HasAllTags", r.HasAnyTag = "HasAnyTag", r.Not_HasActiveItem = "Not_HasActiveItem", r.Not_HasActiveItemsByTag = "Not_HasActiveItemsByTag", r.Not_AdvancedPlaybook = "Not_AdvancedPlaybook", r.Not_HasAllTags = "Not_HasAllTags", r.Not_HasAnyTag = "Not_HasAnyTag", r))(Ko || {}), Yt = /* @__PURE__ */ ((r) => (r.yellow = "yellow", r.red = "red", r.white = "white", r.cyan = "cyan", r))(Yt || {}), Ke = /* @__PURE__ */ ((r) => (r.overlay = "overlay", r.pcSheet = "pcSheet", r.factionSheet = "factionSheet", r.projectSheet = "projectSheet", r.scoreSheet = "scoreSheet", r.rollCollab = "rollCollab", r.chatMessage = "chatMessage", r))(Ke || {}), Pt = /* @__PURE__ */ ((r) => (r.full = "full", r.clocks = "clocks", r.activeClocks = "activeClocks", r.presentCurrentClock = "presentCurrentClock", r.present0 = "present0", r.present1 = "present1", r.present2 = "present2", r.present3 = "present3", r.present4 = "present4", r.present5 = "present5", r))(Pt || {}), Ls = /* @__PURE__ */ ((r) => (r.push = "push", r))(Ls || {}), I0 = /* @__PURE__ */ ((r) => (r.Barrowcleft = "Barrowcleft", r.Brightstone = "Brightstone", r.Charhollow = "Charhollow", r.Charterhall = "Charterhall", r.Coalridge = "Coalridge", r["Crows Foot"] = "Crows Foot", r["The Docks"] = "The Docks", r.Dunslough = "Dunslough", r.Nightmarket = "Nightmarket", r.Silkshore = "Silkshore", r["Six Towers"] = "Six Towers", r.Whitecrown = "Whitecrown", r))(I0 || {}), P0 = /* @__PURE__ */ ((r) => (r["Gaddoc Station"] = "Gaddoc Station", r["The Lost District"] = "The Lost District", r["The Void Sea"] = "The Void Sea", r["Ironhook Prison"] = "Ironhook Prison", r["Old North Port"] = "Old North Port", r.Deathlands = "Deathlands", r))(P0 || {}), Tt = /* @__PURE__ */ ((r) => (r.insight = "insight", r.prowess = "prowess", r.resolve = "resolve", r))(Tt || {}), js = /* @__PURE__ */ ((r) => (r.hunt = "hunt", r.study = "study", r.survey = "survey", r.tinker = "tinker", r.finesse = "finesse", r.prowl = "prowl", r.skirmish = "skirmish", r.wreck = "wreck", r.attune = "attune", r.command = "command", r.consort = "consort", r.sway = "sway", r))(js || {}), ke = /* @__PURE__ */ ((r) => (r.AcquireAsset = "AcquireAsset", r.IndulgeVice = "IndulgeVice", r.LongTermProject = "LongTermProject", r.Recover = "Recover", r.ReduceHeat = "ReduceHeat", r.Train = "Train", r))(ke || {}), pt = /* @__PURE__ */ ((r) => (r.Primary = "Primary", r.Observer = "Observer", r.GM = "GM", r.Participant = "Participant", r))(pt || {}), Oe = /* @__PURE__ */ ((r) => (r.Action = "Action", r.Resistance = "Resistance", r.Fortune = "Fortune", r.IndulgeVice = "IndulgeVice", r))(Oe || {}), Na = /* @__PURE__ */ ((r) => (r.Incarceration = "Incarceration", r.Engagement = "Engagement", r.GatherInfo = "GatherInfo", r.GroupLead = "GroupLead", r.GroupParticipant = "GroupParticipant", r))(Na || {}), Re = /* @__PURE__ */ ((r) => (r.general = "general", r.harm = "harm", r.teamwork = "teamwork", r.ability = "ability", r.gear = "gear", r.crew_ability = "crew_ability", r.crew_upgrade = "crew_upgrade", r.advantage = "advantage", r.disadvantage = "disadvantage", r))(Re || {}), Vt = /* @__PURE__ */ ((r) => (r.ReducedEffect = "ReducedEffect", r.ComplicationMinor = "ComplicationMinor", r.ComplicationMajor = "ComplicationMajor", r.ComplicationSerious = "ComplicationSerious", r.LostOpportunity = "LostOpportunity", r.WorsePosition = "WorsePosition", r.InsightHarm1 = "InsightHarm1", r.InsightHarm2 = "InsightHarm2", r.InsightHarm3 = "InsightHarm3", r.InsightHarm4 = "InsightHarm4", r.ProwessHarm1 = "ProwessHarm1", r.ProwessHarm2 = "ProwessHarm2", r.ProwessHarm3 = "ProwessHarm3", r.ProwessHarm4 = "ProwessHarm4", r.ResolveHarm1 = "ResolveHarm1", r.ResolveHarm2 = "ResolveHarm2", r.ResolveHarm3 = "ResolveHarm3", r.ResolveHarm4 = "ResolveHarm4", r.None = "None", r))(Vt || {}), se = /* @__PURE__ */ ((r) => (r.Hidden = "Hidden", r.ForcedOff = "ForcedOff", r.ToggledOff = "ToggledOff", r.ToggledOn = "ToggledOn", r.ForcedOn = "ForcedOn", r.Dominant = "Dominant", r))(se || {}), ae = /* @__PURE__ */ ((r) => (r.roll = "roll", r.position = "position", r.effect = "effect", r.result = "result", r.after = "after", r))(ae || {}), Ct = /* @__PURE__ */ ((r) => (r.desperate = "desperate", r.risky = "risky", r.controlled = "controlled", r))(Ct || {}), mt = /* @__PURE__ */ ((r) => (r.zero = "zero", r.limited = "limited", r.standard = "standard", r.great = "great", r.extreme = "extreme", r))(mt || {}), H = /* @__PURE__ */ ((r) => (r.tier = "tier", r.quality = "quality", r.scale = "scale", r.magnitude = "magnitude", r))(H || {}), Ue = /* @__PURE__ */ ((r) => (r.critical = "critical", r.success = "success", r.partial = "partial", r.fail = "fail", r))(Ue || {}), Ys = /* @__PURE__ */ ((r) => (r.Collaboration = "Collaboration", r.AwaitingRoll = "AwaitingRoll", r.AwaitingConsequences = "AwaitingConsequences", r.Complete = "Complete", r))(Ys || {}), nc = /* @__PURE__ */ ((r) => (r.Weakened = "Weakened", r.Impaired = "Impaired", r.Broken = "Broken", r.Dead = "Dead", r))(nc || {}), M0 = /* @__PURE__ */ ((r) => (r.Faith = "Faith", r.Gambling = "Gambling", r.Luxury = "Luxury", r.Obligation = "Obligation", r.Pleasure = "Pleasure", r.Stupor = "Stupor", r.Weird = "Weird", r.Worship = "Worship", r.Life_Essence = "Life_Essence", r.Living_Essence = "Living_Essence", r.Electroplasmic_Power = "Electroplasmic_Power", r.Servitude = "Servitude", r))(M0 || {}), Ba = /* @__PURE__ */ ((r) => (r.Cutter = "Cutter", r.Hound = "Hound", r.Leech = "Leech", r.Lurk = "Lurk", r.Slide = "Slide", r.Spider = "Spider", r.Whisper = "Whisper", r.Vampire = "Vampire", r.Hull = "Hull", r.Ghost = "Ghost", r.Assassins = "Assassins", r.Bravos = "Bravos", r.Cult = "Cult", r.Hawkers = "Hawkers", r.Shadows = "Shadows", r.Smugglers = "Smugglers", r.Vigilantes = "Vigilantes", r))(Ba || {}), Oi = /* @__PURE__ */ ((r) => (r.UpgradeOrAbility = "UpgradeOrAbility", r.Ability = "Ability", r.Upgrade = "Upgrade", r.Cohort = "Cohort", r.CohortType = "CohortType", r.GeneralAction = "GeneralAction", r.GeneralInsight = "GeneralInsight", r.GeneralProwess = "GeneralProwess", r.GeneralResolve = "GeneralResolve", r.hunt = "hunt", r.study = "study", r.survey = "survey", r.tinker = "tinker", r.finesse = "finesse", r.prowl = "prowl", r.skirmish = "skirmish", r.wreck = "wreck", r.attune = "attune", r.command = "command", r.consort = "consort", r.sway = "sway", r))(Oi || {}), $e = /* @__PURE__ */ ((r) => (r.CharGen = "CharGen", r.Freeplay = "Freeplay", r.Score = "Score", r.Downtime = "Downtime", r))($e || {}), he;
((r) => {
  ((e) => {
    e.Archived = "Archived", e.Featured = "Featured", e.Hidden = "Hidden", e.MultiplesOK = "MultiplesOK";
  })(r.System || (r.System = {})), ((e) => {
    e.Fine = "Fine", e.General = "General", e.Advanced = "Advanced", e.Upgraded = "Upgraded";
  })(r.Gear || (r.Gear = {})), ((e) => {
    e.Member = "Member", e.CharacterCrew = "CharacterCrew", e.ActivePC = "ActivePC", e.Small = "Small", e.Medium = "Medium", e.Large = "Large", e.CanHeal = "CanHeal";
  })(r.PC || (r.PC = {})), ((e) => {
    e.Arcane = "Arcane", e.SparkCraft = "SparkCraft", e.Alchemical = "Alchemical", e.Mundane = "Mundane", e.Ritual = "Ritual";
  })(r.Invention || (r.Invention = {})), ((e) => {
    e.ArcaneImplement = "ArcaneImplement", e.Document = "Document", e.GearKit = "GearKit", e.SubterfugeSupplies = "SubterfugeSupplies", e.Tool = "Tool", e.Weapon = "Weapon";
  })(r.GearCategory || (r.GearCategory = {})), ((e) => {
    e.Acquaintance = "Acquaintance", e.VicePurveyor = "VicePurveyor", e.CanHeal = "CanHeal";
  })(r.NPC || (r.NPC = {})), ((e) => {
    e.Thugs = "Thugs", e.Rooks = "Rooks", e.Adepts = "Adepts", e.Rovers = "Rovers", e.Skulks = "Skulks", e.Vehicle = "Vehicle";
  })(r.GangType || (r.GangType = {}));
})(he || (he = {}));
const X = {
  SYSTEM_ID: "eunos-blades",
  SYSTEM_NAME: "Euno's Blades",
  SYSTEM_FULL_NAME: "Euno's Blades In The Dark",
  TEMPLATE_ROOT: "systems/eunos-blades/templates",
  GM_PORTRAIT: "systems/eunos-blades/assets/portraits/gm-chat.png",
  AI_MODELS: {
    baseContext: [
      "babbage-002",
      "gpt-3.5-turbo",
      "gpt-4"
    ],
    extendedContext: [
      "gpt-3.5-turbo-16k",
      "gpt-3.5-turbo-16k",
      "gpt-4-32k"
    ]
  },
  MIN_MOUSE_MOVEMENT_THRESHOLD: 2e3,
  AI_FILE_IDS: {
    BladesPDF: "file-n72HTTNwt051piPbswQ8isUa"
  },
  ClockKeySquareSize: 100,
  DowntimeActionDisplay: {
    AcquireAsset: "Acquire an Asset",
    IndulgeVice: "Indulge Your Vice",
    LongTermProject: "Work on a Project",
    Recover: "Heal",
    ReduceHeat: "Reduce the Crew's Heat",
    Train: "Train"
  },
  ConsequenceValues: {
    ReducedEffect: void 0,
    LostOpportunity: 2,
    WorsePosition: void 0,
    None: 0,
    InsightHarm4: 4,
    InsightHarm3: 3,
    InsightHarm2: 2,
    InsightHarm1: 1,
    ProwessHarm4: 4,
    ProwessHarm3: 3,
    ProwessHarm2: 2,
    ProwessHarm1: 1,
    ResolveHarm4: 4,
    ResolveHarm3: 3,
    ResolveHarm2: 2,
    ResolveHarm1: 1,
    ComplicationSerious: 3,
    ComplicationMajor: 2,
    ComplicationMinor: 1
  },
  ResistedConsequenceTypes: {
    None: [],
    InsightHarm4: [
      "InsightHarm3"
      /* InsightHarm3 */
    ],
    InsightHarm3: [
      "InsightHarm2"
      /* InsightHarm2 */
    ],
    InsightHarm2: [
      "InsightHarm1"
      /* InsightHarm1 */
    ],
    InsightHarm1: [
      "None"
      /* None */
    ],
    ProwessHarm4: [
      "ProwessHarm3"
      /* ProwessHarm3 */
    ],
    ProwessHarm3: [
      "ProwessHarm2"
      /* ProwessHarm2 */
    ],
    ProwessHarm2: [
      "ProwessHarm1"
      /* ProwessHarm1 */
    ],
    ProwessHarm1: [
      "None"
      /* None */
    ],
    ResolveHarm4: [
      "ResolveHarm3"
      /* ResolveHarm3 */
    ],
    ResolveHarm3: [
      "ResolveHarm2"
      /* ResolveHarm2 */
    ],
    ResolveHarm2: [
      "ResolveHarm1"
      /* ResolveHarm1 */
    ],
    ResolveHarm1: [
      "None"
      /* None */
    ],
    ComplicationSerious: [
      "ComplicationMajor"
      /* ComplicationMajor */
    ],
    ComplicationMajor: [
      "ComplicationMinor"
      /* ComplicationMinor */
    ],
    ComplicationMinor: [
      "None"
      /* None */
    ]
  },
  ConsequenceDisplay: {
    ReducedEffect: "Reduced Effect",
    ComplicationMinor: "Minor Complication",
    ComplicationMajor: "Major Complication",
    ComplicationSerious: "Serious Complication",
    LostOpportunity: "Lost Opportunity",
    WorsePosition: "Worse Position",
    InsightHarm1: "Level 1 Harm (Lesser)",
    InsightHarm2: "Level 2 Harm (Moderate)",
    InsightHarm3: "Level 3 Harm (Severe)",
    InsightHarm4: "Level 4 Harm (FATAL)",
    ProwessHarm1: "Level 1 Harm (Lesser)",
    ProwessHarm2: "Level 2 Harm (Moderate)",
    ProwessHarm3: "Level 3 Harm (Severe)",
    ProwessHarm4: "Level 4 Harm (FATAL)",
    ResolveHarm1: "Level 1 Harm (Lesser)",
    ResolveHarm2: "Level 2 Harm (Moderate)",
    ResolveHarm3: "Level 3 Harm (Severe)",
    ResolveHarm4: "Level 4 Harm (FATAL)",
    None: "None"
  },
  ConsequenceIcons: {
    ReducedEffect: "reduced-effect",
    ComplicationMinor: "complication-minor",
    ComplicationMajor: "complication-major",
    ComplicationSerious: "complication-serious",
    LostOpportunity: "lost-opportunity",
    WorsePosition: "worse-position",
    InsightHarm1: "harm-insight-1",
    InsightHarm2: "harm-insight-2",
    InsightHarm3: "harm-insight-3",
    InsightHarm4: "harm-insight-4",
    ProwessHarm1: "harm-prowess-1",
    ProwessHarm2: "harm-prowess-2",
    ProwessHarm3: "harm-prowess-3",
    ProwessHarm4: "harm-prowess-4",
    ResolveHarm1: "harm-resolve-1",
    ResolveHarm2: "harm-resolve-2",
    ResolveHarm3: "harm-resolve-3",
    ResolveHarm4: "harm-resolve-4",
    None: ""
  },
  RollResultDescriptions: {
    controlled: {
      critical: "You critically succeed from a controlled position!",
      success: "You fully succeed from a controlled position!",
      partial: "You partially succeed from a controlled position!",
      fail: "You fail from a controlled position!"
    },
    risky: {
      critical: "You critically succeed from a risky position!",
      success: "You fully succeed from a risky position!",
      partial: "You partially succeed from a risky position!",
      fail: "You fail from a risky position!"
    },
    desperate: {
      critical: "You critically succeed from a desperate position!",
      success: "You fully succeed from a desperate position!",
      partial: "You partially succeed from a desperate position!",
      fail: "You fail from a desperate position!"
    }
  },
  Colors: {
    /* IMPORT FROM CSS via css-loader */
    bWHITE: "rgba(255, 255, 255, 1)",
    WHITE: "rgba(200, 200, 200, 1)",
    bGREY: "rgba(170, 170, 170, 1)",
    GREY: "rgba(119, 119, 119, 1)",
    dGREY: "rgba(68, 68, 68, 1)",
    BLACK: "rgba(32, 32, 32, 1)",
    dBLACK: "rgba(0, 0, 0, 1)",
    bGOLD: "rgba(255,216, 44, 1)",
    GOLD: "rgba(215,175,  0, 1)",
    dGOLD: "rgba(165,134,  0, 1)",
    ddGOLD: "rgba(103, 83,  0, 1)",
    bRED: "rgba(255, 0, 0, 1)",
    RED: "rgba(200, 0, 0, 1)",
    dRED: "rgba(150,  0,  0, 1)",
    ddRED: "rgba(50,  0,  0, 1)",
    bBLUE: "rgba(   0,224,224, 1)",
    BLUE: "rgba(52,213,213, 1)",
    dBLUE: "rgba(0,118,118, 1)",
    ddBLUE: "rgba(0, 77, 77, 1)"
  },
  // ClockKeyPositions: {
  //   elemSquareSize: 100,
  //   0: {
  //     keyDimensions: {width: 0, height: 0},
  //     keyCenter: {x: 0, y: 0},
  //     clocksCenter: {x: 0, y: 0},
  //     clocksCenterDimensions: {width: 0, height: 0},
  //     clocks: {}
  //   },
  //   1: {
  //     keyDimensions: {width: 230, height: 836},
  //     keyCenter: {x: 115, y: 418},
  //     clocksCenter: {x: 111.011, y: 108.5},
  //     clocksCenterDimensions: {width: 169, height: 169},
  //     clocks: {
  //       0: {x: 111.011, y: 108.5, size: 169}
  //     }
  //   },
  //   2: {
  //     keyDimensions: {width: 202, height: 625},
  //     keyCenter: {x: 101, y: 312},
  //     clocksCenter: {x: 101, y: 189},
  //     clocksCenterDimensions: {width: 110, height: 290},
  //     clocks: {
  //       0: {x: 101, y: 99, size: 108},
  //       1: {x: 101, y: 279, size: 108}
  //     }
  //   },
  //   3: {
  //     keyDimensions: {width: 280, height: 915},
  //     keyCenter: {x: 140, y: 457},
  //     clocksCenter: {x: 140, y: 169},
  //     clocksCenterDimensions: {width: 242, height: 222},
  //     clocks: {
  //       0: {x: 140, y: 99, size: 108},
  //       1: {x: 74, y: 211, size: 108},
  //       2: {x: 206, y: 211, size: 108}
  //     }
  //   },
  //   4: {
  //     keyDimensions: {width: 376, height: 1140},
  //     keyCenter: {x: 188, y: 570},
  //     clocksCenter: {x: 188, y: 185},
  //     clocksCenterDimensions: {width: 284, height: 282},
  //     clocks: {
  //       0: {x: 188, y: 99, size: 108}, // yTop = 45
  //       1: {x: 101, y: 185, size: 108},
  //       2: {x: 275, y: 185, size: 108},
  //       3: {x: 188, y: 273, size: 108} // yBottom = 327
  //     }
  //   },
  //   5: {
  //     keyDimensions: {width: 376, height: 1140},
  //     keyCenter: {x: 188, y: 570},
  //     clocksCenter: {x: 188, y: 185},
  //     clocksCenterDimensions: {width: 284, height: 384},
  //     clocks: {
  //       0: {x: 188, y: 99, size: 108}, // yTop = 45
  //       1: {x: 101, y: 185, size: 108},
  //       2: {x: 275, y: 185, size: 108},
  //       3: {x: 188, y: 273, size: 108},
  //       4: {x: 188, y: 452, size: 108} // yBottom = 506
  //     }
  //   },
  //   6: {
  //     keyDimensions: {width: 376, height: 1140},
  //     keyCenter: {x: 188, y: 570},
  //     clocksCenter: {x: 188, y: 391},
  //     clocksCenterDimensions: {width: 284, height: 692},
  //     clocks: {
  //       0: {x: 188, y: 99, size: 108}, // yTop = 45
  //       1: {x: 101, y: 185, size: 108},
  //       2: {x: 275, y: 185, size: 108},
  //       3: {x: 188, y: 273, size: 108},
  //       4: {x: 188, y: 452, size: 108},
  //       5: {x: 188, y: 683, size: 108} // yBottom = 737
  //     }
  //   }
  // },
  Loadout: {
    selections: [
      { value: "Light", display: "Light" },
      { value: "Normal", display: "Normal" },
      { value: "Heavy", display: "Heavy" }
    ],
    levels: ["BITD.Light", "BITD.Normal", "BITD.Heavy", "BITD.Encumbered", "BITD.OverMax"]
  },
  AttributeTooltips: {
    insight: "<p>Resists consequences from <strong>deception</strong> or <strong>understanding</strong></p>",
    prowess: "<p>Resists consequences from <strong>physical strain</strong> or <strong>injury</strong></p>",
    resolve: "<p>Resists consequences from <strong>mental strain</strong> or <strong>willpower</strong></p>"
  },
  ShortAttributeTooltips: {
    insight: "vs. <strong>deception</strong> or <strong>(mis)understanding</strong>",
    prowess: "vs. <strong>physical strain</strong> or <strong>injury</strong>",
    resolve: "vs. <strong>mental strain</strong> or <strong>willpower</strong>"
  },
  ShortActionTooltips: {
    hunt: "carefully track a target",
    study: "scrutinize details and interpret evidence",
    survey: "observe the situation and anticipate outcomes",
    tinker: "fiddle with devices and mechanisms",
    finesse: "employ dexterity or subtle misdirection",
    prowl: "traverse skillfully and quietly",
    skirmish: "entangle a target in melee so they can't escape",
    wreck: "unleash savage force",
    attune: "open your mind to the ghost field or channel nearby electroplasmic energy through your body",
    command: "compel swift obedience",
    consort: "socialize with friends and contacts",
    sway: "influence someone with guile, charm, or argument"
  },
  ActionTooltips: {
    hunt: "<p>When you <strong>Hunt</strong>, you carefully track a target.</p><ul><li>You might follow a person or discover their location.</li><li>You might arrange an ambush.</li><li>You might attack with precision shooting from a distance.</li></ul><ul><li>You could try to wield your guns in a melee <em>(but <strong>Skirmishing</strong> might be better)</em>.</li></ul>",
    study: "<p>When you <strong>Study</strong>, you scrutinize details and interpret evidence.</p><ul><li>You might gather information from documents, newspapers, and books.</li><li>You might do research on an esoteric topic.</li><li>You might closely analyze a person to detect lies or true feelings.</li></ul><ul><li>You could try to understand a pressing situation <em>(but <strong>Surveying</strong> might be better)</em>.</li></ul>",
    survey: "<p>When you <strong>Survey</strong>, you observe the situation and anticipate outcomes.</p><ul><li>You might spot telltale signs of trouble before it happens.</li><li>You might uncover opportunities or weaknesses.</li></ul><ul><li>You might detect a person's motives or intentions <em>(but <strong>Studying</strong> might be better)</em>.</li><li>You could try to spot a good ambush point <em>(but <strong>Hunting</strong> might be better)</em>.</li></ul>",
    tinker: "<p>When you <strong>Tinker</strong>, you fiddle with devices and mechanisms.</p><ul><li>You might create a new gadget or alter an existing item.</li><li>You might pick a lock or crack a safe.</li><li>You might disable an alarm or trap.</li><li>You might turn the sparkcraft and electroplasmic devices around the city to your advantage.</li></ul><ul><li>You could try to control a vehicle with your tech-savvy <em>(but <strong>Finessing</strong> might be better)</em>.</li></ul>",
    finesse: "<p>When you <strong>Finesse</strong>, you employ dexterity or subtle misdirection.</p><ul><li>You might pick someone's pocket.</li><li>You might handle the controls of a vehicle or direct a mount.</li><li>You might formally duel an opponent with graceful fighting arts.</li></ul><ul><li>You could try to leverage agility in a melee <em>(but <strong>Skirmishing</strong> might be better)</em>.</li><li>You could try to pick a lock <em>(but <strong>Tinkering</strong> might be better)</em>.</li></ul>",
    prowl: "<p>When you <strong>Prowl</strong>, you traverse skillfully and quietly.</p><ul><li>You might sneak past a guard or hide in the shadows.</li><li>You might run and leap across the rooftops.</li><li>You might attack someone from hiding with a back-stab or blackjack.</li></ul><ul><li>You could try to waylay a victim during combat <em>(but <strong>Skirmishing</strong> might be better)</em>.</li></ul>",
    skirmish: "<p>When you <strong>Skirmish</strong>, you entangle a target in melee so they can't escape.</p><ul><li>You might brawl or wrestle with them.</li><li>You might hack and slash.</li><li>You might seize or hold a position in battle.</li></ul><ul><li>You could try to fight in a formal duel <em>(but <strong>Finessing</strong> might be better)</em>.</li></ul>",
    wreck: "<p>When you <strong>Wreck</strong>, you unleash savage force.</p><ul><li>You might smash down a door or wall with a sledgehammer.</li><li>You might use an explosive to do the same.</li><li>You might use chaos or sabotage to create distractions or overcome obstacles.</li></ul><ul><li>You could try to overwhelm an enemy with sheer force in battle <em>(but <strong>Skirmishing</strong> might be better)</em>.</li></ul>",
    attune: "<p>When you <strong>Attune</strong>, you open your mind to the ghost field or channel nearby electroplasmic energy through your body.</p><ul><li>You might communicate with a ghost or understand aspects of spectrology.</li><li>You might peer into the echo of Doskvol in the ghost field.</li></ul><ul><li>You could try to perceive beyond sight in order to better understand your situation <em>(but <strong>Surveying</strong> might be better)</em>.</li></ul>",
    command: "<p>When you <strong>Command</strong>, you compel swift obedience.</p><ul><li>You might intimidate or threaten to get what you want.</li><li>You might lead a gang in a group action.</li></ul><ul><li>You could try to persuade people by giving orders <em>(but <strong>Consorting</strong> might be better)</em>.</li></ul>",
    consort: "<p>When you <strong>Consort</strong>, you socialize with friends and contacts.</p><ul><li>You might gain access to resources, information, people, or places.</li><li>You might make a good impression or win someone over with charm and style.</li><li>You might make new friends or connect with your heritage or background.</li></ul><ul><li>You could try to direct allies with social pressure <em>(but <strong>Commanding</strong> might be better)</em>.</li></ul>",
    sway: "<p>When you <strong>Sway</strong>, you influence someone with guile, charm, or argument.</p><ul><li>You might lie convincingly.</li><li>You might persuade someone to do what you want.</li><li>You might argue a case that leaves no clear rebuttal.</li></ul><ul><li>You could try to trick people into affection or obedience <em>(but <strong>Consorting</strong> or <strong>Commanding</strong> might be better)</em>.</li></ul>"
  },
  ActionTooltipsGM: {
    hunt: "<p>When you <strong>Hunt</strong>, you carefully track a target.</p><ul><li>You might follow a person or discover their location.</li><li>You might arrange an ambush.</li><li>You might attack with precision shooting from a distance.</li></ul><ul><li>You could try to wield your guns in a melee <em>(but <strong>Skirmishing</strong> might be better)</em>.</li></ul><hr><ul><li>How do you hunt them down?</li><li>What methods do you use?</li><li>What do you hope to achieve?</li></ul>",
    study: "<p>When you <strong>Study</strong>, you scrutinize details and interpret evidence.</p><ul><li>You might gather information from documents, newspapers, and books.</li><li>You might do research on an esoteric topic.</li><li>You might closely analyze a person to detect lies or true feelings.</li></ul><ul><li>You could try to understand a pressing situation <em>(but <strong>Surveying</strong> might be better)</em>.</li></ul><hr><ul><li>What do you study?</li><li>What details or evidence do you scrutinize?</li><li>What do you hope to understand?</li></ul>",
    survey: "<p>When you <strong>Survey</strong>, you observe the situation and anticipate outcomes.</p><ul><li>You might spot telltale signs of trouble before it happens.</li><li>You might uncover opportunities or weaknesses.</li></ul><ul><li>You might detect a person's motives or intentions <em>(but <strong>Studying</strong> might be better)</em>.</li><li>You could try to spot a good ambush point <em>(but <strong>Hunting</strong> might be better)</em>.</li></ul><hr><ul><li>How do you survey the situation?</li><li>Is there anything special you're looking out for?</li><li>What do you hope to understand?</li></ul>",
    tinker: "<p>When you <strong>Tinker</strong>, you fiddle with devices and mechanisms.</p><ul><li>You might create a new gadget or alter an existing item.</li><li>You might pick a lock or crack a safe.</li><li>You might disable an alarm or trap.</li><li>You might turn the sparkcraft and electroplasmic devices around the city to your advantage.</li></ul><ul><li>You could try to control a vehicle with your tech-savvy <em>(but <strong>Finessing</strong> might be better)</em>.</li></ul><hr><ul><li>What do you tinker with?</li><li>What do you hope to accomplish?</li></ul>",
    finesse: "<p>When you <strong>Finesse</strong>, you employ dexterity or subtle misdirection.</p><ul><li>You might pick someone's pocket.</li><li>You might handle the controls of a vehicle or direct a mount.</li><li>You might formally duel an opponent with graceful fighting arts.</li></ul><ul><li>You could try to leverage agility in a melee <em>(but <strong>Skirmishing</strong> might be better)</em>.</li><li>You could try to pick a lock <em>(but <strong>Tinkering</strong> might be better)</em>.</li></ul><hr><ul><li>What do you finesse?</li><li>What's graceful or subtle about this?</li><li>What do you hope to achieve?</li></ul>",
    prowl: "<p>When you <strong>Prowl</strong>, you traverse skillfully and quietly.</p><ul><li>You might sneak past a guard or hide in the shadows.</li><li>You might run and leap across the rooftops.</li><li>You might attack someone from hiding with a back-stab or blackjack.</li></ul><ul><li>You could try to waylay a victim during combat <em>(but <strong>Skirmishing</strong> might be better)</em>.</li></ul><hr><ul><li>How do you prowl?</li><li>How do you use the environment around you?</li><li>What do you hope to achieve?</li></ul>",
    skirmish: "<p>When you <strong>Skirmish</strong>, you entangle a target in melee so they can't escape.</p><ul><li>You might brawl or wrestle with them.</li><li>You might hack and slash.</li><li>You might seize or hold a position in battle.</li></ul><ul><li>You could try to fight in a formal duel <em>(but <strong>Finessing</strong> might be better)</em>.</li></ul><hr><ul><li>How do you skirmish with them?</li><li>What combat methods do you use?</li><li>What do you hope to achieve?</li></ul>",
    wreck: "<p>When you <strong>Wreck</strong>, you unleash savage force.</p><ul><li>You might smash down a door or wall with a sledgehammer.</li><li>You might use an explosive to do the same.</li><li>You might use chaos or sabotage to create distractions or overcome obstacles.</li></ul><ul><li>You could try to overwhelm an enemy with sheer force in battle <em>(but <strong>Skirmishing</strong> might be better)</em>.</li></ul><hr><ul><li>What do you wreck?</li><li>What force do you bring to bear?</li><li>What do you hope to accomplish?</li></ul>",
    attune: "<p>When you <strong>Attune</strong>, you open your mind to the ghost field or channel nearby electroplasmic energy through your body.</p><ul><li>You might communicate with a ghost or understand aspects of spectrology.</li><li>You might peer into the echo of Doskvol in the ghost field.</li></ul><ul><li>You could try to perceive beyond sight in order to better understand your situation <em>(but <strong>Surveying</strong> might be better)</em>.</li></ul><hr><ul><li>How do you open your mind to the ghost field?</li><li>What does that look like?</li><li>What energy are you attuning to?</li><li>How are you channeling that energy?</li><li>What do you hope the energy will do?</li></ul>",
    command: "<p>When you <strong>Command</strong>, you compel swift obedience.</p><ul><li>You might intimidate or threaten to get what you want.</li><li>You might lead a gang in a group action.</li></ul><ul><li>You could try to persuade people by giving orders <em>(but <strong>Consorting</strong> might be better)</em>.</li></ul><hr><ul><li>Who do you command?</li><li>How do you do it—what's your leverage here?</li><li>What do you hope they'll do?</li></ul>",
    consort: "<p>When you <strong>Consort</strong>, you socialize with friends and contacts.</p><ul><li>You might gain access to resources, information, people, or places.</li><li>You might make a good impression or win someone over with charm and style.</li><li>You might make new friends or connect with your heritage or background.</li></ul><ul><li>You could try to direct allies with social pressure <em>(but <strong>Commanding</strong> might be better)</em>.</li></ul><hr><ul><li>Who do you consort with?</li><li>Where do you meet?</li><li>What do you talk about?</li><li>What do you hope to achieve?</li></ul>",
    sway: "<p>When you <strong>Sway</strong>, you influence someone with guile, charm, or argument.</p><ul><li>You might lie convincingly.</li><li>You might persuade someone to do what you want.</li><li>You might argue a case that leaves no clear rebuttal.</li></ul><ul><li>You could try to trick people into affection or obedience <em>(but <strong>Consorting</strong> or <strong>Commanding</strong> might be better)</em>.</li></ul><hr><ul><li>Who do you sway?</li><li>What kind of leverage do you have here?</li><li>What do you hope they'll do?</li></ul>"
  },
  ActionVerbs: {
    hunt: "hunts",
    study: "studies",
    survey: "surveys",
    tinker: "tinkers",
    finesse: "finesses",
    prowl: "prowls",
    skirmish: "skirmishes",
    wreck: "wrecks",
    attune: "attunes",
    command: "commands",
    consort: "consorts",
    sway: "sways"
  },
  ActionPastVerbs: {
    hunt: "hunted",
    study: "studied",
    survey: "surveyed",
    tinker: "tinkered",
    finesse: "finessed",
    prowl: "prowled",
    skirmish: "skirmished",
    wreck: "wrecked",
    attune: "attuned",
    command: "commanded",
    consort: "consorted",
    sway: "swayed"
  },
  TraumaTooltips: {
    Cold: "You're not moved by emotional appeals or social bonds.",
    Haunted: "You're often lost in reverie, reliving past horrors, seeing things.",
    Obsessed: "You're enthralled by one thing: an activity, a person, an ideology.",
    Paranoid: "You imagine danger everywhere; you can't trust others.",
    Reckless: "You have little regard for your own safety or best interests.",
    Soft: "You lose your edge; you become sentimental, passive, gentle.",
    Unstable: "Your emotional state is volatile. You can instantly rage, or fall into despair, act impulsively, or freeze up.",
    Vicious: "You seek out opportunities to hurt people, even for no good reason.",
    Chaotic: "You've become so detached from the living that inhibitions fall away, leaving you impulsive and unpredictable.",
    Destructive: "You are easily angered by reminders of all you've lost, and can lash out violently against the trappings of the living world.",
    Furious: "Your ravaged soul is fertile kindling for rage, and your fury is easily ignited.",
    Obsessive: "Your wants and desires become fixations and compulsions, driving you to achieve them at any cost.",
    Territorial: "You see some place as yours: Trespassers are dealt with, and even guests must respect your claim.",
    Savage: "When moved to anger or violence, you act with cruelty and feral malevolence.",
    Clanking: "Your frame has developed a persistent metallic clang with each step, making stealth difficult.",
    Leaking: "You continuously leak oil, leviathan blood, distilled electroplasm or some other potentially-dangerous substance.",
    Fixated: "You have become fixated on a function of your choice, and lose all memory of your humanity when you pursue it.",
    Smoking: "Your frame exudes a constant miasma of acrid, foul-smelling smoke.",
    Sparking: "Electroplasmic energy erupts in arcing sparks from joints and junctions throughout your frame.",
    Ruthless: "You lose any sense of humanity when indulging your Vice or pursuing your most important goal.",
    Secretive: "Knowledge has become so precious to you, that even your closest allies are on a need-to-know basis."
  },
  EdgeTooltips: {
    Fearsome: "<p>The cohort is terrifying in aspect and reputation.</p>",
    Independent: "<p>The cohort can be trusted to make good decisions and act on their own initiative in the absence of direct orders.</p>",
    Loyal: "<p>The cohort can't be bribed or turned against you. </p>",
    Tenacious: "<p>The cohort won't be deterred from a task.</p>",
    Nimble: "<p>The vehicle handles easily. Consider this an <strong>assist</strong> for tricky maneuvers.</p>",
    Simple: "<p>The vehicle is easy to repair. Remove all of its <strong>Harm</strong> during <strong>downtime</strong></p>",
    Sturdy: "<p>The vehicle keeps operating even when <strong>Broken</strong>.</p>",
    "Arrow-Swift": "<p>Your pet gains <strong>Potency</strong> when tracking or fighting the supernatural.</p><p>It can move extremely quickly, outpacing any other creature or vehicle.</p>",
    "Ghost Form": "<p>Your pet gains <strong>Potency</strong> when tracking or fighting the supernatural.</p><p>It can transform into electroplasmic vapor as if it were a spirit.</p>",
    "Mind Link": "<p>Your pet gains <strong>Potency</strong> when tracking or fighting the supernatural.</p><p>You and your pet can share senses and thoughts telepathically.</p>"
  },
  FlawTooltips: {
    Principled: "<p>The cohort has an ethic or values that it won't betray.</p>",
    Savage: "<p>The cohort is excessively violent and cruel.</p>",
    Unreliable: "<p>The cohort isn't always available, due to other obligations, stupefaction from their vices, etc.</p>",
    Wild: "<p>The cohort is drunken, debauched, and loud-mouthed.</p>",
    Costly: "<p>The vehicle costs <strong>1 Coin</strong> per <strong>downtime</strong> to keep it in operation.</p>",
    Distinct: "<p>The vehicle has memorable features. Take <strong>+1 Heat</strong> when you use it on a score.</p>",
    Finicky: "<p>The vehicle has quirks that only one person understands. When operated without them, it has <strong>-1 Quality</strong>.</p>"
  },
  QualityDescriptors: [
    "Poor",
    "Adequate",
    "Good",
    "Excellent",
    "Superior",
    "Impeccable",
    "Legendary"
  ],
  ForceDescriptors: [
    "Weak",
    "Moderate",
    "Strong",
    "Serious",
    "Powerful",
    "Overwhelming",
    "Devastating"
  ],
  VehicleDescriptors: [
    "A Vehicle?",
    "A Vehicle",
    "A Respectable Vehicle",
    "A Respected Vehicle",
    "A Precision-Built Vehicle",
    "A Powerful, Advanced Vehicle",
    "A Uniquely Strong, Extremely Advanced Vehicle"
  ],
  PetDescriptors: [
    "A Weak Hunting Pet",
    "A Hunting Pet",
    "A Strong Hunting Pet",
    "A Serious Hunting Pet",
    "A Powerful Hunting Pet",
    "An Overwhelmingly Powerful Hunting Pet",
    "A Devastating Hunting Pet"
  ],
  AreaExamples: [
    "a closet",
    "a small room",
    "a large room",
    "several rooms",
    "a small building",
    "a large building",
    "a city block"
  ],
  ScaleExamples: [
    "(1 or 2 members)",
    "(3 - 6 members)",
    "(~12 members)",
    "(~20 members)",
    "(~40 members)",
    "(~80 members)",
    "(~160 members)"
  ],
  ScaleSizes: [
    "A Few ",
    "A Small Gang of ",
    "A Gang of ",
    "A Large Gang of ",
    "A Small Army of ",
    "An Army of ",
    "A Massive Army of "
  ],
  DiceOddsStandard: [
    { crit: 0, success: 2.8, partial: 22.2, fail: 75 },
    { crit: 0, success: 16.7, partial: 33.3, fail: 50 },
    { crit: 2.8, success: 27.8, partial: 44.4, fail: 25 },
    { crit: 7.4, success: 34.7, partial: 45.4, fail: 12.5 },
    { crit: 13.2, success: 38.6, partial: 42, fail: 6.3 },
    { crit: 19.6, success: 40.2, partial: 37.1, fail: 3.1 },
    { crit: 26.3, success: 40.2, partial: 31.9, fail: 1.6 },
    { crit: 33, success: 39.1, partial: 27.1, fail: 0.8 },
    { crit: 39.5, success: 37.2, partial: 22.9, fail: 0.4 },
    { crit: 45.7, success: 34.9, partial: 19.2, fail: 0.2 },
    { crit: 51.5, success: 32.3, partial: 16.1, fail: 0.1 },
    { crit: 56.9, success: 29.6, partial: 13.4, fail: 0 },
    { crit: 61.9, success: 26.9, partial: 11.2, fail: 0 },
    { crit: 66.3, success: 24.3, partial: 9.3, fail: 0 },
    { crit: 70.4, success: 21.8, partial: 7.8, fail: 0 },
    { crit: 74, success: 19.5, partial: 6.5, fail: 0 },
    { crit: 77.3, success: 17.3, partial: 5.4, fail: 0 },
    { crit: 80.2, success: 15.3, partial: 4.5, fail: 0 },
    { crit: 82.7, success: 13.5, partial: 3.8, fail: 0 },
    { crit: 85, success: 11.9, partial: 3.1, fail: 0 },
    { crit: 87, success: 10.4, partial: 2.6, fail: 0 }
  ],
  DiceOddsResistance: [
    // Stress Cost: [-1, 0, 1, 2, 3, 4, 5]
    [0, 2.8, 8.3, 13.9, 19.4, 25, 30.6],
    [0, 16.7, 16.7, 16.7, 16.6, 16.7, 16.7],
    [2.8, 27.8, 25, 19.4, 13.9, 8.3, 2.8],
    [7.4, 34.7, 28.3, 17.1, 8.8, 3.2, 0.5],
    [13.2, 38.6, 28.5, 13.5, 5, 1.2, 0.1],
    [19.6, 40.2, 27, 10.1, 2.7, 0.4, 0],
    [26.3, 40.2, 24.7, 7.2, 1.4, 0.1, 0]
  ],
  ExperienceClues: {
    Scoundrel: [
      "You expressed your beliefs, drives, heritage, or background.",
      "You struggled with issues from your vice or traumas during the session."
    ],
    Crew: [
      "You contended with challenges above your current station.",
      "You bolstered your crew's reputation, or developed a new one.",
      "You expressed the goals, drives, inner conflict, or essential nature of the crew."
    ]
  },
  GatherInfoQuestions: {
    Cutter: [
      "How can I hurt them?",
      "Who's most afraid of me?",
      "Who's most dangerous here?",
      "What do they intend to do?",
      "How can I get them to [X]?",
      "Are they telling the truth?",
      "What's really going on here?"
    ],
    Hound: [
      "What do they intend to do?",
      "How can I get them to [X]?",
      "What are they really feeling?",
      "Where are they vulnerable?",
      "Where did [X] go?",
      "How can I find [X]?",
      "What's really going on here?"
    ],
    Leech: [
      "What do they intend to do?",
      "How can I get them to [X]?",
      "Are they telling the truth?",
      "What can I tinker with here?",
      "What might happen if I [X]?",
      "How can I find [X]?",
      "What's really going on here?"
    ],
    Lurk: [
      "What do they intend to do?",
      "How can I get them to [X]?",
      "What should I look out for?",
      "What's the best way in?",
      "Where can I hide here?",
      "How can I find [X]?",
      "What's really going on here?"
    ],
    Slide: [
      "What do they intend to do?",
      "How can I get them to [X]?",
      "Are they telling the truth?",
      "What are they really feeling?",
      "What do they really care about?",
      "How can I blend in here?",
      "What's really going on here?"
    ],
    Spider: [
      "What do they want most?",
      "What should I look out for?",
      "Where's the leverage here?",
      "How can I discover [X]?",
      "What do they intend to do?",
      "How can I get them to [X]?",
      "What's really going on here?"
    ],
    Whisper: [
      "What is arcane or weird here?",
      "What echoes in the ghost field?",
      "What is hidden or lost here?",
      "What do they intend to do?",
      "What drives them to do this?",
      "How can I reveal [X]?",
      "What's really going on here?"
    ],
    Ghost: [
      "What do they intend to do?",
      "How can I get them to [X]?",
      "What are they really feeling?",
      "What should I lookout for?",
      "Where's the weakness here?",
      "How can I find [X]?",
      "What's really going on here?"
    ],
    Hull: [
      "What do they intend to do?",
      "How can I get them to [X]?",
      "What are they really doing?",
      "What should I lookout for?",
      "Where's the weakness here?",
      "How can I find [X]?",
      "What's really going on here?"
    ],
    Vampire: [
      "What do they intend to do?",
      "How can I get them to [X]?",
      "What are they really feeling?",
      "What should I lookout for?",
      "Where's the weakness here?",
      "How can I find [X]?",
      "What's really going on here?"
    ]
  },
  Playbooks: {
    Cutter: {
      "system.experience_clues": [
        "You addressed a challenge with violence or coercion.",
        "You expressed your beliefs, drives, heritage, or background.",
        "You struggled with issues from your vice or traumas during the session."
      ],
      "system.trauma_conditions": ["Cold", "Haunted", "Obsessed", "Paranoid", "Reckless", "Soft", "Unstable", "Vicious"],
      "system.gather_info_questions": [
        "How can I hurt them?",
        "Who's most afraid of me?",
        "Who's most dangerous here?",
        "What do they intend to do?",
        "How can I get them to [X]?",
        "Are they telling the truth?",
        "What's really going on here?"
      ],
      "system.suggested_ability": "Battleborn"
    },
    Hound: {
      "system.bgImg": "systems/eunos-blades/assets/icons/class-icons/hound-trans.svg",
      "system.tagline": "A Deadly Sharpshooter & Tracker",
      // "system.acquaintances_name": "Deadly Friends & Rivals",
      "system.friends_name": "Deadly Friends",
      "system.rivals_name": "Deadlier Rivals",
      "system.starting_stats.chargen": {
        "system.attributes.insight.hunt.value": 2,
        "system.attributes.insight.survey.value": 1
      },
      "system.experience_clues": [
        "You addressed a challenge with tracking or violence.",
        "You expressed your beliefs, drives, heritage, or background.",
        "You struggled with issues from your vice or traumas during the session."
      ],
      "system.trauma_conditions": ["Cold", "Haunted", "Obsessed", "Paranoid", "Reckless", "Soft", "Unstable", "Vicious"],
      "system.gather_info_questions": [
        "What do they intend to do?",
        "How can I get them to [X]?",
        "What are they really feeling?",
        "Where are they vulnerable?",
        "Where did [X] go?",
        "How can I find [X]?",
        "What's really going on here?"
      ],
      "system.suggested_ability": "Sharpshooter"
    },
    Leech: {
      "system.bgImg": "systems/eunos-blades/assets/icons/class-icons/leech-trans.svg",
      "system.tagline": "A Saboteur & Technician",
      // "system.acquaintances_name": "Clever Friends & Rivals",
      "system.friends_name": "Clever Friends",
      "system.rivals_name": "Cleverer Rivals",
      "system.starting_stats.chargen": {
        "system.attributes.insight.tinker.value": 2,
        "system.attributes.prowess.wreck.value": 1
      },
      "system.experience_clues": [
        "You addressed a challenge with technical skill or mayhem.",
        "You expressed your beliefs, drives, heritage, or background.",
        "You struggled with issues from your vice or traumas during the session."
      ],
      "system.trauma_conditions": ["Cold", "Haunted", "Obsessed", "Paranoid", "Reckless", "Soft", "Unstable", "Vicious"],
      "system.gather_info_questions": [
        "What do they intend to do?",
        "How can I get them to [X]?",
        "Are they telling the truth?",
        "What can I tinker with here?",
        "What might happen if I [X]?",
        "How can I find [X]?",
        "What's really going on here?"
      ],
      "system.suggested_ability": "Alchemist"
    },
    Lurk: {
      "system.bgImg": "systems/eunos-blades/assets/icons/class-icons/lurk-trans.svg",
      "system.tagline": "A Stealthy Infiltrator & Burglar",
      // "system.acquaintances_name": "Shady Friends & Rivals",
      "system.friends_name": "Shady Friends",
      "system.rivals_name": "Shadier Rivals",
      "system.starting_stats.chargen": {
        "system.attributes.prowess.prowl.value": 2,
        "system.attributes.prowess.finesse.value": 1
      },
      "system.experience_clues": [
        "You addressed a challenge with stealth or evasion.",
        "You expressed your beliefs, drives, heritage, or background.",
        "You struggled with issues from your vice or traumas during the session."
      ],
      "system.trauma_conditions": ["Cold", "Haunted", "Obsessed", "Paranoid", "Reckless", "Soft", "Unstable", "Vicious"],
      "system.gather_info_questions": [
        "What do they intend to do?",
        "How can I get them to [X]?",
        "What should I look out for?",
        "What's the best way in?",
        "Where can I hide here?",
        "How can I find [X]?",
        "What's really going on here?"
      ],
      "system.suggested_ability": "Infiltrator"
    },
    Slide: {
      "system.bgImg": "systems/eunos-blades/assets/icons/class-icons/slide-trans.svg",
      "system.tagline": "A Subtle Manipulator & Spy",
      // "system.acquaintances_name": "Sly Friends & Rivals",
      "system.friends_name": "Sly Friends",
      "system.rivals_name": "Slyer Rivals",
      "system.starting_stats.chargen": {
        "system.attributes.resolve.sway.value": 2,
        "system.attributes.resolve.consort.value": 1
      },
      "system.experience_clues": [
        "You addressed a challenge with deception or influence.",
        "You expressed your beliefs, drives, heritage, or background.",
        "You struggled with issues from your vice or traumas during the session."
      ],
      "system.trauma_conditions": ["Cold", "Haunted", "Obsessed", "Paranoid", "Reckless", "Soft", "Unstable", "Vicious"],
      "system.gather_info_questions": [
        "What do they intend to do?",
        "How can I get them to [X]?",
        "Are they telling the truth?",
        "What are they really feeling?",
        "What do they really care about?",
        "How can I blend in here?",
        "What's really going on here?"
      ],
      "system.suggested_ability": "Rook's Gambit"
    },
    Spider: {
      "system.bgImg": "systems/eunos-blades/assets/icons/class-icons/spider-trans.svg",
      "system.tagline": "A Devious Mastermind",
      // "system.acquaintances_name": "Shrewd Friends & Rivals",
      "system.friends_name": "Shrewd Friends",
      "system.rivals_name": "Very Shrewd Rivals",
      "system.starting_stats.chargen": {
        "system.attributes.resolve.consort.value": 2,
        "system.attributes.insight.study.value": 1
      },
      "system.experience_clues": [
        "You addressed a challenge with calculation or conspiracy.",
        "You expressed your beliefs, drives, heritage, or background.",
        "You struggled with issues from your vice or traumas during the session."
      ],
      "system.trauma_conditions": ["Cold", "Haunted", "Obsessed", "Paranoid", "Reckless", "Soft", "Unstable", "Vicious"],
      "system.gather_info_questions": [
        "What do they want most?",
        "What should I look out for?",
        "Where's the leverage here?",
        "How can I discover [X]?",
        "What do they intend to do?",
        "How can I get them to [X]?",
        "What's really going on here?"
      ],
      "system.suggested_ability": "Foresight"
    },
    Whisper: {
      "system.bgImg": "systems/eunos-blades/assets/icons/class-icons/whisper-trans.svg",
      "system.tagline": "An Arcane Adept & Channeler",
      // "system.acquaintances_name": "Strange Friends & Rivals",
      "system.friends_name": "Strange Friends",
      "system.rivals_name": "Stranger Rivals",
      "system.starting_stats.chargen": {
        "system.attributes.resolve.attune.value": 2,
        "system.attributes.insight.study.value": 1
      },
      "system.experience_clues": [
        "You addressed a challenge with knowledge or arcane power.",
        "You expressed your beliefs, drives, heritage, or background.",
        "You struggled with issues from your vice or traumas during the session."
      ],
      "system.trauma_conditions": ["Cold", "Haunted", "Obsessed", "Paranoid", "Reckless", "Soft", "Unstable", "Vicious"],
      "system.gather_info_questions": [
        "What is arcane or weird here?",
        "What echoes in the ghost field?",
        "What is hidden or lost here?",
        "What do they intend to do?",
        "What drives them to do this?",
        "How can I reveal [X]?",
        "What's really going on here?"
      ],
      "system.suggested_ability": "Compel"
    },
    Ghost: {
      "system.bgImg": "systems/eunos-blades/assets/icons/class-icons/ghost-trans.svg",
      "system.tagline": "A Vengeful Disembodied Spirit",
      "system.acquaintances_name": "Enemies & Rivals",
      "system.starting_stats.add": {
        "system.attributes.insight.hunt.value": 1,
        "system.attributes.prowess.prowl.value": 1,
        "system.attributes.resolve.attune.value": 1
      },
      "system.experience_clues": [
        "You exacted vengeance upon those whom you deem deserving.",
        "You expressed your outrage or anger, or settled scores from your heritage, or background.",
        "You struggled with issues from your need or glooms during the session."
      ],
      "system.trauma_conditions": ["Chaotic", "Destructive", "Furious", "Obsessive", "Territorial", "Savage"],
      "system.gather_info_questions": [
        "What do they intend to do?",
        "How can I get them to [X]?",
        "What are they really feeling?",
        "What should I lookout for?",
        "Where's the weakness here?",
        "How can I find [X]?",
        "What's really going on here?"
      ],
      "system.auto_abilities": ["Ghost Form"]
    },
    Hull: {
      "system.bgImg": "systems/eunos-blades/assets/icons/class-icons/hull-trans.svg",
      "system.tagline": "An Animated Spark-Craft Frame",
      "system.acquaintances_name": "Master",
      "system.starting_stats.add": {
        "system.attributes.prowess.skirmish.value": 1,
        "system.attributes.resolve.attune.value": 1
      },
      "system.experience_clues": [
        "You fulfilled your functions despite difficulty or danger.",
        "You suppressed or ignored your former human beliefs, drives, heritage, or background.",
        "You struggled with issues from your wear during the session."
      ],
      "system.trauma_conditions": ["Clanking", "Leaking", "Fixated", "Smoking", "Sparking", "Unstable"],
      "system.gather_info_questions": [
        "What do they intend to do?",
        "How can I get them to [X]?",
        "What are they really doing?",
        "What should I lookout for?",
        "Where's the weakness here?",
        "How can I find [X]?",
        "What's really going on here?"
      ],
      "system.auto_abilities": ["Automaton"]
    },
    Vampire: {
      "system.bgImg": "systems/eunos-blades/assets/icons/class-icons/vampire-trans.svg",
      "system.tagline": "An Animated Undead Body",
      "system.acquaintances_name": "Dark Servants",
      "system.starting_stats.add": {
        "system.attributes.insight.hunt.value": 1,
        "system.attributes.prowess.prowl.value": 1,
        "system.attributes.prowess.skirmish.value": 1,
        "system.attributes.resolve.attune.value": 1,
        "system.attributes.resolve.command.value": 1,
        "system.attributes.resolve.sway.value": 1
      },
      "system.experience_clues": [
        "You displayed your dominance or slayed without mercy.",
        "You expressed your beliefs, drives, heritage, or background.",
        "You struggled with issues from your vice, traumas, or strictures during the session."
      ],
      "system.trauma_conditions": ["Cold", "Haunted", "Obsessed", "Paranoid", "Ruthless", "Secretive", "Unstable", "Vicious"],
      "system.gather_info_questions": [
        "What do they intend to do?",
        "How can I get them to [X]?",
        "What are they really feeling?",
        "What should I lookout for?",
        "Where's the weakness here?",
        "How can I find [X]?",
        "What's really going on here?"
      ],
      "system.auto_abilities": ["Undead"]
    }
  },
  ClockSizes: [1, 2, 3, 4, 5, 6, 8, 10, 12],
  ActorTypes: [
    "pc",
    "npc",
    "crew",
    "faction"
    /* faction */
  ],
  ItemTypes: [
    "ability",
    "background",
    "clock_keeper",
    "cohort_gang",
    "cohort_expert",
    "crew_ability",
    "crew_reputation",
    "crew_playbook",
    "crew_upgrade",
    "feature",
    "gm_tracker",
    "heritage",
    "gear",
    "playbook",
    "preferred_op",
    "stricture",
    "vice",
    "project",
    "ritual",
    "design",
    "location",
    "score"
    /* score */
  ],
  SimpleItemTypes: [
    "background",
    "crew_reputation",
    "feature",
    "heritage",
    "preferred_op",
    "stricture"
    /* stricture */
  ],
  Attribute: [
    "insight",
    "prowess",
    "resolve"
    /* resolve */
  ],
  Action: {
    insight: [
      "hunt",
      "study",
      "survey",
      "tinker"
      /* tinker */
    ],
    prowess: [
      "finesse",
      "prowl",
      "skirmish",
      "wreck"
      /* wreck */
    ],
    resolve: [
      "attune",
      "command",
      "consort",
      "sway"
      /* sway */
    ]
  },
  Vices: [
    "Faith",
    "Gambling",
    "Luxury",
    "Obligation",
    "Pleasure",
    "Stupor",
    "Weird",
    "Worship",
    "Living_Essence",
    "Life_Essence",
    "Electroplasmic_Power"
    /* Electroplasmic_Power */
  ]
}, Be = {
  NPC: {
    heritage: [
      "Akorosi",
      "Akorosi",
      "Akorosi",
      "Akorosi",
      "Akorosi",
      "Akorosi",
      "Dagger Islander",
      "Iruvian",
      "Severosi",
      "Skovlander",
      "Skovlander",
      "Tycherosi"
    ],
    background: [
      "Academic",
      "Academic",
      "Academic",
      "Labor",
      "Labor",
      "Labor",
      "Labor",
      "Law",
      "Law",
      "Law",
      "Military",
      "Military",
      "Military",
      "Military",
      "Military",
      "New Money",
      "New Money",
      "Old Money",
      "Old Money",
      "Politics",
      "Politics",
      "Trade",
      "Trade",
      "Trade",
      "Underworld",
      "Underworld",
      "Underworld",
      "Underworld",
      "Underworld",
      "Weird"
    ],
    gender: [
      "M",
      "M",
      "M",
      "M",
      "F",
      "F",
      "F",
      "U",
      "X"
    ],
    appearance: [
      "Athletic",
      "Beard",
      "Bony",
      "Chiseled",
      "Crippled / Prosthetic",
      "Cute",
      "Dark",
      "Delicate",
      "Disfigured / Maimed",
      "Elegant",
      "Fair",
      "Glasses / Monocle",
      "Handsome",
      "Large",
      "Long Hair",
      "Lovely",
      "Old",
      "Plain",
      "Plump",
      "Rough",
      "Scarred",
      "Sexy",
      "Shaved Bald",
      "Short",
      "Slim",
      "Stooped",
      "Stout",
      "Strange",
      "Striking",
      "Stylish",
      "Tall",
      "Tattooed",
      "Weathered",
      "Wig",
      "Wild",
      "Wiry",
      "Worn",
      "Young"
    ],
    goal: [
      "Achievement",
      "Authority",
      "Change",
      "Chaos / Destruction",
      "Control",
      "Cooperation",
      "Freedom",
      "Happiness",
      "Infamy / Fear",
      "Justice",
      "Knowledge",
      "Love",
      "Pleasure",
      "Power",
      "Prestige / Fame",
      "Respect",
      "Revenge",
      "Wealth"
    ],
    method: [
      "Alchemy",
      "Arcane",
      "Blackmail",
      "Chaos",
      "Commerce",
      "Espionage",
      "Hard Work",
      "Law / Politics",
      "Manipulation",
      "Negotiation",
      "Sabotage",
      "Strategy",
      "Study",
      "Subterfuge",
      "Teamwork",
      "Theft",
      "Threats",
      "Violence"
    ],
    profession: [
      "Advocate",
      "Apiarist",
      "Architect",
      "Artist",
      "Author",
      "Bailiff",
      "Baker",
      "Baker",
      "Baker",
      "Banker",
      "Barber",
      "Barber",
      "Barber",
      "Blacksmith",
      "Blacksmith",
      "Blacksmith",
      "Bounty Hunter",
      "Brewer",
      "Brewer",
      "Brewer",
      "Butcher",
      "Butcher",
      "Butcher",
      "Captain",
      "Carpenter",
      "Carpenter",
      "Carpenter",
      "Cartwright",
      "Cartwright",
      "Cartwright",
      "Chandler",
      "Chandler",
      "Chandler",
      "Clerk",
      "Clerk",
      "Clerk",
      "Clockmaker",
      "Cobbler",
      "Cobbler",
      "Cobbler",
      "Composer",
      "Cooper",
      "Cooper",
      "Cooper",
      "Courtesan",
      "Criminal",
      "Criminal",
      "Criminal",
      "Cultivator",
      "Cultivator",
      "Cultivator",
      "Diplomat",
      "Driver",
      "Driver",
      "Driver",
      "Dyer",
      "Dyer",
      "Dyer",
      "Embroiderer",
      "Embroiderer",
      "Embroiderer",
      "Explorer",
      "Fishmonger",
      "Fishmonger",
      "Fishmonger",
      "Furrier",
      "Glass Blower",
      "Goat Herd",
      "Goat Herd",
      "Goat Herd",
      "Gondolier",
      "Gondolier",
      "Gondolier",
      "Guard",
      "Guard",
      "Guard",
      "Jailer",
      "Jeweler",
      "Journalist",
      "Leatherworker",
      "Leatherworker",
      "Leatherworker",
      "Leech",
      "Locksmith",
      "Magistrate",
      "Mason",
      "Mason",
      "Mason",
      "Merchant",
      "Merchant",
      "Merchant",
      "Messenger",
      "Messenger",
      "Messenger",
      "Musician",
      "Physicker",
      "Plumber",
      "Printer",
      "Rail Jack",
      "Roofer",
      "Roofer",
      "Roofer",
      "Ropemaker",
      "Ropemaker",
      "Ropemaker",
      "Rug Maker",
      "Rug Maker",
      "Rug Maker",
      "Sailor",
      "Sailor",
      "Sailor",
      "Scholar",
      "Scribe",
      "Servant",
      "Servant",
      "Servant",
      "Shipwright",
      "Shipwright",
      "Shipwright",
      "Soldier",
      "Sparkwright",
      "Spirit Warden",
      "Steward",
      "Tailor",
      "Tailor",
      "Tailor",
      "Tanner",
      "Tanner",
      "Tanner",
      "Tax Collector",
      "Tinkerer",
      "Tinkerer",
      "Tinkerer",
      "Treasurer",
      "Vendor",
      "Vendor",
      "Vendor",
      "Weaver",
      "Weaver",
      "Weaver",
      "Whisper",
      "Woodworker",
      "Woodworker",
      "Woodworker"
    ],
    trait: [
      "Arcane",
      "Arrogant",
      "Artistic",
      "Bold",
      "Brash",
      "Brave",
      "Calculating",
      "Calm",
      "Candid",
      "Careless",
      "Cautious",
      "Cavalier",
      "Charming",
      "Cold",
      "Commanding",
      "Compassionate",
      "Confident",
      "Connected",
      "Cooperative",
      "Creative",
      "Cruel",
      "Cultured",
      "Daring",
      "Defiant",
      "Dishonest",
      "Dramatic",
      "Elitist",
      "Enigmatic",
      "Enthusiastic",
      "Erudite",
      "Experienced",
      "Fierce",
      "Flexible",
      "Friendly",
      "Gracious",
      "Greedy",
      "Haunted",
      "Insightful",
      "Kind",
      "Melancholy",
      "Moody",
      "Obsessive",
      "Paranoid",
      "Patient",
      "Popular",
      "Principled",
      "Proud",
      "Quiet",
      "Reckless",
      "Respected",
      "Ruthless",
      "Sadistic",
      "Savage",
      "Secretive",
      "Shrewd",
      "Sincere",
      "Sneaky",
      "Sophisticated",
      "Strange",
      "Stylish",
      "Subtle",
      "Suspicious",
      "Tough",
      "Vain",
      "Vengeful",
      "Vicious",
      "Visionary",
      "Volatile",
      "Weird",
      "Wise"
    ],
    interests: [
      "Alchemy, medicine",
      "Antiques, artifacts, curios",
      "Arcane books, rituals",
      "Architecture, furnishings",
      "Church of Ecstasy",
      "Cooking, gardening",
      "Craft (leatherwork, etc.)",
      "Demon lore, legends",
      "Drugs, essences, tobacco",
      "Essences, alchemy",
      "Exploration, adventure",
      "Fine arts, opera, theater",
      "Fine clothes, jewelry, furs",
      "Fine food, restaurants",
      "Fine whiskey, wine, beer",
      "Forgotten gods",
      "Gadgets, new technology",
      "Gambling, cards, dice",
      "History, legends",
      "Horses, riding",
      "Hunting, shooting",
      "Lovers, romance, trysts",
      "Music, instruments, dance",
      "Natural philosophy",
      "Painting, drawing, sculpture",
      "Parties, social events",
      "Path of Echoes",
      "Pets (birds, dogs, cats)",
      "Pit-fighting, duels",
      "Poetry, novels, writing",
      "Politics, journalism",
      "Pre-cataclysm legends",
      "Ships, boating",
      "Spectrology, electroplasm",
      "Weapons collector",
      "Weeping Lady, charity"
    ],
    quirk: [
      "A fraud. Some important aspect is fabricated.",
      "Bigoted against culture / belief / social class.",
      "Black sheep / outcast from family or organization.",
      "Blind to flaws in friends, allies, family, etc.",
      "Celebrity. Popularized in print / song / theater.",
      "Concerned with appearances, gossip, peers.",
      "Cursed, haunted, harassed by spirits or demon.",
      "Deeply traditional. Opposed to new ideas.",
      "Devoted to their family.",
      "Drug / alcohol abuser. Often impaired by their vice.",
      "Extensive education on every scholarly subject.",
      "Has chronic illness that requires frequent care.",
      "Holds their position due to blackmail.",
      "Holds their position to spy for another faction.",
      "In prison or under noble's house arrest.",
      "Inherited their position. May not deserve / want it.",
      "Intense, unreasonable phobia or loathing.",
      "Involved with war crimes from the Unity War.",
      "Is blindly faithful to an ideal, group, or tradition.",
      "Keeps detailed journals, notes, records, ledgers.",
      "Leads a double life using cover identity.",
      "Married into important / powerful family.",
      "Massive debts (to banks / criminals / family)",
      "Once hollowed, then restored. Immune to spirits.",
      "Proud of heritage, traditions, native language.",
      "Reclusive. Prefers to interact via messengers.",
      "Relies on council to make decisions.",
      "Revolutionary. Plots against the Imperium.",
      "Scandalous reputation (deserved or not).",
      "Secretly (openly?) controlled by possessing spirit.",
      "Serves a demon's agenda (knowingly or not).",
      "Spotless reputation. Highly regarded.",
      "Superstitious. Believes in signs, magic numbers.",
      "Surrounded by sycophants, supplicants, toadies.",
      "Visionary. Holds radical views for future.",
      "Well-traveled. Connections outside Doskvol."
    ],
    style: {
      male: [
        "Apron",
        "Cane",
        "Collared Shirt",
        "Crutches",
        "Eelskin Bodysuit",
        "Face Mask",
        "Fitted Leggings",
        "Heavy Cloak",
        "Heavy Gloves",
        "Hide & Furs",
        "Hood & Veil",
        "Hooded Coat",
        "Knit Cap",
        "Leathers",
        "Long Coat",
        "Long Scarf",
        "Loose Silks",
        "Mask & Robes",
        "Rough Tunic",
        "Sharp Trousers",
        "Short Cloak",
        "Slim Jacket",
        "Soft Boots",
        "Suit & Vest",
        "Suspenders",
        "Tall Boots",
        "Tatters",
        "Thick Greatcoat",
        "Tool Belt",
        "Tricorn Hat",
        "Uniform",
        "Waxed Coat",
        "Wheelchair",
        "Wide Belt",
        "Work Boots"
      ],
      female: [
        "Apron",
        "Cane",
        "Crutches",
        "Eelskin Bodysuit",
        "Face Mask",
        "Fitted Dress",
        "Fitted Leggings",
        "Heavy Cloak",
        "Heavy Gloves",
        "Hide & Furs",
        "Hood & Veil",
        "Hooded Coat",
        "Knit Cap",
        "Leathers",
        "Long Coat",
        "Long Scarf",
        "Loose Silks",
        "Mask & Robes",
        "Rough Tunic",
        "Sharp Trousers",
        "Short Cloak",
        "Skirt & Blouse",
        "Slim Jacket",
        "Soft Boots",
        "Suspenders",
        "Tall Boots",
        "Tatters",
        "Thick Greatcoat",
        "Tool Belt",
        "Uniform",
        "Waxed Coat",
        "Wheelchair",
        "Wide Belt",
        "Work Boots"
      ]
    },
    name_title: [
      "Adept",
      "Archivist",
      "Captain",
      "Charter",
      "Scrivener"
    ],
    name_first: {
      male: [
        "Abel",
        "Abenthy",
        "Adric",
        "Airic",
        "Alabaster",
        "Alastair",
        "Aldo",
        "Alen",
        "Aleph",
        "Ambrose",
        "Amosen",
        "Andal",
        "Andrel",
        "Anton",
        "Aquilla",
        "Aradan",
        "Aram",
        "Archibald",
        "Archie",
        "Arden",
        "Arliden",
        "Arlyn",
        "Armand",
        "Arquo",
        "Arrell",
        "Arvus",
        "Asher",
        "Aurelio",
        "Benedict",
        "Bolster",
        "Brace",
        "Bran",
        "Brance",
        "Branon",
        "Bricks",
        "Brock",
        "Brutus",
        "Caius",
        "Carro",
        "Casian",
        "Cato",
        "Cavelle",
        "Cedric",
        "Chance",
        "Chauncey",
        "Cid",
        "Clave",
        "Cliff",
        "Cornelius",
        "Cross",
        "Crowl",
        "Cym",
        "Cyrus",
        "Declan",
        "Del",
        "Drav",
        "Drazhan",
        "Drem",
        "Edlun",
        "Edmund",
        "Edrom",
        "Edwin",
        "Elan",
        "Elend",
        "Elias",
        "Elodin",
        "Ephrim",
        "Erasmus",
        "Eremon",
        "Ethan",
        "Everitt",
        "Feldspar",
        "Fero",
        "Finn",
        "Fisher",
        "Galen",
        "Gallahad",
        "Garner",
        "Gilbert",
        "Glint",
        "Gnik",
        "Gregalos",
        "Grey",
        "Greyson",
        "Grifter",
        "Grine",
        "Gristofer",
        "Hadrian",
        "Hagran",
        "Hammond",
        "Hix",
        "Holtz",
        "Hugo",
        "Iden",
        "Irton",
        "Isaac",
        "Ivellios",
        "Jabari",
        "Jericho",
        "Jerod",
        "Kazimir",
        "Kellan",
        "Kelvyn",
        "Kelyr",
        "Khafra",
        "Kobb",
        "Kristov",
        "Kyrilu",
        "Lael",
        "Lafayette",
        "Laudius",
        "Lawrence",
        "Leif",
        "Lem",
        "Lenny",
        "Logan",
        "Lucas",
        "Lucius",
        "Lysander",
        "Milos",
        "Mord",
        "Morketh",
        "Morlan",
        "Myre",
        "Narcus",
        "Nehi",
        "Noggs",
        "Norton",
        "Obel",
        "Obelas",
        "Octavius",
        "Odelay",
        "Orem",
        "Orlan",
        "Orth",
        "Orton",
        "Pavel",
        "Perceval",
        "Percival",
        "Peregrine",
        "Phin",
        "Phineas",
        "Porto",
        "Preston",
        "Primo",
        "Quess",
        "Quill",
        "Rafe",
        "Rasmus",
        "Raul",
        "Resh",
        "Rias",
        "Ring",
        "Rivallo",
        "Rodmund",
        "Roethe",
        "Roose",
        "Roric",
        "Sethla",
        "Silas",
        "Sindri",
        "Snitch",
        "Sol",
        "Solomon",
        "Sprig",
        "Stavrul",
        "Stellan",
        "Stev",
        "Sym",
        "Tacitus",
        "Tarn",
        "Taylor",
        "Thackeray",
        "Thaddeus",
        "Thane",
        "Thelian",
        "Theo",
        "Theron",
        "Thurston",
        "Timoth",
        "Tisk",
        "Tocker",
        "Tristero",
        "Ulric",
        "Vask",
        "Veleris",
        "Ventaro",
        "Virgil",
        "Vond",
        "Wax",
        "Wayne",
        "Weaver",
        "Wester",
        "Winsley"
      ],
      female: [
        "Adaire",
        "Adelaide",
        "Adella",
        "Adroit",
        "Ailen",
        "Aina",
        "Akilah",
        "Albinia",
        "Althaea",
        "Alyosha",
        "Ansa",
        "Arabella",
        "Arwyl",
        "Ashlyn",
        "Avora",
        "Brena",
        "Brenna",
        "Calienthe",
        "Camilla",
        "Candor",
        "Candra",
        "Carissa",
        "Cascabel",
        "Casslyn",
        "Castille",
        "Celeste",
        "Chen",
        "Claret",
        "Clementine",
        "Constance",
        "Cordelia",
        "Corille",
        "Corsica",
        "Cyrene",
        "Dahlia",
        "Daphnia",
        "Delia",
        "Dena",
        "Denna",
        "Desmona",
        "Dolores",
        "Drenna",
        "Edie",
        "Eira",
        "Elsie",
        "Emeline",
        "Etta",
        "Fela",
        "Felicity",
        "Galenica",
        "Galina",
        "Gitta",
        "Gloria",
        "Gwen",
        "Hedy",
        "Hella",
        "Helles",
        "Henrietta",
        "Iduna",
        "Iona",
        "Isa",
        "Isabella",
        "Iskra",
        "Isolde",
        "Jasna",
        "Jaxi",
        "Joan",
        "Juno",
        "Kamelin",
        "Kari",
        "Koli",
        "Lauria",
        "Lenia",
        "Leona",
        "Leyva",
        "Lieu",
        "Lilith",
        "Lin",
        "Lizete",
        "Lorette",
        "Lucella",
        "Lynthia",
        "Lyra",
        "Maia",
        "Maiathah",
        "Maie",
        "Mara",
        "Marasi",
        "Marielda",
        "Marisol",
        "Marris",
        "Mira",
        "Naria",
        "Nasha",
        "Octavia",
        "Odrienne",
        "Olivia",
        "Ora",
        "Ordenna",
        "Oressia",
        "Orsella",
        "Pardenna",
        "Penelope",
        "Penny",
        "Phoebe",
        "Polonia",
        "Pravda",
        "Prudence",
        "Quelenna",
        "Raisa",
        "Redji",
        "Remira",
        "Rey",
        "Riven",
        "Runa",
        "Sabina",
        "Sabinia",
        "Sabrina",
        "Sadeh",
        "Sahar",
        "Selma",
        "Sesereth",
        "Severea",
        "Silaqui",
        "Skannon",
        "Sprig",
        "Stabitha",
        "Syra",
        "Tabitha",
        "Talitha",
        "Tamsyn",
        "Tasi",
        "Terra",
        "Tesslyn",
        "Thava",
        "Thena",
        "Tiff",
        "Una",
        "Vaurin",
        "Veretta",
        "Vesna",
        "Vestine",
        "Vey",
        "Victoria",
        "Vin",
        "Vita",
        "Volette",
        "Vorka",
        "Wander",
        "Ylva",
        "Zahra",
        "Zaida",
        "Zamira",
        "Zarya"
      ]
    },
    name_surname: [
      "Abberwick",
      "Adelbury",
      "Adleton",
      "Aloro",
      "Alsa",
      "Ankhayat",
      "Arran",
      "Ashton",
      "Ashweather",
      "Athanoch",
      "Axelrod",
      "Backworth",
      "Barrow",
      "Basran",
      "Black",
      "Blackford",
      "Blackpool",
      "Blackthorne",
      "Bluff",
      "Boden",
      "Booker",
      "Boulder",
      "Bowman",
      "Braeside",
      "Bramble",
      "Braum",
      "Bray",
      "Breakiron",
      "Bristle",
      "Brocken",
      "Brogan",
      "Bromley",
      "Burnsides",
      "Caebrek",
      "Cartwright",
      "Carver",
      "Childermass",
      "Claw",
      "Clelland",
      "Clemont",
      "Clermont",
      "Cobblecarver",
      "Coleburn",
      "Combe",
      "Comber",
      "Crofty",
      "Cunningham",
      "Daava",
      "Dal",
      "Dalmore",
      "Danfield",
      "Drawlight",
      "Drigg",
      "Dunvil",
      "Elmore",
      "Eveningeyes",
      "Evensteps",
      "Eventide",
      "Everpenny",
      "Fairplay",
      "Farros",
      "Fellwater",
      "Fogg",
      "Gatcombe",
      "Glasseye",
      "Goldsworth",
      "Grave",
      "Graythwaite",
      "Greysteel",
      "Grine",
      "Haig",
      "Half-Off",
      "Havelton",
      "Havenhorst",
      "Hectares",
      "Helker",
      "Helles",
      "Hellyers",
      "Hemme",
      "Hightower",
      "Hightown",
      "Highwater",
      "Hill",
      "Hitchcock",
      "Innerwick",
      "Jayan",
      "Jeduin",
      "Kardera",
      "Karstas",
      "Keel",
      "Kempt",
      "Kessarin",
      "Kinclaith",
      "King",
      "Lake",
      "Larriston",
      "Leake",
      "Lomond",
      "Longstaff",
      "Lorewood",
      "Maroden",
      "Mayson",
      "Merriweather",
      "Michter",
      "Mindwell",
      "Morcombe",
      "Morriston",
      "Mortimer",
      "Netherton",
      "Night",
      "Nighteyre",
      "Nightly",
      "Noctoft",
      "Notherhome",
      "Orchard",
      "Orchid",
      "Path",
      "Peak",
      "Pegg",
      "Penderyn",
      "Pond",
      "Pool",
      "Prichard",
      "Raines",
      "Ravenglass",
      "Ravenwood",
      "Reigns",
      "Reyes",
      "Reynes",
      "Rhodes",
      "Riverford",
      "Robel",
      "Rowan",
      "Sable",
      "Sage",
      "Salkara",
      "Salos",
      "Sevoy",
      "Shilbottle",
      "Shillmoor",
      "Shook",
      "Skelkallan",
      "Skora",
      "Slane",
      "Song",
      "Steadystep",
      "Stoutale",
      "Stovestoker",
      "Strange",
      "Strangford",
      "Strathmill",
      "Sunder",
      "Sunderland",
      "Swiftwhistle",
      "Tailor",
      "Tallfellow",
      "Templeton",
      "Tenpenny",
      "Tevilton",
      "Thistle",
      "Thrysus",
      "Thurston",
      "Tinmouth",
      "Tower",
      "Tristé",
      "Tyrconnell",
      "Vale",
      "Valentine",
      "Veldaire",
      "Venture",
      "Walund",
      "Warren",
      "Waters",
      "Wecker",
      "Welker",
      "Wend",
      "Wharver",
      "Whythe",
      "Woodall"
    ],
    name_alias: [
      "Bell",
      "Birch",
      "Bird",
      "Bliss",
      "Bricks",
      "Bug",
      "Chime",
      "Coil",
      "Cricket",
      "Cross",
      "Crow",
      "Echo",
      "Flint",
      "Frog",
      "Frost",
      "Goods",
      "Grip",
      "Gunner",
      "Hammer",
      "Hook",
      "Ink",
      "Junker",
      "Mist",
      "Moon",
      "Nail",
      "Needle",
      "Ogre",
      "Pool",
      "Ring",
      "Ruby",
      "Silver",
      "Skinner",
      "Song",
      "Spur",
      "Tackle",
      "Thistle",
      "Thorn",
      "Tick",
      "Tick-Tock",
      "Tock",
      "Trick",
      "Twelves",
      "Vixen",
      "Whip",
      "Wicker"
    ],
    name_suffix: [
      "Jr.",
      "Sr.",
      "III",
      "IV"
    ]
  },
  GM: {
    Bargains: [
      { name: "Infected Wound", category: "Character Effect", effect: "The next time you Recover from Harm, your Physicker is at -1d." },
      { name: "Infected Wound", category: "Character Effect", effect: "The next time you Recover from Harm, your Physicker is at -1d." },
      { name: "Infected Wound", category: "Character Effect", effect: "The next time you Recover from Harm, your Physicker is at -1d." },
      { name: "It's Mine Now", category: "Character Effect", effect: "You discover a small item that belongs to a rival. What is it? Who used to own it? How does this change things for you?" },
      { name: "It's Mine Now", category: "Character Effect", effect: "You discover a small item that belongs to a rival. What is it? Who used to own it? How does this change things for you?" },
      { name: "It's Mine Now", category: "Character Effect", effect: "You discover a small item that belongs to a rival. What is it? Who used to own it? How does this change things for you?" },
      { name: "Mine By Blood", category: "Character Effect", effect: "You discover evidence of the death of a family member during the Score. Who is it? How did they die? How does this change things for your character?" },
      { name: "Mine By Blood", category: "Character Effect", effect: "You discover evidence of the death of a family member during the Score. Who is it? How did they die? How does this change things for your character?" },
      { name: "Mine By Blood", category: "Character Effect", effect: "You discover evidence of the death of a family member during the Score. Who is it? How did they die? How does this change things for your character?" },
      { name: "Mine By Name", category: "Character Effect", effect: "You discover an envelope addressed to you during the Score. What is in it? Who left it here for you to find? How does this change things for your character?" },
      { name: "Mine By Name", category: "Character Effect", effect: "You discover an envelope addressed to you during the Score. What is in it? Who left it here for you to find? How does this change things for your character?" },
      { name: "Mine By Name", category: "Character Effect", effect: "You discover an envelope addressed to you during the Score. What is in it? Who left it here for you to find? How does this change things for your character?" },
      { name: "Mine By Rights", category: "Character Effect", effect: "You discover a small item from your past during the Score. What is it? What does it mean that it's here? Does this change things for your character?" },
      { name: "Mine By Rights", category: "Character Effect", effect: "You discover a small item from your past during the Score. What is it? What does it mean that it's here? Does this change things for your character?" },
      { name: "Mine By Rights", category: "Character Effect", effect: "You discover a small item from your past during the Score. What is it? What does it mean that it's here? Does this change things for your character?" },
      { name: "Not Paying Attention", category: "Character Effect", effect: "Uncheck one of the XP triggers already marked for your character for this Score." },
      { name: "Not Paying Attention", category: "Character Effect", effect: "Uncheck one of the XP triggers already marked for your character for this Score." },
      { name: "Shadow From the Past", category: "Character Effect", effect: "Your intel missed that someone from your past is associated with the target of the Score. Who is it, and how does that change things for you?" },
      { name: "Shadow From the Past", category: "Character Effect", effect: "Your intel missed that someone from your past is associated with the target of the Score. Who is it, and how does that change things for you?" },
      { name: "Shadow From the Past", category: "Character Effect", effect: "Your intel missed that someone from your past is associated with the target of the Score. Who is it, and how does that change things for you?" },
      { name: "Thicker than Blood", category: "Character Effect", effect: "Your intel missed that one of your family members is associated with the target of the Score. How does that change things for you?" },
      { name: "Thicker than Blood", category: "Character Effect", effect: "Your intel missed that one of your family members is associated with the target of the Score. How does that change things for you?" },
      { name: "Thicker than Blood", category: "Character Effect", effect: "Your intel missed that one of your family members is associated with the target of the Score. How does that change things for you?" },
      { name: "Why'd It Have To Be...", category: "Character Effect", effect: "The room you're in triggers a phobia that the Crew didn't know about before. Describe the phobia and take 2 Stress." },
      { name: "Why'd It Have To Be...", category: "Character Effect", effect: "The room you're in triggers a phobia that the Crew didn't know about before. Describe the phobia and take 2 Stress." },
      { name: "Why'd It Have To Be...", category: "Character Effect", effect: "The room you're in triggers a phobia that the Crew didn't know about before. Describe the phobia and take 2 Stress." },
      { name: "Demonic Guest", category: "Crew Effect", effect: "A demonic presence has appeared in your Lair and will need to be dealt with during Free Play." },
      { name: "Demonic Guest", category: "Crew Effect", effect: "A demonic presence has appeared in your Lair and will need to be dealt with during Free Play." },
      { name: "Fracturing Faction", category: "Crew Effect", effect: "If your Hold is Strong, reduce it to Weak. If your Hold is Weak, reduce your Rep to zero." },
      { name: "Lesson Not Learned", category: "Crew Effect", effect: "Uncheck one of the XP triggers already marked for your crew for this Score." },
      { name: "Lesson Not Learned", category: "Crew Effect", effect: "Uncheck one of the XP triggers already marked for your crew for this Score." },
      { name: "Otherworldly Guest", category: "Crew Effect", effect: "A scion of one of the Old Gods has appeared in your Lair and will need to be dealt with during Free Play." },
      { name: "Otherworldly Guest", category: "Crew Effect", effect: "A scion of one of the Old Gods has appeared in your Lair and will need to be dealt with during Free Play." },
      { name: "Rebellious Faction", category: "Crew Effect", effect: "A new crew has taken possession of one of your Claims, and will have to be dealt with in Free Play." },
      { name: "Spectral Guest", category: "Crew Effect", effect: "A ghostly presence has appeared in your Lair and will need to be dealt with during Free Play." },
      { name: "Spectral Guest", category: "Crew Effect", effect: "A ghostly presence has appeared in your Lair and will need to be dealt with during Free Play." },
      { name: "Turncoat", category: "Crew Effect", effect: "One of your Cohorts leaves your crew and joins a rival." },
      { name: "Double-Crossed", category: "Downtime Effect", effect: "After the normal Entanglement roll and result, your Crew takes an additional Flipped result." },
      { name: "Double-Crossed", category: "Downtime Effect", effect: "After the normal Entanglement roll and result, your Crew takes an additional Flipped result." },
      { name: "Double-Crossed", category: "Downtime Effect", effect: "After the normal Entanglement roll and result, your Crew takes an additional Flipped result." },
      { name: "Easily Identified", category: "Downtime Effect", effect: "You left something behind that is easily traced to you. Choose either +2 Heat and −2 Rep, or +1 Heat and −1 Rep." },
      { name: "Easily Identified", category: "Downtime Effect", effect: "You left something behind that is easily traced to you. Choose either +2 Heat and −2 Rep, or +1 Heat and −1 Rep." },
      { name: "Easily Identified", category: "Downtime Effect", effect: "You left something behind that is easily traced to you. Choose either +2 Heat and −2 Rep, or +1 Heat and −1 Rep." },
      { name: "High Profile", category: "Downtime Effect", effect: "This Score gains +2 Heat." },
      { name: "High Profile", category: "Downtime Effect", effect: "This Score gains +2 Heat." },
      { name: "High Profile", category: "Downtime Effect", effect: "This Score gains +2 Heat." },
      { name: "Most Wanted", category: "Downtime Effect", effect: "After the normal Entanglement roll and result, you are the target of an additional Arrest result." },
      { name: "Most Wanted", category: "Downtime Effect", effect: "After the normal Entanglement roll and result, you are the target of an additional Arrest result." },
      { name: "Project Setback", category: "Downtime Effect", effect: "Mark one less Clock segment the first time you work on a Long-Term Project." },
      { name: "Project Setback", category: "Downtime Effect", effect: "Mark one less Clock segment the first time you work on a Long-Term Project." },
      { name: "Project Setback", category: "Downtime Effect", effect: "Mark one less Clock segment the first time you work on a Long-Term Project." },
      { name: "Quelle Horreur!", category: "Downtime Effect", effect: "You suffer nightmares for a week. −1d to all Downtime Actions after this Score." },
      { name: "Quelle Horreur!", category: "Downtime Effect", effect: "You suffer nightmares for a week. −1d to all Downtime Actions after this Score." },
      { name: "Shortchanged", category: "Downtime Effect", effect: "This Score's payoff is −2 Coin." },
      { name: "Shortchanged", category: "Downtime Effect", effect: "This Score's payoff is −2 Coin." },
      { name: "Shortchanged", category: "Downtime Effect", effect: "This Score's payoff is −2 Coin." },
      { name: "Supply Challenges", category: "Downtime Effect", effect: "The next time you pay Coin for an Acquire Asset roll, you must pay 3 instead of 2 Coin per Tier." },
      { name: "Supply Challenges", category: "Downtime Effect", effect: "The next time you pay Coin for an Acquire Asset roll, you must pay 3 instead of 2 Coin per Tier." },
      { name: "Supply Delays", category: "Downtime Effect", effect: "Suffer -1d to your next Acquire Asset roll." },
      { name: "Supply Delays", category: "Downtime Effect", effect: "Suffer -1d to your next Acquire Asset roll." },
      { name: "Supply Delays", category: "Downtime Effect", effect: "Suffer -1d to your next Acquire Asset roll." },
      { name: "Tastes Like Ashes", category: "Downtime Effect", effect: "The next time you indulge your Vice, only clear half as much Stress (rounded down) as normal." },
      { name: "Tastes Like Ashes", category: "Downtime Effect", effect: "The next time you indulge your Vice, only clear half as much Stress (rounded down) as normal." },
      { name: "Thrice-Named", category: "Downtime Effect", effect: "After the normal Entanglement roll and result, your Crew takes an additional Demonic Notice result." },
      { name: "Thrice-Named", category: "Downtime Effect", effect: "After the normal Entanglement roll and result, your Crew takes an additional Demonic Notice result." },
      { name: "Thrice-Named", category: "Downtime Effect", effect: "After the normal Entanglement roll and result, your Crew takes an additional Demonic Notice result." },
      { name: "Warden's Attention", category: "Downtime Effect", effect: "+4 Heat (instead of the normal +2 Heat) if there is a death during this Score." },
      { name: "Warden's Attention", category: "Downtime Effect", effect: "+4 Heat (instead of the normal +2 Heat) if there is a death during this Score." },
      { name: "We Want a Bigger Take!", category: "Downtime Effect", effect: "The gang wants a bigger piece of the action. −2 Coin to Payoff for each Cohort used in this Score." },
      { name: "We Want a Bigger Take!", category: "Downtime Effect", effect: "The gang wants a bigger piece of the action. −2 Coin to Payoff for each Cohort used in this Score." },
      { name: "Weekend Getaway", category: "Downtime Effect", effect: "If you indulge your Vice after this Score, you automatically overindulge." },
      { name: "Weekend Getaway", category: "Downtime Effect", effect: "If you indulge your Vice after this Score, you automatically overindulge." },
      { name: "Weekend Getaway", category: "Downtime Effect", effect: "If you indulge your Vice after this Score, you automatically overindulge." },
      { name: "What's Our Take?", category: "Downtime Effect", effect: "The gang wants a bigger piece of the action. −1 Coin to Payoff for each Cohort used in this Score." },
      { name: "What's Our Take?", category: "Downtime Effect", effect: "The gang wants a bigger piece of the action. −1 Coin to Payoff for each Cohort used in this Score." },
      { name: "What's Our Take?", category: "Downtime Effect", effect: "The gang wants a bigger piece of the action. −1 Coin to Payoff for each Cohort used in this Score." },
      { name: "Accelerating Plans", category: "Faction Relationship Effect", effect: "A rival faction advances one of its Clocks by two before your next Score." },
      { name: "Accelerating Plans", category: "Faction Relationship Effect", effect: "A rival faction advances one of its Clocks by two before your next Score." },
      { name: "Accelerating Plans", category: "Faction Relationship Effect", effect: "A rival faction advances one of its Clocks by two before your next Score." },
      { name: "Escalating Tensions", category: "Faction Relationship Effect", effect: "A faction of your choice that is unfriendly to your crew moves one step towards War." },
      { name: "Escalating Tensions", category: "Faction Relationship Effect", effect: "A faction of your choice that is unfriendly to your crew moves one step towards War." },
      { name: "Forgiveness or Vengeance?", category: "Faction Relationship Effect", effect: "During the Score, one of your Cohorts got in a fight with an neutral Cohort. Choose −2 Rep and +1 faction relationship, or +2 Rep and −1 faction relationship." },
      { name: "Forgiveness or Vengeance?", category: "Faction Relationship Effect", effect: "During the Score, one of your Cohorts got in a fight with an neutral Cohort. Choose −2 Rep and +1 faction relationship, or +2 Rep and −1 faction relationship." },
      { name: "Forgiveness or Vengeance?", category: "Faction Relationship Effect", effect: "During the Score, one of your Cohorts got in a fight with an neutral Cohort. Choose −2 Rep and +1 faction relationship, or +2 Rep and −1 faction relationship." },
      { name: "Hot-Headed Cohort", category: "Faction Relationship Effect", effect: "During the Score, one of your Cohorts picked a fight with an allied Cohort. Pay 2 Coin, lose 2 Rep, or −1 faction relationship." },
      { name: "Hot-Headed Cohort", category: "Faction Relationship Effect", effect: "During the Score, one of your Cohorts picked a fight with an allied Cohort. Pay 2 Coin, lose 2 Rep, or −1 faction relationship." },
      { name: "Hot-Headed Cohort", category: "Faction Relationship Effect", effect: "During the Score, one of your Cohorts picked a fight with an allied Cohort. Pay 2 Coin, lose 2 Rep, or −1 faction relationship." },
      { name: "Mixed Messages", category: "Faction Relationship Effect", effect: "A faction of your choice that is friendly to your crew moves one step towards Neutral." },
      { name: "Mixed Messages", category: "Faction Relationship Effect", effect: "A faction of your choice that is friendly to your crew moves one step towards Neutral." },
      { name: "Mutual Defense", category: "Faction Relationship Effect", effect: "A friendly Faction goes to War with a neutral Faction. Either join their War, or they move to −1 on the relationship chart." },
      { name: "Mutual Defense", category: "Faction Relationship Effect", effect: "A friendly Faction goes to War with a neutral Faction. Either join their War, or they move to −1 on the relationship chart." },
      { name: "Tensions Spread", category: "Faction Relationship Effect", effect: "One Neutral Faction moves a step towards War, and another Neutral Faction moves a step towards Ally." },
      { name: "Tensions Spread", category: "Faction Relationship Effect", effect: "One Neutral Faction moves a step towards War, and another Neutral Faction moves a step towards Ally." },
      { name: "Tensions Spread", category: "Faction Relationship Effect", effect: "One Neutral Faction moves a step towards War, and another Neutral Faction moves a step towards Ally." },
      { name: "The Walls Have Ears", category: "Faction Relationship Effect", effect: "A friendly faction hears you did a Score against their ally. −1 to that faction's relationship rating." },
      { name: "The Walls Have Ears", category: "Faction Relationship Effect", effect: "A friendly faction hears you did a Score against their ally. −1 to that faction's relationship rating." },
      { name: "The Walls Have Ears", category: "Faction Relationship Effect", effect: "A friendly faction hears you did a Score against their ally. −1 to that faction's relationship rating." },
      { name: "The Walls Have Eyes", category: "Faction Relationship Effect", effect: "A friendly faction hears you did a Score against their ally. −1 to both factions' relationship ratings." },
      { name: "The Walls Have Eyes", category: "Faction Relationship Effect", effect: "A friendly faction hears you did a Score against their ally. −1 to both factions' relationship ratings." },
      { name: "...and Into the Fire", category: "Immediate Effect", effect: "You are ambushed by an assassin or bounty hunter. Start a 4-Clock, 'Elite Ambusher' to overcome this new foe." },
      { name: "...and Into the Fire", category: "Immediate Effect", effect: "You are ambushed by an assassin or bounty hunter. Start a 4-Clock, 'Elite Ambusher' to overcome this new foe." },
      { name: "A Familiar Face", category: "Immediate Effect", effect: "You recognize a contact of your choice among the rivals you are running the Score against." },
      { name: "A Familiar Face", category: "Immediate Effect", effect: "You recognize a contact of your choice among the rivals you are running the Score against." },
      { name: "A Familiar Face", category: "Immediate Effect", effect: "You recognize a contact of your choice among the rivals you are running the Score against." },
      { name: "Accidental Discharge", category: "Immediate Effect", effect: "A weapon or item you are carrying loudly discharges and needs to be reloaded before it can be used." },
      { name: "Accidental Discharge", category: "Immediate Effect", effect: "A weapon or item you are carrying loudly discharges and needs to be reloaded before it can be used." },
      { name: "Accidental Discharge", category: "Immediate Effect", effect: "A weapon or item you are carrying loudly discharges and needs to be reloaded before it can be used." },
      { name: "All or Nothing", category: "Immediate Effect", effect: "If you fail this roll, you cannot resist the effects of that failure." },
      { name: "All or Nothing", category: "Immediate Effect", effect: "If you fail this roll, you cannot resist the effects of that failure." },
      { name: "All or Nothing", category: "Immediate Effect", effect: "If you fail this roll, you cannot resist the effects of that failure." },
      { name: "Bishop's Gambit", category: "Immediate Effect", effect: "If you are not in combat, gain +2d for this roll instead of the standard +1d; but you can roll no more than 1d for your next Action." },
      { name: "Bishop's Gambit", category: "Immediate Effect", effect: "If you are not in combat, gain +2d for this roll instead of the standard +1d; but you can roll no more than 1d for your next Action." },
      { name: "Bishop's Gambit", category: "Immediate Effect", effect: "If you are not in combat, gain +2d for this roll instead of the standard +1d; but you can roll no more than 1d for your next Action." },
      { name: "Brute Force Method", category: "Immediate Effect", effect: "You noisily break a weapon of your choice while attempting this Action, even if it is not a combat Action." },
      { name: "Brute Force Method", category: "Immediate Effect", effect: "You noisily break a weapon of your choice while attempting this Action, even if it is not a combat Action." },
      { name: "Brute Force Method", category: "Immediate Effect", effect: "You noisily break a weapon of your choice while attempting this Action, even if it is not a combat Action." },
      { name: "Clear the Board", category: "Immediate Effect", effect: "If you succeed at this roll, clear or fill a Score Clock of your choice. If you fail the roll, you Trauma out of the scene." },
      { name: "Clear the Board", category: "Immediate Effect", effect: "If you succeed at this roll, clear or fill a Score Clock of your choice. If you fail the roll, you Trauma out of the scene." },
      { name: "Devil's Exchange", category: "Immediate Effect", effect: "You gain the normal +1d to this roll, but suffer −1d to your next Action, and cannot take a Devil's Bargain to offset it." },
      { name: "Devil's Exchange", category: "Immediate Effect", effect: "You gain the normal +1d to this roll, but suffer −1d to your next Action, and cannot take a Devil's Bargain to offset it." },
      { name: "Devil's Exchange", category: "Immediate Effect", effect: "You gain the normal +1d to this roll, but suffer −1d to your next Action, and cannot take a Devil's Bargain to offset it." },
      { name: "Ghostly Attention", category: "Immediate Effect", effect: "Whether you succeed in this roll or not, a ghost in the area notices you and begins stalking you." },
      { name: "Ghostly Attention", category: "Immediate Effect", effect: "Whether you succeed in this roll or not, a ghost in the area notices you and begins stalking you." },
      { name: "Ghostly Attention", category: "Immediate Effect", effect: "Whether you succeed in this roll or not, a ghost in the area notices you and begins stalking you." },
      { name: "Gimcrack Gear", category: "Immediate Effect", effect: "Whatever weapon or tool you are using is cheaply made and breaks whether the roll succeeds or not." },
      { name: "Gimcrack Gear", category: "Immediate Effect", effect: "Whatever weapon or tool you are using is cheaply made and breaks whether the roll succeeds or not." },
      { name: "Gimcrack Gear", category: "Immediate Effect", effect: "Whatever weapon or tool you are using is cheaply made and breaks whether the roll succeeds or not." },
      { name: "Gone Rogue", category: "Immediate Effect", effect: "You cannot accept an Assist for the rest of this Score." },
      { name: "Gone Rogue", category: "Immediate Effect", effect: "You cannot accept an Assist for the rest of this Score." },
      { name: "Hunter Becomes Hunted", category: "Immediate Effect", effect: "You've been so preoccupied with the obstacles in front of you that you didn't notice the rival lining up a shot behind you." },
      { name: "Hunter Becomes Hunted", category: "Immediate Effect", effect: "You've been so preoccupied with the obstacles in front of you that you didn't notice the rival lining up a shot behind you." },
      { name: "Hunter Becomes Hunted", category: "Immediate Effect", effect: "You've been so preoccupied with the obstacles in front of you that you didn't notice the rival lining up a shot behind you." },
      { name: "I Know I Packed It!", category: "Immediate Effect", effect: "You must immediately check off 1 Load to no effect, representing equipment you've misplaced." },
      { name: "I Know I Packed It!", category: "Immediate Effect", effect: "You must immediately check off 1 Load to no effect, representing equipment you've misplaced." },
      { name: "I Know I Packed It!", category: "Immediate Effect", effect: "You must immediately check off 1 Load to no effect, representing equipment you've misplaced." },
      { name: "I Know I Packed Them!", category: "Immediate Effect", effect: "You must immediately check off 2 Load to no effect, representing equipment you've misplaced." },
      { name: "I Know I Packed Them!", category: "Immediate Effect", effect: "You must immediately check off 2 Load to no effect, representing equipment you've misplaced." },
      { name: "I Know I Packed Them!", category: "Immediate Effect", effect: "You must immediately check off 2 Load to no effect, representing equipment you've misplaced." },
      { name: "Jangled Nerves", category: "Immediate Effect", effect: "For the rest of the Score, all rolls to Resist generate +1 Stress." },
      { name: "Jangled Nerves", category: "Immediate Effect", effect: "For the rest of the Score, all rolls to Resist generate +1 Stress." },
      { name: "Jangled Nerves", category: "Immediate Effect", effect: "For the rest of the Score, all rolls to Resist generate +1 Stress." },
      { name: "Just a Little Spark", category: "Immediate Effect", effect: "A lamp or candle gets knocked over, catching a curtain or rug on fire. Start a Clock: 'Building is on Fire'." },
      { name: "Just a Little Spark", category: "Immediate Effect", effect: "A lamp or candle gets knocked over, catching a curtain or rug on fire. Start a Clock: 'Building is on Fire'." },
      { name: "Just a Little Spark", category: "Immediate Effect", effect: "A lamp or candle gets knocked over, catching a curtain or rug on fire. Start a Clock: 'Building is on Fire'." },
      { name: "King's Gambit", category: "Immediate Effect", effect: "If you fail at this roll, you are immune to any Harm; but you have a zero rating to your next Action." },
      { name: "King's Gambit", category: "Immediate Effect", effect: "If you fail at this roll, you are immune to any Harm; but you have a zero rating to your next Action." },
      { name: "King's Gambit", category: "Immediate Effect", effect: "If you fail at this roll, you are immune to any Harm; but you have a zero rating to your next Action." },
      { name: "Knight's Gambit", category: "Immediate Effect", effect: "If you are in combat, gain +2d for this roll instead of the standard +1d; but you can roll no more than 1d for your next Action." },
      { name: "Knight's Gambit", category: "Immediate Effect", effect: "If you are in combat, gain +2d for this roll instead of the standard +1d; but you can roll no more than 1d for your next Action." },
      { name: "Knight's Gambit", category: "Immediate Effect", effect: "If you are in combat, gain +2d for this roll instead of the standard +1d; but you can roll no more than 1d for your next Action." },
      { name: "Knuckle Buster", category: "Immediate Effect", effect: "Whether this Action succeeds or not, you accidentally inflict level 1 Harm on your hand, 'Busted Knuckles.'" },
      { name: "Knuckle Buster", category: "Immediate Effect", effect: "Whether this Action succeeds or not, you accidentally inflict level 1 Harm on your hand, 'Busted Knuckles.'" },
      { name: "Knuckle Buster", category: "Immediate Effect", effect: "Whether this Action succeeds or not, you accidentally inflict level 1 Harm on your hand, 'Busted Knuckles.'" },
      { name: "Now or Never", category: "Immediate Effect", effect: "If you fail this roll, you lose this opportunity and cannot retry it for this Score." },
      { name: "Now or Never", category: "Immediate Effect", effect: "If you fail this roll, you lose this opportunity and cannot retry it for this Score." },
      { name: "Now or Never", category: "Immediate Effect", effect: "If you fail this roll, you lose this opportunity and cannot retry it for this Score." },
      { name: "Out of the Frying Pan...", category: "Immediate Effect", effect: "Things are about to go from bad to worse. Start a 4-Clock, 'Surprise Reinforcements'." },
      { name: "Out of the Frying Pan...", category: "Immediate Effect", effect: "Things are about to go from bad to worse. Start a 4-Clock, 'Surprise Reinforcements'." },
      { name: "Out of the Frying Pan...", category: "Immediate Effect", effect: "Things are about to go from bad to worse. Start a 4-Clock, 'Surprise Reinforcements'." },
      { name: "Overextended", category: "Immediate Effect", effect: "Your next Action automatically has reduced Effect." },
      { name: "Overextended", category: "Immediate Effect", effect: "Your next Action automatically has reduced Effect." },
      { name: "Overextended", category: "Immediate Effect", effect: "Your next Action automatically has reduced Effect." },
      { name: "Pawn's Gambit", category: "Immediate Effect", effect: "You cannot use Load for Armor during this Score. You cannot accept this bargain if you already have used Load for Armor." },
      { name: "Pawn's Gambit", category: "Immediate Effect", effect: "You cannot use Load for Armor during this Score. You cannot accept this bargain if you already have used Load for Armor." },
      { name: "Pawn's Gambit", category: "Immediate Effect", effect: "You cannot use Load for Armor during this Score. You cannot accept this bargain if you already have used Load for Armor." },
      { name: "Plan C...", category: "Immediate Effect", effect: "Things are not going according to plan. Flashbacks cost +1 Stress for the rest of the Score." },
      { name: "Plan C...", category: "Immediate Effect", effect: "Things are not going according to plan. Flashbacks cost +1 Stress for the rest of the Score." },
      { name: "Queen's Gambit", category: "Immediate Effect", effect: "You automatically succeed at this Action as if you rolled a 6; but you have a zero rating to your next Action." },
      { name: "Queen's Gambit", category: "Immediate Effect", effect: "You automatically succeed at this Action as if you rolled a 6; but you have a zero rating to your next Action." },
      { name: "Queen's Gambit", category: "Immediate Effect", effect: "You automatically succeed at this Action as if you rolled a 6; but you have a zero rating to your next Action." },
      { name: "Quicksilver Poisoning", category: "Immediate Effect", effect: "Used in electroplasmic containers and devices, you get a noseful of quicksilver vapor, suffering level 1 Harm, 'Silverlung' which starts a 4-Clock Project to heal." },
      { name: "Quicksilver Poisoning", category: "Immediate Effect", effect: "Used in electroplasmic containers and devices, you get a noseful of quicksilver vapor, suffering level 1 Harm, 'Silverlung' which starts a 4-Clock Project to heal." },
      { name: "Quicksilver Poisoning", category: "Immediate Effect", effect: "Used in electroplasmic containers and devices, you get a noseful of quicksilver vapor, suffering level 1 Harm, 'Silverlung' which starts a 4-Clock Project to heal." },
      { name: "Rook's Gambit", category: "Immediate Effect", effect: "You cannot use Load for Unusual or Scary Weapons this Score. You cannot accept this bargain if you already have used Load for these." },
      { name: "Rook's Gambit", category: "Immediate Effect", effect: "You cannot use Load for Unusual or Scary Weapons this Score. You cannot accept this bargain if you already have used Load for these." },
      { name: "Rook's Gambit", category: "Immediate Effect", effect: "You cannot use Load for Unusual or Scary Weapons this Score. You cannot accept this bargain if you already have used Load for these." },
      { name: "Shot Nerves", category: "Immediate Effect", effect: "For the rest of the Score, all rolls to Resist generate +2 Stress." },
      { name: "Shot Nerves", category: "Immediate Effect", effect: "For the rest of the Score, all rolls to Resist generate +2 Stress." },
      { name: "Turned Around", category: "Immediate Effect", effect: "You lose track of your position. Start a 4-Clock, 'Where Am I?' You must use Actions looking for your Crew to rejoin them." },
      { name: "Turned Around", category: "Immediate Effect", effect: "You lose track of your position. Start a 4-Clock, 'Where Am I?' You must use Actions looking for your Crew to rejoin them." },
      { name: "Turned Around", category: "Immediate Effect", effect: "You lose track of your position. Start a 4-Clock, 'Where Am I?' You must use Actions looking for your Crew to rejoin them." },
      { name: "Unsure Footing", category: "Immediate Effect", effect: "Whether you succeed in this roll or not, you loose your footing and fall prone after this Action." },
      { name: "Unsure Footing", category: "Immediate Effect", effect: "Whether you succeed in this roll or not, you loose your footing and fall prone after this Action." },
      { name: "Unsure Footing", category: "Immediate Effect", effect: "Whether you succeed in this roll or not, you loose your footing and fall prone after this Action." },
      { name: "Worse than We thought", category: "Immediate Effect", effect: "A Clock of your choice that is running for this Score is either advanced or set back by two segments (whichever is worse for the Crew)." },
      { name: "Worse than We thought", category: "Immediate Effect", effect: "A Clock of your choice that is running for this Score is either advanced or set back by two segments (whichever is worse for the Crew)." },
      { name: "You're All On Your Own", category: "Immediate Effect", effect: "After this roll, you cannot offer to Assist on anyone else's roll for the rest of the Score." },
      { name: "You're All On Your Own", category: "Immediate Effect", effect: "After this roll, you cannot offer to Assist on anyone else's roll for the rest of the Score." },
      { name: "You're All On Your Own", category: "Immediate Effect", effect: "After this roll, you cannot offer to Assist on anyone else's roll for the rest of the Score." },
      { name: "Death Will Not Stop Me", category: "Long-Term Effect", effect: "The ghost of someone you killed is driven to take you with it. Start a 12-Clock, 'Spectral Vengence'" },
      { name: "That's Enough of That", category: "Long-Term Effect", effect: "Someone whose goals are affected by this Score is going to focus on you now. Start a 8-Clock, 'Cold Vengence'" },
      { name: "That's Enough of That", category: "Long-Term Effect", effect: "Someone whose goals are affected by this Score is going to focus on you now. Start a 8-Clock, 'Cold Vengence'" },
      { name: "The Last Straw", category: "Long-Term Effect", effect: "You've royally pissed off someone with real clout in the city. Start a 12-Clock, 'Furious Vengence'" },
      { name: "You'll Pay For This", category: "Long-Term Effect", effect: "Someone hurt by this Score will come back to collect what's owed. Start a 6-Clock, 'Petty Vengence'" },
      { name: "You'll Pay For This", category: "Long-Term Effect", effect: "Someone hurt by this Score will come back to collect what's owed. Start a 6-Clock, 'Petty Vengence'" },
      { name: "You'll Pay For This", category: "Long-Term Effect", effect: "Someone hurt by this Score will come back to collect what's owed. Start a 6-Clock, 'Petty Vengence'" },
      { name: "Dalgomur, the Heart of the Storm", category: "Mandatory Effect", effect: "If one is not already active for the crew, start a 12-Clock labeled 'The Heart of the Storm' and set it to one. If the Clock is already active, advance it by one." },
      { name: "Dalgomur, the Heart of the Storm", category: "Mandatory Effect", effect: "If one is not already active for the crew, start a 12-Clock labeled 'The Heart of the Storm' and set it to one. If the Clock is already active, advance it by one." },
      { name: "Ulf Ironborn, the Skovlan Agitator", category: "Mandatory Effect", effect: "If one is not already active for the crew, start a 4-Clock labeled 'Skovlander Uprising' and set it to one. If the Clock is already active, advance it by one." },
      { name: "Ulf Ironborn, the Skovlan Agitator", category: "Mandatory Effect", effect: "If one is not already active for the crew, start a 4-Clock labeled 'Skovlander Uprising' and set it to one. If the Clock is already active, advance it by one." },
      { name: "Urumbar, the Closed Eye", category: "Mandatory Effect", effect: "If one is not already active for the crew, start an 8-Clock labeled 'The Closed Eye' and set it to one. If the Clock is already active, advance it by one." },
      { name: "Urumbar, the Closed Eye", category: "Mandatory Effect", effect: "If one is not already active for the crew, start an 8-Clock labeled 'The Closed Eye' and set it to one. If the Clock is already active, advance it by one." },
      { name: "Vaskani, the Crossroads Demon", category: "Mandatory Effect", effect: "If one is not already active for the crew, start a 6-Clock labeled 'The Crossroads Demon' and set it to one. If the Clock is already active, advance it by one." },
      { name: "Vaskani, the Crossroads Demon", category: "Mandatory Effect", effect: "If one is not already active for the crew, start a 6-Clock labeled 'The Crossroads Demon' and set it to one. If the Clock is already active, advance it by one." }
    ],
    Obstacles: [
      {
        name: "Centipedes",
        category: "Animal Guards",
        desc: "Centipedes the length of a forearm are almost noiseless. If they bite, their toxin causes living flesh to blacken and die, leading to amputation if the poison isn't countered. People tend to scream when bit.",
        questions: [
          "Were the centipedes brought in as guardians, or are they a local nuisance?",
          "There are many different breeds, how will you describe the appearance of yours?",
          "Do they have a nasty local nickname?"
        ],
        modsHarder: [
          "When one attacks it releases a scent that enrages others nearby, so they tend to swarm.",
          "They are excellent swimmers, and they hunt in bog-like areas under the surface."
        ],
        modsEasier: [
          "They are bright yellow and red, and hiss before striking, giving all the warning possible.",
          "All the guardians and neighbors carry the antidote, the local apothecary knows what you need."
        ]
      },
      {
        name: "Great Cats",
        category: "Animal Guards",
        desc: "One or more great cats slink through the shadows. They like to attack from high places. Their fur mottles to match the colors and tones and textures around them.",
        questions: [
          "Did the current owners bring them in, or are they inherited from a previous owner?",
          "Do they stay on the estate, or go hunting in the local neighborhood?"
        ],
        modsHarder: [
          "The cats are trained to alert guards (or wear charm jewelry to alert supernatural guardians) when they detect intruders with their keen senses.",
          "Massive old trees draped with moss, or many ledges and overlooks, provide the cats cover."
        ],
        modsEasier: [
          "There is only one, with a regular feeding time and place.",
          "The cats are well fed and lazy, mostly for show unless provoked."
        ]
      },
      {
        name: "Hunting Spiders",
        category: "Animal Guards",
        desc: "These lightning-fast nightmares are about twenty pounds and three feet across, built like jumping spiders and loaded with paralytic venom.",
        questions: [
          "Were these spiders bred for a decadent aristocrat, or warped to this impossible size by an insane whisper?",
          "Can they survive away from a spirit well?",
          "What noise do they make?",
          "How do they smell?"
        ],
        modsHarder: [
          "They are mostly trained, their handler using a slide whistle to give orders to hunt, attack, withdraw, or guard.",
          "The color of the stone, the shape of the underbrush, the leaf litter--everything matches the spider color scheme and hides its movement."
        ],
        modsEasier: [
          "Little lasting harm at first; paralyzed prey is dragged back to a lair and webbed up. You have a day or so to rescue the prey before the spider injects acid into the web bundle so it can drink its victim.",
          "The poison is weak and easy to resist, requiring several successful bites to put a human down."
        ]
      },
      {
        name: "Mastiff Pack",
        category: "Animal Guards",
        desc: "A pack of mastiffs have run of the guarded area when it is not in more public use. They only respond to their masters, who have special tunics, whistles, and gloves. They kill anyone or anything else.",
        questions: [
          "What is their heraldry?",
          "How many mastiffs are in the pack?",
          "Are they trained well enough to ignore poisoned meat or live animal distractions?"
        ],
        modsHarder: [
          "Each one is precious to the site owner, who will tirelessly seek vengeance if they are hurt.",
          "The pack masters are elite veterans with firearms and excellent tracking and hunting skills."
        ],
        modsEasier: [
          "The equipment is properly installed, its vulnerable parts behind the energy curtain, directly guarding what needs protecting.",
          "The lightning walls attract loose spirits, intruders may also have to contend with confused ghosts."
        ]
      },
      {
        name: "Venomous Snakes",
        category: "Animal Guards",
        desc: "Venomous snakes have lairs prepared for them in the guarded area.",
        questions: [
          "How fast acting is their venom?",
          "How aggressive are they?",
          "Is their hide camouflage for hunting, or bright to warn away predators?",
          "Are there only a few big ones, or many small snakes?",
          "Do the site guardians feed them, or can they find enough vermin on their own?"
        ],
        modsHarder: [
          "Knee-deep plants and elevation shifts intentionally make it difficult to see snakes.",
          "Other guardians have a side business in selling venom and meat and hides. They have venom blowdarts and poisoned daggers."
        ],
        modsEasier: [
          "The snakes dislike a certain whistle tone. Let out a blast occasionally and they'll stay away.",
          "A former employee knows how guardians got around the site with minimal risk of snakes."
        ]
      },
      {
        name: "Armor Hosts",
        category: "Ghostly Guards",
        desc: "Guardian spirits are able to inhabit a crystal melded to each suit of armor in a guarded area. When melded, the spirit can control the armor. Spirits use the armor to attack intruders.",
        questions: [
          "Were the suits of armor built for this purpose, or retrofitted by a spirit trafficker?",
          "Are the guardian spirits loyal, or were they stripped of their will by a ritual or other power?",
          "Are the suits visibly paranormal?"
        ],
        modsHarder: [
          "A single powerful (relatively sane) spirit can flit from armor to armor, backed up by two slave spirits. The guardian can form an electroplasmic face in the helmet to sneer at intruders.",
          "A swarm of spirits are eager to take their turn in armor. When one tires another drops in.",
          "Ceaseless patrol."
        ],
        modsEasier: [
          "The ghost(s) that animate the armor are murderous and difficult to control.",
          "The guardians can play a chime to recall them to a restraining prism.",
          "The suits of armor are old, battered, and prone to physical failure."
        ]
      },
      {
        name: "Coldrooms",
        category: "Ghostly Guards",
        desc: "The defended area is kept cold. Body heat registers like a plume of blood in the water. Ghosts flood living meat with cold, gorging on body heat, becoming more visible as their outlines swirl with life-blood.",
        questions: [
          "Were they created by ritually starving victims to death in the defended space?",
          "Were they stolen from the site of a massive horrific disaster?",
          "Does a spirit trafficker maintain the wards on the space?"
        ],
        modsHarder: [
          "A dead whisper leads them, countering defensive charms and magic, sniffing out breath even if heat is concealed, dueling any supernatural defense.",
          "The guarded area is powerfully warded and underground where temperature is easy to maintain."
        ],
        modsEasier: [
          "The guarded area is vulnerable to weather conditions. It is sharp in the cold, but almost dormant in the heat.",
          "A relatively simple spirit bane charm can keep them at bay if created in tune with the site."
        ]
      },
      {
        name: "Cursed Treasure",
        category: "Ghostly Guards",
        desc: "Treasures are infused with a haunting spirit. Anyone touching the treasure will be cursed, dreaming the crimes of the ghost and attracting anger and distaste from strangers. Friends become uncomfortable and suspicious around the cursed scoundrel.",
        questions: [
          "Were those sacrificed to make the haunts loyal, serving past death, or punished by undeath?",
          "Is the treasure marked as cursed?"
        ],
        modsHarder: [
          "The haunting is so deadly that it drives most victims to suicide within a week. Resourceful scoundrels with access to spirit traffickers have days to somehow break the hold. Others are doomed.",
          "Electroplasmic poisoning begins, and within a week the scoundrel will become a vampire."
        ],
        modsEasier: [
          "All the bad luck waiting in the wings (unfinished clocks from foes, poorly protected stashes, jilted lovers, false identities) go wrong in quick succession. Then the curse is over.",
          "A competent occultist can break the curse as a down time project with a four segment clock."
        ]
      },
      {
        name: "Darkrooms",
        category: "Ghostly Guards",
        desc: "The defended area is dark. The ragged ghosts hate light. They shriek horribly as they attack light sources with slapping leathery hands, like bat wings. Intruders may glimpse their luminous fangs.",
        questions: [
          "Were these ghosts placed here intentionally, or are they the result of some horror that left a print in the Ghost Field?",
          "Is this defense maintained, or passive?"
        ],
        modsHarder: [
          "Another guardian lurks in the dark and takes advantage of the distraction to steal from intruders, perhaps killing them too.",
          "The ghosts are aggressive, pushing intruders. Surroundings include long drops, spikes, mazes, or other hazards difficult to navigate in darkness."
        ],
        modsEasier: [
          "While annoying, they do no real damage, and forewarned scoundrels may prepare unbreakable light sources or supernatural dark vision.",
          "There is enough ambient light to see."
        ]
      },
      {
        name: "Dynastic Hive",
        category: "Ghostly Guards",
        desc: "Ancestors have been ritually infused into the defense site, it is a dynastic holding. The spirits are old, and insane, but strategically placed to act out their madness in the most damaging way.",
        questions: [
          "Did the family get special permission to harbor ghosts?",
          "Do they have connections to limmers?",
          "Are spirits tied to leviathan bone shards?",
          "Are they moving pictures, or conversationalists with clues?"
        ],
        modsHarder: [
          "The ghosts are legally protected, like landmarks or artwork. Damaging them is a serious crime.",
          "Some of the more powerful or canny ghosts are still somewhat sane collaborators with the site owners."
        ],
        modsEasier: [
          "They are out of control, and few dare to enter the site now (or it is abandoned.)",
          "They will not harm family members (but may not react well to hostages.)"
        ]
      },
      {
        name: "Hunting Ghostpack",
        category: "Ghostly Guards",
        desc: "A group of weaponized ghosts haunts the defended area. They are capable of scouting to find intruders, descending on them with lethal force.",
        questions: [
          "Do they appear as a pack with a mounted hunter, spectral hounds, and a ghostly horn call?",
          "Or an armored warband?",
          "Shapeless lethal electroplasmic stalkers?",
          "Are the wounds they inflict bloody cuts, or hard frostbite?",
          "Is their area surrounded with runes that let them see into the material world?"
        ],
        modsHarder: [
          "The ghost leader feels all life force in its hunting ground, knowing its location.",
          "The hunt can only rise when certain conditions like anniversaries, moon phases, etc. are met. However, they have a treasure that can only be taken from them when they manifest."
        ],
        modsEasier: [
          "The attack is purely psychological, killing with supernatural fear. The effect can be resisted.",
          "They are summoned and directed by a command artifact like a hunting horn or special weapon. If someone else tunes to the weapon, control (and its obligations) may shift to a new bearer."
        ]
      },
      {
        name: "Possession Gate",
        category: "Ghostly Guards",
        desc: "If an intruder breaks a clearly marked seal, the intruder is attacked by a possessing spirit that takes on the traits of the most strong-willed, brutal person the seal-breaker ever killed. The possessing spirit and the seal-breaker struggle for control. This counts as a harm.",
        questions: [
          "Is the possessing spirit a ghost, or a shape-shifting construct made by an expert that makes a shape out of something in the target?",
          "If an innocent triggers the trap, what form does the spirit take then?"
        ],
        modsHarder: [
          "The only way to be free is to die, undergo electroplasmic surgery while dead, and be revived. Otherwise the curse is protected by the victim's life force.",
          "The haunting spirit tries to take possession once a day or so, sending the host into a blackout and acting out vicious crimes against allies, loved ones, and bluecoats."
        ],
        modsEasier: [
          "The condition can be reduced with a resist roll, but still is likely a 6 segment clock to clear.",
          "The curse haunt would rather have a host ally than kill its victim, and may bargain for shared control."
        ]
      },
      {
        name: "Spirit-Infused Art",
        category: "Ghostly Guards",
        desc: "Art works are haunted by spirits that are capable of spying. They observe their area, and may be able to murmur about what they see to a guardian.",
        questions: [
          "Was art repurposed to host spirits, or was it created for them and around them?",
          "Is the art mosaics, portraits, statues, or some other form?",
          "How sane and coherent are the spirits?",
          "How loyal are they?",
          "Do they have the power to attack intruders?"
        ],
        modsHarder: [
          "One or more guardians has a signet ring tuned to the haunted art pieces, and can hear what they whisper as they spy.",
          "The ghosts inhabiting the art can move from one piece to another, following intruders or retreating to report."
        ],
        modsEasier: [
          "One spirit per art piece, and each spirit has its own unbalanced personality.",
          "Unhinged art is violent, so it has to be shrouded or restrained when guardians go through the defended area."
        ]
      },
      {
        name: "Starving Fog",
        category: "Ghostly Guards",
        desc: "The guarded area is in a clinging cold fog. Fog draws energy from those breathing in it until it manifests shadows that increase target fear, which feeds it more. Eventually it can manifest a killing shape.",
        questions: [
          "What do intruders in the fog see when it reflects their fears?",
          "Are there sound effects, smells, and sounds, or just fleeting glimpses and silhouettes?",
          "Does it project hallucinations or trigger memories?"
        ],
        modsHarder: [
          "The fog strengthens the Ghost Field, making ghosts within it more powerful.",
          "The fog can move, summoned or controlled by other guardians to provide backup or help search."
        ],
        modsEasier: [
          "The fog is generated by an artifact. If the artifact is neutralized so is the fog.",
          "Those with the proper energy keyed amulet or other trinket are invisible to the fog."
        ]
      },
      {
        name: "Sweat Nectar",
        category: "Ghostly Guards",
        desc: "The defended area is kept hot. Sweat tastes like nectar to swarming ghosts, who dehydrate targets into mummies. The stolen life force and moisture flows to prepared corpses, so ghosts can ride them again.",
        questions: [
          "Were they created by dehydrating sacrifices to death in the defended space?",
          "Were they gathered from outside the lightning walls to stand guard here?",
          "Does a spirit trafficker maintain the wards on the space?"
        ],
        modsHarder: [
          "Many prepared corpses are stashed in unexpected places, bursting into combat when rejuvenated.",
          "Once they rise, the desiccated spirit-ridden corpses will chase intruders until they can't."
        ],
        modsEasier: [
          "Only a few corpses are left to revive.",
          "The site is difficult to keep hot enough to extract the necessary sweat from intruders."
        ]
      },
      {
        name: "Dartus Weed",
        category: "Supernatural Plants",
        desc: "When something moves near a tangled bank of dartus weed, the vines flex, flicking barbed tips towards the source of motion within arm's reach. The darts are paralytic; a target will pass out for about an hour.",
        questions: [
          "Do they have a distinctive flower or smell?",
          "What is the aftertaste of the poison's effect?"
        ],
        modsHarder: [
          "Hounds with chemically toughened hides patrol the weed banks, brutally killing intruders.",
          "Weed banks are cultivated strategically, flanking important doorways or draped over arborwalks, straggling along verges."
        ],
        modsEasier: [
          "The weeds are young. Darts can be stopped with thick leather.",
          "Weed banks are out of the way of defended valuables, but too close to very annoyed neighbors who may hold a grudge."
        ]
      },
      {
        name: "Dreamspore Shrooms",
        category: "Supernatural Plants",
        desc: "Placed on the ceiling, they drizzle sandy spores when they sense motion below. Victims hallucinate, heightening subconscious emotion (so they are very mellow, or super anxious, or filled with rage, etc.).",
        questions: [
          "Were these intended to be a site defense?",
          "Did they instead serve a religious or recreational function?",
          "Are there special techniques for harvesting them, perhaps selling them to alchemists?"
        ],
        modsHarder: [
          "A more intense strain, these can knock out those who succumb, and give them vivid dreams for several hours.",
          "They are placed near other guardians as well as hazards like a steep drop or running water."
        ],
        modsEasier: [
          "Other guardians come here recreationally, their effectiveness reduced.",
          "The spores are weak and easier to resist."
        ]
      },
      {
        name: "Floormesh",
        category: "Supernatural Plants",
        desc: "Flat vines grow together to make flooring. Connected below is the bulb, covered in venomous spikes. Anyone heavier than a child will fall through. Blood and rot feed the floormesh.",
        questions: [
          "Have site defenders put carpet over the flat vines to further hide the threat?",
          "What colors, textures, and patterns does this version have?",
          "How dangerous is the venom?"
        ],
        modsHarder: [
          "The building's architecture assumes use of floormesh, the carpets are woven to look like floormesh so the guardians don't have to cover the actual pits.",
          "The mesh itself has venomous thorns in it, so stepping on it or falling through poisons the target."
        ],
        modsEasier: [
          "The pit is not cleaned, the area near it stinks heavily of corpserot. The mesh sags visibly.",
          "Floormesh is mostly hung like tapestries, living decorations, rather than forming pit traps."
        ]
      },
      {
        name: "Ghost Crystal Topiary",
        category: "Supernatural Plants",
        desc: "Ghost crystals are worked into the roots of fancifully trimmed bushes. Ghosts may be able to inhabit the bushes and make them move. This gardening curiosity can be weaponized.",
        questions: [
          "Is this a currently maintained garden, or one that is overgrown and abandoned?",
          "Who provides the necessary skilled care to create or maintain the topiary?",
          "Is there a theme to the sculptures?"
        ],
        modsHarder: [
          "Certain of the most powerful bushes can uproot and move around like living green golems driven by electroplasmic energy.",
          "The bushes hardly move, but the powerful energies of the crystals make ghosts much more coherent and powerful in the garden."
        ],
        modsEasier: [
          "Left unprotected at one point, the garden was raided by thieves after the ghost crystals. Few crystals are left in the shaggy bushes.",
          "Incompetent handling has drained most of the power from the crystals."
        ]
      },
      {
        name: "Keenshrooms",
        category: "Supernatural Plants",
        desc: "These fist-sized mushrooms let out a keening wail when light comes within about thirty feet.",
        questions: [
          "What do they look like?",
          "Is their smell distinctive?",
          "Are they good eating?"
        ],
        modsHarder: [
          "They are strategically placed to surprise intruders; inside doors, on ceilings, in alcoves, behind statues.",
          "Masses of keenshrooms have been allowed to coat walls or fill rooms, and their keen is strong enough to deafen or kill."
        ],
        modsEasier: [
          "The keenshrooms were placed too close to trafficked paths inside or outside the defended site. Constant false alarms dull vigilance.",
          "Too far from site defenders, their keens are seldom investigated."
        ]
      },
      {
        name: "Murder Tree",
        category: "Supernatural Plants",
        desc: "The willow tree grew around bones wired to it, spirit crystals studded in its bark, and leviathan blood at its roots. lt is dimly self-aware. It senses and hates life, whipping and clubbing any who approach.",
        questions: [
          "How do guardians move around the tree?",
          "Suggestions include knowing passwords, having enchanted amulets, or attuning to its blind spots. How many guard the site?",
          "Who had the expertise to cultivate this living weapon, how long ago?"
        ],
        modsHarder: [
          "The chorus of semi-aware spirits that fuel the tree are enslaved by one domineering will. The tree is as coherent as a person.",
          "Multiple murder trees are connected by roots and share knowledge with each other (and any other site guardians.)"
        ],
        modsEasier: [
          "No one can communicate with the murder tree, or control it, so it is isolated from other defenses.",
          "The tree sleeps most of the time, and it is difficult to rouse it to fighting fury."
        ]
      },
      {
        name: "Snatchweed",
        category: "Supernatural Plants",
        desc: "It grows in fresh water, lengthening its long winding tendrils almost to the surface. When touched, it snatches and pulls, coiling down to the bottom and holding for a few minutes before relaxing back up.",
        questions: [
          "Is their growth boosted supernaturally, and can you see faces reflecting from the Ghost Field beneath their fronds?",
          "Are the locals aware of the threat, willing to talk about it?"
        ],
        modsHarder: [
          "Snatchweed is cultivated in areas where intruders must enter the water to get past other obstacles.",
          "The bottom of the water has two foot spikes, victims are pulled down onto them."
        ],
        modsEasier: [
          "A sign warns of the hazard, as required by law.",
          "This particular breed of snatchweed recoils from salt; put enough on the surface and tendrils recoil."
        ]
      },
      {
        name: "Thirstclimber",
        category: "Supernatural Plants",
        desc: "The vines are red, and when flesh touches them (even through leather) the vine draws blood to the surface in alarming quantities. The vines are slippery, and almost impossible to grasp with wet hands.",
        questions: [
          "Are the vines clearly visible to those who can see in the Ghost Field?",
          "Do the vines cause damage that must be healed, or does the blood only flow when they are nearby?"
        ],
        modsHarder: [
          "The site has guard creatures that track by scent and are drawn to attack things that smell bloody.",
          "Thirstclimber is cultivated at the mid-point of a really difficult climb."
        ],
        modsEasier: [
          "Annoyed locals keep it trimmed back on outside walls periodically in spite of the guardian's threats.",
          "Guards know the ingredients to make a special paste, and the symbol to paint on skin with it, to protect from the plant's effects. A former guard might share the secret."
        ]
      },
      {
        name: "Thirsty Thorns",
        category: "Supernatural Plants",
        desc: "Strategically placed thornbushes grow on walls and serve as decorations. They live on blood. They only flower if something dies on them; the bigger the life, the more impressive the bloom.",
        questions: [
          "Do they feed on radiant light?",
          "Are they along the interior walls, lining the walks, and climbing walls outside?",
          "Are there thorns inside, along windows or protecting secret doors?"
        ],
        modsHarder: [
          "The thorns are poisonous, inflicting some condition on those who fail to resist.",
          "Possibilities include sleep, death by choking, blinding blood from the eyes, or paralysis.",
          "The thorns are considered a gardening achievement, with some fame and support as local culture."
        ],
        modsEasier: [
          "A custom amulet tuned to their life energy turns the thorns away, allowing its bearer to push through them unharmed. A site defender may have one, or one could be made.",
          "They are old and brittle, dying by inches and neglected."
        ]
      },
      {
        name: "Vine Curtains",
        category: "Supernatural Plants",
        desc: "Curtains of vines connect back to a radiant root that has grown semi­aware, fed on rogue spirits. If touched, the vines slither and writhe to entangle, hoist, and bundle the target for a guardian to find.",
        questions: [
          "What do the vines look like?",
          "Do they use their scent to attract or repel?",
          "Where is the root relative to the curtain?"
        ],
        modsHarder: [
          "Many curtains and roots of different sizes (some quite big) connect back to a central bulb somewhere in the defense site.",
          "The vines also have a contact poison that makes their target go limp for 10-60 minutes."
        ],
        modsEasier: [
          "The site owner does not have legal permission to have the vine curtains, so they are only used inside.",
          "The vine curtains grow wild and the lazy site owner does not keep them trimmed back, so other guards must stay away from them."
        ]
      },
      {
        name: "Caul Piercers",
        category: "Traps",
        desc: "Piercers are designed to puncture whoever touches them. They pierce the energy caul of the character's life force in the Ghost Field. This causes a harm condition that worsens or costs stress every down time cycle until the caul can be mended (6 segment project.) Interpret as needed.",
        questions: [
          "Do the piercers resemble knives, nails, or thorn-like carvings?",
          "What sadistic expert crafted these dire traps?",
          "If pried out of their settings, how long do they retain potency?"
        ],
        modsHarder: [
          "Those affected will trail life energy like a wounded fish bleeding in the water; demons and ghosts alike will investigate the scent.",
          "They are worked into important doorknobs, strategic ledges, and concealed flooring."
        ],
        modsEasier: [
          "They all look alike and are similarly placed, relying on surprise to be effective.",
          "They are only on the main treasure."
        ]
      },
      {
        name: "Collapsing Ceilings",
        category: "Traps",
        desc: "If triggered, this trap drops a mass of stone. That seals off the threatened area, and crushes anyone tampering with its defenses.",
        questions: [
          "Who put valuables behind a trap that could seal them away for good?",
          "How old is this defense, and who takes care of it?",
          "What warning signs tip off an intruder that continuing is dangerous?"
        ],
        modsHarder: [
          "Hidden mechanisms can raise the block back up to the ceiling, so the trap can be reused (or defeated remotely.)",
          "More than one block falls; the first one cuts off escape, then death seems inevitable."
        ],
        modsEasier: [
          "The stone dropped long ago. Site guardians or intruders have developed ways to climb over it or get past it. Other blocks may still be untriggered, but some of them are no longer dangerous.",
          "More like a mine collapse, difficult to control and possible to tunnel past."
        ]
      },
      {
        name: "Combination or Trick",
        category: "Traps",
        desc: "Various portals and defenses of the site are protected by combination locks or riddles to solve. Lockpicks will not work against them, though finesse may solve them eventually.",
        questions: [
          "Are there a series of combination locks expressing a religious or eccentric worldview?",
          "Are there picture arranging puzzles, or unusual  keys  to go in sculpture locks?",
          "Are the locks mechanical or supernatural?"
        ],
        modsHarder: [
          "Powerful runic work or enslaved ghosts make the obstacle difficult to smash or trick--the right combination or object must be used to bypass it.",
          "Clues and needed items are spread across a large estate, or multiple estates."
        ],
        modsEasier: [
          "The combination or solution to the puzzle is in a scholarly work, and can be found or bought ahead of time.",
          "The solutions are painfully obvious to someone with the right upbringing and background."
        ]
      },
      {
        name: "Contact Needles",
        category: "Traps",
        desc: "Small needles are worked into contact surfaces and poisoned, to deter intruders. They may be on doorknobs, seat backs or cushions, doorframes, stair treads, ledges, beds—anywhere, really.",
        questions: [
          "Are the needles easily visible if you look for them, or camouflaged?",
          "Are they retractable if you know what you're doing?",
          "What kind of poison is on them?",
          "Will the victim sleep, freeze, die, or hallucinate?"
        ],
        modsHarder: [
          "The needles are only corporeal to those who touch them without wearing a certain amulet. Important site guardians are immune to the needles.",
          "Anything important or at an unguarded entry point is going to be festooned with needles."
        ],
        modsEasier: [
          "They are not well maintained. Many have snapped off, and few retain much poison.",
          "They are only on the most important objects or the most useful trap objects (like a chair for guests.)"
        ]
      },
      {
        name: "Excellent Locks",
        category: "Traps",
        desc: "Beyond simple security, these locks are works of art. They are higher potency than they would normally be. Also, they are equipped with poison needle traps, or pick breakers, or redundancies.",
        questions: [
          "Who put in these superior locks, and for what reason?",
          "Are the locks designed to defeat entry, or actively punish intruders?",
          "Do the specialized keys have a distinctive look, like two flanges?",
          "Is there a master key?"
        ],
        modsHarder: [
          "Everything is locked, and all the locks are good. Somebody had a real lock problem.",
          "The locks involve supernatural components, like hidden keyholes or paralyzing energy."
        ],
        modsEasier: [
          "The locks are in poor repair, of variable quality after indifferent maintenance and many intrusion attempts.",
          "Very fancy locks, but they are padlocks, and bolt cutters can circumvent the problem."
        ]
      },
      {
        name: "Murder Holes",
        category: "Traps",
        desc: "Intruders go past one door, into a hallway or small room, and the door closes behind them. Arrow slits open in the walls, and slots in the ceiling allow boiling oil to be poured down. Intruders are trapped and vulnerable. These are often in doors through defenses.",
        questions: [
          "Was the original site builder often under siege?",
          "Are the murder holes obvious or concealed?"
        ],
        modsHarder: [
          "Murder holes are automated with self- slamming doors and pre-boiling oil, so a few defenders can trap and/or kill many intruders.",
          "The whole layout is built with many murder hole areas to deter invasion."
        ],
        modsEasier: [
          "The walls are wooden, and determined captives can break through to face their attackers.",
          "This area does not have enough staff to monitor intruders and make best use of murder holes."
        ]
      },
      {
        name: "Pit Traps",
        category: "Traps",
        desc: "The defended site has pit traps in strategic places. They are between 10 and 40 feet deep.",
        questions: [
          "Do they have slick sides?",
          "Are there spikes at the bottom?",
          "Are the covers mechanized, or flimsy boards and carpets, grass turf, or leaves over canvas?",
          "Are the sides stone, earth, or clay?"
        ],
        modsHarder: [
          "Fist sized tunnels connect pits. Predatory creatures (crabs, snakes, spiders, rats) scurry to devour victims.",
          "Once someone falls into the pit the covers close again, and will not open until unlocked."
        ],
        modsEasier: [
          "The pits drop into a lower area, mostly abandoned except for predators. It is possible to find a way out.",
          "The pits are mostly open and filled with junk."
        ]
      },
      {
        name: "Retractable Spikes",
        category: "Traps",
        desc: "Spring-loaded spears or racks of spears launch at intruders. They can come from the side, behind, ahead, below, or above.",
        questions: [
          "Are the defenses standardized to protect guardians, or random to confuse intruders?",
          "Are they in an area that site defenders use, or in an isolated off-limits area?",
          "How long have they been in use, and how often are they maintained?"
        ],
        modsHarder: [
          "After doing their killing work, they retract, and the launch points are not obvious.",
          "The spears are slathered with some toxin, further affecting the victim."
        ],
        modsEasier: [
          "The mechanisms are not well maintained. Sometimes they don't work, and when they do, there is a screech and they are a bit slow.",
          "The spears are designed to pin an intruder in place, to be interrogated and punished, rather than to kill outright."
        ]
      },
      {
        name: "Secret Doors & Spyholes",
        category: "Traps",
        desc: "Guardians are well trained in the use of numerous secret doors and hidden passages with spyholes. They can attack from unexpected directions, escape without a trace, and watch intruders unobserved.",
        questions: [
          "Was this site built by a spy, or a cult, or a paranoid aristocrat?",
          "Are there consistent tells, a code built into the decor and architecture, or must all secrets be known individually?"
        ],
        modsHarder: [
          "Ongoing rearrangement and construction means old information from plans or people ages out fast.",
          "Supernatural locks and keys mean that triggers and spyholes and seams may not be visible in the material world at all."
        ],
        modsEasier: [
          "Frequent use has made secret doors easier to spot. Poor baffling of lights may reveal spyholes in use.",
          "Current residents are only aware of some secrets; intruders may use back ways to elude security."
        ]
      },
      {
        name: "Shock Grips",
        category: "Traps",
        desc: "One or more contact points are connected to energy so they will badly shock anyone who touches them. These could be doorknobs, chest lids, floor plates, ladders, and so on.",
        questions: [
          "Are they powered by batteries or enslaved ghosts?",
          "Does the site have legal permission to use them?",
          "How loud is the shock?",
          "How do site guardians avoid getting shocked?"
        ],
        modsHarder: [
          "The shock grips are numerous and concealed, connected to their energy source through the Ghost Field.",
          "The shock is designed to stop the heart and kill the victim (possibly setting hair on fire.)"
        ],
        modsEasier: [
          "The shock grips are connected to control boxes and energy sources by cables.",
          "Shock grips are marked by a rune, and shiny, and also give out a palpable hum of energy. They are easy to detect."
        ]
      },
      {
        name: "Brutal Sadists",
        category: "Twisted Guards",
        desc: "Only brutal sadists are hired on as guards. They have permission to play with captured intruders.",
        questions: [
          "Is the owner of the protected property aware of this cultural rule, or are guards hired by an employee?",
          "Do they share cultural roots (slaughterhouse workers, leviathan hunters, soldiers, city guards, etc)?",
          "How do the neighbors feel about their occasional scandals?"
        ],
        modsHarder: [
          "Several of them are skilled in both torture and interrogation; they extract secrets from intruders. A side business in blackmail helps them avoid legal trouble.",
          "They are hardened veterans, exceptionally tough and dangerous. They aim to incapacitate."
        ],
        modsEasier: [
          "Their ugly tactics and poorly chosen victims have earned them (and their employer) enemies in lots of unexpected places.",
          "They really, really like to drink."
        ]
      },
      {
        name: "Close-Knit Guard Network",
        category: "Twisted Guards",
        desc: "Guards are only hired by referral. Failure results in punishment for both the guard and the sponsor. Their loyalty is tested many ways before and after they are hired.",
        questions: [
          "Do they favor bastards of the employer?",
          "Are they connected to one military unit?",
          "Are they refugees from another place?",
          "Do they come from a single neighborhood?",
          "Does punishment extend to their families?"
        ],
        modsHarder: [
          "They are connected to a larger sponsoring organization that would seek vengeance if they are attacked or insulted, and also offer them favors.",
          "They speak in code and have passwords that include safewords and warnings."
        ],
        modsEasier: [
          "Nepotism has pulled in some really incompetent guards.",
          "Endless drama from working with family and friends."
        ]
      },
      {
        name: "Compulsive Detail Focus",
        category: "Twisted Guards",
        desc: "Only a certain type is hired; a type that checks every lock and every dark corner. Schedules are strict, thoroughness is a guarantee, and they seem unable to cut corners or skip steps. Everything is by the book.",
        questions: [
          "Are they altered to be like this, or just screened for a mindset?",
          "What are the detailed parts of the defended site that need this kind of attention?",
          "How does their gear reflect this fussy attention to detail?"
        ],
        modsHarder: [
          "There are other elements of the defended site that require their focus, like a pattern of stepping over tiles to avoid triggering traps or complex combination locks or dozens of cells with dangerous prisoners.",
          "They are trusted with specialty items like firearms or charms because they are responsible with them."
        ],
        modsEasier: [
          "Everyone knows that they fall apart if things deviate from the pattern, like distractions or chaos.",
          "The locals pick on them when they are off duty, teasing them for their compulsions. They have enemies, and could use friends."
        ]
      },
      {
        name: "Convict Public Service",
        category: "Twisted Guards",
        desc: "Due to prison overcrowding, some criminals are sentenced to indentured service to a noble to work off their debt to society. This site's guardian uses criminals as guards, under the stern eye of professionals.",
        questions: [
          "Are casualties high due to danger from intruders or other site defenses?",
          "Is the patron benevolent and trying to rehabilitate criminals, or using them as disposable fodder?",
          "How do the convicts like this place?"
        ],
        modsHarder: [
          "Serving here is a known post among criminals, both a resume builder and networking site.",
          "Angering these guards could bring consequences from unexpected directions in the criminal underworld.",
          "Hand picked as the hardest and deadliest, these criminal guards are canny and tough."
        ],
        modsEasier: [
          "Convicts are eager to assist anyone with enough Coin or pull to secure their pardon and freedom.",
          "The convicts are bullied and sullen, as much a hindrance to defenders as a defense themselves."
        ]
      },
      {
        name: "Demonic Mutations",
        category: "Twisted Guards",
        desc: "About a quarter of the guards have been mutated by contact with demonic essence. They are strong, and their senses are sharp.",
        questions: [
          "Do they share one demon patron?",
          "Did they become guards to gain this power?",
          "Are they worshippers or mercenaries?",
          "Did they volunteer or are they victims?",
          "What element is their demonic affinity?"
        ],
        modsHarder: [
          "They share a supernatural connection and can sense when other demonic guards are in trouble.",
          "They are highly resistant to normal damage. They may be vulnerable to supernatural attacks or a specific allergy (silver, garlic, salt, etc.) Or, they may be resistant to supernatural attacks instead."
        ],
        modsEasier: [
          "They become physically impressive, but their minds are lost to incoherent lusts and fury.",
          "The rest of the staff resent or fear the demonic guards. Loyalty and morale are low among mundane employees."
        ]
      },
      {
        name: "Enchanted Prosthetics",
        category: "Twisted Guards",
        desc: "Guards are all amputees with at least one prosthetic. Each prosthetic tunes to its owner. The prosthetics can stun on contact.",
        questions: [
          "Are the false limbs the work of one genius?",
          "Are they part of a collection?",
          "Were they made for this use?",
          "Is a ghost bound to each?",
          "Are they scientific, with batteries?",
          "Are they powered by the bearer's life force?"
        ],
        modsHarder: [
          "All guards have some adept training and spirit bane charms, alert against supernatural forces.",
          "Veteran guards have learned to tune to their prosthetics to get an additional effect, like life detection or firing energy blasts."
        ],
        modsEasier: [
          "Only one use between recharges.",
          "The guards are mostly old or broken, relying on reputation and supernatural energy to be effective."
        ]
      },
      {
        name: "Feral Pen",
        category: "Twisted Guards",
        desc: "Some areas of the defended site have free-range maniacs. Destitute and wretched beggars are treated as guard dogs, expected to attack intruders and draw attention to anything unusual.",
        questions: [
          "Does the guarded site pretend to be charitable, or a madhouse, or a prison?",
          "What philosophy leads to treating people this way?",
          "How do the city authorities feel about the site?",
          "Religious authorities?",
          "Does the site feed into the Ghost Field in an unusual way?"
        ],
        modsHarder: [
          "Most of the feral guards are killers, possibly haunted, and extremely dangerous.",
          "This pet project is as much art and religion as defense, and has support from a variety of decadent aristocrats in positions of power."
        ],
        modsEasier: [
          "The rest of the site guards hate the feral pen and ignore it as best they can.",
          "It is as much prison hospice as guard dog kennel. Its victims are weak, sick, and starving."
        ]
      },
      {
        name: "Fighting School",
        category: "Twisted Guards",
        desc: "An onsite training school focuses on the lifestyle and skill of a school of fighting. Site defenders are part of a group identity with specialty training.",
        questions: [
          "Is the school's focus on dueling, a martial art, commando training, or something else?",
          "What is their crest, uniform, motto, and lore?",
          "What sort of training space do they have?"
        ],
        modsHarder: [
          "The school itself is an impressive fortress or defense.",
          "The school has an impressive alumni network that visits occasionally and would avenge wrongs to the honor of the school."
        ],
        modsEasier: [
          "This is an off-site shrine or expansion, where they send troublemakers and those they can't eject for political or financial reasons.",
          "Leadership is riddled with rivalries and power struggles. Outsiders know some details."
        ]
      },
      {
        name: "Performance Enhancers",
        category: "Twisted Guards",
        desc: "Guards have ready access to drugs. Some of the drugs enhance performance.",
        questions: [
          "Do the drugs give them a burst of combat effectiveness?",
          "Are the drugs recreational, making them popular with a customer base that pays well and owes favors?",
          "Who provides them with drugs?"
        ],
        modsHarder: [
          "As dealers, the guards are difficult to bribe or intimidate, as they have money and prestige.",
          "Guards can medicate flexibly, with concoctions to enhance perception (even to see the supernatural,) gain combat prowess, or heal."
        ],
        modsEasier: [
          "Their peddling of illegal drugs has made enemies among bluecoats and inspectors.",
          "The guards are junkies. Their employer uses addiction to control them, keeping them near the edge. They are often distractible or unconscious."
        ]
      },
      {
        name: "Zealots",
        category: "Twisted Guards",
        desc: "Guards share a religion that binds them together and makes them resistant to intimidation or corruption.",
        questions: [
          "Do they worship one of the Forgotten Gods? The Church of the Ecstasy of the Flesh? Weeping Lady?",
          "Have they sworn oaths?",
          "What does religion require them to hate, or to love?"
        ],
        modsHarder: [
          "The defended site includes a shrine or temple. Violating the site angers offended worshippers.",
          "Serving as a site guardian is part of a religious duty. Unexpectedly seasoned warriors or important people may serve as lowly guards for a time."
        ],
        modsEasier: [
          "Mandatory prayer times, unclean objects or places left uninspected, and restricted areas may create holes in security.",
          "Enemies of their religion may offer help to embarrass, discredit, or injure the zealots."
        ]
      },
      {
        name: "Ghostport Lock",
        category: "Weird Tech",
        desc: "Keys are tuned to locks that cannot be picked by normal means, or bypassed without whisper expertise. Their access point is in the Ghost Field until the key is present.",
        questions: [
          "Are these locks modem scientific triumphs, or old arcane defenses?",
          "Does he key look like a key, or does it look like a missing decoration, or a gem?",
          "Is the key physical, or energy, like living blood of the right family?"
        ],
        modsHarder: [
          "The locks are hidden and trapped. Messing with the lock could hollow the intruder (tearing the spirit out of the body) or other unpleasantness.",
          "The precise location of the lock must be known, and it is not near what it is locking."
        ],
        modsEasier: [
          "The ghostport lock has been a fad several times in Duskwall. Each time, there was some mass production, and a key to a similar lock might work with a little help.",
          "The owner may have stiffed a whisper locksmith on the fee, or otherwise offended the expert, who is knowledgeable and disgruntled."
        ]
      },
      {
        name: "Lightning Walls",
        category: "Weird Tech",
        desc: "Runic energy twisting technology can make pylons that project a curtain of energy between them. The glowing walls are transparent, but crippling to touch and lethal to pass through. They stop projectiles.",
        questions: [
          "Does the site have the technology legally, or is it stolen?",
          "Maybe cobbled together from leftovers by a mad alchemist?",
          "Is it on all the time (expensive to fuel) or only if the alarm is raised?",
          "Where are the fuel cells kept?"
        ],
        modsHarder: [
          "The equipment is properly installed, its vulnerable parts behind the energy curtain, directly guarding what needs protecting.",
          "The lightning walls attract loose spirits, intruders may also have to contend with confused ghosts."
        ],
        modsEasier: [
          "The walls guard a few key access points, but there are multiple ways around.",
          "The walls are installed poorly, so their machinery is vulnerable from the outside while it is on. If no other guards are present, they can be wrecked."
        ]
      },
      {
        name: "Panopticon",
        category: "Weird Tech",
        desc: "Special crystal lenses transmit their sight through the Ghost Field to mirrors in a central location. From one place, a guardian can monitor views all over the defended site.",
        questions: [
          "Is this new industrial alchemical technology, or an ancient enchanted construction?",
          "Does the current owner know how to get the most functionality out of it?",
          "Who maintains the system?"
        ],
        modsHarder: [
          "The lenses are hidden in mirror frames, statues, and other decor. They are difficult to spot.",
          "The lenses can see into the Ghost Field as well, observing ghosts or occult work, and life force."
        ],
        modsEasier: [
          "The guardians watching the mirrors are somewhat lax.",
          "Over time, many lenses have not been replaced or repaired. Views are limited."
        ]
      },
      {
        name: "Shadow Lanterns",
        category: "Weird Tech",
        desc: "Guards are equipped with lanterns that detect shadows of recent life force as well as shedding light.",
        questions: [
          "Are the lanterns traditional lantern shape, or a glowing ball, or something else?",
          "Does an expert keep the guardians supplied, or is their supply jealously guarded?",
          "Does it cost the guards something to activate the lanterns?",
          "Will the lanterns work if taken off-site?"
        ],
        modsHarder: [
          "Guards are trained to tune into the life force energy to also hear conversations of the life shadows. Guards can tune into the life force energy to know the owner's current location, if in the defended area.",
          "Untended lanterns can be set to transmit detection of a life force to a nearby guardian."
        ],
        modsEasier: [
          "The lanterns can be rendered blind by properly tuning a spiritbane charm while near one.",
          "Every sunrise wipes all traces of past life forces, and they only work at night."
        ]
      },
      {
        name: "Shadow Rooms",
        category: "Weird Tech",
        desc: "The Ghost Field sometimes remembers rooms or entire neighborhoods that no longer exist in the material world. Some defended sites hide treasures in these spaces that can only be accessed if you knowhow.",
        questions: [
          "How are colors different in these shadow rooms?",
          "Is there a smell or sound that lingers?",
          "How does it feel to step out of the material world?",
          "What natural laws work differently here, like fire not flickering?"
        ],
        modsHarder: [
          "The access point to the shadow rooms is an enchanted lock, its location is known and guarded.",
          "The shadow rooms are only connected to the material world a few times a year, or less."
        ],
        modsEasier: [
          "Transitioning from the material world to the shadow rooms involves certain proscribed movements; cross the courtyard three times, then back down stairs with eyes closed (for example.) Too many people know the formula.",
          "The current site owners do not know these rooms exist."
        ]
      }
    ],
    NPCs: [
      {
        name: "Arturo Montastic",
        type: "npc",
        concept: "Addicted Gambler",
        arena: "New Money",
        description: "He is impossibly lucky. He wins enough at games of chance to pay for his addictions, and to treat the consequences (transfusions, transplants, cutting-edge treatments.) His relationships are intense but brief. He often loses everything, but then wins it all back and more. He has owned epic treasures many times.",
        notes: "Risk-averse collectors cannot bear his cavalier attitude on winning and losing priceless art. He does not truly appreciate his treasures, and should not be trusted with them. Losers can take their losses hard."
      },
      {
        name: "Baron Kelyr Strathmill",
        type: "npc",
        concept: "Hardened Industrialist",
        arena: "Old Money",
        description: "His family has controlled the docks for many generations. They quietly destroy competition, and get lucrative city contracts to re-develop blighted areas if the money slows down. Graceful, educated, and pleasant, he is ruthless as barbed steel under a cultured veneer. He is proud of his estate's gardens.",
        notes: "Competition doesn't like being crippled. He often hires outsiders for the dirtiest work, and his victims often hire outsiders to get revenge."
      },
      {
        name: "Baroness Thena Hellyers",
        type: "npc",
        concept: "Hazy Art Patron",
        arena: "Old Money",
        description: "Thena is one of the least emotionally scarred survivors in her weird family. She is a leading light in the art world. She is patron to many artists and her criticism and evaluation drives a significant element of Duskwall's art scene. Whispers have noted she has an unusual connection to the Ghost Field.",
        notes: "Sometimes she hires outsiders to sort out one of her artists' problems. She has a private gallery that she updates with her current trending tastes—those in the art market need to know what's in it."
      },
      {
        name: "Calvin Dannos",
        type: "npc",
        concept: "Eerie Assassin",
        arena: "Underworld",
        description: "The Inkvein was a cabal of seven anonymous assassins, named for their maps of the canals. If one of them was identified as a member, the other six were sworn to kill the outed assassin. Dannos was outed a decade ago, and he killed the other members and their undying founder. Now he IS Inkvein.",
        notes: "Easily bored, he prefers interesting challenges to high paying or easy kills. Of course, many bereaved or power hungry individuals want him dead."
      },
      {
        name: "Commissioner Naria Haig",
        type: "npc",
        concept: "Political Matchmaker",
        arena: "City Law",
        description: "She exudes a plump grandmotherly innocence, but she is one of the sharpest politicians in Duskwall. She supervises over the merging of unexpected allies and the schism of monolithic interests. She cares about one thing—the good of Duskwall as a whole. She is Chair of the Ethics Oversight Committee.",
        notes: "Always playing a bigger game, she uses outsiders to manage errands whose purpose they cannot see. Those she outmaneuvers tend to want to get back at her with violence."
      },
      {
        name: "Doc Sarnin",
        type: "npc",
        concept: "Lecherous Leech",
        arena: "Underworld",
        description: `Doc can keep life in you if you're alive (or recently dead) when you get to him. His extreme methods are often horrifying. Still, his concoctions can crush ghosts, re-attach limbs, and more. The Crows, a tough crew, protect him. They give him victims for his "needs," which are emotional, physical, and scientific.`,
        notes: "Sometimes the Crows hire outsiders to go after rare components or victims for Doc. He has many, many enemies who want to either steal him and force him to serve them, or punish him."
      },
      {
        name: "Doctor Ixit Crichelle",
        type: "npc",
        concept: "Elegant Spook",
        arena: "Old Money",
        description: "Crechelle calls himself an Oneiric Master. He interprets dreams for a fee. He enters them, alters them, and moves through veils to understand truths and secrets the dreamer may not grasp. If he touches a target, or one of their possessions, he may enter their dreams. He appears feeble, but his mind is deadly.",
        notes: "Aristocratic patrons invite him to parties. He needs a person's possession to see into their dreams; he pays for objects to visit some people's dreams. Victims will pay to free themselves ."
      },
      {
        name: "Dr. Hansel Kryvanntic",
        type: "npc",
        concept: "Brilliant Scientist",
        arena: "Foreign",
        description: "He is Severosi, bow-legged and wild-haired. His work on electroplasmic poisoning and mutation in animals and humans is ground-breaking. Fleeing persecution because of his ethically questionable methods back in Severos, he found a more open-minded scientific community in Duskwall.",
        notes: "His research has applications in art, medicine, and war. Those with sufficient resources to further his studies want to control him. He has hurt a lot of people, over time, so he has many enemies."
      },
      {
        name: "Dr. Yerial Crabbskidditch",
        type: "npc",
        concept: "Sleazy Lawyer",
        arena: "New Money",
        description: "He firmly believes those who are wealthy should not be pestered with the law. No matter what you do, if you have means you can arrange for an alternate story that favors you. Deaths, frauds, robberies, and other crimes can be reduced to a few fines. He throws money at problems until they disappear.",
        notes: "He routinely hires outsiders to destroy evidence, intimidate witnesses, compel confessions, and so forth. He has countless enemies, both those seeking justice and former clients who ran out of money."
      },
      {
        name: "Duvrel the Snake",
        type: "npc",
        concept: "Cunning Smuggler",
        arena: "Foreign",
        description: "She is Tycherosian, with the eyes and horns of a goat. Snake tattoos coil around her arms. Exotic drugs from the Dagger Isles flow through her distribution network in Duskwall. She hires outsiders to remove stubborn people while she has an alibi, or to retrieve drugs misplaced at incriminating locations.",
        notes: "Inspectors have orders from the Spirit Wardens to take her alive, to study her uncanny ability to flex with the Ghost Field for supernatural stealth."
      },
      {
        name: "Dylayzia Finchester",
        type: "npc",
        concept: "Fashionable Whisper",
        arena: "New Money",
        description: "Her exotic looks, tattoos, and bright green eyes draw attention. She popularized thigh-high buckled leather boots and spirit bane chokers. Her opinions echo in drawing rooms across the city. People enjoy her feud with the Church of the Ecstasy of the Flesh.",
        notes: "Wealthy figures in the fashion world pay top win for sneak peeks at her clothing designs. Her opinions inflame many enemies­-especially the Church. She hires outsiders to get rare components for her rituals."
      },
      {
        name: "Emeline Coleburn",
        type: "npc",
        concept: "Weary Regulator",
        arena: "City Law",
        description: "She inspects buildings and reports to the Duskwall Council whether they are sound, and whether they serve the purpose listed on the owner's taxation form. She is front-line in the tug-of-war between criminals, politicians, and nobles. She no longer cares about the greater good. Now it's about kickbacks.",
        notes: "She takes the path of least resistance in her evaluations, so people pay to make their preference easier and other roads harder. She hires outsiders for off-the-books communication with pushy customers."
      },
      {
        name: "Eric the White",
        type: "npc",
        concept: "Vigilante Rebel",
        arena: "Foreign",
        description: "The War of Skovlan Unity is over, but this slender maniac with a brushy beard can't let it go. He plans to destroy the government and turn Duskwall into a Skovlan colony to punish them for the destructive war. He wants to discredit and disrupt the government at every turn.",
        notes: "He targets gavernment officials as high up as he can reach, hoping to cause enough trouble to make the government vulnerable to change. He has gathered zealots, and he uses outsiders for disposable work."
      },
      {
        name: "Gi Aniru Ga of Sultha",
        type: "npc",
        concept: "Sacrificing Cultist",
        arena: "Supernatural",
        description: "She worships the Gaping Maw, the Runnel of Life, the Cosmic Thirst. She builds a cult, teaching them to hunt and conduct rituals. Then she moves on. Witnesses uneasily describe her supernatural abilities, including shapeshifting, flight, killing people by attacking their shadows, and so on.",
        notes: "Bereaved relatives, rival cultists, and law enforcers all want her stopped. She hires outsiders to threaten, misdirect, or kill law enforcement. Determined inspectors crush cults she trained, need help to catch her."
      },
      {
        name: "Holtz Clermont",
        type: "npc",
        concept: "Reformed Clerk",
        arena: "City Law",
        description: "He used to be a forger. After he served stint in prison, some respectable family friends got him a position as City Clerk for the whole district. He manages correspondence for permit requests and official notices. When corrupt people inside and outside the system need to adjust evidence, they come to him.",
        notes: "Jilted clients can be threatening, leading him to take steps to adjust their attitude by hiring outside help. He's smarter than he looks, and knows how to back people off. He also might know too much."
      },
      {
        name: "Inspector Lorette Salkha",
        type: "npc",
        concept: "Crusading Inspector",
        arena: "City Law",
        description: 'She needs allies in her hopeless quest to clean up the city. Corruption is everywhere, crime runs rampant, and the bluecoats serve the powerful (on both sides of the law.) Some tragedy in her past propels her into a suicidal effort to restore "rule of law.” Her peers muse it is a shame she will die young.',
        notes: "She could be helpful if she focuses on the right bad guys—your enemies. She can't be bought, so maybe someone needs her killed (or otherwise neutralized.)"
      },
      {
        name: "Jemma Dropkick",
        type: "npc",
        concept: "Feminist Vigilante",
        arena: "Underworld",
        description: "She is a legend in the Seven Shallows neighborhood. She attacks men who abuse women. She survives because she has friends—a few bluecoats, a gang of thugs, and a grateful public. She carefully plans attacks to hurt abusers. Lf her victims abuse again, they are mutilated, packed like luggage, and shipped out of town.",
        notes: "Many powerful men would pay for revenge on Jemma. Sometimes she hires outsiders to help out."
      },
      {
        name: "Kheldaria Whinnich",
        type: "npc",
        concept: "Implacable Developer",
        arena: "New Money",
        description: "She has a vision for developing the Crow's Foot district. It will be divided between businesses, estates, and parks. To realize her vision, she has been selectively buying real estate all around the city, bartering for land in Crow's Foot, and using whatever persuasion is needed to convince owners to sell to her.",
        notes: "She has an estate where she stores induce­ments of all sorts, a variety of treasure designed to persuade owners to sell in exchange for what they want most. They say you could find almost anything there."
      },
      {
        name: "Lady Ashlyn Tyrconnel",
        type: "npc",
        concept: "Decadent Duelist",
        description: "For centuries, aristocrats of Duskwall have learned the Tyrconnel Method of swordplay and self defense. The Tyrconnel family produces countless public servants and warriors—but also a share of scoundrels. Ashlyn's trademark suite of moves is to duel, win, bed someone, and drink to unconsciousness.",
        notes: "You're hired to join the spy game in the Tyrconnel family. Or, someone is targeting her. Either way. Watch your back. Outsiders in the games of nobles are uniformly expendable."
      },
      {
        name: "Lady Candra Dunvil",
        type: "npc",
        concept: "Corrupt Fixer",
        arena: "Old Money",
        description: "Her family built Ironhook Prison. Her wealth is built on generations of shady deals with incarcerated aristocrats and business owners. She sees the world as a rigged game and has contempt for anyone who finds corruption shocking or fixable. She is vain, practical, and ruthless.",
        notes: "She hires outsiders to carry out promises she made to inmates. Her family has casually wrecked reputations and lives over centuries, and that leaves a trail of vengeance seekers."
      },
      {
        name: "Lady Polonia Brogan",
        type: "npc",
        concept: "Desirable Dowry",
        arena: "Old Money",
        description: "She's ugly, smelly, stupid, and rude--and also the key to the Brogan fortune. Her lucky spouse will have access to massive wealth and infrastructure among professional builders and shipwrights of Duskwall. Only her aunt, CECILIA DURWITHE, looks out for her best interests with sharp disapproval.",
        notes: "Brogan hires outsiders to punish those who slight her, or to investigate potential partners. She collects fake wills rogues have planted during assassination attempts, trying to leave her fortune to usurpers ."
      },
      {
        name: "Lord Branon Kinclaith",
        type: "npc",
        concept: "Romantic Horseman",
        arena: "Old Money",
        description: "Branon looks like a hero from a legendary story. He manages the family's stables, the finest horses in Duskwall (where horses are a rare luxury.) His tumultuous trysts with both men and women are common knowledge. Business suffers from his impulsive romantic gestures, but benefits from his charm.",
        notes: "Branon sometimes refuses to sell horses, or breed them, if he dislikes the buyer. Some buyers want access to horseflesh anyway. If his horses are attacked, he hires outsiders to get revenge."
      },
      {
        name: "Lord Bulward Skinnester",
        type: "npc",
        concept: "Greedy Banker",
        arena: "New Money",
        description: "This portly curmudgeon does a brisk trade in real estate titles, both lending and foreclosing. He is acutely aware of the value of properties and how neighbors affect value. He takes particular glee in foreclosing on aristocracy and setting up the newly rich in ancient estates.",
        notes: "Sometimes he hires outsiders to solve problems that his hired bluecoats and bribed councilmen cannot manage. He collects sculpture by Duskwall artists. He has ruined the lives of many formerly influential people."
      },
      {
        name: "Lord Orlan Booker",
        type: "npc",
        concept: "Insulated Mastermind",
        arena: "Old Money",
        description: "Ennui is a danger to the wealthy. Booker fills his days by gathering intelligence and planning heists, then selling the plans to ambitious gangs that lack his patience, experience, resources, and insight. Twice a month he goes to the opera, and meets those who have arranged to purchase a score.",
        notes: "Sometimes things go wrong, and it is natural to blame the planner and want revenge. Sometimes a target wants to punish those who acted against them, even if the act was planning."
      },
      {
        name: "Master Slen Dallicore",
        type: "npc",
        concept: "Protective Guilder",
        arena: "New Money",
        description: "Master Dallicore is the Guildmaster for the Docker's Guild. They move all cargo on and off ships, boats, and gondolas. Their role is protected by law, as are the fees they charge. The guild uses low-level violence to discourage non-guild laborers and smugglers. However, some challenges require proper scoundrels.",
        notes: "Dallicore is not above hiring outsiders to punish powerful patrons of smugglers or illegal dock workers. His position of power also gives him access to rare antiquities, both purchased and acquired."
      },
      {
        name: "Minister Fourteen",
        type: "npc",
        concept: "Grungy Fixer",
        arena: "Underworld",
        description: "The blind Skovlander holds court on the docks, moving from one basement to another. He favors baggy shirts, stained vests, shiny jewelry, and fraying lace. He often acts through his massive bodyguard Severen and his weedy messenger Torok.",
        notes: "He is connected in the Skovlander refugee community, and in Skovlan. For a price (either wealth or an errand) he will share information about Skovlanders. He often hires outsiders to handle sensitive tasks."
      },
      {
        name: "Moonslider the Third",
        type: "npc",
        concept: "Eccentric Artist",
        arena: "New Money",
        description: "She feels moon phases. Her family put her in an asylum for a decade. Later, she won her freedom and inherited the family bootmaking fortune. She makes art. She tries to communicate her moon feelings. She uses oil paint, glass blowing, sculpture, song, and dance in multimedia recitals and art pieces.",
        notes: "Her family bought nice things before they all died and she inherited them; she ignores most of it. She needs expensive equipment and supplies for her bizarre art shows."
      },
      {
        name: "Officer Milos Penderyn",
        type: "npc",
        concept: "Corrupt Bailiff",
        arena: "City Law",
        description: "Milos has access to trial evidence, and to prisoners awaiting trial. He can't get people out, but he can silence them. He has a network of corrupt peers, judges, bluecoats, and others so he can trade favors to accomplish the impossible. Huge and greasy, he is built like a bull and he enjoys the scent of fear.",
        notes: "Controlling Milos could mean protecting or killing someone in bluecoat custody. An endless stream of people want revenge on him, and a more select group would like to control or use him."
      },
      {
        name: "Officer Veleris Walund",
        type: "npc",
        concept: "Heroic Bluecoat",
        description: "There are actually songs about him. He is very popular. Veleris is a skilled orator (though he retreats into modesty) and a canny judge of character and situations. (He insists he just tries to do the right thing.) His opinion is influential in his district. He is trusted to guard valuables. His moustaches are his pride and joy.",
        notes: "He has no family, and he seems to be an idealist. Some try to persuade him, others try to threaten him. Threats don't seem to work. He has been known to quietly hire outsiders to get justice."
      },
      {
        name: "Pebbler",
        type: "npc",
        concept: "Demon Spy",
        arena: "Supernatural",
        description: "This earth demon looks like a fat man built around a boulder gut, leaking sand from joints. It is able to see and hear through sand, earth, and stone within a range of miles. It works with non-cultists voluntarily, selling information in exchange for raids into the rare areas protected from its prying.",
        notes: "Dozens of powerful people want Pebbler banished or robbed. However, the demon is a peerless information exchange, valuable even if it is difficult to control."
      },
      {
        name: "Saithernon",
        type: "npc",
        concept: "Exotic Fence",
        arena: "Underworld",
        description: "He drapes his python, DELGRAAZ, around his neck. He wears a turban with a jewel on it. He is willing to buy almost anything, no matter how strange. He also knows what you need, sometimes before you know you need it. His bazaar unfurls below the Kennington market in an abandoned gondola dock.",
        notes: "He pays people to get things for him, then sells them at tremendously inflated prices to those desperate to have them. This can cause hurt feelings among the desperate."
      },
      {
        name: "Serlevica the Brander",
        type: "npc",
        concept: "Spy Whisper",
        arena: "Underworld",
        description: "Gaunt and frizzed, this foul-smelling Whisper has a secret ritual that allows her to control and see through rats she brands. She sells her services as a spy or site guardian. She has survived by retreating into slums and sewers when threatened, and striking from the shadows until it is safe to emerge again.",
        notes: "She is closely tied to the information marketplace, buying and selling secrets. She often hires outsiders to deal with her enemies through theft or violence, and she is in turn a frequent target."
      },
      {
        name: "Sir Mournseller",
        type: "npc",
        concept: "Anarchist Ghost",
        arena: "Supernatural",
        description: "This ghost possesses old men from the Draymach Asylum, breaking them out to find and hire scoundrels for obscure tasks with no independent purpose. Examples include killing an insignificant chandler or stealing a specific stone from a wall in a noble's estate. Payment is the location of hidden treasure.",
        notes: "A decade ago, an astute inspector began picking out the connection between errands, seeing a very long and very dangerous game to unseat the city's rulers emerging."
      },
      {
        name: "Sir Olen Llanwold",
        type: "npc",
        concept: "Piratical Industrialist",
        arena: "New Money",
        description: "He is thin and nervous, easy to underestimate. He specializes in stripping foes of their assets and taking over their operations. His father was a butler, and he grew up hating aristocrats. He understands power structures and corrupts retainers. His top agent, Ellsfielder, is a beautiful and ruthless woman.",
        notes: "Many ruined aristocrats (and their allies) hate Danwold passionately. He does not hesitate to use his assets, legal and otherwise, to defend himself and cripple his foes. He hires outsiders through proxies."
      },
      {
        name: "Sir Tocker Farros",
        type: "npc",
        concept: "Pragmatic Councilman",
        arena: "City Law",
        description: "Sometimes the law works, and sometimes it doesn't. Regardless, the Council must rule and there must be order. Sir Farros ensures the districts he serves do not get too far out of hand before lawless elements are curbed. One way or another. He looks like an affable grandfather, but he has a dark past.",
        notes: "Sir Farros uses inspectors or scoundrels, politicians or housemaids—anyone who will get the job done. He has an endless list of enemies who feel he wronged them, and want revenge. His agents are disposable."
      },
      {
        name: "SLOPSPATTER",
        type: "npc",
        concept: "Canal Hull",
        arena: "Supernatural",
        description: "This hull learned to consume spirits and bolster its strength with theirs. It cannibalizes machinery and rummages in wrecked boats for parts. It has gondola prow shoulder guards and helm, and strange banded armor made of water-logged wood over intricate mechanical parts. It fears destruction.",
        notes: "It assassinates targets, with its body or by possessing machines near them. It hunts whispers, leeches, and scholars, stealing their knowledge and killing them. Their allies want revenge."
      },
      {
        name: "Syla DuTorrivestria",
        type: "npc",
        concept: "Famous Connoisseur",
        arena: "Foreign",
        description: "This mysterious Iruvian hides behind a veil. For years, she has been the final word on Duskwall delicacies. She specializes in evaluating high-end cuisine (including spore wines and cooking with leviathan blood.) She stays in the public eye with racy politics and a string of scandalous romances.",
        notes: 'She must keep any real competitors for her fame weakened and embarrassed, and she has countless enemies. Everyone "knows" she is an Iruvian spy.'
      },
      {
        name: "The Honorable Telia Cray",
        type: "npc",
        concept: "Stern Prosecutor",
        arena: "City Law",
        description: "She's old, she's sour, and she has a reputation for jailing Duskwall's criminals. As thin and hard as an iron poker, she relentlessly pursues her cases, bending the law with a passionate hatred of scoundrels. She runs a special unit of Inspectors dedicated to investigating her cases, run by INSPECTOR ULEK.",
        notes: "If she is taking a case personally ( as she often does) she may hire outsiders to acquire or create evidence. She also conduds a brutal war of counter-intelligence against rogues looking to free their associates."
      },
      {
        name: "The Wooden Judge",
        type: "npc",
        concept: "Haunted Puppet",
        arena: "Underworld",
        description: "This knee-high ventriloquist dummy looks like a caricature of a grim Judge. It is supernaturally animated. The puppet appears unexpectedly, interrupting a scoundrel's routine by offering jobs in a squeaky voice. He pays by revealing the location of hidden caches of ancient coin.",
        notes: "Many angry victims want to know who pulls the strings of the Wooden Judge. The puppet often hires fresh talent for dubious work."
      },
      {
        name: "Theodore Lysander",
        type: "npc",
        concept: "Bard Pimp",
        arena: "Underworld",
        description: "Elegant and charismatic, this well-dressed man runs the Tenpenny Court Network. He manages prostitutes and their customers, his personal connections and charm monetized. He is also a skilled composer and performer, often seen at the Worldsedge Theater in Crow's Foot.",
        notes: "He is a skilled networker. He takes the safety of his friends seriously, and is protedive of his employees, to the point of using blackmail to force powerful patrons to back off."
      },
      {
        name: "Chief Prichard",
        type: "npc",
        description: "The head Overseer of the Ministry of Provisions in Duskwall. Manages the workers and food allotments for the city districts.",
        district: "Barrowcleft",
        traits: [
          "calculating",
          "confident",
          "calm"
        ]
      },
      {
        name: "Lord Strangford",
        type: "npc",
        description: "Operates one of the largest leviathan hunter fleets, serves on the City Council and is a high-ranking member of the secret order within the Church of Ecstasy.",
        district: "Brightstone",
        traits: [
          "secretive",
          "calculating",
          "arrogant"
        ]
      },
      {
        name: "Hutton",
        type: "npc",
        description: "A Skovlander refugee and former soldier, now the leader of an anarchist revolutionary movement, bent on forcing the government to acknowledge Skovlander rights in the Empire.",
        district: "Charhollow",
        traits: [
          "brave",
          "compassionate",
          "wise"
        ]
      },
      {
        name: "Lady Drake",
        type: "npc",
        description: `A magistrate who is "reasonable" when it comes to street crime, so long as the offender's purse is sufficient.`,
        district: "Charterhall",
        traits: [
          "flexible",
          "shrewd",
          "subtle"
        ]
      },
      {
        name: "Master Slane",
        type: "npc",
        description: "A notorious factory foreman known for excessive and cruel punishments for the smallest infractions. Many attempts have been made on his life, but all have failed. Some say he's a devil.",
        district: "Coalridge",
        traits: [
          "cold",
          "cruel",
          "sadistic"
        ]
      },
      {
        name: "Sergeant Lochlan",
        type: "npc",
        description: "The senior Bluecoat squad leader in the district, reporting to Captain Dunvil. Lochlan is flexible and reasonable, taking bribes and payoffs when she can; enforcing the law and making examples when necessary.",
        district: "Crow's Foot",
        traits: [
          "shrewd",
          "tough",
          "commanding"
        ]
      },
      {
        name: "Chief Helker",
        type: "npc",
        description: "One of the most influential senior Dockers. Helker has a lot of sway at the docks, and if you cross him, you might find your cargo tossed into the drink—and possibly you along with it.",
        district: "The Docks",
        traits: [
          "cautious",
          "greedy",
          "vengeful"
        ]
      },
      {
        name: "Master Krocket",
        type: "npc",
        description: "An unsavory, greasy-haired, scarecrow of a man who runs the snarling pack of vicious dogs used by Ironhook to track down escapees and sniff out contraband and tunnels. His dog-handlers can be found around the labor camp and all about Dunslough, using their status with the prison for favors and bribes.",
        district: "Dunslough",
        traits: [
          "cruel",
          "greedy",
          "ruthless"
        ]
      },
      {
        name: "Jira",
        type: "npc",
        description: 'A dealer of fine weapons from the Dagger Isles. Greatly respected by many street toughs in The Dusk—a "jira blade" is a status symbol that many aspire to.',
        district: "Nightmarket",
        traits: [
          "bold",
          "tough",
          "confident"
        ]
      },
      {
        name: "Levyra",
        type: "npc",
        description: 'A medium who invites clients to bring ghosts in bottles to posses her so they can share a few final words before the ghost is "freed" (Levyra hands it off to the waiting Spirit Wardens nearby).',
        district: "Silkshore",
        traits: [
          "weird",
          "daring",
          "dishonest",
          ""
        ]
      },
      {
        name: "Mother Narya",
        type: "npc",
        description: "Runs the Arms of the Weeping Lady charity house.",
        district: "Six Towers",
        traits: [
          "kind",
          "patient",
          "gracious"
        ]
      },
      {
        name: "Maestro Helleren",
        type: "npc",
        description: "Senior composer and conductor of the Spiregarden Theater, premiere performance venue for the elite of the city.",
        district: "Whitecrown",
        traits: [
          "sincere",
          "dramatic",
          "vain"
        ]
      },
      {
        name: "Hester Vale",
        type: "npc",
        description: 'Matriarch of the oldest farm family. The living embodiment of "tough but fair."',
        district: "Barrowcleft",
        traits: [
          "proud",
          "fierce",
          "suspicious"
        ]
      },
      {
        name: "Commander Bowmore",
        type: "npc",
        description: "Chief Officer of the Watch in Brightstone. Bowmore's family financed Bowmore Bridge centuries ago and now holds many positions of power.",
        district: "Brightstone",
        traits: [
          "proud",
          "principled",
          "connected"
        ]
      },
      {
        name: "Briggs",
        type: "npc",
        description: "The owner of a merchant stall at Charhollow market, cover for a network of gossips, spies, and code-smiths among the working class people of the district, selling their services to those who need them.",
        district: "Charhollow",
        traits: [
          "secretive",
          "sneaky",
          "cautious"
        ]
      },
      {
        name: "Lord Penderyn",
        type: "npc",
        description: "Chief Scholar of the Archive of Echoes, authorized by the Emperor to keep a collection of ancient ghosts trapped in spirit bottles, to be consulted in cases where knowledge from the distant past would benefit the operation of the Imperial government. Lord Penderyn also consults the spirits on his own volition, forming the rebellious Path of Echoes society for other elites and nobles who seek communion with the spectral realm.",
        district: "Charterhall",
        traits: [
          "reckless",
          "strange",
          "obsessive"
        ]
      },
      {
        name: "Belle Brogan",
        type: "npc",
        description: "A Skovlander factory worker who's been gaining popularity as a potential union organizer. It's only a matter of time before a factory boss tries make an example of her.",
        district: "Coalridge",
        traits: [
          "charming",
          "confident",
          "bold"
        ]
      },
      {
        name: "Lewit, Jol, Myra, Reyf",
        type: "npc",
        description: "Bluecoat constables; run an extortion racket.",
        district: "Crow's Foot",
        traits: [
          "arrogant",
          "vain",
          "volatile"
        ]
      },
      {
        name: "Tris",
        type: "npc",
        description: "A legendary tattooist who only inks those that have looked upon a leviathan and lived to tell the tale. Getting a tattoo from Tris is a rite of passage for everyone who hunts the demons of the void sea.",
        district: "The Docks",
        traits: [
          "artistic",
          "popular",
          "insightful"
        ]
      },
      {
        name: "Vandra",
        type: "npc",
        description: "A deathlands scavenger that survived six runs and was pardoned. She knows the landscape beyond the barrier very well—but few can make sense of her haunted mumblings.",
        district: "Dunslough",
        traits: [
          "haunted",
          "wise",
          "daring"
        ]
      },
      {
        name: "Leclure",
        type: "npc",
        description: "A purveyor of personal luxuries (soaps, hair oils, perfume, fine silks) who dabbles in fortune telling. Some say her that drowned lover is a ghost that whispers secrets in her ear.",
        district: "Nightmarket",
        traits: [
          "shrewd",
          "tough",
          "commanding"
        ]
      },
      {
        name: "Helene",
        type: "npc",
        description: "The elegant and mysterious proprietor of the Silver Stag Casino. People say she would have been a queen of Severos had she lived in the old days before the Empire.",
        district: "Silkshore",
        traits: [
          "cultured",
          "charming",
          "secretive"
        ]
      },
      {
        name: "Chef Roselle",
        type: "npc",
        description: "One of the best cooks in the city, still operating the legendary Golden Plum restaurant—worth the trip into the haunted streets of Six Towers.",
        district: "Six Towers",
        traits: [
          "creative",
          "insightful",
          "friendly"
        ]
      },
      {
        name: "Lady Freyla",
        type: "npc",
        description: "Regarded by some as the finest sommelier in the Empire. She serves only the most deserving at the Emperor's Cask.",
        district: "Whitecrown",
        traits: [
          "erudite",
          "cultured",
          "charming"
        ]
      },
      {
        name: "Mara Keel",
        type: "npc",
        description: "A former smuggler who's gone into hiding among the farm laborers of Barrowcleft.",
        district: "Barrowcleft",
        traits: [
          "quiet",
          "secretive",
          "patient"
        ]
      },
      {
        name: "Rolan Wott",
        type: "npc",
        description: "An influential magistrate who handles property, endowments, and financial cases. Famous for his extravagant parties.",
        district: "Brightstone",
        traits: [
          "stylish",
          "elitist",
          "shrewd"
        ]
      },
      {
        name: "Corben",
        type: "npc",
        description: "An ex-military Skovlander on the lam for crimes against the empire.",
        district: "Charhollow",
        traits: [
          "tough",
          "reckless",
          "candid"
        ]
      },
      {
        name: "Hopper",
        type: "npc",
        description: 'A drug addict, whisper, and all-around weirdo who perches on rooftops in the district. Hopper claims to see "ghost rails" and "spirit trains" originating deep beneath Coalridge, stretching beyond the horizon.',
        district: "Coalridge",
        traits: [
          "weird",
          "visionary",
          "enthusiastic"
        ]
      },
      {
        name: "Mardin Gull",
        type: "npc",
        description: "Owner and operator of the Leaky Bucket public house. Mardin was the leader of the Crows many years ago, before Roric and Lyssa, and now enjoys a comfortable retirement out of the scoundrel life.",
        district: "Crow's Foot",
        traits: [
          "charming",
          "experienced",
          "respected"
        ]
      },
      {
        name: "Mordis",
        type: "npc",
        description: "A strange merchant which hides its true appearance beneath many layers of robes and hoods. Also fences occult and arcane stolen goods, no questions asked.",
        district: "Nightmarket",
        traits: [
          "secretive",
          "insightful",
          "arcane"
        ]
      },
      {
        name: "Madame Tesslyn",
        type: "npc",
        description: "Operates the Red Lamp brothel, the oldest and most respected institution of its sort in the city.",
        district: "Silkshore",
        traits: [
          "confident",
          "insightful",
          "enthusiastic"
        ]
      },
      {
        name: "Flint",
        type: "npc",
        description: "A spirit trafficker who trades out of a condemned manor house.",
        district: "Six Towers",
        traits: [
          "weird",
          "calculating",
          "suspicious"
        ]
      }
    ],
    Scores: [
      {
        name: "Accidental Death",
        category: "Secret Dirty Work",
        desc: "Not only must the target die, the target must not know how death came. If by some misfortune the ghost of the victim is interrogated, it must not have any special knowledge. There is a ritual and an amulet for the assassins to ensure secrecy. No one living or dead can know who did this deed.",
        narrative: "By the time the crew knows the job, there is a better than even chance their knowledge is too much risk and their employer plans to kill them. They might want some leverage."
      },
      {
        name: "Bayer's Train Heist",
        category: "Misplaced Fortune",
        desc: "Bayer was a rail jack fired for being drunk. Over years, he built a crew with one mission in mind--robbing a train. When lruvia completed negotiations with Akoros to buy an unprecedented mass of leviathan blood to pour into industrialization, Bayer's crew hit the train carrying the payment, sabotaging a bridge. Rescuers found the train in the canyon, but no gold--an impossible feat. Bayer's crew vanished.",
        narrative: 'An Iruvian ingot stamped with the year "802" will attract attention.'
      },
      {
        name: "Bellweather Architectural Plans",
        category: "Historical Curiosity",
        desc: "The Duskwall Archives have the sanitized blueprints of the Bellweather Crematorium on file. The original plans were drawn by a Spirit Warden driven mad by an internal rift, so he haunted himself. He drew peculiar plans with occult underpinnings, and those original drawings were interpreted by architects.",
        narrative: "Are there coded secrets in the original plans that reveal a repellant secret or ominous threat? Or are the plans the scribbling of a madman? Either way, some people would pay top coin to get a good look."
      },
      {
        name: "Book of Walls",
        category: "Historical Curiosity",
        desc: "Long ago, a nameless rogue cultivated a mass of bloodworms in a wall. He wrote a book with their blood. The words were nonsense, but strangely affecting; if the reader tuned in to them, and held the book, the reader could walk through a wall. Spirit Wardens ruined the book with holy smoke.",
        narrative: "A legend, or is there truth to it? Walking through walls is a neat trick, and the book may hold the key to learning it. It is sought by a wide variety of the curious—scholars, collectors, and scoundrels."
      },
      {
        name: "Censer Mace of Udoch",
        category: "Religious Object",
        desc: "The head of this ornately carved mace opens on hinges so incense can be put inside to wisp as the mace swings. The haft has a recipe carved into it, instructions to make special incense out of bone and rare sap and unguents. If that incense bums in the mace, it can destroy ghosts or demons with a single hit.",
        narrative: "This was a founding artifact of the Church of the Ecstasy of the Flesh. If it were returned, they would gain a fresh following from critics who feel the church cannot protect against supernatural threats."
      },
      {
        name: "Charter of Crows",
        category: "Historical Curiosity",
        desc: "This gauntlet is made out of crow beaks. Each beak is carved with arcane symbols. Consulting Whispers officially report it does not have any power in the Ghost Field. It was made by the Spirit Warden who first tamed the deathseeker crows; he claimed it was a treaty that guaranteed their service.",
        narrative: "Spirit Wardens lost this gauntlet decades ago, but they want it back. The idea it is a treaty with the deathseeker crows is probably nonsense. They can't take that chance."
      },
      {
        name: "Combination Harpsichord",
        category: "Weird Scholarship",
        desc: 'TARNALI was a Whisper composer who built a special harpsichord. When two tones are played, often a third "ghost" tone can be heard. By attaching the tuning pegs to crystals and runes, Tarnali built a harpsichord that could interact with the Ghost Field through calculated progressions of played tones.',
        narrative: "This effort is intensely interesting to those who want to find doors hidden in the Ghost Field, draw or repel what lurks Behind the Mirror, or develop more portable tonal energies for non-Whispers ."
      },
      {
        name: "Dyvik's Chaser Mask",
        category: "Weird Artifact",
        desc: "This silvery face mask has the word “Elekthiaron” etched along its inner edge. When the word is spoken, the personality of the one touching the mask is pulled into it. The personality that was in the mask goes in the body. If the one in the body doesn't touch the mask once a week, madness threatens.",
        narrative: "Has someone been using the mask to pose as someone else? How long has that been going on? Is there someone in the mask that needs rescuing? Was the mask used to cheat biological death?"
      },
      {
        name: "Evardian's Song Folios",
        category: "Weird Scholarship",
        desc: 'Four leather-bound volumes, full of musical notation with heavily annotated margins. The "music" is supposed to be transcribed and translated leviathan song. Legend suggests if the music is played correctly, it can drive humans insane with visions of the demon-haunted deep.',
        narrative: "Aristocrats will collect anything. Scholars go to great lengths for research material. Cultists may find religious significance in the folios. (Owning the folios is against the law.)"
      },
      {
        name: "Falheim's Prod",
        category: "Historical Curiosity",
        desc: "This ragged pole with a spear and a silver-cable loop was the first prototype of what became the lightning hook. It doesn't work very well, but it was the first historically known charged object that could consistently interact with the Ghost Field.",
        narrative: "Apparently this bit of history is an important prestige piece in the turbulent intrigues of a number of underground cults led by Whispers. The city government would also like to display it in a museum."
      },
      {
        name: "Fang of Ibiria",
        category: "Religious Object",
        desc: "This brutal stiletto has a green stone in the pommel, and a runic symbol on the blade. The blade transforms electroplasm into a mutagen. The longer the blade is in a victim, the more monstrous the victim becomes. A cut gives nightmares, minutes give mutations, hours or days create a real monster.",
        narrative: "Cultists want this blade so they can make or become monsters."
      },
      {
        name: "Goblet of Eletrachtian",
        category: "Weird Artifact",
        desc: "The silver and gold cup is big enough to hold with two hands, crusted with obsidian stones. The owner puts a drop of a demon's blood in the goblet with certain other liquids, and conducts a ritual. For days afterwards (maybe longer) the owner can see anything the demon uses remote vision to view, just by watching the surface's illusory reflections.",
        narrative: "There are many legends about the creation of the goblet, and the fate of the Whisper who first energized it. Rumor suggests the Duskwall Council entrusted the goblet to a certain family for safekeeping."
      },
      {
        name: "Hollow Shroud",
        category: "Religious Object",
        desc: "The Church of the Ecstasy of the Flesh clergy wrapped the funeral shroud around a heretic, then conducted a ritual that severed the heretic's connection to the body, cutting the spirit loose as a ghost. The shroud transferred the spirit of a faithful but sickly member into the heretic's body. New life!",
        narrative: "The Shroud was stolen almost twenty years ago, and rumors suggest it has been used in debased rituals to summon demons or enflesh echoes of the Forgotten Gods."
      },
      {
        name: "Idol of the Sleeping Lion",
        category: "Religious Object",
        desc: "The hefty iron statue depicts a devilfish-headed humanoid, cloaked in wings. Its presence influences human dreams, so they drift through the ink-black sea but can perceive their surroundings. Sacrificing to the statue gives a cultist a cosmic infection, involving psychic ability and mutations.",
        narrative: "The statue has been retrieved by officers of the law several times, and destroyed several times more. Again and again, it emerges in the heart of fresh tragedy, baleful and singular."
      },
      {
        name: "Ink Fleece",
        category: "Family Heirloom",
        desc: "Long ago, Captain Manarill claimed he could prove that leviathans had fur, or fleece. He brought back a swatch of curling fur as big as a bedspread. He claimed to have harvested it from a leviathan's skin. The mantle served as a symbol of the Manarill family's heritage of exploration and danger. But it was stolen.",
        narrative: "Does it do more than represent heritage? What dreams might one have while wrapped in it? Might a wealthy Whisper pay more for it than the family that owned it? Who took it?"
      },
      {
        name: "Kasavaraya Tea Set",
        category: "Family Heirloom",
        desc: "When the Immortal Emperor visited Akoros four centuries ago, he used this tea set with the patriarch of the Kasavaraya family. They are still one of the most decorated and entrenched military families in Duskwall. Their tea set is a symbol of Duskwall's prominence. However, a saucer and a cup are missing.",
        narrative: "This stuff is priceless, literally, so negotiating a price for its return is tricky. If you could find the missing pieces, or forge them adequately, they would be great hostages to ajfed the family's behavior."
      },
      {
        name: "Kidnap The Heir",
        category: "Secret Dirty Work",
        desc: "People are keys that fit into estate locks. They can be turned to open the way to lots of money. You might be taking a child to ransom back to the guardian, or you might be getting someone out of the way so a more distant heir can inherit. This is about controlling where the money goes.",
        narrative: "How harsh does the employer want this to be? Kid gloves treatment, or is the plan to kill the heir when it is all over? How much input will the employer accept from the hired help? Is the plan already in place?"
      },
      {
        name: "Krogs Broken Heart",
        category: "Misplaced Fortune",
        desc: "Krog was a savage from the Dagger Isles, pressed into service on a hunting ship. He eventually owned a small fleet. He was old when he fell in love with a young woman who robbed him. Heartbroken, he took the rest of his treasure aboard his last hunting ship, Heartsong, and scuttled her in the harbor.",
        narrative: "Whispers like to brag they found a way under the waves to find the wealth. Gracmaas the Pirate claimed to have recovered it all to his hidden lair—before he was killed."
      },
      {
        name: "Limptwitch's Stash",
        category: "Misplaced Fortune",
        desc: "Limptwitch was a Whisper who interrogated ghosts to find the location of hidden treasure. He was famous for his Grotto, the place where he stored all his salvaged wealth. Many factions tried to get his treasure, but he never gave up the secret. Then he was jailed and hanged. The Grotto was never found.",
        narrative: "Did a cellmate in prison hear muttered hints as to its location? Maybe a Whisper has clues based on where he left his mark in the sewers. Has someone finally found a real lead?"
      },
      {
        name: "Mark of the Void",
        category: "Religious Object",
        desc: "It is an eerie black disk of leviathan bone, about the size of a dinner plate but five times as thick. The bone is carved with a strange circular pattern with rays cutting through it. The primitive artwork was polished, and silver inlaid in the pattern, by a decadent nobleman.",
        narrative: "Impressionable people admit the disk whispers to them, they hear the Back of the Mirror when it the disk is near. Many cults see this disk as a conduit to clearer communication with their supernatural patrons."
      },
      {
        name: "Naladicha's Cartography",
        category: "Historical Curiosity",
        desc: "The famous cartographer Naladicha died, and his ghost was woven into a spirit anchor connected to a pen on a wire. The drooping pen scribbled nonstop, dipping to indicate a page turn. Two books were filled with scribbles before the pen stilled. These lines and shapes may be maps of the Ghost Field.",
        narrative: "One consulting Whisper reported that when she attuned to the books using an expensive and difficult ritual, the maps became luminous and four dimensional, revealing lost secrets in Duskwall."
      },
      {
        name: "Norscye's Lament",
        category: "Famous Jewel",
        desc: "This ruby has been set in a series of weapons for the last three centuries. One estimate was that the gem had participated in upwards of a thousand deaths. Legend suggests that the ruby can hold a single ghost, surviving the destruction of the body, bound to the gem until it chooses another guest.",
        narrative: "While the gemstone is priceless because of its unnatural clarity, it is also possible that an important ghost might be inside, and might choose to speak to a Whisper or a blood relative."
      },
      {
        name: "Orb Of Sellivas",
        category: "Weird Artifact",
        desc: "This fist-sized golden orb tunes to one bearer at a time, though it may respond to others. If commanded, it can release a steady light that radiates in the material world and the Ghost Field, revealing what is hidden. The radiation can also draw or repel ghosts and demons.",
        narrative: 'The Sellivas order of witches wrote their research journals in an ink that can only be read by the light of the Orb. If someone had the Orb and the "blank" book, they could crack ancient secrets.'
      },
      {
        name: "Plant Evidence",
        category: "Secret Dirty Work",
        desc: "Someone needs to be found guilty of doing something. For that to work out, you need evidence, put in the wrong place at the wrong time. To manage that, you need proper scoundrels.",
        narrative: "Do you know what the target will be accused of doing? Are you to lead the authorities to the evidence? Must someone be seduced before a hidden witness? Are the scoundrels making evidence, or using what they're given? What if they could do better? Must the evidence fool a court, or a powerful individual?"
      },
      {
        name: "Plasmic Blade Flail",
        category: "Weird Artifact",
        desc: "This weapon can slay ghosts and demons. It appears to be a gladius stitched with runes. Once the bearer attunes to the weapon, it can disconnect into vertebrate-like wedges connected by a steely central cable. The blade-whip is flexible and simmering with energy. It can reform into a straight blade at will.",
        narrative: "Only five of these flails ever existed. One is carried by the Spirit Warden assigned to the Immortal Emperor's defense. The rest are the stuff of legends."
      },
      {
        name: "Remote Writer",
        category: "Weird Artifact",
        desc: "This little book has a peculiar occult symbol on the cover. If an object is placed between the covers for a full 24 hours, then the book will transcribe any conversation happening in earshot of the object until reset. When the book reaches the end, the writing starts over on the first page, clearing pages as it goes.",
        narrative: "The book provides remote reading, eavesdropping of a sort. A target's favorite pen or lucky coin can become the broadcaster, and determined spies can copy the magic book writing so they don't lose it."
      },
      {
        name: "Rylaria's Shield",
        category: "Family Heirloom",
        desc: "Rylaria Graefwold was a soldier who gained title and wealth. She wrote her life's story on the back of the shield she used to save a general. Later generations added to the family story. The shield represents the family's honor. It was lost at sea when their first leviathan hunting ship was wrecked. Or was it?",
        narrative: "Now the family is wealthy, and this artifact would be important to them. Does it have a secret in code?"
      },
      {
        name: "Skovlan Scrip",
        category: "Misplaced Fortune",
        desc: "A dense lockbox filled with paper money issued by the Akorosian government to pay soldiers quelling the Skovlander Insurrection. The scrip can be exchanged for coins or services in Duskwall. Scrip is basically untraceable.",
        narrative: "Some of the military supply that got lost during the war. Does the stashs location implicate a corrupt official or other thief?"
      },
      {
        name: "Sonurian Ghost Key",
        category: "Family Heirloom",
        desc: "The Sonuria family had mansions in the area that is now the Seven Shallows slum. They created a vault for the protected dead, and for their mundane treasures. The only way in is for a family member to present the Sonurian Ghost Key before the hidden location of the vault in the Ghost Field. The key has been lost for decades.",
        narrative: "That key could be hidden anywhere. If it were found, either a family member could be recruited to open the door, or the key could be sold to the family. What does the key look like? What is inside the vault?"
      },
      {
        name: "Soultrap Carnelian",
        category: "Famous Jewel",
        desc: "This semi-precious stone was carved by the Whisper Ichralia. She suffocated people with hot wax and bound their fresh ghosts in wax seals on scrolls or letters with the Soultrap. When the seal was broken, the insane ghost attacked the opener and anyone nearby.",
        narrative: "The Spirit Wardens destroyed this object decades ago. Didn't they? Maybe someone else made another one, or maybe the original survived."
      },
      {
        name: "Steal Blackmail",
        category: "Secret Dirty Work",
        desc: "Secrets must be protected. If they come out, people can get hurt, ruined, killed, and so on. You are hired to adjust the circle of people who can prove something. Will it be bigger? Or smaller?",
        narrative: "Do you know what information you're after, or is that secret from you? If you have a chance, will you peek at it? Are you targeting a blackmailer to remove their hold, or getting evidence to give a blackmailer? Is the evidence to be destroyed? Do you plan to do as you are told?"
      },
      {
        name: "Terrorize",
        category: "Secret Dirty Work",
        desc: "People can be stubborn, to the point where only fear can unseat their decision. Maybe they feel independent and need to reminded that they need protection. Maybe they feel safe and need to be reminded they are not untouchable.",
        narrative: "Are you supposed to be someone in particular, like a random street thug or rival's employee or bluecoat? How far can the terror go? Do you need to trash a home, or maybe converse with a loved one?"
      },
      {
        name: "The Emerald Well",
        category: "Famous Jewel",
        desc: "This depthless gem is a chilly pinhole between the material world and the Ghost Field. It provides energy to Whispers and attracts ghosts. The Emerald Well was protected by the Church of the Ecstasy of the Flesh, but a thief stole it decades ago. It is a hotspot for supernatural activity. Disaster flows in its wake.",
        narrative: "This is one of the few objects pursued by demons, Whispers, inspectors, clergy, and collectors. Scholars suggest demons may be able to turn it inside out, creating a fresh gate to incarnate more demons."
      },
      {
        name: "The Hellwhisper Ring",
        category: "Weird Scholarship",
        desc: `The ring is made of tiny bits of bone wired together. It must be worn for at least a day per year of the bearer's life before it begins to work. When placed on a source of information, the ring sifts it until the ring speaks the information's "language." The bearer can see through riddles, read arcane texts, and break code with ease.`,
        narrative: "Legend says 32 demons voluntarily gave some of their bone to be part of this ring, and it was released among humans to cause chaos through greater understanding."
      },
      {
        name: "The Helsman Inheritance",
        category: "Misplaced Fortune",
        desc: "The final will and testament of the clan's patriarch included a 24 hour locked-house condition. Survivors would split the inheritance. Darayl Helsman left the house at the end of the time with a small bag. Explorers found nothing but corpses in the house, the inheritance was gone. Darayl was found dead the next day, the bag gone. The city locked the house and guards against trespassers.",
        narrative: "Surely Darayl hid the inheritance in the Ghost Field. Find the ghost key and lock in the house, and get it all! Or, did someone else already get it?"
      },
      {
        name: "The Key Lens",
        category: "Weird Scholarship",
        desc: 'The round frame has forty special lenses hinged on its rim. The lenses can layer over each other, flip out past the frame, rotate to take advantage of the angles inside the ground crystal, and take translucent colored filters. Their inventor, VLAS HALDAK, said he had found "the key." He died of shock, the lens on his work table.',
        narrative: "Legends vary. It can see into the Ghost Field, it can see into people, it allows reading demonic texts, it can see the way into ghost neighborhoods, etc. Needs a Whisper to use properly."
      },
      {
        name: "The Leviathan's Eye",
        category: "Famous Jewel",
        desc: "This sapphire turns impossibly black if dipped in leviathan blood. If the still-bloody stone is pressed against a seer's forehead, the sensitive can see what the ocean sees, looking above the waves or probing the deeps. The gem used to be passed around between leviathan hunter captains, but has since been lost.",
        narrative: "One expert said using the Eye was as close as a human could get to a demon seeing through its elemental affinity, and that it began a slow change in the individual who was exposed to its power."
      },
      {
        name: "The Tabissera Diary",
        category: "Weird Scholarship",
        desc: "Warden Khalana Uress was the Head Confessor of the Spirit Wardens. She recorded secrets that were only for the use of the order using a book code, coordinates that pointed to words in a specific book. Without that book, the code cannot be cracked. Daring thieves took the book, then lost it.",
        narrative: "Fakes come on the market all the time. Only the Spirit Warden leadership know what the book looked like, and they aren't telling. What is the Diary about?"
      },
      {
        name: "The Thousand Facet Diamond",
        category: "Famous Jewel",
        desc: "This gem is the elegant centerpiece on the back of a peculiar clockwork gauntlet. A seer can use the gauntlet to travel into the Ghost Field while retaining physical presence, or possibly even other dimensions. Each use burns out some of the diamond facets. The device is reported to have a mind of its own.",
        narrative: "Ever since its theft from the Adelairde family, the gauntlet has surfaced only in rumors of especially daring heists or mind-shattering experiments."
      },
      {
        name: "Whitecrown Signet Ring",
        category: "Family Heirloom",
        desc: "The Whitecrown family schismed in the wake of the theft of the matriarch's signet ring over two centuries ago. They fell from being players in the intrigues around the throne to bickering over dwindling family holdings. Their wealth and influence is low, but not beyond recall.",
        narrative: "If the ring resurfaced, elements of the feud might put aside their differences and reunite. Besides, legends suggest a ghost matriarch is bound to the ring, and she knows their secrets."
      }
    ]
  }
}, O0 = {
  1: {
    height: 836,
    width: 230,
    paths: [
      "M217.017,123.52c-1.6-0.8-2.84-1.44-4.1-2.04c-1.12-0.53-2.26-1.04-3.42-1.51 c-1.05-0.43-2.18-0.68-3.18-1.19c-0.89-0.45-1.23-1.23-1.2-2.36c0.09-4.48-0.07-8.97,0.05-13.45c0.08-3.31-0.83-6.47-1.14-9.72 c-0.01-0.14-0.09-0.28-0.14-0.42c-0.57-2.01-1.2-4.01-1.69-6.04c-0.45-1.85-0.75-3.74-1.11-5.61 c-0.012-0.043-0.023-0.085-0.035-0.127c-0.6-1.69-1.348-3.353-1.825-5.083c-0.46-1.66-0.68-3.38-1.03-5.07 c-0.04-0.24-0.16-0.47-0.25-0.7c-0.49-1.32-0.98-2.65-1.47-3.97c-0.55-1.44-0.93-2.97-1.69-4.28c-0.79-1.35-0.65-3.03,0.61-4.19 c0.43-0.39,0.85-0.85,1.08-1.36c0.57-1.3,1.35-2.62,1.44-3.97c0.08-1.11-0.46-3.08-1.14-3.29c-1.58-0.47-3.49-0.42-5.1,0.03 c-1.41,0.4-2.59,1.63-4.07,2.62c-1.15-1.18-2.43-2.41-3.6-3.75c-0.41-0.47-0.43-1.29-0.82-1.78c-0.67-0.84-1.56-1.5-2.23-2.33 c-0.18-0.22-0.08-0.9,0.13-1.16c0.85-1.02,1.78-1.97,2.71-2.92c2.18-2.22,4.37-4.45,6.57-6.65c0.85-0.86,1.78-1.64,2.63-2.5 c1.16-1.17,2.38-2.29,3.37-3.59c0.66-0.88,0.89-2.07,1.42-3.06c0.86-1.63,0.01-3.02-0.68-4.31c-0.23-0.43-1.4-0.4-2.15-0.48 c-0.69-0.08-1.4,0.02-2.09-0.02c-1.71-0.11-3.14,0.17-4.52,1.47c-1.22,1.14-2.96,1.74-4.44,2.62c-0.98,0.59-1.89,1.31-2.88,1.88 c-2.02,1.17-4.2,2.11-6.07,3.47c-1.12,0.81-2.16,1.18-3.49,1.4c-1.28,0.22-2.44,1.1-3.7,1.59c-0.58,0.23-1.72,0.49-1.82,0.3 c-0.91-1.63-2.75-1.79-4.03-2.77c-0.33-0.25-0.58-0.62-0.93-0.82c-1.11-0.64-2.26-1.22-3.38-1.85c-1.48-0.83-2.94-1.7-4.42-2.53 c-0.93-0.53-1.83-1.24-2.84-1.5c-1.37-0.35-2.24-1.96-3.89-1.5c-0.08,0.03-0.19-0.02-0.29-0.04c-1.97-0.58-3.94-1.16-5.91-1.73 c-0.28-0.08-0.76-0.02-0.84-0.18c-0.89-1.7-2.8-1.2-4.1-1.6c-2.83-0.87-5.94-0.87-8.94-1.22c-0.39-0.04-1.05,0.06-1.14-0.13 c-0.79-1.56-2.21-1.01-3.4-1.05c-2.09-0.08-2.68-0.62-2.72-2.65c-0.01-0.84-0.1-1.69-0.24-2.51c-0.16-0.88-0.54-1.72-0.62-2.59 c-0.13-1.24-0.03-2.49-0.11-3.73c-0.06-0.88-0.61-1.45-1.5-1.13c-0.79,0.28-1.59,0.72-2.21,1.28c-1.48,1.36-2.85,2.84-4.29,4.25 c-1.1,1.08-2.08,2.06-3.81,2.55c-1.54,0.44-2.99,1.69-4.63,2.42c-1.79,0.8-3.28,2.25-5.44,2.13c-0.44-0.02-1.16-0.02-1.28,0.22 c-0.7,1.36-1.94,0.82-2.98,0.97c-0.49,0.07-0.99,0.11-1.47,0.24c-1.92,0.49-3.84,0.98-5.75,1.52c-1.74,0.49-3.51,0.95-5.19,1.61 c-1.92,0.74-3.67,1.99-5.63,2.46c-1.64,0.38-3.01,1.13-4.51,1.72c-0.99,0.39-2.52,0.38-3.43-0.13c-1.93-1.09-4.28-1.09-6.03-2.54 c-0.22-0.19-0.67-0.12-1.02-0.13c-0.9-0.02-1.79-0.02-2.69-0.02c-1.37,0.01-2.19,0.72-2.36,2.15c-0.09,0.78-0.06,1.59-0.09,2.38 c-0.01,0.35,0.11,0.87-0.06,1.02c-1.68,1.35-0.89,3.24-1.18,4.9c-0.16,0.88-0.56,1.8-1.1,2.51c-0.75,0.99-1.76,1.79-2.61,2.72 c-1.02,1.1-1.99,2.26-2.99,3.39c-1.49,1.67-2.96,3.37-4.5,5c-1.36,1.45-2.81,2.83-4.2,4.25c-0.16,0.17-0.19,0.46-0.31,0.67 c-0.74,1.29-1.39,2.64-2.25,3.84c-0.89,1.25-2.63,1.86-2.72,3.75c-0.02,0.38-0.57,0.73-0.86,1.11c-0.37,0.49-0.79,0.96-1.07,1.5 c-0.73,1.39-1.26,2.89-2.1,4.21c-1.08,1.71-2.25,3.34-2.65,5.38c-0.07,0.32-0.39,0.6-0.57,0.91c-0.21,0.34-0.45,0.67-0.59,1.05 c-0.43,1.21-0.72,2.48-1.24,3.65c-0.79,1.76-1.75,3.45-2.6,5.19c-1.27,2.6-2.74,5.13-3.69,7.85c-0.5,1.45-0.18,3.23-0.08,4.85 c0.05,0.7,0.68,1.37,0.69,2.06c0.06,6.07,0.06,12.15,0.01,18.23c0,0.71-0.37,1.44-0.63,2.13c-0.35,0.95-1.04,1.85-1.09,2.8 c-0.07,1.31-1.04,1.92-1.62,2.82c-0.91,1.43-2.71,1.9-3.59,3.51c-1.01,1.85-0.94,3.91,0.46,5.41c1.17,1.24,2.59,0.75,3.93,0.97 c1.41,0.22,3.01,0.26,4.12,0.99c1.11,0.74,1.87,2.16,2.5,3.43c0.77,1.56,1.35,3.24,1.8,4.92c0.67,2.5,0.94,5.12,2.32,7.4 c0.56,0.92,1.03,1.9,1.52,2.87c0.51,1.03,0.96,2.09,1.48,3.11c0.56,1.09,1.13,2.18,1.77,3.22c0.29,0.48,0.84,0.8,1.16,1.26 c0.61,0.87,1.11,1.82,1.71,2.69c0.32,0.47,0.83,0.81,1.16,1.27c0.93,1.3,1.79,2.65,2.73,3.95c0.31,0.43,0.83,0.69,1.15,1.11 c0.52,0.69,0.89,1.51,1.44,2.16c0.41,0.48,1.1,0.72,1.54,1.18c1.57,1.66,3,3.46,4.65,5.03c1.3,1.26,2.91,2.18,4.25,3.4 c1.99,1.84,3.82,3.85,5.81,5.7c0.51,0.47,1.42,0.47,1.99,0.9c0.95,0.71,1.78,1.59,2.88,2.59c-0.72,0.66-1.63,1.5-2.55,2.33 c-0.78,0.7-1.61,1.34-2.34,2.07c-1.54,1.55-3.05,3.13-4.54,4.73c-1.24,1.32-2.6,2.56-3.6,4.05c-0.6,0.91-1.1,1.85-1.89,2.63 c-1.23,1.21-1.21,4.03,0.24,4.66c1.03,0.45,2.61,0.53,3.57,0.03c1.41-0.72,2.76-0.5,4.14-0.57c1.93-0.09,3.89,0.02,5.8-0.21 c1.19-0.14,2.33-0.75,3.46-1.2c0.49-0.19,0.89-0.6,1.38-0.76c0.46-0.16,1.13,0.06,1.45-0.21c2.19-1.82,5.18-1.79,7.53-3.48 c1.41-1.01,3.25-2.21,5.36-2.06c0.28,0.02,0.58-0.29,0.88-0.44c0.42-0.22,0.85-0.61,1.29-0.62c3.43-0.04,6.86,0,10.3,0.03 c0.38,0,0.99-0.01,1.11,0.21c0.64,1.13,1.69,0.85,2.63,0.91c1.1,0.06,2.24-0.13,3.27,0.14c2.96,0.79,5.9,1.59,9,1.58 c6.02-0.03,12.05,0.27,18.01-0.93c0.82-0.17,1.69-0.08,2.52-0.24c1.04-0.2,2.05-0.52,3.14-0.81c0.13,0.6,0.21,0.79,0.21,0.98 c0.01,8.226,0.03,16.462,0.01,24.699c-0.001,0.368-0.217,0.882-0.515,1.099c-0.676,0.493-1.572,0.71-2.176,1.273 c-1.37,1.26-2.6,2.68-3.92,4c-0.73,0.73-1.61,1.32-2.31,2.08c-0.98,1.06-0.96,2.42-0.9,3.78c0.07,1.95,0.64,2.62,2.59,2.67 c1.712,0.061,3.434,0.019,5.146,0.03c1.112,0.007,2.014,0.908,2.024,2.02c0.06,6.72,0.08,13.44,0.15,20.16 c0.019,1.205-0.537,1.936-1.437,2.533c-0.23,0.153-0.451,0.318-0.644,0.516c-1.605,1.643-3.165,3.308-4.789,4.931 c-0.63,0.64-1.57,1.05-2.01,1.79c-1.29,2.14-3.22,3.55-5.3,4.69c-2.51,1.38-2.76,1.58-2.61,4.33c0.09,1.65,1.84,3.48,3.41,3.17 c1.82-0.35,3.74-0.85,5.26-1.85c0.77-0.51,1.38-0.68,2.16-0.71c0.95-0.04,1.9-0.01,2.84-0.01c2.59,0.01,3.03,0.46,3.03,3.1 c-0.01,31.18-0.02,62.36-0.04,93.55c0,2.88-0.13,5.78,0.03,8.66c0.16,2.8,0.67,5.58,0.91,8.39c0.15,1.83,0.08,3.68,0.15,5.52 c0.02,0.42,0.14,0.85,0.29,1.25c0.23,0.58,0.66,1.12,0.75,1.72c0.13,0.93-0.34,2.21,0.13,2.78c1.82,2.18-0.35,4.04-0.21,6.04 c0.01,0.2-0.21,0.41-0.31,0.62c-0.53,1.08-1.43,2.14-1.49,3.24c-0.21,4.27-0.19,8.56-0.19,12.84 c-0.01,51.9,0.01,103.81-0.05,155.71c0,4.36-0.54,8.71-0.84,13.06c-0.03,0.34-0.19,0.66-0.31,0.98c-0.25,0.69-0.73,1.36-0.74,2.05 c-0.12,5.68-0.07,11.36-0.23,17.03c-0.11,3.65-0.78,7.31-0.68,10.95c0.12,4.59-0.27,9.16,0.58,13.82 c0.85,4.63,0.19,9.53,0.21,14.31c0.01,1-0.27,2.32,0.24,2.92c1.2,1.39,0.69,2.89,0.79,4.35c0.03,0.33-0.22,0.7-0.37,1.03 c-0.25,0.55-0.55,1.06-0.76,1.62c-0.17,0.44-0.2,0.93-0.36,1.38c-0.47,1.36-0.97,2.72-1.45,4.08c-0.11,0.31-0.11,0.7-0.3,0.94 c-1.58,2-2.33,4.36-2.52,6.8c-0.23,3.07-0.06,6.17-0.08,9.26c-0.02,3.62,0.05,7.24,0.93,10.78c0.07,0.3,0.39,0.56,0.42,0.86 c0.13,1.29,0.2,2.59,0.29,3.88c-0.91,0.05-1.84,0.23-2.72,0.09c-0.66-0.1-1.24-0.71-1.91-0.9c-1.83-0.53-3.81,1.69-3.74,3.17 c0.1,2.16,0.3,4.33,1.59,6.15c1.14,1.6,2.44,3.09,3.73,4.57c1.18,1.36,2.64,2.45,2.25,4.66c-0.47,2.6-0.66,5.25-1.01,8.26 c-4.52,0.25-8.9,0.65-13.3,0.72c-8.65,0.13-17.32,0.08-25.98,0.13c-0.58,0-1.24-0.02-1.74,0.22c-1.03,0.49-1.92,1.28-2.97,1.7 c-1.85,0.75-3.77,1.31-5.65,1.96c-0.22,0.07-0.42,0.22-0.63,0.32c-1.16,0.57-2.28,1.38-3.51,1.64c-1.03,0.21-1.79,0.61-2.49,1.28 c-0.2,0.19-0.4,0.5-0.62,0.51c-1.14,0.08-2.03,0.39-2.85,1.34c-0.63,0.73-1.75,1.04-2.67,1.49c-1.72,0.84-3.48,1.61-5.18,2.49 c-1.48,0.77-3.04,1.49-4.33,2.53c-1.49,1.21-2.68,2.8-4.09,4.14c-0.84,0.79-1.75,1.75-2.79,2.02c-1.46,0.39-2.97,0.34-4.52,0.83 c-2.05,0.64-4.39,0.08-6.57,0.95c-1.38,0.54-3.25-0.48-4.4,1.21c-0.07,0.1-0.38,0.03-0.58,0.05c-2.5,0.25-4.95-0.04-7.53,0.73 c-3.19,0.97-6.74,0.74-10.14,1.08c-0.59,0.06-1.36,0.23-1.7,0.63c-0.83,1.02-0.42,3.75,0.69,4.4c0.91,0.54,2,0.82,3.05,1.07 c0.66,0.15,1.4-0.06,2.08,0.05c1.68,0.29,3.67-0.91,5.01,1.05c0.07,0.1,0.38,0.06,0.58,0.07c4.87,0.2,9.72,0.09,14.61,0.8 c4.38,0.64,8.94-0.01,13.42,0.18c3.03,0.13,5.86-0.88,8.82-1.09c0.14-0.01,0.35-0.06,0.4-0.15c0.61-1.3,1.84-0.85,2.85-1.06 c0.57-0.11,1.2-0.3,1.65-0.65c0.83-0.64,1.45-1.63,2.35-2.1c2.5-1.32,4.56-3.31,7.19-4.45c1-0.43,1.58-0.43,2.51,0.04 c0.62,0.31,1.68,0.25,2.33-0.08c1.06-0.53,1.88-0.64,2.74,0.22c0.76,0.76,1.53,1.51,2.34,2.23c1.14,1.02,2.41,1.91,3.46,3.02 c1.04,1.08,1.85,2.38,2.78,3.56c1.11,1.4,4.49,1.72,5.94,0.58c1.29-1.01,1.57-2.52,1.85-3.97c0.24-1.24,0.03-2.49,0.68-3.78 c0.9-1.75,1.39-2.39,3.41-2.36c2.29,0.02,4.58,0.1,6.87,0.11c1.04,0.01,1.62,0.52,1.84,1.5c0.31,1.31,0.45,2.68,0.96,3.9 c0.36,0.85,1.11,1.71,1.91,2.16c1.23,0.7,4.69-0.66,5.09-2.01c0.53-1.73,1.15-3.6,1-5.35c-0.24-2.82,1.44-4.54,2.89-6.43 c0.3-0.39,1.44-0.68,1.72-0.45c1.45,1.23,3.45,2.17,3.18,4.62c-0.06,0.64,0.09,1.3,0.02,1.94c-0.31,3.01-0.68,6.01-0.98,9.02 c-0.08,0.86-0.01,1.74-0.01,2.77c1.08-0.07,1.88-0.05,2.64-0.18c1.12-0.2,2.2-0.62,3.32-0.73c1.38-0.13,2.78-0.05,4.18-0.04 c1.86,0.01,2.13,0.24,1.82,2.07c-0.17,1-0.42,2.39-1.12,2.8c-1.1,0.65-0.86,1.44-0.87,2.24c-0.05,2.1-0.03,4.19-0.01,6.28 c0.01,0.44,0,1.19,0.2,1.26c1.41,0.53,0.81,1.71,0.98,2.64c0.17,0.9,0.34,1.81,0.64,2.66c0.39,1.08-0.23,3.51-1.19,3.75 c-1.67,0.43-3.39,0.66-5.09,0.99c-1.84,0.36-3.67,0.72-5.5,1.11c-0.22,0.05-0.4,0.28-0.61,0.39c-0.43,0.23-0.85,0.56-1.3,0.63 c-0.594,0.081-1.208,0.05-1.82,0.036c-1.386-0.033-2.643-0.905-3.075-2.222c-0.613-1.87-0.822-3.704-0.936-5.614 c-0.03-0.33-0.6-0.59-0.79-0.96c-0.43-0.85-1.13-1.77-1.07-2.62c0.07-0.98,1.05-1.44,2.19-1.38c0.81,0.04,1.64-0.21,2.44-0.43 c0.59-0.16,1.12-0.55,1.72-0.69c0.52-0.12,1.09-0.06,1.63-0.02c1.25,0.08,1.8-0.43,1.76-1.72c-0.05-1.89,0.01-3.78-0.01-5.68 c-0.01-1.66-0.83-2.55-2.56-2.57c-3.84-0.04-7.67-0.02-11.5,0.02c-1.16,0.01-1.74,0.7-1.85,1.83c-0.05,0.54-0.08,1.09-0.24,1.6 c-0.48,1.6-1.38,3.17-1.45,4.78c-0.08,1.83-0.74,3.01-2.08,4.1c-0.83,0.67-1.56,0.79-2.23,0.04c-1.08-1.22-2.09-2.51-3.04-3.83 c-1.06-1.48-1.88-3.17-3.08-4.51c-0.91-1.03-1.92-2.41-3.7-1.84c-0.51,0.17-0.93,0.69-1.44,0.79c-2.58,0.46-4.33,2.33-6.35,3.7 c-2.13,1.45-4.2,2.53-6.93,2.33c-3.17-0.24-6.37-0.07-9.55-0.09c-0.4,0-0.93,0.1-1.16-0.1c-1.75-1.51-4.32-2.07-5.29-4.5 c-0.06-0.13-0.33-0.24-0.5-0.25c-2.1-0.1-3.95-1.56-6.16-1.07c-0.31,0.07-0.68-0.08-1.02-0.17c-0.9-0.25-1.8-0.73-2.71-0.75 c-4.62-0.08-9.25-0.03-13.88-0.05c-0.46,0-0.94-0.13-1.38-0.29c-0.63-0.24-1.23-0.8-1.85-0.81c-6.97-0.06-13.94-0.01-20.91-0.06 c-1.47-0.01-2.4,0.9-3.11,1.81c-1.58,2.02,0.43,5.8,3.19,6.29c1.71,0.31,3.41,0.64,5.12,0.96c0.19,0.04,0.49,0.05,0.55,0.17 c0.65,1.18,1.78,0.83,2.77,0.94c2.9,0.31,5.78,0.66,8.67,1c0.103,0.019,0.206,0.038,0.308,0.057c2.154,0.545,4.296,1.193,6.481,1.6 c1.241,0.232,2.507,0.15,3.769,0.183c0.284,0.007,0.568,0.119,0.821,0.24c0.62,0.28,1.22,0.6,1.83,0.9 c1.33,0.65,2.68,1.25,3.98,1.96c0.4,0.22,0.6,0.76,0.96,1.06c1.45,1.23,2.93,2.41,4.37,3.64c0.97,0.82,1.92,1.67,2.84,2.54 c1.98,1.86,3.98,3.71,5.89,5.64c1.72,1.72,3.46,3.45,4.97,5.36c1.54,1.93,3.34,2.52,5.79,2.51c18.47-0.08,36.94-0.01,55.4,0.02 c2.17,0,4.19,0.14,5.7-2.14c1.09-1.64,2.99-2.73,4.39-4.2c0.74-0.77,1.1-1.87,1.77-2.73c0.68-0.88,1.47-1.69,2.3-2.45 c1.56-1.45,2.81-3.12,3.91-4.94c0.46-0.76,1.51-1.22,1.86-2.01c0.76-1.74,1.56-3.38,3.08-4.61c0.42-0.34,0.88-0.97,0.86-1.44 c-0.08-1.47,0.99-2.28,1.57-3.39c0.75-1.42,1.61-2.73,1.52-4.59c-0.21-4.42-0.08-8.86-0.05-13.29c0-0.61,0.19-1.23,0.35-1.83 c0.14-0.49,0.55-0.98,0.49-1.43c-0.39-3,0.95-5.77,1.1-8.7c0.01-0.2,0.23-0.39,0.34-0.59c0.26-0.47,0.56-0.92,0.78-1.41 c0.59-1.37,1.1-2.77,1.75-4.11c0.19-0.39,0.85-0.54,1.1-0.93c1.25-1.87,2.56-3.71,3.58-5.7c0.73-1.41,1.8-2.83,1.37-4.6 c-0.1-0.41-0.44-1.03-0.73-1.07c-2.3-0.28-4.43-1.46-6.87-1.09c-1.41,0.21-2.88,0.03-4.32,0.03c-2.22,0-2.56-0.51-2.76-2.74 c-0.2-2.19,1.03-4.66-1.1-6.53c-0.08-0.07-0.02-0.29-0.04-0.44c-0.26-2.65,0.17-5.27-0.75-7.99c-0.82-2.44,0.02-5.23-0.93-7.92 c-0.87-2.51,0.15-5.31-1.06-8.11c-1.14-2.64-0.76-5.92-1.16-8.91c-0.31-2.31,0.38-4.77-0.96-6.94c-0.31-0.5-0.91-0.93-1-1.46 c-0.41-2.24-0.68-4.5-1.01-6.76c-0.32-2.2-0.65-4.4-0.99-6.6c-0.03-0.19-0.09-0.47-0.23-0.53c-1.21-0.55-0.86-1.61-0.88-2.55 c-0.25-12.95,0.26-25.89-0.76-38.84c-0.645-8.159-0.207-16.407-0.21-24.606c0-0.326,0.03-0.655,0.132-0.964 c0.498-1.505,1.628-2.909,1.808-4.439c0.32-2.74,0.57-5.52,0.82-8.26c0.521-5.744,0.168-11.569,0.15-17.363 c-0.001-0.411-0.054-0.823-0.201-1.207c-0.519-1.358-1.356-2.643-1.619-4.039c-0.5-2.67-0.7-5.39-1.02-8.09 c-0.04-0.39-0.08-0.79-0.07-1.19c0.07-3.15-0.3-6.32,0.69-9.42c0.41-1.29-0.17-2.87,1.22-3.88c0.1-0.07,0.06-0.37,0.06-0.57 c0.04-8.32,0.08-16.64,0.08-24.96c0-0.43-0.28-0.88-0.45-1.31c-0.19-0.46-0.56-0.9-0.58-1.36c-0.48-11.05,0.53-22.1-0.75-33.17 c-0.77-6.68-0.15-13.52-0.19-20.29c-0.02-4.13-0.15-8.26-0.15-12.39c-0.01-44.063-0.01-88.115,0-132.178 c0-0.883,0.011-1.77,0.117-2.647c0.323-2.687-0.394-5.417,0.813-8.095c0.54-1.2,0.09-2.85,0.14-4.29c0.01-0.42,0.12-0.86,0.28-1.25 c0.26-0.62,0.63-1.2,0.88-1.82c0.14-0.36,0.1-0.78,0.19-1.16c0.48-2.02,1-4.03,1.44-6.05c0.25-1.17-0.47-2.63,1.09-3.39 c0.11-0.05,0.1-0.36,0.11-0.56c0.28-4.51,0.31-9,0.88-13.53c0.7-5.49,0.44-11.15,0.13-16.71c-0.31-5.55,1.18-10.95,0.94-16.46 c-0.02-0.62,0-1.25,0-1.92c0.98-0.1,1.74-0.1,2.45-0.27c0.7-0.17,1.35-0.53,2.03-0.75c1.92-0.62,2.45-1.33,2.42-3.39 c0-0.43-0.07-0.86-0.12-1.48h-4.97c-1.98-0.01-2.64-0.7-2.65-2.73c-0.01-0.75,0.05-1.5-0.01-2.25c-0.53-6.86,1.3-13.97-2.06-20.55 c0.49-2.24-1.35-4.79,0.96-6.8c1.23-1.08,2.27-2.42,3.62-3.33c1.23-0.83,2.52-1.47,3.3-2.84c0.8-1.42,2.89-2.31,4.31-1.95 c1.05,0.28,2.12,0.53,3.13,0.92c2.26,0.86,4.46,1.89,6.75,2.65c0.94,0.32,2.23,0.47,3.05,0.06c1.77-0.89,2.89-2.77,3.34-4.51 c0.76-2.92,0-5.91-1.12-8.69c-0.5-1.24-0.4-1.92,0.76-2.43c1.71-0.75,3.37-1.59,5.07-2.37c2.07-0.95,3.93-2.43,6.34-2.56 c0.29-0.02,0.55-0.33,0.84-0.5c0.37-0.23,0.78-0.65,1.14-0.63c1.59,0.13,3.06-0.23,4.74,0.92c1.61,1.11,4.13,0.99,6.27,1.19 c1.93,0.17,2.82-0.82,3-2.78c0.04-0.43,0.26-0.88,0.47-1.28c0.39-0.75,1.16-1.46,1.2-2.22c0.07-1.42,0.75-3-1.6-3.85 c-1.72-0.61-2.93-2.52-4.52-3.62c-1.38-0.96-2.98-1.6-4.73-2.51c0.24-0.6,0.46-1.24,0.75-1.85c0.82-1.72,1.67-3.42,2.49-5.13 c0.34-0.73,0.5-1.6,1.01-2.17c1.42-1.63,1.98-3.64,2.79-5.55c0.36-0.87,0.45-1.99,1.06-2.59c1.09-1.06,1.52-2.34,1.98-3.69 c0.29-0.85,0.66-1.68,1.09-2.46c0.51-0.93,1.33-1.73,1.67-2.7c0.81-2.39,2.14-3.18,4.45-2.38c0.31,0.1,0.7,0.11,1.03,0.04 c1.17-0.22,2.36-0.41,3.5-0.76c1.24-0.38,2.44-0.9,3.62-1.43c0.21-0.08,0.37-0.5,0.37-0.77 C217.026,126.28,217.017,124.66,217.017,123.52z M143.507,186.1c-0.82,0.65-1.72,0.95-2.7,1.06c-9.15,3.4-19.04,5.26-29.37,5.26 c-46.57,0-84.32-37.75-84.32-84.32c0-46.56,37.75-84.31,84.32-84.31c46.56,0,84.31,37.75,84.31,84.31 C195.747,143.31,174.167,173.48,143.507,186.1z",
      "M214.327,133.65c-1.07-0.77-2.58-1.24-3.21-2.27c-2.25-3.6-6.31-7.65-5.88-11.05 c1.52-12.04-0.33-23.52-2.8-35.1c-1.17-5.49-2.18-10.99,4.72-14.06c1.08-0.48,1.88-3.13,1.63-4.57c-0.19-1.07-2.16-2.19-3.55-2.64 c-6.7-2.14-12.98-4.88-17.4-10.69c-8.86-11.65-19.24-21.69-32.64-27.85c-6.64-3.05-11.86-6.24-11.09-14.54 c0.07-0.78-0.31-1.64-0.64-2.4c-1.25-2.84-2.56-5.66-3.84-8.48c-2.09,2.6-4.15,5.23-6.27,7.81c-1.41,1.73-2.68,4.5-4.41,4.85 c-5.32,1.1-10.85,1.76-16.28,1.67c-10.63-0.18-20.99,1.14-30.97,4.67c-7.85,2.78-15.14,3.77-22.72-1.31 c-3.42-2.29-8.09-2.69-13.48-4.35c1.1,3.41,1.68,5.25,2.3,7.08c2.66,7.87,2.9,14.94-4.11,21.28c-9.76,8.83-16.78,19.74-21.74,31.96 c-3.43,8.43-7.09,16.77-10.4,25.25c-0.69,1.77-0.76,4.07-0.31,5.93c1.61,6.58,3.4,13.13,5.43,19.59c3.09,9.77,5.6,19.86,9.93,29.08 c3.68,7.83,9.58,14.63,14.68,22.14c-0.79,0.96-2.1,2.1-2.8,3.53c-1.36,2.82-2.37,5.81-3.53,8.72c3.12,0.11,6.55,1.11,9.29,0.15 c8.09-2.86,14.4-0.35,20.54,4.73c2.39,1.98,2.05,3.36,0.46,5.32c-5.83,7.15-10.71,15.15-18.99,20.06 c-0.98,0.57-0.82,3.05-1.18,4.65c1.4,0.24,3.08,1.12,4.16,0.63c10.45-4.67,20.76-9.67,31.2-14.38c6.31-2.84,12.43-5.88,19.84-5.85 c10.42,0.05,20.84-1.07,31.26-1.7c1.76-0.11,3.51-0.28,5.42-0.43c0.16,1.54,0.36,2.51,0.36,3.49 c-0.02,59.51,0.09,119.02-0.28,178.52c-0.04,6.76-2.01,13.66-6.63,19.46c-5.78,7.26-11.13,14.88-16.46,22.49 c-0.72,1.03-0.2,2.93-0.26,4.43c1.3-0.02,2.66,0.24,3.87-0.09c5.76-1.56,11.47-3.28,18.14-5.22c0.62,6.25,1.49,10.98,1.5,15.73 c0.13,47,0.21,94.01,0.09,141.01c-0.02,9.45-0.81,18.9-1.43,28.34c-0.51,7.62-1.87,15.22-1.81,22.82 c0.09,11.27,1.35,22.52,1.59,33.8c0.11,4.87-1.07,9.77-1.69,14.65c-0.95,7.5-2.36,14.98-2.73,22.51c-0.3,6.1,1.55,12.38,0.78,18.37 c-0.97,7.49-5.01,14.53-11.46,18.32c-5.29,3.13-12.04,4.52-18.29,5.09c-7.23,0.66-14.61-0.47-21.92-0.75 c-7.56-0.29-13.36-5.01-15.18-12.31c-0.24-0.97-0.97-2.04-1.79-2.6c-3.54-2.44-7.19-4.7-11.02-7.17 c-6.83,8.88-7.82,11.33-7.65,21.13c0.27,15.78,1.28,31.58,0.87,47.34c-0.19,7.12-0.36,13.84,2.91,20.27 c0.57,1.13,1.4,2.86,2.29,2.97c6.4,0.82,12.69,3.55,19.18-1.16c3.35-2.42,8.23-3.21,12.54-3.72c7.41-0.88,14.92-0.84,22.37-1.43 c4.08-0.32,7.49-1.9,7.64-6.78c0.16-4.95,2.49-7.46,7.41-7.25c1.26,3.22,2.35,6.35,3.73,9.34c0.48,1.05,1.56,2.34,2.55,2.54 c3.24,0.62,6.57,0.74,9.86,1.16c3.38,0.42,5.09-0.92,6.01-4.3c1.78-6.56,3.92-13.02,6.08-19.47c1.92-5.71,2.31-11.28-0.26-16.93 c-0.69-1.51-0.6-3.37-1.02-5.99c2.46,0.64,3.97,1.18,5.52,1.41c2.3,0.33,4.62,0.44,6.93,0.65c-0.07-2.7,0.5-5.64-0.37-8.06 c-1.39-3.88-4.05-7.3-5.6-11.14c-2.34-5.79-5.86-11.75-5.96-17.69c-0.58-35.66-0.34-71.34-0.33-107.01c0-1.81,0.12-3.68,0.57-5.42 c3.38-13.1,3.56-26.5,1.68-39.63c-1.53-10.75-1.54-20.97,1.15-31.44c1.09-4.23,1.29-8.84,1.02-13.23 c-1.21-19.88-3.7-39.73-3.94-59.61c-0.62-50.99-0.29-102-0.34-153.01c0-1.66-0.07-3.35,0.18-4.98c1.91-12.43,4.96-24.78,5.62-37.26 c1.28-24.01,3.36-48.15-1.87-72.06c-0.27-1.25,0.73-3.34,1.8-4.23c9.73-8.05,9.78-8,20.31-1.11c0.7,0.46,1.39,1.05,2.17,1.23 c2.36,0.55,6.51,1.85,6.85,1.21c1.35-2.54,2.6-5.99,1.92-8.6c-2.38-9.22-2.43-17.78,3.82-25.59c2.88-3.6,5.07-8.11,8.66-10.71 c4.75-3.45,10.65-5.28,15.88-8.13c2.41-1.3,5.32-2.92,6.4-5.17C220.707,136.36,216.637,135.31,214.327,133.65z M111.437,192.42 c-46.57,0-84.32-37.75-84.32-84.32c0-46.56,37.75-84.31,84.32-84.31c46.56,0,84.31,37.75,84.31,84.31 C195.747,154.67,157.997,192.42,111.437,192.42z",
      "M216.086,109.69c-0.08-0.48,0.02-1-0.02-1.5c-0.07-0.95,0.16-2.22-0.36-2.76 c-0.73-0.76-2.03-0.97-3.07-1.46c-0.63-0.3-1.24-0.67-1.83-1.05c-0.53-0.33-1.08-0.65-1.53-1.07c-0.8-0.74-1.92-0.81-2.57-2.09 c-1.13-2.22-0.49-4.7-1.75-6.94c-1-1.8,0.07-4.32-0.91-6.51c-0.3-0.67,0.89-2,1.37-3.04c0.65-1.39,2.31-2.03,2.57-3.75 c0.12-0.81,0.64-1.61,1.15-2.28c1.78-2.38,1.16-5.33-1.31-6.02c-1.49-0.42-2.55-1.16-3.72-2.06c-1.21-0.92-2.77-1.49-4.25-1.92 c-1.54-0.44-2.15-1.61-2.84-2.79c-0.59-1.02-1.09-2.11-1.76-3.08c-0.71-1.02-1.59-1.93-2.47-2.98c0.35-0.13,0.74-0.16,0.86-0.35 c1.27-2.02,3.25-2,5.28-1.95c1.15,0.02,2.4,0.21,3.44-0.16c1.28-0.45,2.71-1.16,3.49-2.19c1.24-1.65-0.42-4.48-2.46-4.74 c-1.98-0.25-3.94-0.58-5.91-0.89c-0.18-0.03-0.34-0.15-0.51-0.22c-0.77-0.33-1.52-0.72-2.32-0.95c-0.57-0.16-1.22,0.01-1.79-0.13 c-2.14-0.53-4.24-1.43-6.41-1.61c-1.69-0.14-2.87-0.66-4.02-1.8c-1.28-1.26-2.82-2.26-4.1-3.52c-0.3-0.29-0.23-1.24,0-1.73 c0.44-0.91,1.54-0.97,2.32-1.44c1.74-1.05,3.29-2.45,4.89-3.74c0.52-0.42,1.31-0.9,1.38-1.42c0.19-1.46,0.06-2.96,0.06-4.5 c-2.54-0.33-4.95-0.67-7.38-0.94c-0.89-0.1-1.81-0.01-2.71-0.03c-0.34-0.01-0.68-0.07-1.01-0.16c-0.89-0.23-1.76-0.69-2.64-0.7 c-4.02-0.08-8.04-0.03-12.07-0.05c-0.42,0-1.11,0-1.23-0.23c-1.12-2.09-3.02-1.96-4.92-1.88c-1.14,0.04-1.8-0.46-2.06-1.62 c-0.27-1.22-0.34-2.76-1.12-3.54c-1.17-1.16-0.68-2.45-1.05-3.64c-0.33-1.08-0.81-2.76-1.52-2.93c-2.01-0.5-4.21-0.87-6.23,0.31 c-0.93,0.54-1.88,1.05-2.87,1.44c-1.21,0.48-2.61,0.61-3.7,1.27c-1.77,1.08-3.79,0.89-5.3,0.34c-1.38-0.5-2.66-0.56-4-0.68 c-0.75-0.06-1.5-0.02-2.23-0.16c-0.94-0.18-1.87-0.77-2.76-0.69c-1.9,0.18-3.03-0.91-3.97-2.14c-1.29-1.72-2.14-3.79-3.53-5.41 c-1.31-1.54-1.8-3.71-3.74-4.73c-0.49-0.26-0.96-0.67-1.48-0.73c-0.94-0.12-1.92-0.14-2.85,0c-0.59,0.08-1.26,0.41-1.66,0.85 c-0.55,0.59-0.75,1.49-1.3,2.07c-1.44,1.55-2.99,3-4.48,4.5c-0.13,0.12-0.12,0.38-0.22,0.55c-0.46,0.75-0.9,1.52-1.42,2.22 c-0.5,0.67-1.12,1.24-1.62,1.91c-0.48,0.62-0.79,1.38-1.31,1.96c-1.39,1.54-3.54,0.54-5.35,1.73c-2.13,1.39-5.14,1.6-7.81,1.92 c-2.43,0.29-4.97,0.32-7.37-0.06c-1.44-0.23-2.84-1.32-4.04-2.3c-1.44-1.18-2.57-2.71-4.77-2.47c-0.61,0.06-1.27-0.43-2.23-0.78 c-0.27,0.91-0.79,1.91-0.83,2.92c-0.13,3.22-0.1,6.44-0.1,9.66c0,0.72-0.13,1.16-0.84,1.66c-1.79,1.24-3.39,2.74-5.12,4.08 c-0.33,0.26-0.9,0.26-1.36,0.33c-0.69,0.1-1.75-0.09-2.02,0.28c-0.84,1.21-1.97,0.84-3.05,0.96c-0.53,0.06-1.05,0.27-1.56,0.43 c-1.41,0.44-2.79,0.98-4.23,1.32c-1.4,0.33-3.13-0.6-4.16,1.16c-0.06,0.1-0.38,0.07-0.58,0.08c-1.15,0.07-2.3,0.17-3.45,0.2 c-2.18,0.07-2.94,0.91-2.47,2.97c0.12,0.55,0.55,1.09,0.97,1.51c0.85,0.82,1.83,1.51,2.67,2.35c1.09,1.09,2.1,2.27,2.99,3.24 c-0.99,1.5-1.8,2.84-2.73,4.09c-0.62,0.83-1.51,1.47-2.09,2.32c-1.11,1.6-2.09,3.3-3.12,4.96c-0.31,0.5-0.73,0.96-0.93,1.51 c-0.5,1.33-2.38,2.73-3.8,2.76c-1.15,0.03-2.49-0.24-3.4,0.26c-1.3,0.71-2.55,0.65-3.86,0.66c-2.14,0.01-4.03,0.57-5.36,2.35 c-0.3,0.41-0.32,1.02-0.56,1.48c-0.7,1.31-0.46,3.54,0.67,4.44c0.88,0.71,1.97,1.17,2.86,1.87c0.75,0.58,1.24,1.6,2.06,1.97 c1.26,0.57,1.85,1.38,1.54,2.64c-0.41,1.68,0.4,3.44-0.77,5.14c-0.67,1,0.34,2.85-1.26,3.76c-0.08,0.04-0.05,0.28-0.06,0.43 c-0.07,1.2-0.32,2.3-0.72,3.49c-0.69,2.08-1.06,4.24-2.44,6.06c-1.06,1.41-1.99,2.97-2.99,4.37c-1.47,2.05-3.91,3.38-5.93,5.04 c-0.77,0.63-1.44,1.4-2.26,1.94c-2.24,1.47-2.4,4.44-0.52,6.31c1.02,1.02,2.11,0.63,3.19,0.81c0.52,0.08,1.08,0.08,1.56,0.28 c1.37,0.58,2.71,1.21,4.05,1.87c0.66,0.33,1.54,0.63,1.86,1.2c0.54,0.99,0.73,2.18,1.06,3.29c0.11,0.38,0.15,0.8,0.33,1.14 c0.54,0.96,1.26,1.84,1.67,2.85c1.1,2.69,0.84,5.73,2.18,8.41c0.66,1.31,0.76,2.91,1.15,4.37c0.3,1.13,0.34,2.53,1.05,3.3 c0.9,0.97,0.77,1.95,0.91,3c0.09,0.63,0.37,1.24,0.6,1.95c-0.55,0.45-1.38,0.87-1.82,1.55c-0.96,1.47-1.52,3.18-2.98,4.34 c-1.33,1.06-0.8,2.64-0.82,4.03c-0.02,1.27,1.61,3.18,2.84,3.32c3.02,0.36,6.04,0.64,9.06,0.96c0.33,0.04,0.81,0.04,0.95,0.24 c1,1.45,2.98,2.44,2.17,4.75c-0.11,0.31,0.39,0.78,0.39,1.18c0.02,1.32,0.11,2.68-0.17,3.95c-0.22,1.01-1.1,1.86-1.41,2.87 c-0.54,1.71,0.41,3.02,1.55,4.15c1.28,1.27,1.94,1.24,3.66,0.26c0.96-0.55,1.99-1.12,3.06-1.32c1.94-0.35,3.1,1.4,4.64,2.13 c1.17,0.55,2.17,1.43,3.34,1.98c1.51,0.72,3.1,1.19,4.05,2.8c0.33,0.57,1.26,0.78,1.9,1.19c0.6,0.38,1.4,0.7,1.69,1.26 c0.51,1.03,0.69,2.23,1.05,3.34c0.14,0.4,0.35,0.83,0.65,1.11c0.69,0.66,0.82,3.4,0.13,4.02c-1.03,0.92-1,1.59,0.01,2.49 c0.82,0.73,1.45,1.79,2.39,2.23c0.75,0.36,1.85,0.05,2.78-0.07c0.31-0.04,0.58-0.53,0.9-0.55c3.1-0.24,5.89-1.34,8.58-2.84 c0.3-0.16,0.95-0.17,1.14,0.03c0.76,0.82,2.02,1.28,1.69,2.88c-0.33,1.67,0.2,3.38-1.17,4.99c-1.23,1.45-2.01,3.39-2.64,5.23 c-0.38,1.12-0.54,2.67-0.05,3.67c1.2,2.45,4.7,2.61,6.65,0.57c0.81-0.86,1.69-1.67,2.6-2.42c0.67-0.55,1.47-0.95,2.18-1.46 c0.32-0.22,0.58-0.52,0.85-0.79c0.92-0.91,1.79-1.88,3.23-1.91c0.07-0.01,0.12-0.25,0.21-0.36c0.47-0.55,0.87-1.23,1.45-1.62 c1.52-1.02,3.11-1.93,4.71-2.83c0.26-0.15,0.74-0.13,1.03,0.01c0.92,0.44,2.1,0.77,2.65,1.53c1.27,1.72,2.45,3.58,3.25,5.55 c0.83,2.06,3.35,3.48,5.17,2.57c1.67-0.83,2.63-2.52,4.53-3.18c1.48-0.51,2.62-2,3.93-3.03c0.29-0.22,0.64-0.44,0.98-0.49 c2.46-0.4,4.93-0.75,7.39-1.13c0.2-0.03,0.4-0.06,0.58-0.14c2.21-1.02,3.32-0.31,3.32,2.12c0,14.19-0.05,28.38,0.05,42.57 c0.01,1.86-0.96,2.7-2.18,3.62c-1.74,1.29-3.51,2.55-5.17,3.94c-1.03,0.85-1.73,2.36-2.86,2.77c-2.07,0.74-3.5,2.3-5.3,3.36 c-0.78,0.46-2.38,1.3-1.52,2.46c0.73,0.98,1.51,2.42,3.29,2.29c1.75-0.12,3.52-0.01,5.28,0.04c0.36,0.01,0.79,0.11,1.07,0.32 c0.62,0.47,1.08,1.3,1.76,1.51c2.45,0.76,2.94,2.75,3.4,4.84c0.09,0.38,0.22,0.9,0.49,1.05c1.71,0.98,1.74,2.53,1.65,4.2 c-0.06,1.3,0.03,2.61,0.03,3.92c0,29.84,0.04,59.67-0.06,89.5c-0.01,2.31,0.88,4.73-0.96,7.07c-0.87,1.09-0.54,3.2-0.94,4.86 c-0.58,2.45-0.57,4.95-2.05,7.23c-0.78,1.21-0.76,2.94-1.11,4.44c-0.34,1.49-0.68,2.98-1.03,4.46c-0.03,0.13-0.14,0.34-0.23,0.35 c-1.15,0.18-0.88,1.09-0.84,1.76c0.05,0.94-0.27,1.83,0.87,2.72c0.82,0.63,0.83,2.35,1.12,3.6c0.4,1.74,0.73,3.51,1.09,5.26 c0.03,0.15,0.05,0.32,0.13,0.42c1.29,1.52,1.66,3.35,1.96,5.25c0.2,1.27,0.59,2.51,0.92,3.76c0.03,0.12,0.2,0.2,0.26,0.33 c0.28,0.55,0.77,1.11,0.79,1.68c0.09,3.17,0.09,6.34,0.08,9.51c-0.01,53.22-0.02,106.45-0.08,159.68c0,1.51,0.78,3.34-1.06,4.47 c-0.08,0.05-0.06,0.29-0.07,0.43c-0.29,3.58-0.58,7.16-0.86,10.73c-0.32,4.15-0.63,8.3-0.97,12.45c-0.03,0.37-0.26,0.73-0.4,1.09 c-0.22,0.55-0.64,1.11-0.63,1.66c0.01,2.21,0.17,4.31,0.9,6.56c0.95,2.95,0.48,6.31,0.89,9.51c0.6,4.76,0.19,9.64,0.22,14.47 c0,0.5-0.1,1.11,0.14,1.48c1.42,2.19,0.48,4.57,0.54,6.84c0.04,1.47-0.44,2.98-0.84,4.43c-0.28,0.99-0.67,2.02-1.29,2.82 c-0.83,1.08-1.77,2.01-1.64,3.52c0.05,0.49,0.15,1.21-0.11,1.46c-1.13,1.09-0.65,2.44-0.83,3.69c-0.31,2.06,0.16,4.04-0.82,6.24 c-0.96,2.19-0.26,5.14-0.16,7.75c0.02,0.5,0.87,0.95,0.93,1.47c0.29,2.77-0.03,5.53,0.85,8.32c0.65,2.07,0.26,4.49,0.21,6.75 c-0.04,2.22,0.51,4.38,0.15,6.66c-0.41,2.56-0.2,5.21-0.29,7.83c-0.01,0.43-0.02,1.12-0.27,1.26c-1.4,0.77-2.83,1.57-4.34,2.04 c-1.7,0.53-3.51,0.72-5.26,1.07c-0.15,0.02-0.35,0.06-0.42,0.16c-1.05,1.6-2.96,1.06-4.42,1.69c-1.82,0.79-3.98,0.8-5.99,1.16 c-0.29,0.05-0.67,0.1-0.83,0.3c-1.07,1.37-2.9,1.4-4.18,1.54c-2.35,0.25-4.8-0.49-7.21-0.82c-0.14-0.02-0.32-0.1-0.39-0.21 c-1.13-1.76-2.78-0.72-4.19-0.71c-0.45,0-0.86,0.75-1.36,0.9c-1.49,0.44-3.02,0.74-4.53,1.14c-0.22,0.06-0.35,0.43-0.57,0.58 c-0.67,0.47-1.36,1.26-2.06,1.29c-3.56,0.13-7.14,0.07-10.71,0.04c-0.34,0-0.71-0.21-1.04-0.37c-0.54-0.26-1.05-0.56-1.58-0.84 c-0.82-0.43-1.69-0.79-2.43-1.32c-0.47-0.34-0.64-1.1-1.12-1.39c-1.87-1.14-3.1-2.75-4.11-4.66c-0.29-0.55-1.05-1.17-1.64-1.22 c-2.71-0.22-5.54-0.58-7.69,1.72c-0.83,0.9-1.8,1.06-2.92,1.04c-0.38,0-0.87,0.04-1.14,0.26c-1.57,1.29-3.5,1.51-5.38,1.82 c-2.39,0.39-4.78,0.67-7.17,1.02c-0.22,0.03-0.39,0.29-0.61,0.39c-1.11,0.5-2.2,1.26-3.35,1.41c-2.09,0.25-3.01,0.98-2.64,3.04 c0.19,1.07,0.64,2.49,1.43,2.95c1.21,0.72,2.83,0.7,4.26,1.06c1.65,0.43,3.28,0.93,4.92,1.42c1.01,0.3,2.01,0.63,3.03,0.92 c1.88,0.54,3.74,1.35,5.66,1.53c3.04,0.28,6.13,0.18,9.19,0.18c13.52,0.02,27.05,0,40.57,0.04c1.41,0.01,3.03-0.62,4.13,0.94 c0.1,0.14,0.48,0.07,0.73,0.09c5.48,0.4,11.03-0.61,16.46,0.99c1.95,0.58,4.05,0.68,6.11,1c0.07,1.26,0.61,2.47-0.7,3.3 c-0.85,0.54-1.65,1.22-2.57,1.58c-2.2,0.85-4.44,1.57-6.68,2.32c-0.99,0.34-2.02,0.59-3.01,0.94c-1.67,0.58-3.32,1.21-4.98,1.82 c-0.23,0.09-0.44,0.21-0.66,0.31c-0.53,0.24-1.04,0.64-1.58,0.69c-5.18,0.48-10.35-0.17-15.61,0.68 c-5.76,0.93-11.79-0.18-17.64,1.1c-0.82,0.18-1.73-0.09-2.55,0.08c-1.8,0.37-3.61,0.77-5.32,1.42c-0.58,0.21-1.08,1.13-1.26,1.82 c-0.66,2.45,1.02,5.29,4.03,5.07c1.83-0.13,3.72,0.54,5.59,0.87c0.12,0.02,0.22,0.18,0.34,0.24c0.72,0.31,1.43,0.85,2.17,0.88 c2.51,0.11,5.03,0.09,7.54,0.03c1.18-0.03,2.56,0.41,3.33-1.08c0.07-0.15,0.56-0.11,0.86-0.11c5.22,0.01,10.44,0.02,15.66,0.05 c0.34,0,0.79,0,1,0.19c1.32,1.25,2.86,1.82,4.67,1.79c1.63-0.02,3.26,0.01,4.6,1.25c0.06,0.99-0.12,1.83-1.41,1.95 c-0.23,0.02-0.46,0.31-0.66,0.5c-1.32,1.33-2.56,2.77-3.99,3.98c-1.06,0.89-2.34,2.07-3.56,2.12c-2.5,0.1-4.06,2.03-6.3,2.6 c-1.31,0.34-2.46,1.45-3.98,1.52c-0.29,0.01-0.67,0.07-0.83,0.26c-1.11,1.31-2.62,1.66-4.2,1.76c-1.8,0.12-3.76-0.26-5.37,0.33 c-1.58,0.59-3.07,0.54-4.61,0.59c-1.96,0.05-3.92,0.02-5.88,0c-0.39,0-0.79-0.07-1.16-0.17c-0.83-0.22-1.64-0.59-2.48-0.71 c-2.61-0.36-5.24-0.64-7.85-0.96c-0.15-0.02-0.38-0.06-0.41-0.14c-0.54-1.36-1.74-0.98-2.71-0.99c-4.02-0.06-8.04-0.04-12.07-0.05 c-0.4,0-0.81,0-1.19-0.08c-1.18-0.25-2.34-0.57-3.51-0.81c-0.49-0.09-1.19,0.17-1.47-0.09c-1.49-1.32-3.25-0.64-4.88-0.82 c-0.45-0.05-1.2,0.06-1.3-0.14c-0.68-1.42-1.93-1.03-3.02-1.06c-2.06-0.05-5.27-2.58-6.24-4.39c-0.87-1.64-2.23-3.05-3.48-4.46 c-1.04-1.17-2.36-2.08-3.33-3.29c-0.87-1.07-1.16-2.84-2.21-3.49c-1.93-1.2-2.76-3.77-5.53-3.92c-0.11,0.08-0.58,0.28-0.75,0.63 c-0.28,0.54-0.63,1.29-0.45,1.77c0.48,1.3,1.57,2.45,1.78,3.76c0.36,2.21,2.01,3.73,2.59,5.88c0.45,1.67,1.26,3.48,2.41,5.08 c1.14,1.56,1.41,3.74,2.13,5.63c0.43,1.16,0.89,2.33,1.51,3.4c0.36,0.63,1.01,1.13,1.61,1.59c0.67,0.5,1.52,0.79,2.13,1.35 c0.78,0.7,1.25,1.83,2.11,2.32c1.81,1.02,4.06,1.07,5.77,2.38c0.07,0.06,0.21,0.06,0.3,0.04c2.43-0.53,4.36,1.08,6.06,2.12 c2,1.24,4.52,2.12,5.74,4.61c0.47,0.95,1.67,1.55,3.12,0.54c0.9-0.62,2.18-0.69,3.18-1.48c1.15-0.91,2.59-1.45,3.89-2.16 c0.34-0.18,0.65-0.55,0.97-0.56c2.21-0.07,4.53-0.5,6.59,0.05c1.65,0.44,3.29,0.44,4.91,0.75c3.34,0.63,6.68,1.23,10.11,1.01 c0.19-0.02,0.47-0.04,0.58,0.07c1.69,1.69,4.5-0.27,6.04,1.88c2.64-0.06,5.21,0.33,7.75,1.05c1.35,0.38,2.74,0.65,4.1,0.98 c0.13,0.03,0.21,0.2,0.34,0.27c1.18,0.58,2.33,1.28,3.57,1.7c1.36,0.47,2.81,0.68,4.22,1.01c0.12,0.03,0.22,0.16,0.34,0.24 c0.93,0.58,1.82,1.22,2.8,1.71c1.03,0.51,2.68,0.57,3.1,1.35c1.03,1.92,2.93,2.76,4.5,3.64c1.3,0.73,3.45,0.26,5.09-0.18 c0.46-0.12,0.44-2.05,0.6-3.16c0.06-0.34-0.03-0.71,0.02-1.05c0.29-1.88-1.12-3-1.84-4.46c-0.7-1.42-2.24-1.12-3.03-2.13 c-0.57-0.71-1.11-1.52-1.85-1.99c-1.99-1.26-4.2-2.07-5.98-3.79c-1.42-1.38-3.36-2.21-5.05-3.33c-0.53-0.36-0.97-0.86-1.6-1.43 c1.59-0.28,2.79-0.38,3.91-0.73c1.33-0.42,2.56-1.15,3.88-1.59c1.23-0.41,2.52-0.08,3.86-0.73c1.07-0.51,2.44-1.28,3.54-1.27 c4.9,0.06,9.87-1.42,14.74,0.77c1.85,0.84,4.1,0.89,6.19,1.08c2.2,0.2,4.42,0.08,6.63,0.19c1.39,0.07,2.87-0.36,3.15-1.52 c0.35-1.43-0.11-3.07-0.31-4.61c-0.05-0.35-0.43-0.86-0.75-0.94c-1.89-0.45-3.03-2.61-5.28-2.29c-0.29,0.05-0.76-0.44-0.98-0.79 c-0.55-0.87-1.04-1.78-1.46-2.72c-0.72-1.58-1.07-3.47-2.15-4.72c-1.03-1.21-1.01-2.65-1.64-3.91c-0.95-1.9,1.19-4.82,3.55-5.51 c1.64-0.47,2.56-1.92,3.11-3.23c0.56-1.3,1.48-2.16,2.47-2.65c1.95-1,3.13-2.23,2.85-4.48c-0.15-1.19,0.35-1.95,1.04-2.38 c1,0.29,1.75,0.57,2.54,0.71c0.68,0.12,1.65-0.21,2.05,0.15c1.42,1.25,3.06,0.73,4.59,0.79c1.64,0.07,2.82-1.17,2.72-2.83 c-0.14-2.32,0.71-4.76-1.17-6.9c-1.23-1.41-2.02-3.2-3.05-4.79c-0.22-0.34-0.72-0.52-0.87-0.87c-0.46-1.06-0.77-2.19-1.23-3.25 c-0.29-0.71-0.68-1.39-1.13-2.01c-1.1-1.56-2.04-3.14-1.53-5.37c1.49-0.04,2.78-0.09,3.89-1.32c1.1-1.21,1.2-2.49,1.25-3.92 c0.01-0.23,0.11-0.48,0.24-0.67c1.24-1.84,0.48-3.88,0.58-5.83c0.01-0.15-0.29-0.35-0.49-0.46c-1-0.56-2.03-1.05-3-1.64 c-0.5-0.3-0.84-0.89-1.35-1.13c-1-0.46-2.14-0.66-3.09-1.2c-0.51-0.28-0.94-1-1.07-1.59c-0.43-2.04-0.69-4.12-1.08-6.17 c-0.08-0.39-0.55-0.7-0.63-1.08c-0.19-0.93-0.56-2-0.26-2.78c0.2-0.56,1.73-1.24,2.07-1c1.34,0.91,2.76,0.55,4.13,0.75 c0.3,0.04,0.57,0.28,0.87,0.41c0.5,0.23,0.99,0.58,1.52,0.65c3.46,0.48,6.98-0.42,10.48,0.84c1.88,0.67,4.18,0.23,6.29,0.19 c0.47-0.01,1.28-0.37,1.34-0.69c0.2-1.06,0.29-2.2,0.09-3.25c-0.08-0.41-1.04-0.65-1.59-1c-0.18-0.12-0.3-0.34-0.49-0.47 c-1.59-1.12-3.47-1.86-4.58-3.59c-0.05-0.07-0.2-0.06-0.28-0.11c-0.71-0.43-1.45-0.81-2.11-1.31c-0.61-0.47-1.1-1.11-1.72-1.57 c-0.68-0.5-1.49-0.82-2.16-1.33c-0.65-0.49-1.14-1.21-1.81-1.67c-1.57-1.08-3.21-2.06-4.83-3.08c-0.55-0.35-1.1-0.73-1.69-1.01 c-0.82-0.38-1.8-0.53-2.49-1.06c-0.53-0.41-0.95-1.22-1.04-1.91c-0.29-2.18,0.44-4.47-0.96-6.53c-0.53-0.79-1.11-1.77-1.11-2.66 c-0.06-20.73-0.05-41.46-0.03-62.18c0-0.42,0.15-0.86,0.31-1.25c0.21-0.5,0.64-0.94,0.74-1.45c0.29-1.62,0.18-3.22,0.78-4.9 c0.83-2.34,0.88-4.99,1.09-7.52c0.17-1.95,0.05-3.92,0.11-5.88c0.01-0.47,0.2-0.93,0.37-1.38c0.2-0.51,0.68-0.99,0.69-1.49 c0.05-4.08,0.04-8.15,0.01-12.23c0-0.48-0.04-1.25-0.32-1.39c-0.99-0.49-0.7-1.33-0.78-2.08c-0.35-3.05-0.31-6.21-1.2-9.09 c-0.7-2.29-0.69-4.49-0.62-6.72c0.12-3.64-0.46-7.31,0.67-10.95c0.71-2.26,0.78-4.71,1.14-7.07c0.04-0.24,0.05-0.53,0.19-0.72 c1.27-1.67,1.08-3.79,1.66-5.67c0.44-1.39,0.1-3,0.26-4.5c0.1-0.93,0.2-2.16,0.8-2.68c1.42-1.23,1.05-2.71,1.11-4.18 c0.02-0.75,0.08-1.5,0.08-2.26c0-7.94,0-15.89-0.03-23.84c0-0.4-0.25-0.81-0.42-1.2c-0.21-0.5-0.6-0.97-0.64-1.48 c-0.1-1.3,0.06-2.63-0.09-3.92c-0.13-1.03-0.9-2.06-0.78-3.02c0.31-2.47-0.9-4.62-1.12-6.95c-0.02-0.22-0.23-0.41-0.33-0.63 c-0.25-0.52-0.62-1.03-0.7-1.58c-0.19-1.34,0.04-2.8-0.39-4.03c-0.8-2.24-1.62-4.42-1.62-6.84c0.01-17.65,0.01-35.31,0.01-52.97 c0-0.35,0.01-0.7,0-1.05c-0.02-1.05,0.41-1.5,1.54-1.48c2.96,0.07,5.93,0.14,8.89-0.02c1.36-0.08,2.79-0.5,3.99-1.12 c0.75-0.39,1.46-1.39,1.62-2.23c0.27-1.36,0.17-2.82,0.01-4.2c-0.06-0.53-0.66-1.12-1.16-1.45c-0.95-0.62-2-1.08-3.02-1.6 c-0.99-0.5-1.96-1.06-2.98-1.47c-1.78-0.73-3.61-1.35-5.4-2.06c-0.43-0.18-0.73-0.7-1.16-0.84c-2.24-0.68-2.37-0.81-2.37-3.03 c0.01-25.61,0-51.21,0.02-76.82c0-3.07,0.14-6.13,0.21-9.2c0.01-0.24,0.02-0.5,0.07-0.74c0.27-1.22,0.63-2.42,0.81-3.66 c0.37-2.55,0.64-5.13,0.97-7.69c0.02-0.18,0.12-0.4,0.26-0.51c1.25-1.01,1.6-2.31,1.7-3.89c0.22-3.29,0.67-6.56,1.04-9.84 c0.02-0.18,0.11-0.47,0.23-0.51c1.12-0.39,0.81-1.36,0.9-2.16c0.05-0.55-0.08-1.13,0.06-1.65c0.48-1.75,1.32-3.45,1.53-5.23 c0.29-2.37,0.65-4.96-0.01-7.16c-0.63-2.1-0.45-4.08-0.64-6.11c-0.06-0.75,0.14-1.67-0.22-2.22c-1.07-1.62-0.53-3.36-0.68-5.04 c-0.04-0.45,0-0.91,0-1.36c-0.04-11.77-0.07-23.54-0.12-35.32c0-0.74,0.31-1.64-0.76-2.05c-0.18-0.07-0.26-0.51-0.3-0.79 c-0.28-1.71-0.53-3.42-0.79-5.13c-0.02-0.14-0.04-0.34,0.04-0.43c0.85-1.09,1.42-2.52,3.18-2.48c0.48,0.01,1.01-0.1,1.45-0.3 c1.93-0.87,3.83-1.82,5.76-2.7c0.91-0.41,1.88-0.69,2.8-1.06c0.79-0.32,1.87-0.46,2.28-1.06c1.04-1.51,2.94-0.65,4.08-1.75 c0.2-0.2,0.94-0.09,1.27,0.13c1.02,0.68,1.91,1.57,2.95,2.21c0.97,0.6,2.05,1.01,3.11,1.45c0.77,0.32,1.57,0.54,2.6,0.88 c0.08-0.06,0.43-0.5,0.88-0.68c1.99-0.8,2.28-1.19,2.32-3.33c0.02-0.8-0.16-2.05,0.24-2.3c1.05-0.65,0.8-1.53,0.84-2.37 c0.1-1.85,0.1-3.71,0.2-5.57c0.02-0.46,0.14-1,0.42-1.35c1.19-1.48,2.43-2.92,3.72-4.33c1.85-2.02,3.76-3.98,5.62-5.99 c1.2-1.3,2.41-2.58,3.51-3.96c0.91-1.15,2.34-1.82,2.73-3.48c0.22-0.96,1.04-1.77,1.58-2.66c1.01-1.68,2.08-3.34,2.99-5.07 c0.86-1.63,1.53-3.36,2.33-5.01c0.12-0.24,0.55-0.48,0.82-0.47c0.85,0.06,1.7,0.23,2.56,0.36c1.64-0.37,3.34-0.64,5.04-0.61 c2.2,0.04,4.18-0.16,5.25-2.55c-0.42-0.66-0.75-1.53-1.37-2.07c-1.26-1.13-2.64-2.08-2.54-4.07c0.02-0.43-0.29-0.97-0.6-1.32 c-0.98-1.09-1.88-2.23-2.27-3.68c-0.25-0.92-0.45-1.85-0.7-2.92c0.1-0.16,0.47-0.49,0.53-0.87c0.41-2.81,0.64-5.66,1.19-8.44 c0.36-1.78,1.14-3.48,1.81-5.19c0.13-0.33,0.58-0.58,0.92-0.78c1.21-0.7,2.72-1.11,3.58-2.1c0.87-1,1.89-1.43,2.93-2.05 C215.346,112.2,216.377,111.28,216.086,109.69z M111.437,192.42c-46.57,0-84.32-37.75-84.32-84.32c0-46.56,37.75-84.31,84.32-84.31 c46.56,0,84.31,37.75,84.31,84.31C195.747,154.67,157.997,192.42,111.437,192.42z",
      "M220.041,157.85c-0.55-1.59-1.99-2.91-3.19-4.22c-1.44-1.55-3.06-2.93-4.54-4.44 c-0.94-0.97-2.09-1.91-2.57-3.1c-0.71-1.75-2.03-2.69-3.39-3.77c-0.82-0.65-1.45-1.6-2.05-2.48c-0.5-0.74-0.65-1.96-1.31-2.31 c-1.12-0.62-0.92-1.41-0.84-2.26c0.08-0.9-0.07-2.1,0.44-2.6c0.78-0.78,0.7-1.59,0.82-2.45c0.08-0.56-0.1-1.25,0.16-1.69 c1.35-2.35-0.12-5.35,1.81-7.52c0.27-4.36,0.77-8.72,0.74-13.07c-0.02-4.6-0.55-9.19-0.86-13.78c-0.02-0.23-0.04-0.6-0.18-0.67 c-1.2-0.58-0.74-1.69-0.88-2.62c-0.3-2.03-0.62-4.06-0.94-6.09c-0.03-0.17-0.16-0.32-0.24-0.49c-0.24-0.54-0.6-1.06-0.69-1.62 c-0.13-0.75,0.01-1.54-0.06-2.3c-0.14-1.56,0.39-3.22-0.79-4.65c-0.22-0.28-0.2-1.14,0.05-1.36c1.19-1.08,1.96-2.58,3.68-3.18 c0.9-0.32,1.87-1.42,2.11-2.35c0.36-1.38,0.09-2.92,0.09-4.59c-1.73,0-3.3,0.02-4.87,0c-0.36-0.01-0.98-0.02-1.05-0.2 c-0.46-1.09-1.43-0.72-2.21-0.93c-0.6-0.16-1.47-0.3-1.69-0.73c-0.65-1.26-1.95-1.91-2.51-3.35c-0.54-1.39-1.94-2.48-3.06-3.6 c-1.57-1.58-3.29-3.01-4.82-4.63c-0.9-0.96-1.45-2.23-2.3-3.24c-1.37-1.63-3.13-2.84-3.93-5.04c-0.75-2.04-0.93-2.28,0.91-3.34 c1.13-0.65,2.46-1.26,3.14-2.27c0.61-0.91,1.38-1.33,2.18-1.58c1.22-0.36,1.87-1.27,2.04-2.22c0.26-1.52,0.07-3.12,0.07-4.65 c-0.7-0.18-1.53-0.16-1.73-0.5c-0.54-0.93-1.34-0.88-2.1-0.8c-2.26,0.22-4.43-0.1-6.81,0.91c-2.5,1.06-5.7,0.06-8.58,0.97 c-1.39,0.44-3.04,0.01-4.63-0.49c-1.72-0.54-3.23-1.39-4.81-2.12c-0.53-0.24-0.86-0.92-1.39-1.21c-1.65-0.91-3.34-1.75-5.03-2.58 c-1.13-0.55-2.27-1.12-3.46-1.5c-1.3-0.42-2.67-0.64-4.01-0.96c-0.12-0.03-0.2-0.18-0.32-0.25c-0.49-0.28-0.96-0.69-1.5-0.81 c-1.58-0.38-3.18-0.64-4.78-0.96c-0.14-0.02-0.31-0.04-0.39-0.13c-1.28-1.53-3.33-0.93-4.88-1.77c-0.54-0.3-1.16-0.25-1.76-0.8 c-0.74-0.69-1.95-0.86-2.95-1.27c-0.31-0.13-0.57-0.36-0.88-0.52c-1.82-0.91-2.44-3.41-4.85-3.63c-0.37-0.03-0.84-0.97-0.93-1.54 c-0.16-0.97-0.04-2-0.04-2.77c-1.29-1.4-2.71-1.66-4.31-1.5c-1.04,0.1-3.26,1.89-3.77,2.79c-0.68,1.21-0.49,3.06-2.5,3.4 c-0.54,0.1-1.02,0.85-1.41,1.39c-0.58,0.82-1.24,1.27-2.3,1.24c-2.01-0.06-4.03-0.04-6.04,0.02c-0.52,0.02-1.03,0.31-1.53,0.51 c-0.4,0.16-0.75,0.5-1.15,0.55c-3.09,0.4-6.2,0.74-9.3,1.11c-0.14,0.02-0.31,0.01-0.41,0.1c-1.74,1.46-4.05,1.26-6.01,1.52 c-2.02,0.27-3.57,1.32-5.4,1.82c-1.27,0.35-2.45,1.02-3.69,1.51c-2.06,0.82-4.13,1.61-6.2,2.4c-0.64,0.24-1.35,0.37-1.91,0.73 c-1.46,0.94-2.83,2.01-4.28,2.97c-1.07,0.72-2.2,1.37-3.31,2.04c-0.98,0.59-1.98,1.14-2.94,1.76c-0.49,0.32-0.89,0.79-1.38,1.11 c-0.56,0.35-1.41,0.47-1.71,0.95c-0.49,0.79-1.09,1.06-1.92,1.26c-0.56,0.14-1.09,0.61-1.52,1.04c-0.91,0.91-1.7,1.92-2.6,2.84 c-1.47,1.52-3.01,2.96-4.47,4.49c-1.04,1.1-1.94,2.34-2.99,3.42c-1.05,1.07-2.23,2.02-3.34,3.03c-0.16,0.15-0.42,0.34-0.42,0.49 c0.1,1.74-2.06,1.97-2.29,3.47c-1.95,0.29-1.67,2.42-2.79,3.49c-1.16,1.11-1.61,2.94-2.39,4.45c-0.36,0.68-0.62,1.51-1.17,1.98 c-0.96,0.81-1.45,1.74-1.52,2.96c-0.02,0.38-0.02,0.81-0.2,1.11c-0.84,1.45-1.74,2.87-2.62,4.29c-0.4,0.63-1.03,1.22-1.16,1.9 c-0.25,1.29-0.94,1.6-2.14,1.73c-2.53,0.27-5.17-0.85-7.62,0.97c-0.78,0.57-1.29,0.9-1.28,1.82c0.02,1.15,0.04,2.3,0.09,3.45 c0.01,0.28,0.02,0.64,0.18,0.82c0.91,1.01,1.87,1.99,2.82,2.97c0.3,0.31,0.66,0.56,0.92,0.89c0.54,0.7,0.91,1.58,1.57,2.11 c1.32,1.05,1.76,2.7,0.91,4.16c-0.19,0.32-0.31,0.7-0.37,1.07c-0.33,2.36-0.19,4.68-0.93,7.12c-1.04,3.39-0.76,7.19-0.99,10.82 c-0.084,1.3-0.028,2.609-0.004,3.91c0.006,0.347,0.042,0.913,0.113,1.253c0.215,1.031,0.607,2.038,0.712,3.077 c0.13,1.18,0.02,2.39,0.08,3.59c0.02,0.39,0.24,0.77,0.39,1.15c0.19,0.5,0.5,0.97,0.6,1.49c0.36,1.88,0.66,3.78,0.98,5.67 c0.02,0.14,0.04,0.36,0.12,0.39c1.31,0.58,0.79,1.78,0.95,2.74c0.08,0.47-0.04,1.09,0.21,1.4c1.07,1.27,0.76,2.98,1.64,4.41 c0.92,1.49,0.83,3.53,1.95,5.15c1.07,1.53,1.11,3.52,2.09,5.23c1.14,2,1.76,4.33,3.12,6.29c0.99,1.43,1.86,2.94,2.81,4.39 c0.43,0.64,1.05,1.17,1.38,1.86c0.32,0.66,0.52,1.46,0.46,2.17c-0.02,0.21-1.11,0.37-1.72,0.47c-0.89,0.14-2.03-0.1-2.64,0.37 c-1.27,0.99-2.58,1.6-4.16,1.75c-0.27,0.02-0.66,0.12-0.78,0.31c-0.74,1.2-2.18,0.94-3.19,1.62c-0.9,0.6-1.97,0.95-2.95,1.45 c-0.13,0.06-0.15,0.33-0.22,0.5c-0.29,0.61-0.57,1.22-0.88,1.88c0.22,0.14,0.66,0.26,0.73,0.49c0.44,1.56,1.62,1.71,2.95,1.69 c6-0.1,12,0.28,17.98-0.6c2.02-0.3,2.35-0.04,2.27,1.87c-0.01,0.33,0.33,0.65,0.42,1c0.28,1.08,0.93,2.18-0.3,3.18 c-0.72,0.59-1.28,1.39-1.97,2.04c-0.57,0.55-1.16,1.13-1.84,1.51c-1.53,0.85-3.29,1.33-4.37,2.87c-0.11,0.16-0.38,0.21-0.57,0.32 c-1.53,0.89-3.3,1.54-4.54,2.74c-1.67,1.63-4.03,1.83-5.72,3.3c-0.62,0.53-1.4,0.9-2.1,1.34c-0.35,0.22-0.68,0.57-1.05,0.64 c-1.67,0.33-2.61,1.81-2.12,3.47c0.38,1.29,2.05,1.63,3.29,1.08c1.5-0.67,2.83-2,4.72-1.6c0.23,0.05,0.48-0.03,0.71,0.01 c3.29,0.59,6.38-0.81,9.6-0.9c0.14,0,0.37-0.02,0.4-0.09c0.59-1.47,1.9-0.82,2.92-1.07c1.08-0.27,2.31-0.48,3.12-1.14 c1.34-1.1,3.01-1.42,4.43-1.52c2.07-0.14,3.55-1.64,5.54-1.71c0.53-0.02,1.04-0.3,1.55-0.46c0.45-0.14,0.92-0.22,1.33-0.43 c0.95-0.49,1.87-1.48,2.8-1.47c2.17,0.03,4.33,0.51,6.5,0.83c0.1,0.02,0.16,0.24,0.27,0.29c0.56,0.28,1.11,0.61,1.7,0.78 c1.28,0.37,2.98,0.25,3.8,1.06c1.41,1.37,3.24,0.88,4.73,1.73c0.92,0.53,2.42-0.25,3.25,1.05c0.11,0.17,0.55,0.21,0.82,0.18 c3.28-0.45,5.4,2.03,8.05,3.18c1.02,0.44,1.9,1.2,2.94,1.6c2.28,0.87,4.77,0.75,7.12,1.85c2.1,0.99,4.76,1.09,7.16,1.03 c6.72-0.19,13.49,0.95,20.17-0.71c1.13-0.28,2.39-0.08,3.58-0.17c0.39-0.02,0.78-0.21,1.15-0.37c0.47-0.21,0.91-0.6,1.39-0.67 c1.14-0.15,2.49,0.21,3.39-0.3c1.52-0.84,2.91-0.42,4.47-0.47c0.03,0.81,0.09,1.47,0.09,2.13v170.39c0,1.92,0.01,3.84-0.01,5.76 c0,0.42,0.03,1.13-0.17,1.22c-1.48,0.66-0.88,1.94-0.93,2.97c-0.1,1.67-0.15,3.36-0.02,5.03c0.14,1.95-0.76,4.1,1,5.79 c0.14,0.13,0.07,0.46,0.13,0.69c0.32,1.16,0.64,2.31,1,3.45c0.05,0.18,0.32,0.33,0.52,0.42c1.35,0.57,1.68,1.45,1.02,2.81 c-0.14,0.29-0.42,0.71-0.31,0.88c1.11,1.81,0.69,3.83,0.63,5.73c-0.1,2.98-0.59,5.94-0.76,8.93c-0.14,2.43-0.03,4.89-0.08,7.33 c-0.01,0.6,0.23,1.41-0.8,1.57c-0.12,0.02-0.28,0.37-0.29,0.57c-0.16,3.08-0.36,6.15-0.72,9.24c-0.59,4.97-0.21,10.05-0.21,15.09 c0,44.18,0.01,88.36,0,132.54c0,6.23-0.02,12.47-0.12,18.7c-0.03,1.37,0.13,2.67-0.79,4.12c-0.92,1.43-0.93,3.56-1.02,5.39 c-0.16,3.11-0.07,6.24-0.11,9.36c-0.01,0.51-0.02,1.4-0.24,1.47c-1.21,0.4-0.8,1.35-0.89,2.13c-0.08,0.62-0.03,1.28-0.26,1.84 c-1.03,2.54-0.86,5.31-0.25,7.71c0.44,1.74,0.41,3.39,0.61,5.08c0.09,0.71-0.17,1.75,0.22,2.08c1.12,0.97,0.85,2.16,0.86,3.3 c0.05,10.08,0.08,20.15,0.07,30.22c0,1.21,0.33,2.59-1.03,3.45c-0.18,0.11-0.18,0.53-0.24,0.8c-0.3,1.45-0.59,2.91-0.92,4.36 c-0.04,0.18-0.32,0.29-0.45,0.47c-0.23,0.34-0.53,0.68-0.61,1.06c-0.36,1.69-0.64,3.38-0.96,5.08c-0.02,0.13-0.03,0.36-0.11,0.39 c-1.37,0.57-0.82,1.77-0.87,2.73c-0.07,1.48,0.09,2.98-0.06,4.45c-0.07,0.64-0.56,1.58-1.07,1.74c-1.53,0.48-3.39-0.22-4.66,1.28 c-6.11,0.05-12.2-0.04-18.29,0.83c-3.57,0.51-7.27,0.09-10.91,0.11c-0.52,0-1.34-0.08-1.52,0.2c-0.88,1.4-2.2,0.79-3.34,0.85 c-1.68,0.09-3.36,0.01-5.03,0.03c-2.22,0.03-2.87,0.61-2.88,2.52c-0.01,1.74,1.56,3.66,3.06,3.67c2.44,0.02,4.89-0.03,7.33,0.03 c0.54,0.01,1.1,0.29,1.59,0.56c0.66,0.35,1.23,1.13,1.88,1.17c2.77,0.19,5.5,0.3,8.27,0.8c3.4,0.62,6.97,0.26,10.46,0.39 c1.31,0.04,2.77-0.51,3.81,0.86c0.13,0.16,0.55,0.11,0.83,0.16c1.98,0.31,3.97,0.57,5.93,0.94c1.09,0.21,2.13,0.61,3.19,0.93 c0.13,0.04,0.23,0.15,0.35,0.21c0.62,0.31,1.25,0.59,1.87,0.9c0.71,0.37,1.79,0.59,2.05,1.17c0.56,1.23,0.85,2.64,0.96,4.01 c0.19,2.53,0.15,5.07,0.25,7.61c0.01,0.38,0.22,0.77,0.39,1.12c0.21,0.43,0.67,0.83,0.68,1.24c0.06,2.54,0.03,5.08,0.03,8.02 c-1.66,0.18-3.24,0.45-4.82,0.5c-2.92,0.07-5.85,0-8.77,0.03c-0.79,0-1.59,0.13-2.49,0.22c0.04,1.62-0.73,3.04,0.83,4.49 c1.37,1.26,2.42,2.7,4.52,2.55c0.429-0.031,0.861,0.057,1.262,0.211c2.119,0.81,4.149,1.889,6.518,1.859 c2.647-0.022,3.007,0.673,2.932,3.776c-0.017,0.708,0.025,1.415,0.061,2.122c0.065,1.295-0.44,1.831-1.823,1.812 c-3.69-0.07-7.38-0.03-11.07,0c-0.56,0.01-1.42-0.02-1.62,0.29c-0.74,1.16-1.8,0.84-2.78,0.84c-2.78,0.02-5.56,0.01-8.34,0.01 c-2.64,0-5.27,0.06-7.9-0.01c-1.15-0.03-2.08,0.55-2.33,1.39c-0.7,2.4,0.27,5.56,3.59,5.63c1.2,0.02,2.77-0.38,3.51,0.22 c1.4,1.15,2.84,0.75,4.28,0.95c1.97,0.27,3.93,0.57,5.9,0.89c0.17,0.03,0.3,0.3,0.46,0.45c0.91,0.82,1.76,1.71,3.21,1.47 c0.49-0.09,1.07,0.16,1.57,0.35c0.51,0.19,0.95,0.66,1.45,0.73c3.2,0.43,6.4,0.78,9.69,1.16c0.04,0.17,0.13,0.39,0.14,0.62 c0.03,1.82,0.03,3.65,0.06,5.47c0.01,0.76-0.1,1.57,0.11,2.28c0.5,1.64,0.12,2.28-1.61,2.28c-4.12,0-8.24-0.01-12.36,0.02 c-0.7,0.01-1.77,0-2.02,0.4c-0.59,0.96-1.36,0.7-2.11,0.73c-1.81,0.07-3.64,0.04-5.44,0.19c-1.13,0.1-2.23,0.64-3.35,0.64 c-8.67,0.06-17.35,0.03-26.02,0.05c-0.66,0-1.71-0.04-1.89,0.3c-0.55,1.03-1.38,0.79-2.18,0.88c-1.31,0.17-2.07,1-2.12,2.29 c-0.1,2.71,1.38,4.42,4.05,4.64c0.66,0.06,1.34,0.06,2.01,0.06c11.59,0,23.19-0.04,34.79,0.04c2.11,0.01,4.23,0.53,6.34,0.84 c0.16,0.02,0.3,0.17,0.46,0.26c0.46,0.24,0.9,0.61,1.38,0.7c2.05,0.38,4.12,0.68,6.18,1.02c0.17,0.02,0.32,0.14,0.49,0.22 c0.59,0.27,1.16,0.71,1.77,0.77c1.78,0.18,2.26,0.55,2.18,2.39c-0.13,2.89,0.3,5.79-0.56,8.69c-0.54,1.82,0.44,4.02-1.28,5.61 c-1.07,0.99-1.03,2.72-2.45,3.52c-0.6,0.33-1.11,0.94-1.49,1.53c-0.84,1.31-1.52,2.72-2.37,4.02c-0.39,0.59-1.08,0.97-1.53,1.53 c-0.82,1.05-1.77,2.07-2.29,3.27c-0.73,1.7,0.72,3.6,2.56,3.61c1.2,0,2.39-0.07,3.59-0.14c0.28-0.01,0.76-0.06,0.79-0.18 c0.37-1.48,1.9-1.22,2.79-1.6c1.47-0.63,2.91-1.2,4.18-2.2c0.6-0.47,1.56-0.65,1.91-1.24c0.65-1.1,0.98-2.39,1.44-3.6 c0.17-0.43,0.37-0.84,0.5-1.28c0.4-1.41,0.82-2.81,1.14-4.24c0.15-0.69,0.22-1.46,0.08-2.14c-0.28-1.36,0.93-1.72,1.44-2.55 c0.84-1.38,1.53-1.33,2.36-0.08c0.04,0.06,0.18,0.09,0.27,0.09h5.12c-0.27-2.27,0.54-4.2-0.94-6.39c-1.18-1.72-2.35-3.95-2.25-6.37 c0.02-0.28-0.07-0.57-0.13-0.85c-0.31-1.36-0.62-2.72-0.98-4.33c4.5,0,8.43-0.01,12.35,0.02c0.27,0,0.59,0.24,0.78,0.46 c0.82,0.96,1.75,1.44,3.09,1.4c2.73-0.08,5.46,0.06,8.19,0.06c14.24,0.01,28.47,0,42.7,0c0.67,0,1.35,0.02,2.01-0.07 c0.32-0.05,0.75-0.28,0.88-0.55c0.69-1.38,1.24-2.78,1.07-4.42c-0.22-2-0.91-2.79-2.91-2.81c-2.59-0.03-5.17,0-7.76-0.03 c-0.4,0-0.82-0.09-1.21-0.22c-0.79-0.28-1.56-0.86-2.35-0.87c-4.08-0.1-8.15-0.05-12.22-0.06c-0.39,0-0.91,0.14-1.13-0.05 c-1.49-1.3-3.27-0.63-4.92-0.82c-1.42-0.16-3.03,0.59-4.17-0.93c-0.17-0.22-0.72-0.18-1.1-0.18c-1.29-0.03-2.58-0.02-3.86-0.03 c-0.63,0-1.49,0.23-1.83-0.09c-1.49-1.41-3.58-0.43-5.29-1.62c-1.47-1.03-3.79-0.13-5.71-1.05c-1.26-0.6-2.87,0.1-4.29-1.07 c-1.64-1.35-3.9-1.12-5.98-1.07c-1.17,0.02-1.96-0.78-2.01-1.96c-0.02-0.61,0-1.22,0-1.93c0.7-0.04,1.27-0.05,1.83-0.12 c0.31-0.04,0.62-0.16,0.9-0.3c0.48-0.24,0.93-0.73,1.42-0.78c3.66-0.32,7.33-0.56,10.99-0.82c0.05-0.01,0.1-0.01,0.15-0.01 c1.17-0.12,2.41-1.19,2.51-2.35c0.1-1.23,0.02-2.47,0.02-3.7c-1.73-0.36-3.3-0.9-4.9-0.98c-3.01-0.13-6.03,0-9.05,0.03 c-0.43,0-0.99-0.06-1.25,0.17c-1.07,0.95-2.32,0.59-3.51,0.66c-1.57,0.08-2.62-0.97-2.97-2.16c-0.34-1.18-0.19-2.67,0.24-3.85 c0.41-1.13,3.21-1.2,4.42-0.44c0.97,0.61,2.01,1.16,3.09,1.52c0.79,0.26,1.7,0.21,2.56,0.22c2.42,0.05,3.28-0.79,3.32-3.21 c0.02-1.15,0.11-2.31-0.02-3.45c-0.11-0.94-0.49-1.85-0.77-2.77c-0.35-1.1-0.72-2.18-1.14-3.45c0.69-0.05,0.96-0.09,1.24-0.09 c4.31-0.08,8.62-0.14,12.93-0.23c0.51-0.01,1.03-0.12,1.52-0.26c0.68-0.19,1.33-0.66,1.99-0.67c6.85-0.05,13.71-0.02,20.56-0.04 c0.71,0,1.61,0.13,2.1-0.23c1.18-0.87,2.44-0.56,3.67-0.62c1.29-0.05,2.6,0.05,3.87-0.13c0.76-0.11,1.42-0.83,2.18-0.93 c2.31-0.3,4.64,0.04,6.98-0.78c1.36-0.48,1.89-0.92,1.89-2.21c-0.01-1.05,0-2.09,0-3.07c-1.98-0.4-3.74-0.82-5.52-1.07 c-1.03-0.15-2.1-0.02-3.15-0.04c-0.33,0-0.87,0.04-0.95-0.13c-0.68-1.28-1.88-0.93-2.9-0.94c-4.36-0.05-8.72-0.02-13.08-0.03 c-0.42,0-0.84-0.06-1.25-0.16c-0.85-0.21-1.69-0.65-2.53-0.66c-3.74-0.08-7.48-0.04-11.22-0.07c-0.39,0-0.81-0.11-1.19-0.25 c-0.65-0.26-1.27-0.76-1.93-0.82c-1.661-0.151-3.335-0.019-5.007-0.073c-0.629-0.021-1.638-0.204-2.243-0.375 c-0.66-0.186-1.321-0.376-1.99-0.432c-1.57-0.13-3.16-0.02-4.74-0.05c-0.36,0-0.73-0.1-1.06-0.22c-0.75-0.28-1.46-0.83-2.21-0.87 c-2.29-0.12-4.62,0.13-6.89-0.13c-1-0.11-2.34-0.9-2.73-1.74c-0.4-0.87-0.13-2.37,0.4-3.27c0.641-1.095,1.837-1.878,2.791-2.802 c0.176-0.17,0.314-0.377,0.406-0.604c0.418-1.034,0.692-2.09,1.883-2.644c0.49-0.22,0.73-0.96,1.09-1.46 c0.58-0.8,1.01-1.83,1.79-2.34c1.34-0.86,2.7-1.8,4.39-2.05c0.94-0.14,2.19-0.41,2.65-1.07c0.83-1.21,2.16-0.98,3.16-1.63 c1.45-0.94,3.1-1.57,4.65-2.39c0.2-0.1,0.36-0.48,0.37-0.73c0.03-1.66,0.02-3.32,0.02-5.1c-1.93,0-3.73-0.2-5.46,0.05 c-1.77,0.26-3.54,0.82-5.19,1.53c-0.95,0.41-1.55,0.46-2.52,0.01c-1.67-0.76-3.21-2.09-5.31-1.62c-0.77,0.17-1.62,0.05-2.43,0.02 c-1.31-0.03-2.01-0.77-2.04-2.07c-0.03-1.1,0.24-2.39-0.24-3.26c-0.82-1.47-0.5-2.93-0.57-4.4c-0.07-1.35,0.57-1.94,1.93-1.96 c1.81-0.04,3.65,0.03,5.45-0.16c1.45-0.15,2.85-0.78,4.3-0.91c2.1-0.2,4.21-0.09,6.32-0.19c5.64-0.27,11.27-0.58,16.91-0.89 c0.29-0.01,0.59-0.18,0.87-0.31c0.46-0.22,0.9-0.66,1.36-0.68c2.87-0.12,5.74-0.18,8.61-0.21c1.86-0.01,3.49-0.46,4.72-1.98 c0.73-0.91,0.33-3.4-0.5-3.95c-1.54-1.02-3.21-0.87-4.89-0.91c-0.4-0.01-0.81-0.11-1.19-0.25c-0.76-0.27-1.48-0.83-2.23-0.85 c-3.214-0.102-6.428-0.038-9.642-0.061c-0.354-0.003-0.711-0.029-1.053-0.122c-0.859-0.234-1.683-0.63-2.544-0.697 c-1.48-0.12-2.97-0.01-4.46-0.04c-0.35,0-0.72-0.1-1.05-0.23c-0.7-0.28-1.36-0.79-2.07-0.87c-1.37-0.14-2.78,0.05-4.16-0.06 c-4.36-0.36-8.78,0.74-13.14-0.72c-1.01-0.34-1.88-0.84-2.7-1.35c-0.51-0.31-0.85-1.41-0.73-2.06c0.1-0.55,0.9-1.24,1.51-1.38 c1.69-0.39,3.52,0.23,5.11-1.2c0.68-0.6,1.73-0.79,2.03-1.87c0.46-1.59,0.03-3.2-1.02-4.15c-1.15-1.05-2.8-1.57-4.3-2.17 c-0.95-0.37-1.49-0.84-1.48-1.89c0.03-1.58,0.02-3.17-0.01-4.75c-0.01-0.57,0.08-1.42-0.24-1.65c-1.34-0.97-1.03-2.35-1.03-3.6 c-0.03-12.57-0.2-25.14,0.09-37.7c0.09-4.05-0.94-8.2,0.93-12.27c0.93-2.02,0.71-4.58,1.03-6.89c0.16-1.24-0.47-2.69,1-3.6 c0.14-0.09,0.09-0.54,0.09-0.83c0-4.12,0.01-8.25-0.02-12.37c0-0.41-0.16-0.82-0.29-1.22c-0.19-0.59-0.54-1.16-0.6-1.77 c-0.36-3.45-0.65-6.9-0.98-10.35c-0.03-0.31-0.24-0.6-0.38-0.89c-0.22-0.51-0.58-1-0.66-1.53c-0.24-1.69,0.47-3.51-0.81-5.07 c-0.19-0.23-0.19-0.89,0-1.1c1.13-1.21,0.66-2.69,0.81-4.07c0.03-0.33-0.01-0.85,0.17-0.94c1.18-0.61,0.78-1.71,0.9-2.64 c0.31-2.41,0.6-4.82,0.92-7.23c0.02-0.17,0.16-0.32,0.24-0.48c0.28-0.64,0.56-1.28,0.85-1.91c0.32-0.7,0.59-1.93,1-1.98 c1.63-0.19,2.43-1.42,3.43-2.35c1.11-1.02,1.99-2.29,3.34-3.88c1.88-0.27,4.43-0.62,6.97-0.99c0.244-0.035,0.634-0.127,0.864-0.214 c1.441-0.546,2.865-1.399,4.326-1.486c2.42-0.16,3.88-1.4,5.1-3.21c0.42-0.63,0.74-1.32,1.14-1.95c0.73-1.13,0.46-2.45-0.7-3.13 c-1.06-0.64-2.14-1.26-3.22-1.86c-0.79-0.43-1.66-0.72-2.39-1.23c-1.235-0.87-2.388-1.874-3.593-2.814 c-0.497-0.388-1.371-0.934-1.933-1.221c-0.971-0.497-1.952-0.974-2.934-1.465c-1-0.5-2.02-0.97-3.01-1.5 c-1.6-0.84-3.21-1.67-4.75-2.6c-0.37-0.23-0.71-0.84-0.72-1.29c-0.12-4.45-0.14-8.91-0.24-13.37c-0.01-0.63-0.24-1.27-0.47-1.87 c-0.4-1.04-1.01-2.01-1.27-3.07c-0.41-1.62-0.52-3.32-0.9-4.95c-0.19-0.8-1.03-1.52-1.04-2.28c-0.03-2.59-1.5-4.95-1.05-7.62 c0.23-1.35,0.07-2.78,0.01-4.17c-0.02-0.49-0.22-0.99-0.41-1.46c-0.18-0.47-0.63-0.91-0.64-1.37c-0.1-5.89-0.19-11.79-0.2-17.69 c-0.01-43.36-0.01-86.72,0.01-130.09c0-3.59,0.1-7.19,0.18-10.78c0-0.35,0.13-0.72,0.28-1.04c0.23-0.52,0.69-0.98,0.75-1.51 c0.14-1.13-0.01-2.31,0.15-3.44c0.21-1.41,0.24-3.06,1.01-4.12c1.23-1.69,0.93-3.66,1.6-5.44c0.86-2.26-0.54-4.93,1.14-7.29 c1.15-1.62,1.74-3.65,2.56-5.5c0.27-0.59,0.41-1.24,0.72-1.81c0.54-1.02,1.19-1.98,1.75-2.99c0.58-1.04,1.14-2.09,1.63-3.17 c0.67-1.52,2.22-1.88,3.43-2.66c0.92-0.59,2.03-0.89,3.04-1.36c1.51-0.69,3.02-1.38,4.5-2.12c0.5-0.26,1.18-0.59,1.33-1.04 c0.46-1.4,0.79-2.85,1.02-4.31c0.13-0.82-0.4-1.39-1.27-1.39c-3.26,0-6.51,0.03-9.77,0.06c-0.24,0-0.51,0-0.7,0.11 c-2.29,1.29-4.7,0.26-7.06,0.66c-0.05-0.53-0.1-0.81-0.1-1.1c0-8.53,0.13-17.08-0.04-25.61c-0.18-8.49,0.86-17.02-0.84-25.46 c-0.17-0.87-0.26-1.75-0.48-2.61c-0.13-0.53-0.56-0.99-0.63-1.51c-0.16-1.28,0.11-2.69-0.33-3.83c-0.93-2.37-0.35-3.87,2.08-4.61 c1.47-0.44,2.09-2.42,3.94-2.27c0.03,0,0.06-0.17,0.13-0.23c0.85-0.86,1.58-2.12,2.61-2.47c1.65-0.55,2.44-1.96,3.72-2.84 c0.98-0.67,1.86-1.5,2.82-2.2c0.62-0.46,1.31-0.81,1.96-1.23c0.66-0.42,1.31-0.86,1.95-1.31c0.27-0.2,0.49-0.46,0.76-0.67 c0.8-0.63,1.65-1.2,2.4-1.88c1.08-0.97,2.05-2.05,3.13-3.03c1.21-1.1,2.77-1.94,3.64-3.25c1.25-1.87,2.53-3.64,4.13-5.24 c1.47-1.47,2.88-3.08,3.97-4.84c0.72-1.18,2.37-1.65,2.4-3.29c0-0.06,0.14-0.14,0.22-0.16c1.32-0.35,2.61-0.84,3.95-1 c1.36-0.16,2.93-0.39,3.93,0.85c1.2,1.51,2.76,0.97,4.22,1.05c0.96,0.06,1.93,0.15,2.88,0.04c2.29-0.27,4.18,0.69,6.06,1.78 c0.68,0.4,1.4,0.75,2.09,1.13c0.92,0.51,1.83,1.03,2.85,1.6c0-0.01,0.07-0.17,0.19-0.27c0.97-0.86,2.45-1.54,2.79-2.6 C220.411,161.37,220.561,159.38,220.041,157.85z M111.437,192.42c-43.96,0-80.06-33.63-83.96-76.57c-0.27-0.72-0.3-1.53-0.18-2.4 c-0.12-1.77-0.18-3.55-0.18-5.35c0-46.56,37.75-84.31,84.32-84.31c46.56,0,84.31,37.75,84.31,84.31 C195.747,154.67,157.997,192.42,111.437,192.42z",
      "M230.071,128.64c-0.15-1.08-0.7-2.04-2.08-2.04c-0.28,0-0.57-0.25-0.84-0.39 c-0.47-0.25-0.92-0.61-1.42-0.73c-1.45-0.36-2.93-0.61-4.39-0.92c-0.12-0.03-0.22-0.18-0.34-0.23c-0.69-0.31-1.37-0.67-2.09-0.89 c-0.5-0.15-1.09,0.01-1.58-0.15c-1.59-0.49-3.12-1.21-4.73-1.56c-0.84-0.18-1.56-0.25-1.9-1.1c-0.26-0.64-0.44-1.3-0.58-1.71 c-0.72-0.61-1.66-1-1.81-1.59c-0.47-1.97-0.84-4-0.92-6.01c-0.17-4.38-0.13-8.76-0.19-13.14c0-0.39,0.08-0.98-0.12-1.13 c-1.52-1.11-0.88-2.72-1.05-4.13c-0.09-0.72-0.04-1.47-0.24-2.16c-0.52-1.81-1.24-3.58-1.68-5.41c-0.47-1.99-0.71-4.03-1.05-6.05 c-0.02-0.15-0.03-0.35-0.12-0.41c-1.51-0.98-1.28-2.82-1.53-4.12c-0.44-2.32-1.97-4.02-2.61-6.16c-0.4-1.34-1.17-2.57-1.71-3.87 c-0.68-1.62-1.18-3.32-1.99-4.86c-0.81-1.54-2.08-2.85-2.84-4.42c-0.66-1.35-0.85-2.94-2.05-4.04c-0.1-0.09-0.05-0.51,0.07-0.66 c0.56-0.66,1.05-1.5,1.78-1.88c1.3-0.68,1.3-1.76,1.31-2.91c0.01-1.17-0.04-2.34,0.01-3.51c0.07-1.48-0.62-2.06-2.07-2.04 c-3.26,0.04-6.52,0.06-9.78-0.01c-0.7-0.02-1.46-0.33-2.05-0.72c-1.1-0.72-2.12-1.56-3.13-2.4c-0.54-0.45-0.96-1.03-1.48-1.5 c-0.43-0.39-0.99-0.65-1.4-1.06c-1.1-1.08-2.85-1.27-3.64-2.8c-0.26-0.51-0.8-0.93-1.31-1.26c-1.904-1.241-3.992-2.242-5.711-3.712 c-0.881-0.754-1.89-1.335-2.86-1.97c-0.607-0.397-1.054-1.111-1.699-1.348c-2.2-0.8-3.28-2.91-5.09-4.15 c-1.33-0.92-1.84-2.72-3.74-3.11c-0.83-0.18-1.88-1.09-2.14-1.89c-0.88-2.71-2.14-5.37-1.84-8.36c0.05-0.48,0.01-0.96,0.01-1.34 c-1.25-1.09-2.38-0.97-3.36,0.1c-0.89,0.97-1.57,2.15-2.54,3.02c-1.43,1.29-2.97,2.51-4.61,3.52c-0.69,0.42-1.38,0.67-2.02,1.31 c-0.9,0.89-2.2,1.64-3.43,1.85c-1.8,0.3-3.69,0.07-5.53,0.05c-0.18,0-0.48-0.07-0.53-0.18c-0.47-1.14-1.47-0.93-2.36-0.94 c-6.56-0.01-13.14-0.04-19.7,0.04c-1.54,0.02-3.04-0.25-4.58,0.97c-1.14,0.9-3.14,0.73-4.76,1.02c-2.09,0.36-4.19,0.69-6.29,1.07 c-0.19,0.03-0.33,0.28-0.53,0.39c-0.37,0.22-0.74,0.54-1.14,0.59c-2.19,0.29-4.26,0.71-6.23,1.94c-1.53,0.96-3.44,1.68-5.22,1.77 c-1.75,0.09-2.67,1.41-4.14,1.82c-1.55,0.42-2.99,0.65-4.48-0.1c-0.81-0.405-1.626-0.816-2.452-1.201 c-0.68-0.317-1.835-0.735-2.558-0.934c-1.54-0.425-3.106-0.796-4.66-1.225c-0.36-0.1-0.75-0.28-1-0.54 c-1.13-1.22-3.97-1.95-5.53-1.35c-0.17,0.06-0.44,0.21-0.43,0.31c0.02,1.69-0.44,3.69,0.31,4.96c0.62,1.05,0.67,1.93,0.85,2.94 c0.3,1.71,0.65,3.4,0.99,5.1c0.03,0.13,0.11,0.31,0.22,0.36c1.21,0.52,0.68,1.35,0.48,2.21c-2.65,0-5.23,0-7.8-0.01 c-0.24,0-0.59,0.01-0.69-0.13c-1.25-1.66-3.02-0.97-4.53-0.83c-0.67,0.07-1.56,1.09-1.79,1.86c-0.3,0.97-0.07,2.11,0.02,3.18 c0.03,0.3,0.32,0.68,0.6,0.85c0.79,0.49,1.63,0.88,2.41,1.29c0,1.61-0.25,3.18,0.06,4.61c0.44,1.98-0.79,3.3-1.41,4.84 c-0.37,0.91-1.12,1.68-1.74,2.48c-0.65,0.86-1.47,1.62-1.97,2.56c-1.056,1.961-2.123,3.875-3.665,5.518 c-0.045,0.048-0.085,0.103-0.115,0.162c-0.62,1.2-1.26,2.38-1.81,3.61c-0.52,1.15-0.65,2.41-1.51,3.5c-0.8,1-1.09,2.41-1.63,3.63 c-0.4,0.91-0.89,1.79-1.23,2.73c-0.65,1.77-0.53,3.74-1.91,5.36c-0.96,1.12-1.31,2.75-2.03,4.1c-0.74,1.37-1.69,2.45-3.49,2.5 c-1.86,0.04-3.37,1.92-3.6,3.77c-0.44,3.62,2.49,5.16,4.33,7.38c0.29,0.36,0.73,0.77,0.74,1.17c0.06,1.95,0,3.9-0.04,5.84 c0,0.27-0.16,0.53-0.27,0.79c-0.22,0.58-0.62,1.14-0.66,1.73c-0.1,1.31-0.05,2.63-0.02,3.94c0,0.38,0.07,0.77,0.19,1.13 c0.27,0.77,0.78,1.51,0.84,2.29c0.15,1.79,0.08,3.6,0.11,5.4c0.01,0.78-0.28,1.79,0.1,2.29c1.42,1.91,0.12,4.44,1.72,6.36 c0.72,0.86,0.64,2.41,0.9,3.65c0.5,2.35,1.18,4.66,1.83,6.96c0.68,2.41,2.51,4.36,2.52,7.02c0,0.81,0.91,1.59,1.32,2.43 c0.52,1.07,0.95,2.19,1.43,3.28c0.11,0.24,0.28,0.45,0.41,0.68c0.56,1,1.12,1.99,1.67,2.99c0.32,0.59,0.48,1.5,0.98,1.75 c1.39,0.69,1.07,2.22,1.83,3.18c0.47,0.6,0.82,1.29,1.25,1.92c0.26,0.37,0.56,0.71,0.83,1.08c0.52,0.72,1.09,1.41,1.54,2.17 c0.52,0.89,1.47,2.02,1.24,2.71c-0.31,0.91-1.5,1.63-2.46,2.18c-1.59,0.9-3.29,1.6-4.94,2.38c-0.45,0.21-0.9,0.41-1.35,0.63 c-0.95,0.47-1.92,0.92-2.85,1.45c-0.71,0.42-1.35,0.98-2.05,1.42c-0.99,0.63-2.06,1.14-3,1.82c-0.81,0.58-1.46,1.39-2.27,1.98 c-0.53,0.4-1.41,0.43-1.81,0.9c-0.87,1.04-1.78,2-2.43,3.31c-0.93,1.85-0.62,3.28,0.36,4.67c0.71,1,1.81,1.7,3.22,1.44 c2.79-0.51,5.68,0.59,8.47-0.8c1.08-0.54,2.59-0.18,3.9-0.27c0.42-0.02,1.09-0.02,1.21-0.26c0.52-1.03,1.44-0.76,2.26-0.9 c1.76-0.28,3.52-0.6,5.28-0.92c0.13-0.02,0.33-0.1,0.37-0.21c0.43-1.07,1.39-0.83,2.22-0.9c0.63-0.06,1.27-0.03,1.88-0.15 c2.21-0.43,4.39-1,6.61-1.36c1.77-0.29,3.57-0.02,5.09,0.93c1.33,0.83,2.43,2.06,4.19,1.92c0.07,0,0.14,0.24,0.25,0.32 c0.96,0.71,1.94,1.41,3.11,2.26c-0.03,0.78,0.72,2.01-0.9,2.62c-0.11,0.05-0.12,0.35-0.21,0.52c-0.68,1.31-1.35,2.63-2.06,3.93 c-0.41,0.75-0.86,1.47-1.32,2.17c-0.52,0.79-1.16,1.5-1.6,2.33c-0.46,0.86-0.7,1.84-1.11,2.73c-0.56,1.22-1.46,2.35-1.74,3.63 c-0.31,1.34-0.12,2.81-0.03,4.22c0.08,1.17,0.87,1.95,2,2.03c1.38,0.09,2.83,0.58,4.1-0.64c0.75-0.73,1.82-1.11,2.66-1.76 c0.66-0.5,1.45-1.08,1.73-1.8c0.87-2.3,2.93-3.51,4.48-5.18c0.47-0.51,1.29-0.68,1.83-1.15c1.39-1.22,2.56-2.77,4.1-3.71 c1.46-0.88,3.26-1.31,4.97-1.65c1.24-0.24,2.38,0.18,3.64,0.89c2.31,1.31,5.28,0.57,7.75,2.06c1.12,0.68,2.84,0.67,4.2,0.82 c2.23,0.25,4.29,0.73,6.53,1.79c-0.24,0.43-0.46,0.94-0.77,1.4c-0.4,0.57-0.99,1.05-1.28,1.67c-0.79,1.67-1.35,3.39-1.07,5.31 c0.19,1.25,2.23,3.39,3.42,3.12c1.23-0.27,2.54-0.81,3.48-1.62c1.48-1.28,2.63-2.93,4.01-4.33c1.1-1.12,2.36-2.08,3.53-3.12 c0.71-0.64,1.3-1.64,2.12-1.89c1.76-0.52,3.64-0.61,5.45-0.97c1.79-0.35,3.55,0.17,5.46-0.91c1.89-1.06,4.51-0.98,6.82-1.09 c2.82-0.13,2.63-0.62,2.63,2.59c0,57.42,0.02,114.83-0.06,172.25c0,4.23,0.83,8.54-0.79,12.73c-0.62,1.6-0.25,3.38-1,5.17 c-0.81,1.94-0.89,4.43-1.01,6.62c-0.34,6.56-0.12,13.14-0.11,19.72c0,0.48-0.12,1.18,0.15,1.41c1.43,1.27-0.05,3.62,1.8,4.67 c0.34,3.04,0.98,6.08,0.99,9.12c0.06,52.79,0.04,105.58,0.04,158.37c0,3.16,0,6.33-0.03,9.49c0,0.57-0.12,1.14-0.26,1.69 c-0.19,0.72-0.64,1.41-0.66,2.11c-0.11,3.56-0.11,7.11-0.16,10.67c-0.01,0.42-0.1,0.85-0.21,1.27c-0.2,0.8-0.52,1.58-0.66,2.4 c-0.17,0.95-0.16,1.93-0.31,2.89c-0.16,1.01-0.64,2.01-0.6,2.99c0.16,3.93,0.47,7.84,0.73,11.76c0.01,0.09,0.01,0.19,0.03,0.29 c0.02,0.09,0.03,0.25,0.09,0.26c1.53,0.52,1.01,1.83,1.01,2.84c0.04,8.82,0.12,17.63-0.03,26.45c-0.05,2.65,0.87,5.42-0.97,8.02 c-0.8,1.12-0.72,2.87-1.05,4.32c-0.05,0.23-0.17,0.43-0.26,0.64c-0.55,1.3-1.35,2.55-1.59,3.9c-0.47,2.59-1.33,5.12-1.07,7.86 c0.22,2.37-0.05,4.78,0.08,7.16c0.1,1.83,0.58,3.64,0.72,5.47c0.11,1.56-0.68,2.28-2.23,2.29c-2.87,0.02-5.74-0.01-8.61,0.03 c-0.6,0.01-1.54,0.04-1.74,0.4c-0.54,0.93-1.29,0.71-2.03,0.74c-1.89,0.09-3.92-0.26-5.63,0.33c-1.64,0.56-3.18,0.44-4.77,0.55 c-0.77,0.05-1.56,0-2.33,0.04c-0.39,0.03-0.99,0.03-1.1,0.25c-0.72,1.33-1.93,0.77-2.95,0.89c-0.68,0.07-1.56-0.12-1.99,0.24 c-1.51,1.3-3.91-0.13-5.14,1.79c-2.12-0.02-4.15,0.22-6.23,0.82c-1.96,0.56-2.12,0.32-2.18,2.44c-0.01,0.34-0.01,0.69,0,1.03 c0.06,1.68,2.24,2.98,3.84,2.46c2.01-0.65,4.08-1.5,6.15-1.56c7.1-0.21,14.21-0.12,21.31-0.12c0.47-0.01,0.99,0.07,1.4,0.28 c1.67,0.85,3.32,1.62,5.27,1.47c0.64-0.05,1.32,0.15,1.95,0.35c0.64,0.19,1.22,0.71,1.84,0.75c3.19,0.16,3.22,0.16,3.33,3.45 c0.02,0.47,0.05,1.22,0.31,1.34c2.07,0.98,1.89,2.8,1.64,4.51c-0.1,0.64-0.81,1.33-1.41,1.69c-0.29,0.17-1-0.36-1.53-0.56 c-0.43-0.16-0.87-0.4-1.32-0.42c-1.21-0.07-2.43-0.01-3.65-0.06c-0.4-0.01-0.97-0.03-1.18-0.29c-1.01-1.21-2.46-2.07-2.96-3.72 c-0.12-0.39-0.73-0.77-1.18-0.88c-0.64-0.15-1.36,0-2.03-0.08c-3.01-0.39-4.31,2.14-4.4,4.43c-0.18,4.77-0.13,9.54-0.14,14.31 c-0.01,2.82,2.03,4.69,4.86,4.52c0.33-0.03,0.71,0,1-0.14c0.39-0.2,0.79-0.49,1.05-0.84c0.57-0.81,0.87-2.08,1.62-2.43 c1.73-0.79,3.65-1.22,5.52-1.65c1.12-0.26,2.33-0.11,3.44-0.37c0.5-0.12,0.83-1.12,1.47-0.21c0.36,0.51,0.86,1.02,0.95,1.59 c0.16,0.95,0.03,1.94,0.06,2.91c0.02,0.73-0.3,1.6,0.72,2.02c0.1,0.04,0.07,0.87-0.06,0.92c-0.9,0.37-1.84,0.86-2.77,0.87 c-4.38,0.09-8.76-0.08-13.14,0.08c-4.25,0.15-8.48,0.6-12.73,0.93c-0.14,0.01-0.29,0.04-0.42,0.1c-0.18,0.06-0.46,0.13-0.49,0.24 c-0.27,1.05-1.1,0.74-1.78,0.78c-1.26,0.07-2.71-0.25-3.73,0.27c-1.56,0.79-3.07,0.49-4.61,0.6c-0.83,0.06-1.66-0.02-2.48,0.05 c-0.46,0.04-0.92,0.23-1.36,0.4c-0.57,0.22-1.11,0.68-1.66,0.69c-5.74,0.12-11.48,0.25-17.22,0.19c-2.94-0.03-5.8,0.32-8.66,0.89 c-1.92,0.38-3.87,0.56-5.81,0.84c-0.14,0.02-0.37,0.03-0.41,0.11c-0.64,1.38-1.89,0.79-2.91,0.91c-0.67,0.07-1.58-0.17-1.99,0.19 c-1.16,1-2.45,0.58-3.69,0.69c-0.83,0.07-1.68,0-2.47,0.2c-0.46,0.12-0.79,0.86-1.24,0.91c-2.91,0.37-5.84,0.62-8.76,0.91 c-0.15,0.01-0.35-0.02-0.43,0.06c-0.65,0.68-1.53,1.29-1.85,2.11c-0.31,0.78,0.21,1.51,0.84,2.36c1.3,1.76,2.87,2,4.54,1.69 c2.76-0.49,5.54,0.64,8.38-0.92c1.96-1.08,4.67-0.8,7.06-1.06c1.06-0.12,2.14-0.03,3.21-0.09c0.36-0.02,0.71-0.16,1.05-0.3 c0.57-0.23,1.13-0.71,1.7-0.71c7.2-0.09,14.42,0.25,21.57-0.98c0.95-0.16,1.86-0.79,2.8-0.8c8.27-0.06,16.54-0.03,24.81-0.02 c0.44,0,1.03-0.11,1.28,0.12c1.16,1.09,2.55,0.69,3.86,0.72c2.62,0.06,5.26-0.04,7.88,0.09c3.92,0.2,7.83,0.57,11.75,0.79 c0.98,0.06,1.1,0.61,1.1,1.33c0.03,2.39,0.05,4.78,0.05,7.16c-0.01,2.02-1.87,3.14-3.77,2.39c-0.95-0.37-1.99-0.7-2.98-0.7 c-10.76-0.06-21.51-0.02-32.27-0.07c-1.58-0.01-3.37,0.66-4.65-0.97c-0.08-0.09-0.27-0.11-0.41-0.13 c-2.93-0.32-5.86-0.62-8.79-0.95c-0.4-0.04-0.8-0.18-1.18-0.33c-0.57-0.24-1.13-0.77-1.69-0.77c-7.35-0.03-14.69,0-22.04,0.04 c-0.95,0-2.27,1.35-2.31,2.29c-0.03,0.86-0.1,1.62,1.01,2.08c0.65,0.27,0.96,1.53,1.59,1.68c1.92,0.48,3.91,0.63,5.87,0.93 c1.04,0.15,2.37-0.55,2.94,1.01c0.04,0.1,0.36,0.11,0.55,0.12c3.51,0.33,7.01,0.67,10.52,0.95c1.16,0.1,2.34,0.02,3.5,0.08 c0.4,0.02,0.79,0.25,1.19,0.39c0.5,0.18,1.01,0.52,1.52,0.53c2.43,0.06,4.86,0.01,7.3,0.06c0.65,0.01,1.3,0.23,1.94,0.4 c0.48,0.13,0.93,0.46,1.4,0.46c7.84,0.09,15.67,0.05,23.5,0.23c5.81,0.13,11.61,0.48,17.4,0.86c0.64,0.05,1.54,0.85,1.76,1.49 c0.49,1.43,1.55,2.76,1.15,4.45c-0.06,0.27,0.33,0.63,0.48,0.97c0.55,1.25,1.09,2.51,1.63,3.77c-0.137,0.184-0.17,0.23-0.307,0.414 c-0.944-0.093-1.899-0.132-2.823-0.294c-0.59-0.1-1.13-0.53-1.7-0.54c-6.96-0.1-13.91-0.14-20.87-0.22 c-1.08-0.01-2.29,0.4-3.09-0.88c-0.16-0.27-0.9-0.25-1.38-0.26c-1.6-0.03-3.21-0.01-4.82-0.01c-0.33-0.01-0.83,0.09-0.99-0.09 c-0.91-1.09-2.14-0.72-3.26-0.77c-1.26-0.05-2.53,0.01-3.79-0.02c-0.36-0.01-0.72-0.14-1.05-0.29c-0.58-0.25-1.11-0.75-1.7-0.82 c-2.88-0.32-5.74-0.13-8.66-0.74c-3.27-0.68-6.78-0.21-10.19-0.18c-0.48,0-1.14,0.2-1.4,0.55c-0.9,1.21,0.09,4.17,1.51,4.44 c2.01,0.39,4.05,0.6,6.08,0.87c0.72,0.1,1.84-0.1,2.09,0.29c0.78,1.21,1.85,0.74,2.83,0.84c0.92,0.1,2.04-0.16,2.7,0.29 c1.05,0.71,2.08,0.6,3.16,0.65c1.06,0.05,2.18-0.07,3.19,0.21c1.63,0.45,3.16,1.3,4.8,1.72c1.71,0.45,3.48,0.08,5.27,1.06 c1.43,0.78,3.44,0.32,5.23,0.91c2.13,0.71,4.5-0.02,6.83,0.88c2.46,0.95,5.22,0.01,8.01,1.07c3.13,1.19,6.86,0.81,10.33,1.12 c0.57,0.05,1.18,0.03,1.68,0.26c0.64,0.3,1.17,0.82,1.75,1.24c0.15-0.02,0.31-0.05,0.46-0.08c-0.1,1.18,0.17,2.59-0.39,3.5 c-0.86,1.38-2.53,1.97-4.19,2.02c-3.25,0.08-6.51,0.02-9.76,0.07c-1.86,0.03-2.68,0.94-2.66,2.81c0.01,0.93,1.47,3.14,2.4,3.36 c1.65,0.4,3.33,0.82,5.01,0.9c3.06,0.14,6.13,0.03,9.19,0.05c1.58,0,2.3,0.73,2.31,2.34c0.02,3.12,0.22,6.25-0.07,9.34 c-0.2,2.13,1.22,2.97,2.27,4.19c0.09,0.1,0.56,0.01,0.73-0.14c0.99-0.82,1.37-1.83,1.28-3.18c-0.06-1.03,0.45-2.08,0.6-3.13 c0.26-1.95-0.25-4.06,1.26-5.73c0.28-5.74,0.56-11.48,0.85-17.22c0.04-0.83,0.14-1.66,0.12-2.48c-0.08-3.46,0.65-6.86,0.83-10.28 c0.13-2.46-0.51-4.96-0.75-7.44c-0.12-1.26,0.28-2.76-0.28-3.74c-0.87-1.54-0.47-3.05-0.63-4.58c-0.05-0.53,0.01-1.07-0.06-1.6 c-0.05-0.37-0.12-0.96-0.36-1.06c-0.97-0.44-0.73-1.24-0.75-1.98c-0.04-1.8,0.39-3.78-0.24-5.34c-0.66-1.64-0.54-3.17-0.62-4.76 c-0.07-1.22-0.02-2.44-0.04-3.65c-0.01-0.44,0.04-1.1-0.2-1.26c-1.41-0.94-0.74-2.36-0.95-3.57c-0.24-1.44-0.63-2.87-0.69-4.32 c-0.07-1.59-0.67-3.32,0.58-4.74c0.21-0.24,0.92-0.42,1-0.32c0.42,0.54,0.88,1.15,1.01,1.8c0.31,1.52-0.14,3.06,1.03,4.58 c1.02,1.3,1.22,3.22,1.85,4.85c0.34,0.86,0.86,1.64,1.25,2.49c0.27,0.58,0.43,1.22,0.69,1.82c0.46,1.07,0.96,2.13,1.45,3.19 c0.52,1.12,1.04,2.24,1.56,3.35c0.41,0.87,1.05,1.69,1.2,2.59c0.41,2.58,0.73,5.18,0.87,7.78c0.17,3.21,0.12,6.43,0.19,9.64 c0.01,0.43-0.01,1.08,0.24,1.23c1.04,0.66,0.84,1.66,0.91,2.6c0.27,3.54-0.37,7.08,0.66,10.64c0.5,1.72,1.74,2.57,2.66,3.79 c0.16,0.21,0.75,0.19,1.12,0.12c0.62-0.12,2.42-2.53,2.46-3.18c0.51-8.75-0.35-17.53,0.71-26.29c0.41-3.38-0.31-6.91-0.58-10.36 c-0.09-1.15,0.49-2.57-1.1-3.24c-0.11-0.04-0.11-0.35-0.13-0.54c-0.3-2.81-0.59-5.62-0.9-8.42c-0.05-0.47-0.11-1.21-0.38-1.33 c-1.02-0.43-0.73-1.26-0.78-1.97c-0.08-1.11,0.3-2.53-0.25-3.27c-0.83-1.1-0.52-2.02-0.49-3.05c1.99-0.43,3.75-1.81,5.74-0.95 c0.39,2.88,0.85,5.69,1.14,8.52c0.23,2.29,1.01,4.26,2.89,5.63c0.45,0.33,1.22,0.47,1.77,0.35c0.76-0.15,1.45-0.63,2.3-1.03 c0-2.53-0.02-5.15,0.02-7.78c0.01-0.86-0.14-1.96,0.31-2.53c0.91-1.16,0.53-1.98-0.12-2.77c0.48-1.75,1.76-1.6,3.07-1.64 c6.71-0.25,13.42-0.57,20.13-0.87c0.19,0,0.39-0.03,0.58-0.06c2.915-0.587,5.795-1.362,8.816-1.146 c1.388,0.099,2.779,0.185,4.166,0.067c1.583-0.135,3.2,0.101,4.658-0.921c0.97-0.68,1.69-1.88,1.18-3.28 c-0.25-0.68-1.16-1.55-1.81-1.58c-5.95-0.3-11.92-0.12-17.83-1.11c-0.37-0.06-0.98-0.04-1.06-0.23c-0.47-1.12-1.42-0.85-2.25-0.88 c-1.79-0.07-3.78,0.4-5.34-0.22c-1.54-0.62-2.97-0.51-4.46-0.69c-4.45-0.53-9.09,1.2-13.37-1.14c-0.57-0.31-1.22-0.55-1.66-0.99 c-1.16-1.18-2.18-2.5-3.35-3.68c-1.89-1.9-3.88-3.71-5.77-5.62c-1.11-1.1-1.9-2.74-3.21-3.36c-1.71-0.81-2.94-1.96-4.27-3.2 c-1.45-1.36-3.25-2.35-5.13-3.67v-1.37c2.39,0.23,4.78-0.38,6.81,1.6c0.74,0.73,2.1,1.17,3.17,1.15c2.07-0.06,2.81-1.1,2.83-3.22 c0.012-1.029,0.105-2.072-0.135-3.065c-0.126-0.522-0.594-1.242-0.983-1.612c-0.994-0.944-2.204-1.718-2.982-2.803 c-1.18-1.62-2.71-2.7-4.3-3.8c-0.66-0.45-1.27-1.04-1.77-1.68c-0.62-0.77-1.01-1.75-1.67-2.48c-0.7-0.79-1.07-1.55-1.07-2.66 c0.04-25.52,0.02-51.03,0.09-76.55c0.01-2.45,0.54-4.89,0.86-7.33c0.02-0.2,0.28-0.36,0.38-0.56c0.51-1.02,1.37-2.03,1.42-3.07 c0.2-4.67,0.37-9.36,0.15-14.02c-0.23-4.6,0.89-9.24-0.91-13.86c-0.97-2.5-0.76-5.45-1.08-8.2c-0.06-0.53-0.12-1.06-0.22-1.59 c-0.17-0.92-0.53-1.84-0.54-2.75c0-1.6-0.1-3.16,0.52-4.8c0.54-1.42,0.41-3.2,0.21-4.77c-0.37-2.8,0.82-5.35,0.97-8.05 c0.01-0.14,0.05-0.36,0.14-0.4c1.26-0.61,0.84-1.8,0.99-2.79c0.06-0.43-0.11-1.04,0.12-1.27c1.46-1.45,0.73-3.5,1.61-5.25 c1.1-2.2-0.12-5.19,1.07-7.68c0.04-9.5,0.1-18.99,0.12-28.49c0-1.74,0.34-3.72-0.35-5.18c-0.85-1.83-0.55-3.56-0.74-5.33 c-0.04-0.36-0.16-0.73-0.31-1.07c-0.25-0.56-0.68-1.08-0.79-1.67c-0.37-2.01-0.64-4.05-0.95-6.07 c-0.018-0.064-0.035-0.126-0.053-0.19c-0.547-1.29-1.442-2.513-1.707-3.87c-0.47-2.46-0.88-4.98-0.88-7.47 c-0.04-51.72-0.02-103.44-0.05-155.15c0-2.24,0.68-3.89,2.54-5.13c0.81-0.53,1.5-1.26,2.19-1.96c1.11-1.12,2.13-2.32,3.27-3.39 c0.39-0.36,1.19-0.28,1.57-0.64c1.32-1.26,2.51-2.66,3.81-3.95c1.03-1.02,2.18-1.94,3.2-2.97c1.34-1.36,2.58-2.82,3.92-4.18 c1.21-1.22,2.62-2.26,3.72-3.58c1.17-1.4,2.28-2.77,4.14-3.27c0.14-0.04,0.24-0.28,0.35-0.43c1.26-1.87,1.11-3.98,0.97-6.07 c-0.02-0.38-0.44-0.97-0.78-1.06c-2.42-0.64-4.68,0.12-6.93,0.92c-0.29,1.52-1.89,1.12-2.8,1.7c-1.15,0.74-2.85,0.01-4.3,1.16 c-0.88,0.7-2.61,0.58-3.96,0.92c-1.74,0.44-3.32,1.03-4.92,2.07c-0.1-0.55-0.25-1.01-0.25-1.47c0-2.48-0.03-4.97,0.07-7.45 c0.23-5.62,0.14-11.24,0.73-16.88c0.56-5.39-0.01-10.89-0.04-16.34c-0.03-6.04,0.03-12.08-0.03-18.12 c-0.03-2.15,0.05-4.26-0.48-6.46c-0.76-3.17-0.78-6.51-1.2-9.77c-0.11-0.84-0.54-1.64-0.8-2.46c-0.06-0.22-0.15-0.54-0.04-0.67 c0.72-0.89,1.46-1.75,2.24-2.59c1.82-1.97,3.8-3.81,5.45-5.92c1.33-1.69,2.58-3.28,4.76-3.9c0.76-0.21,1.55-0.62,2.13-1.15 c1.19-1.11,2.12-2.36,3.81-3.06c1.74-0.72,3.12-2.32,4.64-3.56c0.41-0.33,0.73-0.78,1.16-1.07c2.04-1.42,4.11-2.79,6.15-4.21 c0.29-0.2,0.44-0.61,0.73-0.8c1.46-0.91,3.01-1.69,4.41-2.68c1.16-0.81,2.17-1.83,3.2-2.8c0.46-0.44,0.86-0.97,1.18-1.51 c0.4-0.68,0.54-1.55,1.06-2.09c1.159-1.21,1.822-2.544,1.82-4.222c0-0.258,0.046-0.516,0.159-0.747c0.97-1.97,2.06-3.9,2.95-5.92 c1.15-2.6,2.08-5.3,3.24-7.89c1.04-2.33,2.44-4.52,3.34-6.89c0.61-1.59,1.59-2.02,3.03-2.03c3.99-0.03,7.99-0.22,11.96,0.02 c2.25,0.14,3.79-1.49,5.85-1.66c0.717-0.051,1.424-0.522,2.077-0.886c0.846-0.472,1.672-0.976,2.476-1.516 c0.646-0.434,1.381-0.838,1.917-1.398C230.441,131.98,230.311,130.27,230.071,128.64z M111.437,192.42 c-46.57,0-84.32-37.75-84.32-84.32c0-46.56,37.75-84.31,84.32-84.31c46.56,0,84.31,37.75,84.31,84.31 C195.747,154.67,157.997,192.42,111.437,192.42z"
    ],
    clocks: {
      size: 169,
      0: { x: 111.011, y: 108.5 }
    }
  },
  2: {
    height: 625.438,
    width: 197.009,
    path: "M193.86,271.21c-2.234-2.626-5.64-4.792-8.929-5.835c-6.793-2.153-11.841,2.196-17.463,7.369 c-5.009-25.727-17.583-43.987-38.477-54.246l-18.909-21.56v-12l20.773-23.686c19.55-10.446,31.402-28.304,36.229-53.096 c5.622,5.174,10.67,9.523,17.463,7.369c3.289-1.043,6.695-3.208,8.929-5.835c4.877-5.734,3.879-14.302-1.542-19.605 c-6.442-6.301-13.569-5.549-24.852,3.382c-4.816-25.231-17.183-43.587-38.409-54.031h0.158c-1.506-0.732-3.056-1.394-4.625-2.025 c-2.997-1.25-6.144-2.365-9.463-3.327c0,0-0.527-0.089-1.457-0.217c-2.421-0.731-4.757-2.02-7.743-3.273 c2.103-2.282,3.255-3.455,4.321-4.703c5.176-6.057,4.821-14.978-0.792-20.538c-5.647-5.594-14.543-5.829-20.352-0.539 c-6.101,5.556-6.808,14.49-1.648,20.831c4.153,5.103,3.905,5.403-2.49,8.055c-1.793,0.744-3.604,1.465-5.417,2.187 c-10.281,3.032-16.092,6.929-22.875,12.001c-12.415,9.284-19.739,22.385-23.521,37.515c-0.673,2.693-2.08,5.2-3.437,8.492 c-2.262-2.122-3.424-3.284-4.661-4.36c-6.003-5.222-14.845-4.864-20.356,0.799c-5.544,5.698-5.778,14.673-0.534,20.534 c5.507,6.156,14.361,6.869,20.646,1.662c5.058-4.19,5.355-3.94,7.984,2.512c3.394,8.33,6.292,17.054,10.972,24.62 c6.032,9.752,14.303,16.873,24.096,21.915l21.601,23.357v12l-20.223,21.867c-10.232,5.068-18.855,12.348-25.091,22.43 c-4.68,7.566-7.578,16.29-10.972,24.62c-2.629,6.452-2.926,6.702-7.984,2.512c-6.285-5.206-15.139-4.493-20.646,1.662 c-5.243,5.861-5.01,14.837,0.534,20.534c5.511,5.663,14.352,6.021,20.356,0.799c1.237-1.076,2.399-2.238,4.661-4.36 c1.356,3.292,2.764,5.799,3.437,8.492c3.782,15.13,11.106,28.232,23.521,37.515c7.877,5.89,14.425,10.198,28.206,13.404 c1.38,0.321,2.787,0.579,4.201,0.789c0.031,27.796,0.06,69.604,0.085,105.236c0.009,13.829,0.018,26.73,0.026,37.518 c0,0.826-0.08,1.652-0.121,2.436c-3.447,0.597-4.58-0.495-4.682-4.511c-0.072-2.822-0.002-5.649-0.016-8.473 c-0.024-4.802-0.891-5.97-4.609-5.976c-14.432-0.022-28.864-0.01-43.295-0.009c-4.627,0-9.255,0.084-13.881-0.022 c-3.054-0.07-4.428,1.698-4.326,5.623c0.079,3.039,0.085,6.08-0.001,9.119c-0.111,3.933,1.27,5.674,4.317,5.646 c8.372-0.076,16.745-0.038,25.118-0.024c4.14,0.007,4.933,1.055,4.947,6.397c0.024,9.702,0.024,9.702-7.67,9.702 c-7.381-0.001-14.762-0.025-22.143,0.006c-3.558,0.015-4.54,1.209-4.551,5.611c-0.035,13.947-0.943,13.109,10.004,13.035 c6.61-0.045,13.22-0.032,19.83,0.002c3.528,0.018,4.463,1.226,4.534,5.638c0.17,10.455,0.17,10.455-8.056,10.455 c-7.271,0-14.542-0.024-21.813,0.01c-3.492,0.016-4.48,1.263-4.503,5.672c-0.067,12.642-0.701,12.243,9.397,12.129 c6.83-0.077,13.661-0.04,20.491-0.004c3.466,0.018,4.419,1.281,4.484,5.702c0.154,10.39,0.154,10.39-8.106,10.39 c-7.271,0-14.542-0.026-21.813,0.01c-3.447,0.017-4.439,1.296-4.452,5.736c-0.039,13.671-0.908,12.955,9.772,12.916 c17.076-0.063,34.152-0.012,51.227-0.02c4.329-0.002,5.098-1.02,5.1-6.63c0.001-1.977-0.037-3.956,0.007-5.931 c0.094-4.282,1.178-5.371,4.197-4.937c1.031,10.07,1.909,19.99,3.129,29.842c0.425,3.429,1.312,6.98,2.695,9.93 c1.2,2.56,3.388,5.993,5.16,6.013c1.744,0.02,4.469-3.383,5.098-5.954c2.029-8.292,4.037-16.802,4.667-25.395 c0.85-11.612,0.501-23.379,0.517-35.079c0.042-30.977,0.078-68.798,0.115-106.572c0.037-37.246,0.075-74.445,0.121-104.988 c3.105-0.304,5.045-0.635,5.045-0.635c29.872-8.658,46.55-29.062,52.338-59.383c11.283,8.931,18.409,9.683,24.852,3.382 C197.739,285.512,198.737,276.945,193.86,271.21z M44.186,100.381c0-29.823,24.177-54,54-54s54,24.177,54,54 c0,29.823-24.177,54-54,54S44.186,130.205,44.186,100.381z M98.186,334.381c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54 s54,24.177,54,54C152.186,310.205,128.009,334.381,98.186,334.381z",
    clocks: {
      size: 108,
      0: { x: 98.579, y: 280 },
      1: { x: 98.579, y: 100 }
    }
  },
  3: {
    height: 915.936,
    width: 277.634,
    path: "M263.752,257.836c-13.719,1.508,3.345-15.515,3.955-23.109l-0.113,0.113 c8.127-22.574,2.75-46.079-10.802-65.608c14.365-1.735,19.981-6.287,20.122-15.339c0.118-7.617-5.228-14.388-12.762-14.963 c-3.451-0.263-7.412,0.636-10.496,2.245c-6.369,3.324-6.896,10.001-7.248,17.67c-12.146-8.157-24.329-12.988-36.575-14.34 c-2.94-2.54-4.264-6.236-3.879-10.997c0.451-5.587,0.239-11.066-0.572-16.359c0.828-2.872,1.549-5.847,2.156-8.934 c5.672,5.174,10.766,9.523,17.62,7.369c3.319-1.043,6.755-3.208,9.009-5.835c4.921-5.734,3.914-14.302-1.556-19.605 c-6.5-6.301-13.69-5.549-25.075,3.382c-5.055-30.578-25.967-51.62-54.619-60.047c-2.447-0.732-4.807-2.023-7.825-3.278 c2.125-2.286,3.29-3.461,4.367-4.71c11.938-14.551-7.15-33.181-21.367-21.111c-6.165,5.565-6.879,14.513-1.665,20.864 c4.197,5.111,3.946,5.411-2.516,8.068c-1.812,0.745-3.642,1.467-5.474,2.19c-24.645,7.648-40.948,25.21-46.886,49.595 c-0.68,2.698-2.102,5.208-3.473,8.505c-2.286-2.125-3.461-3.29-4.71-4.367c-14.552-11.938-33.18,7.152-21.111,21.367 c5.565,6.165,14.513,6.879,20.864,1.665c4.71-3.867,5.338-3.944,7.487,1.123c-1.309,6.465-1.74,13.174-1.396,20.102 c0.3,6.03-1.497,10.097-5.356,12.617c-8.889,2.044-17.148,6.132-25.567,9.656c-6.448,2.691-6.837,2.656-7.484-3.926 c-0.804-8.178-7.636-14-15.931-13.576c-18.581,1.516-18.918,28.187-0.181,30.036c1.645,0.122,3.299,0.129,6.419,0.243 c-1.366,3.319-2.113,5.992-3.558,8.47c-3.428,5.74-6.123,11.683-7.912,17.811c-4.722,16.154-2.533,34.602,5.996,50.411 c1.801,5.691,8.569,13.392-1.603,12.903c-40,12.971,18.416,54.114,16.704,9.691c34.782,3.225,46.692,41.92,80.447,49.674 c7.963,2.791,11.179,6.671,12.046,13.724c0.012,3.241,0.01,6.503,0,9.829h-0.223c0,2.086,0,5.309,0,5.309s0.065,0.184-0.069,0.268 c-7.211-0.002-14.005-0.041-20.79,0.015c-4.483,0.037-6.154,1.09-6.592,4.667c-0.352,4.638-0.043,9.45-0.131,14.122 c0.062,5.274,1.49,6.69,6.861,6.724c6.999,0.045,13.998,0.011,21.721,0.011v5.671c-7.723,0-14.722-0.034-21.721,0.011 c-5.372,0.035-6.799,1.45-6.861,6.724c0.087,4.671-0.221,9.484,0.131,14.122c0.438,3.577,2.109,4.63,6.592,4.667 c6.785,0.056,13.579,0.017,20.79,0.015c0.134,0.084,0.279,0.175,0.069,0.268v5.406h0.599c0.031,3.784,0.031,7.619,0,12h-0.599 v4.809c0,0,0.065,0.184-0.069,0.268c-7.211-0.002-14.005-0.041-20.79,0.015c-4.483,0.037-6.154,1.09-6.592,4.667 c-0.352,4.638-0.043,9.45-0.131,14.122c0.062,5.274,1.49,6.69,6.861,6.724c6.999,0.045,13.998,0.011,21.721,0.011v5.671 c-7.723,0-14.722-0.034-21.721,0.011c-5.372,0.035-6.799,1.45-6.861,6.724c0.087,4.671-0.221,9.484,0.131,14.122 c0.438,3.577,2.109,4.63,6.592,4.667c6.785,0.056,13.579,0.017,20.79,0.015c0.134,0.084,0.279,0.175,0.069,0.268v4.906h0.599 c0.031,4.284,0.031,8.119,0,12h-0.599v5.309c0.211,0.092,0.065,0.184-0.069,0.268c-7.211-0.002-14.005-0.041-20.79,0.015 c-4.483,0.037-6.154,1.09-6.592,4.667c-0.352,4.638-0.043,9.45-0.131,14.122c0.062,5.274,1.49,6.69,6.861,6.724 c6.999,0.045,21.721,0.011,21.721,0.011v5.671c0,0-14.722-0.034-21.721,0.011c-5.372,0.035-6.799,1.45-6.861,6.724 c0.087,4.671-0.221,9.484,0.131,14.122c0.438,3.577,2.109,4.63,6.592,4.667c6.785,0.056,13.579,0.017,20.79,0.015 c0.134,0.084,0.279,0.175,0.457,0.268c0,1.594,4.559,168.228,4.51,209.286c-0.005,4.1,0.442,9.128,0.442,10.259 c-3.396,0-6.234,0.133-9.054-0.034c-3.499-0.206-5.37,1.456-6.735,4.558c-1.281,2.913-2.803,5.866-4.843,8.27 c-6.58,7.751-16.578,7.84-23.206,0.144c-2.209-2.565-3.736-5.81-5.169-8.932c-1.239-2.699-2.939-4.083-5.916-4.024 c-3.712,0.073-7.428,0.078-11.14-0.009c-3.163-0.074-4.936,1.432-6.143,4.306c-1.141,2.716-2.476,5.469-4.285,7.764 c-8.725,11.281-23.01,6.923-27.966-5.357c-1.496-5.628-5.039-7.274-10.521-6.767c-4.485,0.415-6.285,1.937-6.286,6.612 c-0.001,15.755-0.002,31.511-0.003,47.266c-0.001,16.376-0.012,32.752,0.006,49.127c0.004,3.646,2.039,5.706,5.586,5.765 c4.244-0.151,7.724,1.078,9.747-3.72c1.63-3.566,3.31-7.297,5.811-10.239c5.927-6.969,15.25-7.396,21.596-0.827 c2.91,3.012,4.885,7.078,6.716,10.936c1.245,2.623,2.748,3.896,5.573,3.857c3.96-0.055,7.925-0.102,11.882,0.027 c3.041,0.099,4.629-1.359,5.914-4.011c1.386-2.861,3.016-5.766,5.166-8.063c10.107-10.412,22.254-3.718,27.139,8.037 c1.337,2.907,3.18,4.141,6.281,4.034c3.442-0.119,6.891-0.027,10.523-0.027c1.065,5.652,2.167,11.021,3.856,16.453 c1.228,3.675,2.407,8.536,7.056,8.594c4.923,0.061,6.042-4.987,7.307-8.743c1.456-4.322,2.867-8.847,3.125-13.35 c0.728-12.721,1.152-25.477,1.174-38.219c0.19-111.404,0.292,50.177,0.366-61.227c0.003-5.129,0.201-18.49,0.201-22.46 c0-41.693,4.098-203.286,4.098-209.558c8.112,0,15.82-0.053,23.528,0.021c5.544,0.13,6.64-3.323,6.288-8.201 c0.033-3.547,0.038-7.095-0.007-10.642c-0.066-5.278-1.476-6.669-6.885-6.701c-7.529-0.044-23.121-0.011-23.121-0.011v-5.671 c0,0,15.592,0.033,23.121-0.011c5.408-0.032,6.819-1.423,6.885-6.701c0.044-3.547,0.04-7.095,0.007-10.642 c0.351-4.882-0.742-8.33-6.288-8.201c-7.707,0.073-15.416,0.021-22.724,0.021v-22.76c7.308,0,15.017-0.053,22.724,0.021 c5.544,0.13,6.64-3.323,6.288-8.201c0.033-3.547,0.038-7.095-0.007-10.642c-0.066-5.278-1.476-6.669-6.885-6.701 c-7.529-0.044-15.059-0.011-23.121-0.011v-5.671c8.062,0,15.592,0.033,23.121-0.011c5.408-0.032,6.819-1.423,6.885-6.701 c0.044-3.547,0.04-7.095,0.007-10.642c0.351-4.882-0.742-8.33-6.288-8.201c-7.707,0.073-15.416,0.021-22.724,0.021v-22.76 c7.308,0,15.017-0.053,22.724,0.021c5.544,0.13,6.64-3.323,6.288-8.201c0.033-3.547,0.038-7.095-0.007-10.642 c-0.066-5.278-1.476-6.669-6.885-6.701c-7.529-0.044-15.059-0.011-23.121-0.011v-5.671c8.062,0,15.592,0.033,23.121-0.011 c5.408-0.032,6.819-1.423,6.885-6.701c0.044-3.547,0.04-7.095,0.007-10.642c0.351-4.882-0.742-8.33-6.288-8.201 c-7.707,0.073-15.416,0.021-22.724,0.021v-13.831c0.379-7.638,5.186-13.149,13.162-15.825 c28.456-7.104,41.808-33.352,64.888-48.287c17.492-10.743,9.354,22.937,28.518,19.129 C282.127,286.309,282.455,259.681,263.752,257.836z M105.697,839.074c0.498,2.38,0.15,4.934-3.302,4.884 c-2.295-0.033-3.176,1.042-3.702,3.217c-0.26,1.076-1.713,2.383-2.793,2.559c-0.723,0.118-2.36-1.479-2.505-2.467 c-0.409-2.804-2.004-3.344-4.385-3.299c-3.709,0.07-7.424,0.116-11.131-0.006c-3.83-0.126-3.945,2.278-3.981,5.13 c-0.038,2.976,0.755,4.826,4.142,4.589c1.477-0.103,2.968,0.015,4.451-0.025c2.202-0.059,4.543-0.006,4.579,2.901 c0.039,3.187-2.477,3.119-4.78,3.068c-1.36-0.03-2.728,0.082-4.08-0.025c-3.258-0.257-4.5,1.312-4.272,4.425 c-0.041,4.353,1.027,8.028-4.883,7.506c-7.022,0.039-7.951,0.802-7.543-7.405c0.169-3.39-1.192-4.855-4.554-4.524 c-0.857,0.085-1.922,0.329-2.555-0.056c-1.2-0.729-2.156-1.861-3.213-2.825c1.006-1.017,1.944-2.121,3.057-3.004 c0.38-0.301,1.199-0.042,1.817-0.044c5.007-0.022,7.131-2.986,5.196-7.646c-0.392-0.945-1.974-1.785-3.11-1.944 c-3.651-0.437-7.442,0.158-11.117-0.121c-3.786-0.387-5.894,0.721-5.698,5.061c0.045,0.996-1.78,2.077-2.744,3.119 c-0.848-1.038-2.451-2.105-2.412-3.108c0.153-3.932-1.445-5.27-5.269-5.225c-1.017,0.012-2.491-1.899-2.973-3.215 c-0.52-1.421-0.127-3.18-0.126-4.791c0-5.24-0.002-5.268,5.3-5.954c2.366-0.306,3.023-1.787,2.927-3.889 c-0.098-2.143,0.268-4.425,2.848-4.073c1.034,0.141,2.342,2.528,2.49,3.998c0.282,2.788,1.314,4.039,4.131,3.976 c3.956-0.088,7.919-0.125,11.873,0.011c3.063,0.105,4.168-1.204,4.13-4.212c-0.036-2.816-0.326-5.041-3.916-4.755 c-2.559,0.203-4.468-0.474-4.367-3.527c0.095-2.865,2.016-3.344,4.358-3.173c2.898,0.212,3.849-1.243,3.979-4.019 c0.085-1.821,0.73-5.002,1.563-5.153c3.046-0.553,6.308-0.31,9.408,0.165c0.646,0.099,1.284,2.453,1.345,3.795 c0.224,4.967,0.374,5.207,5.401,5.214c1.361,0.002,2.929-0.422,4.027,0.116c1.271,0.623,2.94,2.09,2.942,3.194 c0.002,1.125-1.621,2.815-2.876,3.241c-1.665,0.565-3.667,0.223-5.518,0.132c-3.18-0.157-3.971,1.57-3.952,4.398 c0.019,2.703,0.495,4.64,3.783,4.569c3.956-0.085,7.916-0.055,11.873-0.012c2.165,0.024,3.322-0.763,3.826-3.068 c0.241-1.105,1.771-1.927,2.718-2.877c0.905,0.971,2.333,1.814,2.605,2.939c0.545,2.256,1.757,2.7,3.843,3.111 C108.401,831.102,105.035,835.914,105.697,839.074z M139.108,46c29.823,0,54,24.177,54,54c0,29.823-24.177,54-54,54 s-54-24.177-54-54C85.108,70.176,109.285,46,139.108,46z M19.108,212c0-29.823,24.177-54,54-54s54,24.177,54,54 c0,29.823-24.177,54-54,54S19.108,241.823,19.108,212z M144.944,857.898c-2.09,2.578-1.865,5.176-1.942,7.953 c-0.024,0.854,0.131,1.914-0.302,2.509c-2.403,3.147-3.159,2.809-5.436-0.185c-0.264-0.306-0.178-0.948-0.184-1.437 c-0.041-3.271,0.536-6.657-2.369-9.253c-0.531-0.475-0.479-1.605-0.957-3.425c1.21-1.271,2.47-3.306,4.294-4.333 c2.379-1.339,5.236-0.58,6.441,1.819C145.405,853.367,145.95,856.658,144.944,857.898z M144.996,807.941 c-2.224,2.677-1.877,5.438-1.992,8.318c-0.086,2.146-0.2,4.578-2.99,4.544c-2.765-0.034-2.874-2.475-2.933-4.614 c-0.08-2.895,0.543-5.919-2.179-8.193c-0.631-0.527-0.645-1.797-1.234-3.633c1.265-1.382,2.48-3.465,4.292-4.5 c2.341-1.338,5.233-0.649,6.476,1.731C145.382,803.404,145.991,806.744,144.996,807.941z M80.062,279.694 c17.171-3.582,56.234-25.446,59.296-50.487c5.518,22.114,30,48.729,61,48.729C162.77,319.773,120.431,321.28,80.062,279.694z M205.108,266c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54s54,24.177,54,54C259.108,241.823,234.932,266,205.108,266z",
    clocks: {
      size: 108,
      0: { x: 138.892, y: 100 },
      1: { x: 72.892, y: 212 },
      2: { x: 204.892, y: 212 }
    }
  },
  4: {
    height: 1041,
    width: 368.697,
    path: "M365.949,178.882c-2.159-2.705-5.464-5.038-8.725-6.201c-7.211-2.57-12.634,1.794-18.155,7.261 c-1.008-3.182-1.811-5.292-2.346-7.468c-7.207-29.311-25.676-46.993-55.052-53.142c-3.565-0.746-4.337-2.365-5.721-5.525 c-10.917-24.928-15.917-32.928-31.863-49.408c-1.625-1.679-3.453-3.192-5.144-4.761c-15.909-14.758-20.909-17.758-43.492-26.71 c-1.882-0.746-3.781-1.782-6.866-3.302c2.349-1.876,3.694-2.659,4.662-3.772c4.695-5.397,4.837-13.436,0.452-19.014 c-5.3-6.742-15-7.806-21.456-2.354c-6.714,5.67-7.304,15.417-1.328,21.919c3.617,3.935,3.297,5.361-1.725,7.153 c-2.044,0.73-4.17,1.226-6.237,1.896c-12.766,4.137-23.255,11.604-31.918,21.798c-2.372,2.791-4.778,5.622-7.539,8.002 c-15.564,13.413-26.166,29.895-31.108,49.904c-0.68,2.752-1.741,4.084-4.825,4.54c-29.053,4.299-51.461,25.809-57.16,54.556 c-0.307,1.549-0.792,3.062-1.25,4.806c-11.35-8.302-18-8.998-24.401-2.862c-5.321,5.101-6.467,13.398-1.935,19.203 c2.036,2.608,5.192,4.836,8.302,6.005c7.137,2.683,12.59-1.579,17.735-6.353c0.583,1.299,1.01,1.874,1.096,2.496 c4.046,29.315,27.997,53.277,57.825,57.393c2.223,0.307,4.062,1.874,4.644,4.041c1.308,4.861,2.891,9.682,4.787,14.345 c9.432,23.198,28.811,38.203,45.823,55.084c5.104,5.065,11.204,9.197,17.156,13.308c5.563,3.842,7.792,8.391,7.788,15.456 c-0.129,188.254-0.004,308.508,0.065,496.762c0,0.102-0.005,0.205-0.006,0.307v41.241c-2.701,0.026-5.102,0.092-7.461-0.047 c-3.499-0.206-5.37,1.456-6.735,4.558c-1.282,2.913-2.803,5.866-4.844,8.27c-6.581,7.751-16.578,7.84-23.206,0.144 c-2.254-2.617-3.797-5.94-5.255-9.119c-1.087-2.369-3.472-3.882-6.078-3.833c-3.63,0.068-7.263,0.071-10.893-0.013 c-3.163-0.074-4.936,1.432-6.143,4.306c-1.141,2.716-2.476,5.469-4.285,7.764c-8.725,11.281-23.01,6.923-27.966-5.357 c-1.496-5.628-5.039-7.274-10.521-6.767c-4.485,0.415-6.285,1.937-6.286,6.612c-0.001,15.755-0.002,31.511-0.003,47.266 c-0.001,16.376-0.012,32.752,0.006,49.127c0.004,3.646,2.039,5.706,5.586,5.765c4.244-0.151,7.724,1.078,9.747-3.72 c1.63-3.566,3.31-7.297,5.811-10.239c5.927-6.969,15.25-7.396,21.596-0.827c2.91,3.012,4.885,7.078,6.716,10.936 c1.457,3.071,3.269,4.292,7.14,3.723c2.897-0.426,5.844-0.506,8.73-0.009c4.108,0.708,6.007-0.762,7.499-3.84 c1.386-2.861,3.016-5.766,5.166-8.063c10.107-10.412,22.254-3.718,27.139,8.037c1.337,2.907,3.181,4.141,6.281,4.034 c2.715-0.094,5.446-0.058,8.257-0.038v2.091c0.319,0.001,0.631,0.004,0.951,0.004c0.362,2.11,0.473,3.786,0.947,5.352 c2.41,7.972,4.19,16.244,7.596,23.773c3.168,7.005,9.289,6.901,12.709-0.011c2.932-5.925,5.134-12.395,6.525-18.868 c4.01-18.662,2.675-37.664,2.696-56.567c0.133-118.853,0.314,0.295,0.392-118.558c0.068-103.934,0.013-377.867,0.064-481.801 c0.001-2.781-0.281-6.125,1.073-8.24c4.886-7.634,8.978-15.851,18.168-20.058c5.139-2.352,9.257-7.045,13.652-10.893 c4.267-3.736,8.16-7.904,12.459-11.599c15.452-13.278,26.023-29.619,30.885-49.451c0.909-3.707,2.926-4.598,6.161-5.73 c8.764-3.067,17.943-5.775,25.742-10.598c14.82-9.164,23.822-23.162,28.263-40.071c0.703-2.678,1.909-5.223,2.991-8.122 c11.076,8.596,18.006,9.328,24.489,3.223C369.187,192.953,370.464,184.538,365.949,178.882z M146.765,952.539 c0.498,2.38,0.15,4.934-3.302,4.884c-2.294-0.033-3.176,1.042-3.702,3.217c-0.26,1.076-1.713,2.383-2.793,2.559 c-0.723,0.118-2.36-1.479-2.504-2.467c-0.409-2.804-2.004-3.344-4.384-3.299c-3.709,0.07-7.424,0.116-11.131-0.006 c-3.83-0.126-3.945,2.278-3.981,5.13c-0.038,2.976,0.755,4.826,4.142,4.589c1.477-0.103,2.968,0.015,4.451-0.025 c2.202-0.059,4.543-0.006,4.579,2.901c0.04,3.187-2.477,3.119-4.78,3.068c-1.36-0.03-2.728,0.082-4.08-0.025 c-3.258-0.257-4.5,1.312-4.272,4.425c-0.041,4.353,1.027,8.028-4.883,7.506c-7.022,0.039-7.951,0.802-7.542-7.405 c0.168-3.39-1.192-4.855-4.555-4.524c-0.857,0.085-1.922,0.329-2.555-0.056c-1.2-0.729-2.156-1.861-3.213-2.825 c1.006-1.017,1.944-2.121,3.057-3.004c0.379-0.301,1.199-0.042,1.817-0.044c5.007-0.022,7.131-2.986,5.197-7.646 c-0.393-0.945-1.975-1.785-3.11-1.944c-3.651-0.437-7.442,0.158-11.117-0.121c-3.786-0.387-5.894,0.721-5.698,5.061 c0.045,0.996-1.78,2.077-2.744,3.119c-0.848-1.038-2.451-2.105-2.412-3.108c0.153-3.932-1.445-5.27-5.269-5.225 c-1.017,0.012-2.491-1.899-2.973-3.215c-0.52-1.422-0.127-3.18-0.126-4.791c0.001-5.24-0.002-5.268,5.3-5.954 c2.366-0.306,3.023-1.787,2.927-3.889c-0.098-2.143,0.268-4.425,2.848-4.073c1.034,0.141,2.342,2.528,2.49,3.998 c0.282,2.788,1.314,4.039,4.131,3.976c3.956-0.088,7.919-0.125,11.872,0.011c3.063,0.105,4.168-1.204,4.13-4.212 c-0.035-2.816-0.326-5.041-3.916-4.755c-2.559,0.203-4.468-0.474-4.367-3.527c0.095-2.865,2.016-3.344,4.358-3.173 c2.898,0.212,3.849-1.243,3.979-4.019c0.085-1.821,0.73-5.002,1.563-5.153c3.046-0.553,6.308-0.31,9.408,0.165 c0.646,0.099,1.284,2.453,1.345,3.795c0.224,4.967,0.375,5.207,5.402,5.214c1.361,0.002,2.928-0.423,4.027,0.116 c1.272,0.623,2.94,2.09,2.943,3.194c0.002,1.125-1.621,2.815-2.876,3.241c-1.666,0.565-3.668,0.223-5.518,0.132 c-3.18-0.157-3.971,1.57-3.952,4.398c0.019,2.703,0.495,4.64,3.783,4.569c3.957-0.085,7.916-0.055,11.874-0.012 c2.166,0.024,3.322-0.763,3.826-3.068c0.242-1.105,1.771-1.927,2.718-2.877c0.905,0.971,2.333,1.814,2.605,2.939 c0.545,2.256,1.757,2.7,3.843,3.111C149.469,944.566,146.104,949.379,146.765,952.539z M252.621,98.898 c0.287-0.167,0.574-0.334,0.861-0.502c2.841,6.521,5.683,13.042,8.739,20.056c-4.719,1.002-8.414,1.787-12.443,2.642 C250.758,113.446,251.689,106.172,252.621,98.898z M184.136,46.188c29.823,0,54,24.177,54,54c0,29.823-24.177,54-54,54 s-54-24.177-54-54C130.136,70.365,154.313,46.188,184.136,46.188z M162.097,165.903c14.218,3.796,27.946,4.565,42.414-0.072 c-3.942,14.414-4.001,28.063,0.302,42.583c-14.189-3.96-27.779-4.487-42.527-0.062C166.547,193.78,166.444,180.286,162.097,165.903 z M114.049,99.643c0.292,0.134,0.583,0.269,0.875,0.403c1.095,7.133,2.19,14.267,3.378,22.01 c-3.852-0.843-7.747-1.695-12.458-2.726C108.69,112.502,111.369,106.072,114.049,99.643z M114.09,275.17 c-2.992-7.299-5.446-13.283-8.044-19.622c4.192-0.951,7.557-1.714,11.303-2.564C116.293,260.174,115.314,266.84,114.09,275.17z  M97.136,240.188c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54s54,24.177,54,54 C151.136,216.012,126.96,240.188,97.136,240.188z M190.317,961.816c-2.889,3.631-2.59,7.316-2.675,11.229 c-0.063,2.929-0.301,6.185-4.102,6.083c-3.718-0.099-3.92-3.373-3.912-6.266c0.01-3.961,0.532-7.956-2.966-11.069 c-0.843-0.75-0.86-2.433-1.653-4.938c1.737-1.842,3.427-4.577,5.876-5.996c3.218-1.864,7.078-0.801,8.743,2.361 C190.908,955.651,191.666,960.12,190.317,961.816z M190.377,894.286c-2.75,3.639-2.754,7.277-2.731,11.231 c0.017,2.954-0.303,6.162-3.967,6.219c-3.722,0.058-4.036-3.156-4.069-6.118c-0.044-3.915,0.729-7.982-2.898-11.07 c-0.855-0.728-0.902-2.408-1.792-5.047c1.877-1.885,3.726-5.163,6.313-5.925c2.41-0.711,6.606,0.411,8.177,2.279 C190.999,887.744,191.681,892.56,190.377,894.286z M190.399,830.196c-3.107,3.329-2.592,6.926-2.795,10.682 c-0.086,1.597-0.323,3.33-1.04,4.717c-1.41,2.725-4.298,2.744-5.822,0.114c-0.63-1.087-1.04-2.453-1.075-3.706 c-0.125-4.43,0.653-9.009-3.304-12.472c-0.62-0.543-0.572-1.852-0.833-2.806c-0.315-0.34-0.629-0.679-0.944-1.019 c2.103-2.244,3.85-5.571,6.413-6.415c2.391-0.788,6.184,0.324,8.392,1.933C192.319,823.355,192.864,827.555,190.399,830.196z  M184.136,328.188c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54s54,24.177,54,54 C238.136,304.012,213.96,328.188,184.136,328.188z M252.789,277.752c-0.265-0.133-0.531-0.265-0.796-0.398 c-1.015-8.257-2.029-16.515-3.086-25.115c4.167,0.862,8.324,1.721,13.585,2.809C259.162,262.841,255.975,270.297,252.789,277.752z  M271.136,240.188c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54c29.823,0,54,24.177,54,54 C325.137,216.012,300.96,240.188,271.136,240.188z",
    clocks: {
      size: 108,
      0: { x: 184.245, y: 100 },
      1: { x: 97.245, y: 186 },
      2: { x: 271.245, y: 186 },
      3: { x: 184.245, y: 274 }
    }
  },
  5: {
    height: 1148.657,
    width: 368.698,
    path: "M364.919,177.185c-5.856-6.593-15.147-6.888-21.897-0.694c-3.717,3.411-4.299,3.242-5.541-1.587 c-0.25-0.972-0.571-1.926-0.803-2.901c-6.223-26.032-22.396-42.736-47.523-51.238c-2.474-0.837-4.808-2.72-6.666-4.641 c-6.618-6.844-12.426-14.598-19.638-20.709c-7.25-6.144-14.426-11.753-15.964-21.863c-0.145-0.952-0.81-1.83-1.262-2.728 c-10.14-20.142-26.293-32.5-48.2-37.503c-2.572-0.587-5.014-1.743-8.025-2.817c1.316-1.702,1.86-2.531,2.526-3.247 c6.502-6.986,6.698-15.783,0.465-21.94c-5.785-5.714-15.027-5.762-20.84-0.11c-6.368,6.191-6.436,15.084,0.239,21.857 c2.991,3.035,1.728,4.561-1.167,5.98c-1.334,0.654-2.844,0.952-4.281,1.387c-24.857,7.514-40.936,23.712-48.399,48.654 c-0.748,2.499-2.69,4.83-4.561,6.77c-8.684,9.004-17.485,17.897-26.377,26.695c-1.782,1.764-3.95,3.591-6.269,4.287 c-27.272,8.186-44.245,25.906-50.386,53.864c-0.306,1.391-0.752,2.75-1.182,4.299c-11.942-8.326-18.43-8.891-24.733-2.424 c-5.16,5.294-6.085,13.716-1.351,19.24c2.253,2.629,5.655,4.841,8.962,5.874c6.77,2.115,12.009-1.8,16.717-6.757 c0.647,1.364,1.068,1.923,1.182,2.539c5.495,29.672,22.939,48.289,51.806,56.504c1.891,0.538,3.666,2.056,5.112,3.503 c8.725,8.731,17.397,17.519,25.942,26.426c1.755,1.83,3.532,4.061,4.227,6.423c5.507,18.702,16.574,32.696,33.076,43.228 c6.667,4.255,11.428,11.52,16.987,17.48c0.5,0.535,0.688,1.544,0.692,2.334c0.044,10.877,0.03,21.753,0.03,32.638 c-1.577,0.516-2.845,0.932-4.113,1.346c-17.135,5.597-30.511,16.033-39.024,31.952c-3.426,6.407-5.333,13.646-7.754,20.57 c-1.76,5.033-3.129,5.54-6.907,2.08c-2.706-2.478-6.172-4.068-9.837-4.235c-8.598-0.392-15.176,6.223-15.67,13.97 c-0.384,6.021,2.865,11.744,8.198,14.44c5.638,2.851,12.01,2.021,16.818-2.189c2.562-2.243,5.668-1.656,6.923,1.51 c1.187,2.993,1.799,6.229,3.124,9.149c2.549,5.62,4.886,11.444,8.247,16.568c9.497,14.478,39.422,28.018,39.422,28.018v28.542 c0,0-0.496,0.466-0.788,0.469c-5.522,0.049-11.045,0.088-16.568,0.095c-9.805,0.013-10.191,0.382-10.188,9.959 c0.001,2.347-0.002,4.695,0,7.042c0.008,7.059,1.061,8.147,7.942,8.157c6.643,0.01,13.286,0.002,20.223,0.002 c-0.115,2.368-0.198,4.098-0.292,6.035c-7.528,0-14.546,0.054-21.562-0.02c-3.56-0.037-6.383,2.854-6.323,6.415 c0.064,3.826-0.011,7.654,0.01,11.481c0.033,5.918,1.364,7.248,7.324,7.269c6.815,0.024,21.22,0.006,21.22,0.006v7.044 c0,0-14.435-0.017-21.108,0.005c-6.069,0.02-7.373,1.289-7.434,7.19c-0.028,2.682,0.18,5.38-0.039,8.044 c-0.443,5.389,0.07,10.039,6.912,10.524c-3.015,31.457-2.572,62.398,2.234,93.196c2.98,19.097,7.19,37.854,16.599,55.063 c1.443,2.639,2.397,5.924,2.406,8.914c0.209,63.543,0.251,127.087,0.325,190.631c0.002,1.795,0,3.59,0,5.442 c-5.238,0.679-7.397-1.369-7.347-5.986c0.035-3.185,0.024-6.371,0.006-9.557c-0.034-5.945-1.325-7.274-7.309-7.285 c-17.074-0.032-34.148-0.022-51.222-0.026c-11.718-0.003-23.435-0.029-35.153,0.013c-5.235,0.019-6.699,1.54-6.756,6.814 c-0.038,3.521-0.04,7.042,0.004,10.563c0.066,5.255,1.516,6.725,6.823,6.744c11.215,0.04,22.431,0.01,33.646,0.013 c11.868,0.003,11.868,0.005,11.75,11.912c-0.059,5.922-1.3,7.16-7.407,7.176c-12.22,0.031-24.439,0.018-36.659,0.029 c-7.054,0.006-8.155,1.08-8.167,7.935c-0.004,2.18-0.006,4.359,0.001,6.539c0.021,6.383,1.222,7.644,7.439,7.655 c11.048,0.02,22.096,0.002,33.144,0.006c11.791,0.005,11.791,0.008,11.648,12.012c-0.067,5.703-1.367,7.062-7.047,7.083 c-10.378,0.04-20.758,0.096-31.135-0.002c-15.122-0.144-14.146-0.478-14.047,14.132c0.038,5.646,1.377,6.992,7.074,7.008 c11.048,0.031,22.096,0.007,33.144,0.01c12.19,0.003,12.19,0.005,12.011,12.153c-0.083,5.597-1.413,6.924-7.187,6.944 c-10.211,0.034-20.423,0.089-30.633-0.001c-15.773-0.139-14.465-0.577-14.406,14.774c0.024,6.173,1.313,7.37,7.73,7.375 c13.726,0.011,27.452,0.005,41.179,0.003c14.898-0.002,29.796,0.018,44.694-0.027c5.339-0.016,6.767-1.487,6.831-6.742 c0.033-2.682-0.046-5.366,0.02-8.047c0.126-5.106,1.839-6.469,8.044-5.697c0,5.722-0.455,11.611,0.097,17.404 c1.078,11.308,2.634,22.631,8.667,32.623c3.709,6.143,9.563,5.816,12.753-0.612c2.984-6.015,5.833-12.625,6.409-19.174 c1.579-17.969,2.543-36.045,2.614-54.083c0.36-91.878,0.35-183.757,0.553-275.636c0.005-2.049,0.733-4.214,1.576-6.124 c3.369-7.639,7.748-14.934,10.257-22.833c11.421-35.946,13.433-72.997,11.755-110.391c-0.269-5.99-0.801-11.968-1.209-17.909 c7.452-1.534,7.775-1.945,7.779-9.588c0.001-2.515,0.011-5.03,0.007-7.545c-0.013-7.75-0.894-8.656-8.46-8.663 c-7.141-0.007-22.406-0.001-22.406-0.001v-7.045c0,0,16.742-0.048,24.561,0.019c4.359,0.038,6.392-2,6.312-6.351 c-0.071-3.855,0.016-7.712-0.019-11.568c-0.053-5.938-1.345-7.219-7.35-7.242c-7.485-0.029-22.504-0.007-22.504-0.007v-6.035 c0,0,15.454,0.033,22.967-0.011c5.362-0.031,6.803-1.454,6.876-6.683c0.049-3.52,0.028-7.042,0.018-10.563 c-0.019-6.708-1.157-7.881-7.7-7.895c-7.319-0.016-21.161-0.004-21.161-0.004v-28.963c0,0,51.319-18.506,51.418-58.803 c13.274,8.8,19.828,9.143,25.982,1.96c4.843-5.653,4.919-13.758,0.181-19.362c-6.121-7.24-12.687-6.904-26.259,1.909 c-5.709-30.27-22.672-50.541-52.587-59.137c0-11.198-0.038-22.249,0.053-33.298c0.01-1.247,0.394-2.826,1.206-3.677 c5.143-5.394,9.736-11.741,15.851-15.695c15.582-10.074,26.618-23.168,32.069-40.997c0.628-2.052,2.154-4.251,3.897-5.472 c12.064-8.448,22.297-18.658,30.858-30.639c1.235-1.728,3.009-3,5.027-3.661c25.276-8.284,41.218-25.241,47.865-51.029 c0.549-2.129,1.536-4.145,2.62-7.008c2.028,1.88,3.182,3.03,4.418,4.083c5.813,4.951,14.202,4.893,19.761-0.107 C369.847,192.788,370.428,183.388,364.919,177.185z M252.394,107.492c4.098,3.415,7.887,6.574,11.677,9.733 c-0.404,0.395-0.807,0.791-1.211,1.186c-4.169,0.785-8.338,1.57-13.15,2.476C250.666,116.112,251.516,111.872,252.394,107.492z  M184.406,46c29.823,0,54,24.177,54,54c0,29.823-24.177,54-54,54s-54-24.177-54-54C130.406,70.177,154.583,46,184.406,46z  M162.373,165.581c14.357,4.18,28.096,4.578,42.513,0.199c-4.092,14.47-3.946,28.113,0.227,42.523 c-14.26-4.037-27.868-4.509-42.273-0.152C166.659,193.831,166.896,180.189,162.373,165.581z M115.827,107.593 c1.197,5.466,2.101,9.598,3.149,14.382c-4.547-0.964-8.521-1.806-13.675-2.899C108.835,115.221,111.958,111.814,115.827,107.593z  M43.406,186c0-29.823,24.177-54,54-54s54,24.177,54,54c0,29.823-24.177,54-54,54S43.406,215.823,43.406,186z M115.278,265.909 c-3.402-3.626-6.248-6.661-9.67-10.309c4.662-1.06,8.192-1.862,12.324-2.801C117.071,257.051,116.27,261.011,115.278,265.909z  M238.406,453c0,29.823-24.177,54-54,54s-54-24.177-54-54s24.177-54,54-54S238.406,423.177,238.406,453z M184.406,328 c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54s54,24.177,54,54C238.406,303.823,214.23,328,184.406,328z M251.958,267.927 c-1.167-5.669-2.154-10.46-3.262-15.84c5.154,0.97,9.935,1.87,14.716,2.77c0.446,0.541,0.892,1.082,1.338,1.623 C260.673,260.129,256.595,263.778,251.958,267.927z M271.406,240c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54 c29.823,0,54,24.177,54,54C325.406,215.823,301.23,240,271.406,240z",
    clocks: {
      size: 108,
      0: { x: 184.245, y: 100 },
      1: { x: 97.245, y: 186 },
      2: { x: 271.245, y: 186 },
      3: { x: 184.245, y: 274 },
      4: { x: 184.245, y: 453 }
    }
  },
  6: {
    height: 1148.98,
    width: 370.141,
    path: "M365.84,176.489c-5.689-5.831-14.774-6.109-20.983-0.642c-4.677,4.118-4.976,4.085-6.414-2.269 c-6.187-27.333-22.732-44.97-49.412-53.347c-1.887-0.593-3.769-2.168-4.983-3.788c-8.33-11.115-18.008-20.785-29.318-28.894 c-1.84-1.32-3.239-3.825-3.948-6.065c-8.013-25.306-24.804-41.278-50.453-47.985c-1.299-0.34-2.628-0.562-3.93-0.89 c-6.029-1.519-6.346-2.456-2.44-7.102c5.378-6.396,4.93-15.201-1.065-20.921c-5.702-5.442-14.806-5.447-20.582-0.013 c-6.006,5.651-6.507,14.545-1.066,20.88c0.962,1.12,2.36,1.865,5.102,3.969c-3.997,1.969-6.466,3.647-9.192,4.455 c-21.058,6.239-37.094,18.816-44.941,39.357c-3.899,10.207-9.562,17.625-17.758,24.394c-6.646,5.489-11.704,12.883-17.615,19.294 c-1.38,1.497-3.203,3.002-5.097,3.546c-28.343,8.127-45.563,26.507-51.567,55.389c-0.195,0.941-0.595,1.84-1.211,3.697 c-4.56-5.357-9.738-8.928-16.367-7.261c-3.226,0.811-6.599,2.778-8.897,5.184c-5.104,5.343-4.779,13.776,0.038,19.336 c6.068,7.004,12.02,6.721,25.619-1.458c0.72,3.007,1.322,5.896,2.106,8.735c7.133,25.831,23.797,42.127,49.404,49.659 c2.498,0.735,4.874,2.61,6.784,4.488c8.593,8.445,17.053,17.028,25.427,25.692c1.767,1.828,3.636,4.007,4.323,6.356 c5.597,19.138,16.997,33.318,33.994,43.913c6.567,4.094,11.118,11.439,16.51,17.374c0.48,0.528,0.534,1.578,0.536,2.386 c0.033,10.743,0.022,21.486,0.022,30.697c-9.552,5.427-18.816,9.569-26.776,15.469c-12.547,9.299-19.949,22.422-23.771,37.578 c-0.68,2.698-2.102,5.208-3.473,8.506c-2.286-2.126-3.461-3.29-4.711-4.367c-6.067-5.231-15.003-4.872-20.573,0.801 c-5.603,5.707-5.839,14.698-0.54,20.569c5.565,6.166,14.515,6.88,20.866,1.665c5.112-4.197,5.412-3.946,8.069,2.516 c3.43,8.344,6.359,17.082,11.089,24.661c8.379,13.426,21.019,21.894,36.078,26.785c1.434,0.466,3.551,2,3.587,3.097 c0.294,8.853,0.165,17.72,0.165,27.124c-7.476,0-14.485-0.043-21.493,0.014c-5.306,0.044-6.687,1.494-6.735,6.878 c-0.033,3.697-0.03,7.394-0.004,11.091c0.042,5.943,1.284,7.157,7.436,7.185c6.702,0.031,13.405,0.007,20.448,0.007 c0,2.034,0,5.598,0,5.598s-13.784-0.034-20.783,0.011c-5.372,0.035-6.799,1.45-6.861,6.724c-0.047,4.026,0.044,8.054-0.023,12.079 c-0.072,4.325,1.898,6.385,6.299,6.345c6.876-0.063,13.753,0.049,20.629,0.113c0.289,0.003,1.739,0.534,1.739,0.534v6.407 c0,0-14.692-0.032-21.682,0.01c-5.652,0.034-7.334,1.395-6.872,7.119c0.694,8.601-1.289,15.249-8.006,21.638 c-8.605,8.185-13.036,19.34-15.463,31.089c-1.309,6.335-2.096,6.555-6.889,2.398c-6.287-5.453-15.195-5.103-20.871,0.819 c-5.657,5.902-5.624,15.003,0.076,20.896c5.702,5.895,14.51,6.153,20.855,0.613c1.117-0.975,2.238-1.945,4.238-3.682 c1.129,2.807,2.274,4.924,2.843,7.186c4.769,18.938,15.137,33.728,31.864,44.051c1.736,1.072,3.27,3.377,3.775,5.392 c3.397,13.548,7.363,26.834,14.685,38.904c0.804,1.325,1.03,3.177,1.033,4.786c0.118,64.926,0.18,129.852,0.239,194.778 c0.001,0.981-0.122,1.963-0.184,2.894c-5.249,0.709-6.974-0.588-7.13-5.358c-0.109-3.352-0.003-6.71-0.024-10.065 c-0.036-5.705-1.357-7.092-7.019-7.099c-21.978-0.026-43.956-0.012-65.933-0.011c-7.046,0-14.094,0.1-21.138-0.026 c-4.635-0.083-6.728,2.003-6.589,6.633c0.109,3.639,0.121,7.278-0.002,10.917c-0.157,4.646,1.947,6.703,6.575,6.67 c12.75-0.09,25.501-0.045,38.251-0.028c6.305,0.008,7.513,1.253,7.533,7.599c0.038,11.525,0.038,11.526-11.68,11.525 c-11.24-0.001-22.481-0.03-33.722,0.007c-5.418,0.018-6.914,1.437-6.931,6.666c-0.053,16.568-1.437,15.572,15.235,15.484 c10.066-0.053,20.132-0.038,30.198,0.002c5.373,0.021,6.796,1.457,6.905,6.697c0.259,12.419,0.259,12.42-12.268,12.419 c-11.073,0-22.146-0.028-33.218,0.011c-5.319,0.019-6.822,1.501-6.857,6.738c-0.102,15.018-1.068,14.544,14.31,14.408 c10.401-0.092,20.803-0.047,31.205-0.005c5.279,0.022,6.729,1.522,6.828,6.773c0.234,12.342,0.234,12.342-12.345,12.342 c-11.073,0-22.146-0.031-33.218,0.012c-5.25,0.02-6.76,1.539-6.779,6.814c-0.06,16.24-1.382,15.39,14.882,15.343 c26.004-0.075,52.009-0.015,78.013-0.024c6.592-0.002,7.763-1.211,7.767-7.876c0.001-2.349-0.056-4.699,0.01-7.046 c0.144-5.087,1.794-6.38,6.391-5.865c1.57,11.962,2.907,23.747,4.765,35.449c0.647,4.073,1.998,8.292,4.104,11.797 c1.828,3.041,5.159,7.119,7.859,7.143c2.656,0.024,6.805-4.019,7.763-7.073c3.09-9.85,6.148-19.959,7.106-30.167 c1.295-13.794,0.763-27.772,0.787-41.671c0.158-91.433,0.238-182.866,0.46-274.299c0.006-2.499,0.844-5.29,2.131-7.444 c7.151-11.972,11.314-25.021,14.283-38.502c0.767-3.483,2.275-5.895,5.318-7.958c14.472-9.809,23.801-23.321,28.184-40.279 c0.711-2.753,1.981-5.361,3.281-8.798c2.096,1.947,3.257,3.114,4.508,4.173c6.274,5.312,15.319,4.747,20.867-1.276 c5.371-5.83,5.28-14.718-0.209-20.541c-5.593-5.933-14.657-6.313-20.861-0.875c-4.91,4.304-5.502,4.183-6.871-2.32 c-2.843-13.501-9.129-25.091-18.636-35.051c-1.059-1.109-1.624-3.064-1.703-4.662c-0.225-4.519-0.177-9.058-0.049-13.584 c0.13-4.584-1.863-6.712-6.52-6.641c-7.688,0.117-23.46,0.032-23.46,0.032v-7.081c0,0,15.513,0.035,23.187-0.012 c5.264-0.032,6.699-1.51,6.757-6.834c0.042-3.858,0.047-7.718-0.001-11.576c-0.066-5.278-1.476-6.669-6.885-6.701 c-7.529-0.044-22.059-0.011-22.059-0.011v-6.073c0,0,14.421,0.036,22.088-0.012c5.373-0.034,6.792-1.451,6.855-6.73 c0.048-4.026-0.055-8.054,0.028-12.079c0.089-4.361-1.944-6.374-6.308-6.332c-7.707,0.073-23.662,0.021-23.662,0.021 s0-18.743,0-28.6c29.397-8.459,46.462-28.621,52.535-59.535c5.681,5.182,10.784,9.539,17.649,7.382 c3.324-1.045,6.767-3.214,9.025-5.845c4.929-5.744,3.921-14.326-1.559-19.637c-6.511-6.312-13.714-5.558-25.117,3.388 c-5.85-30.371-22.706-50.809-52.896-59.482c0-11.328-1.021-22.855,0.356-34.088c0.927-7.564,7.385-13.291,13.943-17.092 c17.546-10.17,29.776-24.263,35.419-43.925c0.495-1.726,2.182-3.403,3.745-4.482c12.023-8.304,22.113-18.494,30.667-30.315 c1.255-1.734,3.402-3.24,5.446-3.923c25.095-8.384,41.101-25.168,47.682-50.873c0.553-2.159,1.517-4.212,2.638-7.26 c1.992,1.814,3.143,2.911,4.345,3.949c6.307,5.446,15.194,5.081,20.928-0.844C371.579,191.607,371.538,182.33,365.84,176.489z M253.55,107.072c4.157,3.613,7.747,6.732,11.337,9.852c-0.326,0.501-0.652,1.003-0.979,1.504 c-4.182,0.798-8.365,1.596-13.163,2.512C251.718,116.132,252.577,111.882,253.55,107.072z M185.289,45.98c29.823,0,54,24.177,54,54 c0,29.823-24.177,54-54,54s-54-24.177-54-54C131.289,70.157,155.466,45.98,185.289,45.98z M164.151,165.773 c13.581,4.334,27.363,4.22,41.777,0.199c-4.474,14.48-3.87,28.139,0.027,42.429c-14.232-4.098-27.748-4.399-41.531-0.444 c0.777-7.312,2.093-14.066,2.044-20.809C166.419,180.244,165.032,173.349,164.151,165.773z M116.538,107.809 c1.209,5.322,2.145,9.436,3.252,14.311c-4.762-1.06-8.731-1.943-13.791-3.07C109.65,115.157,112.775,111.823,116.538,107.809z M98.289,239.98c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54s54,24.177,54,54 C152.289,215.804,128.113,239.98,98.289,239.98z M115.949,265.97c-3.407-3.594-6.205-6.546-9.77-10.308 c5.012-1.059,8.587-1.815,12.604-2.664C117.803,257.484,116.976,261.266,115.949,265.97z M239.289,683.98c0,29.823-24.177,54-54,54 s-54-24.177-54-54s24.177-54,54-54S239.289,654.157,239.289,683.98z M239.289,452.98c0,29.823-24.177,54-54,54s-54-24.177-54-54 s24.177-54,54-54S239.289,423.157,239.289,452.98z M185.289,327.98c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54 s54,24.177,54,54C239.289,303.804,215.113,327.98,185.289,327.98z M253.079,268.69c-1.271-6.405-2.241-11.297-3.279-16.525 c5.356,1.047,10.057,1.966,16.634,3.251C261.644,260.177,257.764,264.034,253.079,268.69z M272.289,239.98 c-29.823,0-54-24.177-54-54c0-29.823,24.177-54,54-54c29.823,0,54,24.177,54,54C326.289,215.804,302.113,239.98,272.289,239.98z",
    clocks: {
      size: 108,
      0: { x: 185.128, y: 100 },
      1: { x: 98.128, y: 186 },
      2: { x: 272.128, y: 186 },
      3: { x: 185.128, y: 274 },
      4: { x: 185.128, y: 453 },
      5: { x: 185.128, y: 684 }
    }
  }
}, Wg = {
  teeth: {
    tall: {
      viewBox: "0 0 512 1540",
      paths: {
        frame: "M0,0v1540l512-244.2V0H0z M451,1263.5l-390,186V61h390V1263.5z",
        half: "M0,0v748l512-244.2V0H0z",
        full: "M0,0v1540l512-244.2V0H0z"
      }
    },
    med: {
      viewBox: "0 0 512 1540",
      paths: {
        frame: "M0,0v1388l512-395.6V0H0z M458,965.7L54,1278V53h404V965.7z",
        full: "M0,0v1540l512-244.2V0H0z"
      }
    },
    short: {
      viewBox: "0 0 512 1540",
      paths: {
        frame: "M0,0v991l511.4-247L512,0H0z M470.5,715.2L41,922.6V40h430L470.5,715.2z",
        full: "M0,0v991l511.4-247L512,0H0z"
      }
    }
  },
  armor: {
    viewBox: "0 0 512 512",
    paths: {
      heavy: "M157.5,80.7c-20.6,13.7-46,22.5-69.4,26c6.8,48.9,26.1,84.1,46,97.8 c10.5,7.3,20.4,9,30.4,5.6c8.9-3.1,18.6-11,27.8-25.6C165.3,154.3,160.6,113.5,157.5,80.7L157.5,80.7z M354.5,80.8 c-3.1,32.8-7.8,73.6-34.7,103.8c9.1,14.6,18.9,22.5,27.8,25.6c10,3.4,19.8,1.7,30.4-5.6c19.8-13.7,39.1-48.8,45.9-97.7 C399.3,103.7,376,95.5,354.5,80.8L354.5,80.8z M254.4,67.9c-37.1,0-69.8,8.3-89.6,21c1.2,6.5,2.6,13,4.2,19.3 c19.2-8.2,50.3-16.7,85.4-16.7c35.2,0,66.3,8.5,85.4,16.7c1.7-6.3,3.1-12.8,4.2-19.3C324.2,76.2,291.5,67.9,254.4,67.9z M64.9,127.9l-47.7,45.5c29.8,37.2,63,56.8,86.5,58.7c1.1,0.1,2.3,0.1,3.3,0.2c1.8-7.6,4-15.1,6.5-22.3 C91.7,194.9,74.4,166.1,64.9,127.9L64.9,127.9z M447.1,127.9c-9.6,38.3-26.9,67-48.6,82c0,0-0.1,0-0.1,0.1 c2.5,7.3,4.7,14.7,6.5,22.3c1.1,0,2.2-0.1,3.4-0.2c23.4-1.9,56.8-21.5,86.5-58.7L447.1,127.9L447.1,127.9z M176,139.4 c5.7,12.2,13.1,23.3,22.9,32.8l6.4,6.2l-4.3,7.8c-2.3,4.1-4.6,8-7,11.7c40.8,15,85,14,124-0.2c-2.4-3.6-4.6-7.4-6.9-11.4l-4.3-7.8 l6.4-6.2c9.4-9.1,16.7-19.9,22.3-31.5C280.8,153.8,228.5,151.3,176,139.4L176,139.4z M401.7,243.6c0,0-3.7,38.1-22.9,76.1 l-121.7-32.7l-1.8-0.4l-1.8,0.4l-120.3,32.7c-19-38-22.7-76.1-22.7-76.1s12,3.8,19.5-18.7c10.7,3.2,22,3.3,32.8-0.4 c9.2-3.2,17.8-8.8,25.8-16.9c21.6,8.9,44.2,13.1,66.7,13.1c22.7,0,45.6-4.2,67.4-13.1c8,8,16.8,13.7,26.1,16.9 c10.9,3.7,22.3,3.6,33.1,0.4C389.6,247.4,401.7,243.6,401.7,243.6z M486.1,210.7c-25.4,24.2-52.1,38-76.2,40c-0.4,0-0.9,0-1.3,0.1 c1.2,8.1,2,16.2,2.3,24.4c22.8,3.8,54.7,0.1,90-14.3L486.1,210.7L486.1,210.7z M25.9,210.8l-14.8,50.1c35.3,14.4,67.2,18.1,90,14.3 c0.3-8.2,1.1-16.3,2.3-24.4c-0.4,0-0.9,0-1.3-0.1C78,248.7,51.3,234.9,25.9,210.8L25.9,210.8z M256,305.2l-114.8,28.1 c1.9,7.7,10.1,17.6,15.4,23.8c31.8-7.3,59.3-11.4,94.7-11.6c2.6,0,5.3,0,7.9,0c38.2,0.3,64.9,4.3,95.9,11.6 c5.1-6.2,15.2-15.8,16.8-23.6L256,305.2L256,305.2z M254.1,347.8l-79.3,22.1c5.8,4.8,16,8.5,23.2,13.3c18-5,33.5-7.8,53.5-7.9 c1.5,0,3,0,4.5,0c21.6,0.2,36.6,3,54.1,7.9c9.9-1.8,16.8-6.8,25.5-12.3L254.1,347.8L254.1,347.8z M373.3,377.7 c-68.3,55.6-166.9,55.7-235.3,0.3l-1.8,35.9c4.7,7.9,18.3,17,38,23c21,6.4,48,9.9,75.6,10.2c27.6,0.3,55.8-2.6,79.4-8.7 c21.6-5.6,39.3-14.2,48.8-23.9L373.3,377.7L373.3,377.7z",
      light: "M254.9,88c-23.1,0-44.1,2.8-59.8,8.8c-7.9,3-14.5,6.8-19.5,11.9c-5,5.1-8.4,12.1-8.4,19.9 c0,3.2,0.5,6.2,1.5,9.1c2,37.1-20.9,83.9-46,107.5c5.9,35.9,19.4,72.7,39.6,106.3c23.8,23,54.6,35.4,85.9,37.1v-24 c-9.6-0.1-19-0.5-26.5-1.1l0.8-13.2c7.1,0.6,16.2,1,25.7,1.1v-28.3c-9.1,0.4-17.9,1.8-24.4,4.2l-3.3-12.7 c8.1-2.9,17.8-4.6,27.7-5.1v-23.8c-2.9,0.2-5.8,0.5-8.7,1c-17.2,1-31.8,3.6-45.2,7.5l-0.1-0.2c16.7-14.8,38.1-22.2,59.6-22.2 c21.4,0,42.9,7.4,59.6,22.2l-0.1,0.1c-13.4-3.9-28.1-6.5-45.4-7.5c-2.8-0.5-5.7-0.8-8.5-1v23.8c10,0.5,19.7,2.1,27.7,5.1l-3.3,12.7 c-6.6-2.4-15.4-3.8-24.5-4.2v28.3c9.4-0.1,18.6-0.4,25.7-1.1l0.8,13.2c-7.5,0.7-16.9,1-26.5,1.1v24.1c32.4-0.8,64.6-13,89.4-36.5 c21.1-33.6,34.9-69.9,40.8-105.3c-26.2-23.2-50.7-72.5-47.8-110.7c0.7-2.5,1-5,1-7.7c0-7.8-3.4-14.8-8.4-19.9 c-5-5.1-11.7-8.9-19.6-11.9C298.9,90.8,278,88,254.9,88L254.9,88z M254.9,101.3c22.3,0,42.5,2.9,56.4,8.2c7,2.7,12.4,6,15.7,9.3 c3.3,3.4,4.5,6.3,4.5,9.9c0,1.8-0.3,3.6-1.1,5.5c-21.9-11.9-49.3-17.9-76.7-17.9c-26.6,0-53.2,5.6-74.7,16.8 c-0.5-1.5-0.7-2.9-0.7-4.4c0-3.5,1.2-6.5,4.5-9.9c3.3-3.4,8.7-6.7,15.7-9.3C212.4,104.1,232.6,101.3,254.9,101.3L254.9,101.3z M253.7,130c24.6,0,49.2,4.8,68.6,14.3c-3.1,2.6-6.9,5.1-11.4,7.3c-13.9,7-33.9,11.5-56,11.5s-42-4.5-56-11.5 c-4.9-2.4-9-5.2-12.2-8C205.8,134.5,229.7,130,253.7,130z M232.3,174.9c3.7,0.5,7.5,0.9,11.4,1.2c0.5,3.6,1,7.5,1.6,11.8 c1.6,13,3.3,27.9,3.3,37.5c0,10.8-3.5,20.6-9.5,28.1c-6.1,7.5-14.5,13-24.6,16.5c-11.2,3.9-24.5,5.6-39.3,4.8 c-14.2-2.5-25.1-9.3-35.7-19.6c29.1,8.3,54.5,8.2,71.9,2.1c8.7-3.1,15.4-7.6,19.7-13c4.3-5.4,6.5-11.4,6.5-18.9 c0-7.7-1.6-22.8-3.1-35.6C233.6,184.1,232.9,179,232.3,174.9L232.3,174.9z M275,175.2c-0.6,4-1.3,9-2,14.6 c-1.6,12.7-3.1,27.9-3.1,35.6c0,7.5,2.1,13.6,6.5,18.9c4.3,5.4,11,9.9,19.7,13c17.3,6.1,42.6,6.2,71.6-2.1 c-10.6,10.3-21.5,17.1-35.7,19.6c-14.8,0.8-28-0.9-39.1-4.8c-10.1-3.5-18.5-9-24.6-16.5s-9.5-17.3-9.5-28.1 c0-9.7,1.7-24.6,3.3-37.5c0.5-4.3,1.1-8.2,1.5-11.7C267.4,176,271.2,175.7,275,175.2L275,175.2z M347.1,370.2 c-52.9,43.1-129.3,43.2-182.3,0.3l-1.4,27.8c3.6,6.1,14.2,13.2,29.4,17.8c16.3,4.9,37.2,7.7,58.5,7.9c21.4,0.2,43.2-2,61.5-6.7 c16.8-4.3,30.4-11,37.8-18.5L347.1,370.2L347.1,370.2z",
      special: "M256,14.2c-65.6,98.3-131.1,90.2-196.7,106.5c0,262.3,65.6,327.8,196.7,377 c131.1-49.2,196.7-114.7,196.7-377C387.1,104.4,321.6,112.6,256,14.2z M256,47c5.1,0,9.2,4.1,9.2,9.2s-4.1,9.2-9.2,9.2 s-9.2-4.1-9.2-9.2S250.9,47,256,47z M70.6,138.2c0-5.1,4.1-9.2,9.2-9.2s9.2,4.1,9.2,9.2s-4.1,9.2-9.2,9.2S70.6,143.3,70.6,138.2z M92.1,301.1c-5.1,0-9.2-4.1-9.2-9.2c0-5.1,4.1-9.2,9.2-9.2s9.2,4.1,9.2,9.2C101.3,296.9,97.2,301.1,92.1,301.1z M157.7,432.2 c-5.1,0-9.2-4.1-9.2-9.2c0-5.1,4.1-9.2,9.2-9.2s9.2,4.1,9.2,9.2C166.9,428.1,162.7,432.2,157.7,432.2z M256,483.4 c-5.1,0-9.2-4.1-9.2-9.2s4.1-9.2,9.2-9.2s9.2,4.1,9.2,9.2S261.1,483.4,256,483.4z M354.3,432.2c-5.1,0-9.2-4.1-9.2-9.2 c0-5.1,4.1-9.2,9.2-9.2c5.1,0,9.2,4.1,9.2,9.2C363.6,428.1,359.4,432.2,354.3,432.2z M314.4,426.7c-15.8,11.1-33.7,18.7-51.1,26.8 c-6.7,4.7-14-0.5-20.7-2.5c-44.7-18.3-86.5-49.8-107.6-94.5c-29.8-63.5-33.8-135-36.7-204.3c58.8-9,115.3-28.5,156.2-72.1l1.9-2.1 c4.5,5,9.3,9.8,14.2,14.5c35.8,36.3,85,47,133.9,57.8c2.8,1.2,6.8,0.5,9.1,2c-2.7,66.4-5.7,134.9-33.1,196.4 C367.3,380.9,343.2,407.7,314.4,426.7z M419.9,301.1c-5.1,0-9.2-4.1-9.2-9.2c0-5.1,4.1-9.2,9.2-9.2s9.2,4.1,9.2,9.2 C429.1,296.9,425,301.1,419.9,301.1z M432.2,147.4c-5.1,0-9.2-4.1-9.2-9.2s4.1-9.2,9.2-9.2s9.2,4.1,9.2,9.2 S437.3,147.4,432.2,147.4z M301.1,154.9c0.2,23.3,0.3,46.6,0.5,69.9c0,1,0.4,2.2,0.9,3.1c4.9,8.4,9.8,16.9,15,25.1 c1.6,2.6,0.8,5.1,0.6,7.6c-0.7,9.5-1.7,19-2.6,28.5c-1,10.5-2,21-3,31.6c-0.8,9-1.6,17.9-2.4,26.9c-0.8,9-1.7,17.9-2.5,26.9 c-0.7,7.3-1.3,14.6-2,22c-0.1,1.2-0.6,2.7-1.4,3.6c-12,12-24.1,23.9-36.2,35.9c-0.2,0.2-0.5,0.5-1.1,1c0-1.1,0-1.8,0-2.5 c0.1-66.5,0.3-133,0.5-199.5c0-1.5,0.8-3.2,1.7-4.4c2.2-2.9,2.8-6,2.8-9.6c0-28.5,0.1-57.1,0.2-85.6c0-0.7,0-1.5,0-2.5 c0.8,0,1.5-0.1,2.3-0.1c13.9,0.1,27.8,0.1,41.7,0.1c1.2,0,1.9,0.3,2.3,1.5c0.8,2.2,1.7,4.3,2.7,6.6c-6.2,3.9-12.2,7.6-18.2,11.3 C301.6,152.6,301.1,153.4,301.1,154.9z M245.2,433.7c0,0.9,0,1.7,0,2.6c-0.2,0.1-0.4,0.2-0.6,0.3c-1.4-1.5-2.8-3.1-4.3-4.5 c-10.7-10.6-21.5-21.2-32.2-31.9c-0.9-0.9-1.6-2.5-1.7-3.9c-1-9.2-1.8-18.4-2.6-27.5c-0.7-7.2-1.3-14.3-2-21.5 c-0.8-9.2-1.7-18.4-2.6-27.5c-0.7-7.1-1.3-14.2-1.9-21.3c-0.9-9.3-1.7-18.5-2.6-27.8c-0.5-4.9-1-9.9-1.3-14.8 c-0.1-0.7,0.4-1.6,0.8-2.2c5.1-8.6,10.2-17.1,15.2-25.7c0.5-0.9,0.9-2.1,0.9-3.1c0.2-23.2,0.3-46.4,0.5-69.6c0-1.6-0.5-2.5-1.9-3.4 c-6-3.6-11.9-7.3-18-11.2c1-2.5,2-4.9,3.1-7.4c0.2-0.3,0.8-0.6,1.2-0.6c14.6-0.1,29.3-0.1,43.9-0.1c0.1,0,0.3,0.1,0.6,0.3 c0,0.7,0.1,1.5,0.1,2.3c0.1,29.2,0.2,58.4,0.3,87.7c0,2.1,0.3,4,1.7,5.6c2.5,2.9,3,6.2,3,10C244.9,303.4,245.1,368.5,245.2,433.7z",
      specialBg: "M316.9,432.4c-16.5,11.6-35,19.4-53.1,27.8c-7,4.9-14.6-0.5-21.6-2.6 c-46.5-19-90-51.8-111.9-98.3c-31-66.1-35.1-140.5-38.2-212.4c61.2-9.4,119.9-29.6,162.4-75l2-2.1c4.7,5.2,9.6,10.2,14.7,15.1 c37.2,37.7,88.4,48.9,139.2,60.1c2.9,1.3,7.1,0.5,9.4,2.1c-2.9,69.1-5.9,140.3-34.4,204.3C372,384.8,346.8,412.7,316.9,432.4z"
    }
  },
  ReducedEffect: {
    viewBox: "0 0 512 512",
    paths: {
      main: "M260.7,487.55C133,487.55,28.39,382.92,28.39,255.23S133,24.45,260.7,24.45A230.5,230.5,0,0,1,491.49,255.23c0,127.69-103.1,232.32-230.78,232.32Zm-1.06-82L377,287.58l-23.94-25.1-65.41,37.94V128a167.28,167.28,0,0,1,103.6,268.91,193.71,193.71,0,0,0,61.22-141.63A191.18,191.18,0,0,0,260.7,63.45c-106.39,0-193.31,85.39-193.31,191.78A192.9,192.9,0,0,0,128,395.55,167.3,167.3,0,0,1,231,128.2V296.92l-62.5-35.62-25.09,26.28Z"
    },
    classes: {
      main: "fill-linear"
    }
  },
  ComplicationMinor: {
    viewBox: "0 0 512 512",
    paths: {
      main: "M345.58,263.18l39.74-8.31,73.29-15.3,22.83-4.79,2.81-.58,9.56-2V213.1l-6.33,1.33-79.55,16.62-26.49,5.54-55.93,11.69c-13-11.18-20-24.73-27.16-39.89l-1.67-3.53,34.18-46.76,57.87-79.18,3-4.1,41.19-56.33H409.77L375.26,65.7l-4.09,5.59-60.51,82.78-32.91,45c-15.06-6.36-26.14-17.76-38.57-30.33l-2.34-2.37-4.59-30.28L216.72,33.5l-1-6.47-1.29-8.54h-18.9l2.84,18.75-.11-4.41,15.2,104.1,5.59,37c-11.18,7.5-24.44,12.15-39,15.49l-22.9-28.89L93.8,80.58,44.58,18.49H20.74l53,66.83,4.18,5.26,66.54,84,19.15,24.16-.08.7c-1.93,17.37-8.88,29.63-16.65,43.07L115.3,234.2,25.49,210.61,23.08,210l-4.31-1.14v19.32l2.56.67L112,252.65l27.61,7.25.56,1.4c6.1,15.15,5.39,31.77,2.9,49.71l-30.31,14.2L23.15,367.14l-4.38,2.06v20.62l9.18-4.3,67.92-31.77,17.13-8,28.92-13.54,1.52,1.53c5.85,5.86,10,10.29,11.22,20.75l-31.14,31.3L56.27,453.39l-37.5,37.69v2.43h24l20.91-21h0l77.94-78.36,24.11-24.24,1-.23c23.75-5.79,59.86-6.75,80.11-6.78,4,0,6.81,0,9.35.08l10.4,32.29L293,477.73l1.54,4.78,3.54,11h19.63l-5.19-16.14-2.24-6.95-25.77-80.06-11-34.32c3.55-3.17,8.73-7.63,15-12.42,11.42-8.73,26.21-17.7,35.68-19.62l4.24-.87,25.37,10L442,368.08l4.18,1.66,47.6,18.83V368.48l-37.78-15-5.21-2-82.75-32.74-36.59-14.48c0-13.16,1.4-22.85,9.12-33.93Zm-61.35-41.29c5.12,10.41,11.11,21.1,19.66,30.91l-31.15,6.52a39.69,39.69,0,0,0-6.93-12.22Zm-62.13-28,6,39.74a39.25,39.25,0,0,0-10.25,3.48l-25.18-31.77A132,132,0,0,0,222.1,193.9Zm-43.39,23.92,24.91,31.43a38.6,38.6,0,0,0-4.08,7.07l-33.92-8.92C170.58,238.65,175.45,229.15,178.71,217.82Zm17.49,56.93a39.32,39.32,0,0,0,2.08,10.45L163,301.7c1.05-11.91.92-24.05-2-36.2ZM160,324.27l.09-.55,47.15-22.07h0L169.55,339.5A54.79,54.79,0,0,0,160,324.27Zm28.37,22.85,36.61-36.8a39.43,39.43,0,0,0,10.6,1.45,35.54,35.54,0,0,0,4-.2L250,344.11C236.7,344,212.41,344.2,188.33,347.12ZM250.78,236a35.39,35.39,0,0,0-3.61-1.32L241.46,197a109.45,109.45,0,0,0,25.15,17.38Zm26.37,92.76c-3.9,3-7.1,5.61-9.88,8l-10.1-31.4a39.81,39.81,0,0,0,8.16-7.16l36.5,14.44A169,169,0,0,0,277.15,328.76Zm36-31.76L273.9,281.47c.26-1.14.47-2.29.64-3.44l45.58-9.53C315.5,277.93,313.74,287.39,313.17,297Z"
    },
    classes: {
      main: "fill-radial"
    }
  },
  ComplicationMajor: {
    viewBox: "0 0 512 512",
    paths: {
      main: "M458.26,239.57l22.83-4.78,2.81-.59,9.56-2v-19.1l-6.33,1.33-79.55,16.62-26.49,5.54-55.93,11.69c-13-11.18-20-24.73-27.16-39.89l-1.67-3.53,34.18-46.76.58-.79c9.76,28.37,24.84,58.48,51.36,78.35l24.6-5,1.83-.54L407.07,229c-37.27-19.15-50.45-51.64-61.94-88.83l-.44-1.43,43.69-59.78,3-4.1,41.19-56.34H409.42L374.91,65.7l-4.09,5.6-46.71,63.9c-34.73.23-70.42-3-95.76-22.5l-12-79.19-1-6.47-1.29-8.55H195.2L198,37.24l-.11-4.4,12.18,83.44c-17,16.89-39.15,28.73-67.39,26.48L93.45,80.59,44.23,18.49H20.39l53,66.83,4.18,5.27L129,155.51c-3.16,27.24-16.63,53.33-32.88,73.74l-71-18.63L22.73,210l-4.31-1.13v19.32l2.56.67,71.38,18.74c8.29,26.73,6.3,57.28,2.12,86L22.8,367.15l-4.38,2.05v20.63l9.18-4.3,67.92-31.78,1.09-.51A190.52,190.52,0,0,1,104.47,382c1.33,7.25,2.58,14.68,3.19,19.36l-51.74,52-37.5,37.69v2.43H42.37l20.91-21h0l58.27-58.57c10.1-.83,33.7-2.28,59.06-3.17,7.9-.28,16.15-.45,24.46-.47,23.47-.05,49.4,1.12,67.34,4.45l20.27,63,1.54,4.79,3.54,11h19.63l-5.19-16.14L310,470.43,291.2,412.17c23.43-27.05,48.62-54.87,86-69.58l64.45,25.5,4.18,1.65,47.6,18.84v-20.1l-37.78-15-5.21-2.06-62.74-24.82c-3.11-24.21,8.64-50.64,20.2-76.57ZM266.92,336.72l-10.1-31.4a39.76,39.76,0,0,0,8.16-7.15l36.5,14.44a169,169,0,0,0-24.68,16.16C272.9,331.76,269.7,334.38,266.92,336.72Zm-71.07-62a39.17,39.17,0,0,0,2.08,10.44l-35.27,16.5c1.05-11.9.92-24-2-36.19Zm-30.58-27.35c5-8.75,9.83-18.25,13.09-29.59l24.91,31.43a39.28,39.28,0,0,0-4.08,7.07Zm41.58,54.25h0L169.2,339.51a54.79,54.79,0,0,0-9.59-15.23l.09-.56Zm17.74,8.67a39.43,39.43,0,0,0,10.6,1.45,38,38,0,0,0,4-.2l10.47,32.54c-13.32-.16-37.61.08-61.69,3Zm22.23-75.64L241.11,197a109.17,109.17,0,0,0,25.15,17.39L250.43,236A37.88,37.88,0,0,0,246.82,234.69Zm26.73,46.78c.26-1.13.47-2.28.64-3.43l45.58-9.53c-4.62,9.43-6.38,18.89-6.95,28.5Zm30-28.66-31.15,6.51a39.53,39.53,0,0,0-6.93-12.21l18.42-25.21C289,232.31,295,243,303.54,252.81ZM232.78,136.13c23.18,13.26,50.47,17.92,77,18.68l-32.37,44.3c-15.06-6.37-26.14-17.76-38.57-30.33l-2.34-2.37-4.59-30.28,0-.12Zm-5,97.52a39.25,39.25,0,0,0-10.25,3.48l-25.18-31.77a132,132,0,0,0,29.42-11.45Zm-14.52-96,5.48,36.25c-11.18,7.5-24.44,12.15-39.05,15.49l-22.46-28.34C178.25,159.21,198.58,149.44,213.24,137.65Zm-69.67,36.28.5.63,19.15,24.15-.08.71c-1.93,17.37-8.88,29.63-16.65,43.06L115,234.2l-.07,0C127,217.56,138.38,195.1,143.57,173.93ZM123.4,385.56c-.42-2.17-1.06-4.9-1.43-6.92-1.84-10-4.7-23.39-8.85-33.12l28.45-13.32,1.52,1.53c5.85,5.87,10,10.3,11.22,20.75Zm15.89-125.65.56,1.4c6.1,15.14,5.39,31.77,2.9,49.71l-29,13.58c2.87-22.76,3.42-48.28-2.06-71.93h0Zm72.18,131.64h-6.55c-8.5.05-16.9.25-25,.53-15.57.55-28,1.33-37.85,2.07l.07-.07a7.94,7.94,0,0,1-.82-.06l24-24.11,1-.23c23.75-5.79,59.86-6.75,80.11-6.78,4,0,6.81,0,9.35.07l10.29,32C249.77,392.55,229.58,391.66,211.47,391.55Zm73.59-1.18-.71.53-.17-.53-11-34.32c3.55-3.17,8.73-7.63,15-12.42,11.42-8.73,26.21-17.7,35.68-19.63l4.24-.86,25.37,10C324.89,348,303.58,369.47,285.06,390.37ZM368.49,319l-.77-.31-36.59-14.48c0-13.15,1.4-22.84,9.12-33.92l5-7.14L385,254.88l.12,0C376.44,274.07,368.18,297,368.49,319Z"
    },
    classes: {
      main: "fill-radial"
    }
  },
  ComplicationSerious: {
    viewBox: "0 0 512 512",
    paths: {
      main: "M21.42,17.34,78.56,89.45c-2.73,48.59-23.75,85.79-52.39,120l-6.72-1.76V227l2.56.67C37.36,272.78,31.1,318.54,23.83,366l-4.38,2.05v20.63l9.18-4.29c6.52,10.7,13.66,27,19.06,41.33,4.29,11.33,7.48,21,9.26,26.53l-37.5,37.69v2.43h24L72,463.67c9.27-.36,41.77-1.47,82.7-.75,46.74.83,102.61,4.3,139,13.67l5.08,15.78h19.63L311,469.28c35.94-41.51,71.91-80.52,131.73-102.34l51.78,20.49v-20.1l-43-17c-6.37-39.21,12.76-76.67,30.62-116.68l12.37-2.59V212l-6.33,1.32-5.45-2.8c-56.09-28.83-76.33-78-93.3-132.7L433.6,17.34H410.45l-38.6,52.81c-58.28,1.26-112.48-2.46-154.45-37.79l-2.27-15h-18.9l2.83,18.75c-27.13,29-57.56,48-104.58,43.36L45.26,17.34Zm199.92,41c40.6,26.3,88.49,30.89,136.75,30.63L325,134.32c-36.59.39-69.86-3-95.85-24.64l-7.76-51.33Zm-18.84.44,8.29,54.77c-17.81,18.62-37.29,30.18-68,26.86L109.72,98.68c38.59-.74,68.36-17.15,92.78-39.89ZM375.83,96.38c15.53,47,37.05,92.69,84.55,122.72l-51.77,10.82-.82-.42c-37.27-19.14-50.44-51.64-61.93-88.83l-.72-2.31,30.68-42ZM95.09,110.3l34.39,43.39c-2.52,29.59-15.41,52.66-33.14,74.21L45.93,214.67c23.72-29.78,42.64-63.39,49.16-104.37ZM232.93,135c23.94,13.69,51.05,17.4,78.41,17.94l-32.91,45c-15.06-6.36-26.14-17.75-38.57-30.32l-2.35-2.37L232.93,135Zm-18.77.81,5.59,36.95c-11.18,7.5-24.44,12.15-39.05,15.49l-22.9-28.89c22.71-1.4,41.09-10.68,56.36-23.55ZM331.54,157c9.74,29.15,23.14,58,50.58,78.49l-55.93,11.69c-13-11.18-20-24.74-27.16-39.89l-1.67-3.53ZM145.1,173.41l19.15,24.16-.08.71c-1.93,17.36-8.88,29.63-16.65,43.06L116,233.06c13.21-17.36,23.94-36.83,29.12-59.65Zm77.68,19.35,6,39.75A38.88,38.88,0,0,0,218.54,236l-25.18-31.77a132.49,132.49,0,0,0,29.42-11.45Zm19.36,3.05a109.17,109.17,0,0,0,25.15,17.39l-15.83,21.66c-1.18-.49-2.38-.94-3.61-1.32l-5.71-37.73Zm-62.75,20.86L204.3,248.1a39.37,39.37,0,0,0-4.08,7.07l-33.92-8.9c5-8.76,9.83-18.25,13.09-29.6Zm105.52,4.08c5.12,10.42,11.11,21.1,19.66,30.92l-31.15,6.5A39.64,39.64,0,0,0,266.49,246l18.42-25.21ZM43.14,233.26,92,246.09c9.23,28.21,5.8,57.08,1.2,87.45l-49.07,23c6-40.15,10.29-81.42-1-123.24Zm416.14,5.16c-14.93,32.63-30.11,66.73-27.43,104.13l-43.74-17.31c-3.6-25,8.78-49.44,20.72-76.28l50.45-10.54Zm-346.57,13.1,27.61,7.25.56,1.4c6.1,15.13,5.39,31.77,2.9,49.71l-30.32,14.18c3.22-23.51,5-47.81-.75-72.54ZM386,253.74c-9,19.81-17.8,40.8-17.25,63.84l-36.59-14.47c0-13.15,1.4-22.84,9.12-33.92l5-7.15,39.74-8.3ZM161.64,264.36l35.24,9.26A39.33,39.33,0,0,0,199,284.06l-35.27,16.5c1.05-11.9.92-24.05-2.05-36.2Zm159.16,3c-4.62,9.44-6.38,18.89-6.95,28.5l-39.27-15.54c.26-1.12.47-2.27.64-3.43l45.58-9.53ZM266,297l36.5,14.44a169,169,0,0,0-24.68,16.16c-3.9,3-7.1,5.6-9.88,7.94l-10.11-31.4A39.76,39.76,0,0,0,266,297Zm-58.12,3.48-37.66,37.86a54.85,54.85,0,0,0-9.59-15.24l.09-.55,47.15-22.07Zm17.73,8.67a39.43,39.43,0,0,0,10.6,1.46c1.35,0,2.69-.07,4-.2L250.7,343c-13.32-.16-37.62.07-61.7,3l36.61-36.81ZM329.1,322l25.36,10c-29.4,14.92-50.37,35.89-69.25,57.2l-11-34.32c3.55-3.18,8.73-7.63,15-12.43,11.42-8.73,26.21-17.7,35.68-19.63l4.24-.86Zm-186.5,9.07,1.52,1.52c5.85,5.88,10,10.31,11.22,20.75L124.2,384.64c-.35-2.27-.74-4.63-1.2-7.14-2-10.95-4.45-22.94-9.32-32.9l28.92-13.54Zm235.93,10.49,39.22,15.52c-49.42,22.5-82.92,56.68-113.45,91.47l-12.44-38.65c24.11-27.84,47.68-53.61,86.67-68.34Zm-282,11.06c3,6.84,6.22,18.17,8.07,28.26,1.58,8.61,2.5,16.08,3,20.45L71.72,437.4c-1.68-5-3.78-11-6.55-18.29-5.37-14.22-12-30-19.61-42.64l51-23.86Zm150.86,9.15c4,0,6.81,0,9.35.06l10.39,32.3c-26.25-4.15-58.63-4.19-87-3.18-15.58.55-28,1.32-37.86,2.06l24.11-24.24,1-.23C191,362.74,227.16,361.79,247.41,361.76Zm-42.19,47.39c24.92-.06,50.36,1.26,68.41,5.1L287.06,456c-38.71-8.23-89-11-132.09-11.74-27.22-.48-49.23-.19-63.87.17l30.8-31c7.77-.76,30.71-2.84,58.86-3.84,7.9-.28,16.15-.45,24.46-.47Z"
    },
    classes: {
      main: "fill-radial"
    }
  },
  LostOpportunity: {
    viewBox: "0 0 512 512",
    paths: {
      main: "M373.33,52.76A234.57,234.57,0,0,0,52.77,138.67C-12,250.93,26.41,394.41,138.67,459.23s255.75,26.36,320.56-85.91S485.59,117.58,373.33,52.76Zm-211.87,367A189.1,189.1,0,0,1,81,184.37L327.62,431A188.73,188.73,0,0,1,161.46,419.76Zm211.18-14.87L107.14,139.38a187.3,187.3,0,0,1,32.24-32.29L404.89,372.6A187.71,187.71,0,0,1,372.64,404.89ZM431,327.6,184.41,81A189.12,189.12,0,0,1,431,327.6Z"
    },
    classes: {
      main: "fill-linear"
    }
  },
  WorsePosition: {
    viewBox: "0 0 512 512",
    paths: {
      horizon: "M18.36,227.8v18.68h86.37a98.45,98.45,0,0,0-4.43-18.68Zm379.4,0a110.51,110.51,0,0,1,9.44,18.68h86.44V227.8H397.76Z",
      boot: "M218.67,18.73a162.14,162.14,0,0,0-20,1.32C164,24.39,123.5,39.4,91.23,67.36L124.7,257.55l.35,10.12c42.26,15.79,100.82,24.55,152.87,24.25,27.19-.15,52.64-2.74,73-7.78s35.2-12.82,41.81-20.94l.44.35a113,113,0,0,0-6.53-17.06h.19a95.88,95.88,0,0,0-4.85-8.66c-.09-.14-.16-.3-.25-.44l-.31-.47c-21.46-34.89-63.5-55.87-124.28-29.37l-.16.06a215.37,215.37,0,0,0-34,20.19h-.81c11-15.72,23.26-28.12,35.91-37.28l1.12-11.16c-14.68-4-38.08-4.06-53.53-.09L201,161.14a130.33,130.33,0,0,1,30.34-3.84c1.5,0,3,0,4.5,0a117.66,117.66,0,0,1,25.25,3.12l3.19-32c-21.06-8.07-42.12-6.6-64.57-1.59l-4.06-18.25A170.07,170.07,0,0,1,231,104.17c1.72,0,3.44,0,5.16.07a107,107,0,0,1,30.06,5.12l3.16-31.47c-25.6-7.69-51-8.1-76.91-2.78l-3.78-18.28A188.53,188.53,0,0,1,221.52,53c1.14,0,2.29-.05,3.43-.06A167.36,167.36,0,0,1,271.23,59l.47-4.6c5-23.31-18.75-35.71-53-35.65ZM397.26,284.45c-10.84,8.13-25.26,13.7-41.87,17.82-22.37,5.54-49.07,8.18-77.38,8.34a526.46,526.46,0,0,1-65.09-3.75L225.36,329c80.16,9.44,141.5-1.19,172-21.78a113.13,113.13,0,0,0-.13-22.75ZM125.7,287.77l1,30.47,58.6,8.43,9.59-22.31c-24.55-3.82-48.21-9.37-69.19-16.59Z",
      ice: "M92.61,309.3C82.3,312.37,74,315.76,68,319.36l-.21.12L37.58,334.2,18.36,322v22.16L32,352.8l4.41,2.81,4.72-2.31,22-10.72c11.71,9.8,40.46,18.23,79.4,23.87l-60,28.25,26.63,21L18.36,454.23v39H145.14L188.86,447l51,46.28h27.84L159.11,394.8l35.06-23c20,1.37,41.34,2.15,63.56,2.15,20.7,0,40.66-.67,59.44-1.87l39.06,24.69-66.9,35.71,62.28,60.75H475.52L385,440.64l51.32-39.78-71.5-33.28c45.88-6,79.18-15.67,89.81-27l18,6.43,21.06,22.57V342.17l-8.94-9.56L483.17,331l-2.15-.78L439.8,315.42a141.57,141.57,0,0,0-16.66-6c5.37,3.24,8.28,6.7,8.28,10.28,0,18.59-77.73,33.66-173.62,33.66S84.14,338.29,84.14,319.7c0-3.63,3-7.13,8.47-10.4Z"
    },
    classes: {
      horizon: "fill-dark",
      boot: "fill-bright",
      ice: "fill-radial"
    }
  },
  InsightHarm1: {
    viewBox: "0 0 512 512",
    paths: {
      eye: "M406.09,282.69V352.6c4.19,8.54,8.53,16.73,8.53,27.56,0,13.24-8.75,22.78-18.09,22.78-9.13,0-18.69-10-18.69-23.94,0-12.22,5.1-20.64,9.56-29.59V289.63c-6.51-19.32-16.22-25.45-26.54-21.72V226.24A401.64,401.64,0,0,0,409.07,204h45.2C435.64,222.23,417,244.72,406.09,282.69ZM494.83,158.8c-33,49.83-80.77,87.12-134,108.82a291.28,291.28,0,0,1-90,21.07q-7.2.51-14.42.62a256.33,256.33,0,0,1-89-14,239,239,0,0,1-25.35-10.52A239.65,239.65,0,0,1,82.64,223.9C74.76,216.85,66,208.81,57.89,200c-11.54-12.52-21.66-26.51-25.72-41.23,20.19-37.74,48.7-69.38,84.66-92.29C241.41-14.68,416.3,37.68,494.83,158.8Zm-29.17-.36C373.78,11.86,140.41,12.08,57.19,160.28l.46.39-.46.39a353,353,0,0,0,54.67,42.55c45.21,28.32,92.77,42.1,140.82,42.29h.22C324.81,246.14,397.81,215.94,465.66,158.44Z",
      iris: "M303.7,99.51a65,65,0,0,0-45-18h0a65.26,65.26,0,1,0,45,18Zm-45.4,68.13a23.4,23.4,0,1,1,23.39-23.41A23.42,23.42,0,0,1,258.3,167.64Zm45.4-68.13a65,65,0,0,0-45-18h0a65.26,65.26,0,1,0,45,18Zm-45.4,68.13a23.4,23.4,0,1,1,23.39-23.41A23.42,23.42,0,0,1,258.3,167.64Zm45.4-68.13a65,65,0,0,0-45-18h0a65.26,65.26,0,1,0,45,18Zm-45.4,68.13a23.4,23.4,0,1,1,23.39-23.41A23.42,23.42,0,0,1,258.3,167.64Z"
    },
    classes: {
      eye: "fill-dark",
      iris: "fill-med"
    }
  },
  InsightHarm2: {
    viewBox: "0 0 512 512",
    paths: {
      eye: "M305.51,89.71A78.5,78.5,0,0,0,251.22,68h0a78.81,78.81,0,1,0,54.29,21.71ZM250.71,172a28.25,28.25,0,1,1,28.23-28.27A28.28,28.28,0,0,1,250.71,172Zm54.8-82.26A78.5,78.5,0,0,0,251.22,68h0a78.81,78.81,0,1,0,54.29,21.71ZM250.71,172a28.25,28.25,0,1,1,28.23-28.27A28.28,28.28,0,0,1,250.71,172Zm54.8-82.26A78.5,78.5,0,0,0,251.22,68h0a78.81,78.81,0,1,0,54.29,21.71ZM250.71,172a28.25,28.25,0,1,1,28.23-28.27A28.28,28.28,0,0,1,250.71,172Z",
      iris: "M398.59,282.69V352.6c4.19,8.54,8.53,16.73,8.53,27.56,0,13.24-8.75,22.78-18.09,22.78-9.13,0-18.69-10-18.69-23.94,0-12.22,5.1-20.64,9.56-29.59V289.63c-6.51-19.32-16.22-25.45-26.54-21.72V226.24A401.64,401.64,0,0,0,401.57,204h45.2C428.14,222.23,409.46,244.72,398.59,282.69Zm-264-17.94A239.65,239.65,0,0,1,75.14,223.9c-7.88-7.05-16.67-15.09-24.75-23.86,11.79,18.34,22,39.48,27.42,60.27v50c-4.76,10.14-12.06,17.21-12.06,28.41,0,9.09,11.63,18.09,21,18.09,9.2,0,21.6-9.67,21.59-19.25,0-11.36-7.31-17.81-11.87-27V278.22C103,265.1,117.78,261.12,134.61,264.75ZM487.33,158.8c-33,49.83-80.77,87.12-134,108.82a291.28,291.28,0,0,1-90,21.07q-7.2.51-14.42.62a256.33,256.33,0,0,1-88.95-14,239,239,0,0,1-25.35-10.52A239.65,239.65,0,0,1,75.14,223.9c-7.88-7.05-16.67-15.09-24.75-23.86-11.54-12.52-21.66-26.51-25.72-41.23,20.19-37.74,48.7-69.38,84.66-92.29C233.91-14.68,408.8,37.68,487.33,158.8Zm-29.17-.36C366.28,11.86,132.91,12.08,49.69,160.28l.46.39-.46.39a353,353,0,0,0,54.67,42.55c45.21,28.32,92.77,42.1,140.82,42.29h.22C317.31,246.14,390.31,215.94,458.16,158.44Z"
    },
    classes: {
      eye: "fill-med",
      iris: "fill-med"
    }
  },
  InsightHarm3: {
    viewBox: "0 0 512 512",
    paths: {
      eye: "M398.31,282.69V352.6c4.19,8.54,8.53,16.73,8.53,27.56,0,13.24-8.75,22.78-18.09,22.78-9.13,0-18.69-10-18.69-23.94,0-12.22,5.1-20.64,9.56-29.59V289.63c-6.51-19.32-16.22-25.45-26.54-21.72V226.24A401.64,401.64,0,0,0,401.29,204h45.2C427.86,222.23,409.18,244.72,398.31,282.69Zm-264-17.94A239.65,239.65,0,0,1,74.86,223.9C67,216.85,58.19,208.81,50.11,200c11.79,18.34,22,39.48,27.42,60.27v50c-4.76,10.14-12.06,17.21-12.06,28.41,0,9.09,11.63,18.09,21,18.09,9.2,0,21.6-9.67,21.59-19.25,0-11.36-7.31-17.81-11.87-27V278.22C102.75,265.1,117.5,261.12,134.33,264.75Zm114.3,24.56a256.33,256.33,0,0,1-88.95-14,109.79,109.79,0,0,1,42.38,48.58v80.59c-6.36,10.47-13.62,16.95-13.62,28.87,0,17.89,11.76,24.5,23.93,24.5,11.91,0,21.6-5.66,21.6-24.5,0-9.3-7.44-16.63-13.22-31.06V324.1C227.16,309.18,237.5,294.45,248.63,289.31ZM487.05,158.8c-33,49.83-80.77,87.12-134,108.82a291.28,291.28,0,0,1-90,21.07q-7.2.51-14.42.62a256.33,256.33,0,0,1-88.95-14,239,239,0,0,1-25.35-10.52A239.65,239.65,0,0,1,74.86,223.9C67,216.85,58.19,208.81,50.11,200c-11.54-12.52-21.66-26.51-25.72-41.23,20.19-37.74,48.7-69.38,84.66-92.29C233.63-14.68,408.52,37.68,487.05,158.8Zm-29.17-.36C366,11.86,132.63,12.08,49.41,160.28l.46.39-.46.39a353,353,0,0,0,54.67,42.55c45.21,28.32,92.77,42.1,140.82,42.29h.22C317,246.14,390,215.94,457.88,158.44Z",
      iris: "M314.46,80a91.84,91.84,0,0,0-63.52-25.39h0A92.2,92.2,0,1,0,314.46,80Zm-64.12,96.24a33.05,33.05,0,1,1,33-33.07A33.08,33.08,0,0,1,250.34,176.25ZM314.46,80a91.84,91.84,0,0,0-63.52-25.39h0A92.2,92.2,0,1,0,314.46,80Zm-64.12,96.24a33.05,33.05,0,1,1,33-33.07A33.08,33.08,0,0,1,250.34,176.25ZM314.46,80a91.84,91.84,0,0,0-63.52-25.39h0A92.2,92.2,0,1,0,314.46,80Zm-64.12,96.24a33.05,33.05,0,1,1,33-33.07A33.08,33.08,0,0,1,250.34,176.25Z"
    },
    classes: {
      eye: "fill-med",
      iris: "fill-bright"
    }
  },
  InsightHarm4: {
    viewBox: "0 0 512 512",
    paths: {
      eye: "M244,27.44c-46.86,0-93.53,12.25-134.7,39.08-36,22.91-64.47,54.55-84.66,92.29,4.06,14.72,14.18,28.71,25.72,41.23,8.08,8.77,16.87,16.81,24.75,23.86a239.65,239.65,0,0,0,59.47,40.85A239,239,0,0,0,160,275.27a256.33,256.33,0,0,0,88.95,14q7.22-.1,14.42-.62a291.28,291.28,0,0,0,90-21.07A299.94,299.94,0,0,0,430.12,222a286.46,286.46,0,0,0,57.21-63.16C434.75,77.71,339,27.44,244,27.44ZM245.4,245.9h-.22c-48.05-.19-95.61-14-140.82-42.29a353,353,0,0,1-54.67-42.55l.46-.39-.46-.39c83.22-148.2,316.59-148.42,408.47-1.84C390.31,215.94,317.31,246.14,245.4,245.9Zm17.93,42.79c7.16,3,14.11,11.57,20,28.08,3.54,9.85,6.71,22.54,9.33,38.58v74.84C287.27,440.69,281,449.64,281,462.5s10,22.19,21,22.19c10.74,0,22.18-9.73,22.18-23.34,0-14.45-7.09-23.42-12.81-34.57V342.22h-.22a223.26,223.26,0,0,1,7.48-25.45c9.57-26.37,22.57-44.47,34.73-48.86v-.29A291.28,291.28,0,0,1,263.33,288.69Zm-38.82,28.08c6.37-12.19,15.11-23.17,24.4-27.46a256.33,256.33,0,0,1-88.95-14,109.62,109.62,0,0,1,38.91,41.5q1.84,3.45,3.47,7.08v80.59c-6.36,10.47-13.62,16.95-13.62,28.87,0,17.89,11.76,24.5,23.93,24.5,11.91,0,21.6-5.66,21.6-24.5,0-9.3-7.44-16.63-13.22-31.06V324.1C222.09,321.64,223.26,319.18,224.51,316.77Zm-89.9-52A239.65,239.65,0,0,1,75.14,223.9c-7.88-7.05-16.67-15.09-24.75-23.86,11.79,18.34,22,39.48,27.42,60.27v50c-1.08,2.29-2.28,4.43-3.51,6.49-4.18,7.06-8.55,13.25-8.55,21.92,0,9.09,11.63,18.09,21,18.09,9.2,0,21.6-9.67,21.59-19.25,0-8.63-4.22-14.43-8.25-20.76a67,67,0,0,1-3.62-6.27V278.22C103,265.1,117.78,261.12,134.61,264.75Zm267-60.78a401.64,401.64,0,0,1-48.21,22.27v41.67c10.32-3.73,20,2.4,26.54,21.72v59.78c-4.46,8.95-9.56,17.37-9.56,29.59,0,13.94,9.56,23.94,18.69,23.94,9.34,0,18.09-9.54,18.09-22.78,0-10.83-4.34-19-8.53-27.56V282.69c7.59-26.52,19-45.48,31.53-60.73a225.7,225.7,0,0,1,16.65-18Z",
      iris: "M326.5,67.65a108.84,108.84,0,0,0-75.28-30.08h0A109.22,109.22,0,1,0,326.5,67.65Zm-76,114.06a39.17,39.17,0,1,1,39.15-39.19A39.2,39.2,0,0,1,250.51,181.71Zm76-114.06a108.84,108.84,0,0,0-75.28-30.08h0A109.22,109.22,0,1,0,326.5,67.65Zm-76,114.06a39.17,39.17,0,1,1,39.15-39.19A39.2,39.2,0,0,1,250.51,181.71Zm76-114.06a108.84,108.84,0,0,0-75.28-30.08h0A109.22,109.22,0,1,0,326.5,67.65Zm-76,114.06a39.17,39.17,0,1,1,39.15-39.19A39.2,39.2,0,0,1,250.51,181.71Z"
    },
    classes: {
      eye: "fill-bright",
      iris: "fill-med"
    }
  },
  ProwessHarm1: {
    viewBox: "0 0 512 512",
    paths: {
      scar: "M443.44,434.53Q408.7,409.87,376,383.64c-20-11.91-31.49.3-44.26,16.86,8.8-18.17,13.38-36.95,3.24-50.86l-4.46-3.84-44.85-35.35L237.9,336.93l17.19-25.34c7.31-12.4,3.43-27.17-5.65-41.14q-16.37-16.32-32.22-33c-1.66-1.23-3.31-2.38-4.95-3.5l-66.44,18.87L167.59,227c10.57-17.62,0-41.59-9.84-55.7q-8.4-9.81-16.62-19.75l-43.67,7.29c18.43-7.3,31.37-22.38,16.85-40l2.06,2.33Q91.79,90.29,68.44,58.49q43,32.32,83.86,67.06L188.92,116l-22.11,22q23.38,20.3,46.09,41.39l71.86-30.46L266,178l.3-.24c-21.55,27.54,18.77,86,46,78.42l31.91-17.7L319.4,275l36.88,52.71c.26.3.53.59.79.9,13.64,12.5,31.23,1.71,43.05-14.53l-19.59,42Q412.66,394.28,443.44,434.53Z"
    },
    classes: {
      scar: "fill-dark"
    }
  },
  ProwessHarm2: {
    viewBox: "0 0 512 512",
    paths: {
      scarTissue: "M399,355.08c-15-32.31-18.67-65.87-6.23-94.7-47.19,58.41-76.14,4.41-4.09-70.72-101.67,62.7-147.78,31.47-14-88.26-103,54.66-182.49,69.22-130.93,15.19-37.19,10.63-58.21,5.21-76-2.43A643.42,643.42,0,0,0,55.28,58.49a789.14,789.14,0,0,0,47,77.56c7,18.27,3,38.71-31.46,63.44,124.85-33.45,88.52,47-9.36,104.92,166.21-61.68,207.52-47.41,100.64,78,84-61.07,150.14-44.57,122.89,31.29,31.63-24.51,57.9-29.74,78-20.87q43.39,30.7,90.32,59C436.25,418.27,418.25,386,399,355.08ZM352.11,362c-16.61-9.9-26.17.25-36.79,14,7.32-15.11,11.12-30.72,2.69-42.28l-3.7-3.19L277,301.11l-39.68,22,14.29-21.06c6.08-10.31,2.85-22.58-4.7-34.2q-13.6-13.56-26.78-27.46c-1.38-1-2.75-2-4.11-2.91l-55.23,15.68,18.09-21.41c8.78-14.64,0-34.57-8.18-46.3q-7-8.15-13.82-16.42l-36.3,6.06c15.32-6.06,26.08-18.6,14-33.28l-1.89-2.13c.69.72,1.31,1.42,1.89,2.13l1.71,1.94q-20.43-25.65-39.84-52.09,35.76,26.88,69.71,55.75l30.44-7.93-18.38,18.27q19.44,16.88,38.31,34.41l59.73-25.32L260.68,191l.25-.2c-17.91,22.9,15.6,71.52,38.24,65.19l26.52-14.71-20.6,30.37,30.65,43.82.66.74c11.34,10.39,26,1.42,35.79-12.07L355.9,339q26.72,31.78,52.3,65.24Q379.31,383.76,352.11,362Z"
    },
    classes: {
      scarTissue: "fill-med"
    }
  },
  ProwessHarm3: {
    viewBox: "0 0 512 512",
    paths: {
      scar: "M447.44,434.53Q412.7,409.87,380,383.64c-20-11.91-31.49.3-44.26,16.86,8.8-18.17,13.38-36.95,3.24-50.86l-4.46-3.84-44.85-35.35L241.9,336.93l17.19-25.34c7.31-12.4,3.43-27.17-5.65-41.14q-16.37-16.32-32.22-33c-1.66-1.23-3.31-2.38-4.95-3.5l-66.44,18.87L171.59,227c10.57-17.62,0-41.59-9.84-55.7q-8.4-9.81-16.62-19.75l-43.67,7.29c18.43-7.3,31.37-22.38,16.85-40l2.06,2.33Q95.79,90.29,72.44,58.49q43,32.32,83.86,67.06L192.92,116l-22.11,22q23.38,20.3,46.09,41.39l71.86-30.46L270,178l.3-.24c-21.55,27.54,18.77,86,46,78.42l31.91-17.7L323.4,275l36.88,52.71c.26.3.53.59.79.9,13.64,12.5,31.23,1.71,43.05-14.53l-19.59,42Q416.66,394.28,447.44,434.53Z",
      scarTissue: "M436.33,375.37c-18.07-38.87-22.46-79.24-7.49-113.92-56.77,70.27-91.6,5.3-4.93-85.08C301.61,251.8,246.13,214.23,407,70.19,283.18,136,187.5,153.46,249.53,88.47c-44.75,12.79-70,6.27-91.47-2.93a773.7,773.7,0,0,0-135.18-67,949.58,949.58,0,0,0,56.49,93.31c8.39,22,3.6,46.57-37.84,76.32C191.72,148,148,244.71,30.26,314.42c200-74.2,249.65-57,121.08,93.78C252.42,334.73,332,354.59,299.17,445.84c38.06-29.48,69.66-35.77,93.87-25.1q52.21,36.94,108.66,70.93C481.19,451.39,459.54,412.52,436.33,375.37ZM380,383.64c-20-11.91-31.49.3-44.26,16.86,8.8-18.17,13.38-36.95,3.24-50.86l-4.46-3.84-44.85-35.35L241.9,336.93l17.19-25.34c7.31-12.4,3.43-27.17-5.65-41.14q-16.37-16.32-32.22-33c-1.66-1.23-3.31-2.38-4.95-3.5l-66.44,18.87L171.59,227c10.57-17.62,0-41.59-9.84-55.7q-8.4-9.81-16.62-19.75l-43.67,7.29c18.43-7.3,31.37-22.38,16.85-40L116,116.26c.83.86,1.57,1.71,2.27,2.56l2.06,2.33Q95.79,90.29,72.44,58.49q43,32.32,83.86,67.06L192.92,116l-22.11,22q23.38,20.3,46.09,41.39l71.86-30.46L270,178l.3-.24c-21.55,27.54,18.77,86,46,78.42l31.91-17.7L323.4,275l36.88,52.71c.26.3.53.59.79.9,13.64,12.5,31.23,1.71,43.05-14.53l-19.59,42q32.13,38.23,62.91,78.49Q412.7,409.87,380,383.64Z"
    },
    classes: {
      scar: "fill-dark",
      scarTissue: "fill-med"
    }
  },
  ProwessHarm4: {
    viewBox: "0 0 512 512",
    paths: {
      scar: "M441.44,434.53Q406.7,409.87,374,383.64c-20-11.91-31.49.3-44.26,16.86,8.8-18.17,13.38-36.95,3.24-50.86l-4.46-3.84-44.85-35.35L235.9,336.93l17.19-25.34c7.31-12.4,3.43-27.17-5.65-41.14q-16.37-16.32-32.22-33c-1.66-1.23-3.31-2.38-4.95-3.5l-66.44,18.87L165.59,227c10.57-17.62,0-41.59-9.84-55.7q-8.4-9.81-16.62-19.75l-43.67,7.29c18.43-7.3,31.37-22.38,16.85-40l2.06,2.33Q89.79,90.29,66.44,58.49q43,32.32,83.86,67.06L186.92,116l-22.11,22q23.38,20.3,46.09,41.39l71.86-30.46L264,178l.3-.24c-21.55,27.54,18.77,86,46,78.42l31.91-17.7L317.4,275l36.88,52.71c.26.3.53.59.79.9,13.64,12.5,31.23,1.71,43.05-14.53l-19.59,42Q410.66,394.28,441.44,434.53Z",
      scarTissue: "M430.33,375.37c-18.07-38.87-22.46-79.24-7.49-113.92-56.77,70.27-91.6,5.3-4.93-85.08C295.61,251.8,240.13,214.23,401,70.19,277.18,136,181.5,153.46,243.53,88.47c-44.75,12.79-70,6.27-91.47-2.93a773.7,773.7,0,0,0-135.18-67,949.58,949.58,0,0,0,56.49,93.31c8.39,22,3.6,46.57-37.84,76.32C185.72,148,142,244.71,24.26,314.42c200-74.2,249.65-57,121.08,93.78C246.42,334.73,326,354.59,293.17,445.84c38.06-29.48,69.66-35.77,93.87-25.1q52.21,36.94,108.66,70.93C475.19,451.39,453.54,412.52,430.33,375.37ZM374,383.64c-20-11.91-31.49.3-44.26,16.86,8.8-18.17,13.38-36.95,3.24-50.86l-4.46-3.84-44.85-35.35L235.9,336.93l17.19-25.34c7.31-12.4,3.43-27.17-5.65-41.14q-16.37-16.32-32.22-33c-1.66-1.23-3.31-2.38-4.95-3.5l-66.44,18.87L165.59,227c10.57-17.62,0-41.59-9.84-55.7q-8.4-9.81-16.62-19.75l-43.67,7.29c18.43-7.3,31.37-22.38,16.85-40L110,116.26c.83.86,1.57,1.71,2.27,2.56l2.06,2.33Q89.79,90.29,66.44,58.49q43,32.32,83.86,67.06L186.92,116l-22.11,22q23.38,20.3,46.09,41.39l71.86-30.46L264,178l.3-.24c-21.55,27.54,18.77,86,46,78.42l31.91-17.7L317.4,275l36.88,52.71c.26.3.53.59.79.9,13.64,12.5,31.23,1.71,43.05-14.53l-19.59,42q32.13,38.23,62.91,78.49Q406.7,409.87,374,383.64Z",
      welts: "M414.13,84.19a39.5,39.5,0,1,0,39.57,39.5,39.2,39.2,0,0,0-39.57-39.5ZM308.33,29.83A28.66,28.66,0,1,0,337,58.51a28.51,28.51,0,0,0-28.67-28.68ZM90.17,322.56a49.51,49.51,0,1,0,49.53,49.52A49.36,49.36,0,0,0,90.17,322.56Zm258-171.24A22.79,22.79,0,1,0,371,174.11a22.61,22.61,0,0,0-22.83-22.79ZM261.49,89.88a16.72,16.72,0,1,0,16.73,16.73,16.63,16.63,0,0,0-16.73-16.73ZM91.15,187.65a21.18,21.18,0,1,0,21.18,21.18,21,21,0,0,0-21.18-21.18Zm77.51,94.54a32.09,32.09,0,1,0,32.07,32.1,32,32,0,0,0-32.07-32.1ZM391.6,243.05a16.51,16.51,0,1,0,16.49,16.52,16.41,16.41,0,0,0-16.49-16.52ZM238.11,374.85a48.43,48.43,0,1,0,48.44,48.45A48.29,48.29,0,0,0,238.11,374.85Zm137,59.88A22.86,22.86,0,1,0,398,457.59a22.69,22.69,0,0,0-22.86-22.86Z"
    },
    classes: {
      scar: "fill-bright",
      scarTissue: "fill-dark",
      welts: "fill-bright"
    }
  },
  ResolveHarm1: {
    viewBox: "0 0 512 512",
    paths: {
      spikes: "M256.09,19.1A237.5,237.5,0,0,0,197,27.22C70.63,61.08-4.36,191,29.5,317.31,62.59,440.8,187.39,515.21,311,486.92A132.35,132.35,0,0,1,279.74,475,207,207,0,0,1,122,417.49l-13.48-14.55L94.89,385.42a205.62,205.62,0,0,1-24-47.36l-7.2-17.33L60.71,296.5a205.83,205.83,0,0,1-.18-54.37l3-24.36,7.67-19.51a208.28,208.28,0,0,1,29.16-53.84l105,60.61-68.63-98a205.85,205.85,0,0,1,63.68-34.49l27.24-8.18,23.18-1.89q6.46-.48,12.89-.54a205.54,205.54,0,0,1,61.66,8.84l23.65,11,22,9.09A207.05,207.05,0,0,1,428.2,140.9l13.1,14.44L448.93,173a208,208,0,0,1,16.41,42.22,205.89,205.89,0,0,1,2.52,96.73,133,133,0,0,1,7.74,38.31,235.8,235.8,0,0,0,11.48-155.53C458.51,88.09,361.59,18.05,256.09,19.1Z",
      eyeball: "M344.58,242.53a45.61,45.61,0,0,1,8.95,6.95c12.22,12.21,16.07,29.9,13.26,47.35S354.74,332,340,346.82s-32.54,24-50,26.83-35.13-1-47.35-13.26a48,48,0,0,1-13-24.74,114.74,114.74,0,1,0,114.92-93.12Z",
      iris: "M316.24,254a50.56,50.56,0,0,0-7.08.66c-13,2.09-27.56,9.39-39.76,21.59S249.91,303,247.81,316s.75,23.89,8,31.16S274,357.3,287,355.2s27.56-9.39,39.76-21.59,19.5-26.76,21.59-39.76-.75-23.89-8-31.16c-5.45-5.45-12.94-8.42-21.83-8.68-.74,0-1.49,0-2.25,0Zm-13.81,20.35a16,16,0,0,1,11.86,4.38c7.49,7.5,5.16,22-5.22,32.37s-24.88,12.72-32.38,5.23-5.16-22,5.22-32.38c6.17-6.16,13.78-9.49,20.52-9.6Z"
    },
    classes: {
      spikes: "fill-dark",
      eyeball: "fill-dark",
      iris: "fill-med"
    }
  },
  ResolveHarm2: {
    viewBox: "0 0 512 512",
    paths: {
      spikes: "M261.25,19.1a237.64,237.64,0,0,0-59.11,8.12C75.79,61.08.8,191,34.66,317.31,67.75,440.8,192.55,515.21,316.15,486.92A132.59,132.59,0,0,1,284.89,475a207,207,0,0,1-157.72-57.52l-11.44-12.15-15.68-19.92a205.62,205.62,0,0,1-24-47.36l-7.32-17.33L65.87,296.5a205.41,205.41,0,0,1-.18-54.37l91.84,19.32L76.38,198.26a208,208,0,0,1,29.16-53.84L259.93,252.78,141.87,107a205.79,205.79,0,0,1,63.67-34.49L263.45,141,256,62.45q6.46-.48,12.89-.54a205.54,205.54,0,0,1,61.66,8.84l22.84,8.32,22.83,11.78a207,207,0,0,1,57.17,50.05l13.41,16.85L454.08,173a207.52,207.52,0,0,1,18.93,139,132.67,132.67,0,0,1,7.75,38.31,235.92,235.92,0,0,0,11.48-155.53C463.67,88.09,366.74,18.05,261.25,19.1Z",
      eyeball: "M349.74,242.53a45.61,45.61,0,0,1,8.95,6.95c12.21,12.21,16.07,29.9,13.26,47.35s-12.05,35.21-26.83,50-32.54,24-50,26.83-35.14-1-47.35-13.26a48,48,0,0,1-13-24.74,116.19,116.19,0,0,0-2,21.58,114.73,114.73,0,1,0,117-114.7Z",
      iris: "M321.4,254a50.42,50.42,0,0,0-7.08.66c-13,2.09-27.56,9.39-39.76,21.59S255.06,303,253,316s.75,23.89,8,31.16,18.16,10.12,31.16,8,27.56-9.39,39.76-21.59,19.49-26.76,21.59-39.76-.75-23.89-8-31.16c-5.46-5.45-13-8.42-21.83-8.68-.74,0-1.49,0-2.25,0Zm-13.81,20.35a16,16,0,0,1,11.85,4.38c7.5,7.5,5.16,22-5.22,32.37s-24.87,12.72-32.37,5.23-5.16-22,5.22-32.38c6.16-6.16,13.78-9.49,20.52-9.6Z"
    },
    classes: {
      spikes: "fill-med",
      eyeball: "fill-dark",
      iris: "fill-bright"
    }
  },
  ResolveHarm3: {
    viewBox: "0 0 512 512",
    paths: {
      spikes: "M261.31,19.1a237.51,237.51,0,0,0-59.11,8.12C75.84,61.08.86,191,34.71,317.31,67.8,440.8,192.61,515.21,316.2,486.92A132.35,132.35,0,0,1,285,475a207,207,0,0,1-157.72-57.52l-13.81-16.37-13.31-15.7a206,206,0,0,1-24.06-47.36l83.63-17.33L65.93,296.5a205.41,205.41,0,0,1-.18-54.37l164.66,47.21-154-91.08a208,208,0,0,1,29.15-53.84L260,252.78,141.92,107A205.85,205.85,0,0,1,205.6,72.52l95.49,158.21L256,62.45q6.47-.48,12.9-.54a205.43,205.43,0,0,1,61.65,8.84L353.08,169l23.17-78.14a206.76,206.76,0,0,1,57.16,50.05l13.08,22.41,7.65,9.67a207.52,207.52,0,0,1,18.93,139,132.33,132.33,0,0,1,7.74,38.31,235.8,235.8,0,0,0,11.48-155.53C463.73,88.09,366.8,18.05,261.31,19.1Z",
      eyeball: "M349.79,242.53a45.38,45.38,0,0,1,9,6.95c12.21,12.21,16.07,29.9,13.25,47.35s-12,35.21-26.82,50-32.54,24-50,26.83-35.13-1-47.34-13.26a48,48,0,0,1-13-24.74,116.19,116.19,0,0,0-2,21.58,114.73,114.73,0,1,0,117-114.7Z",
      iris: "M321.45,254a50.56,50.56,0,0,0-7.08.66c-13,2.09-27.55,9.39-39.75,21.59S255.12,303,253,316s.75,23.89,8,31.16,18.16,10.12,31.16,8,27.56-9.39,39.76-21.59,19.49-26.76,21.59-39.76-.75-23.89-8-31.16c-5.45-5.45-12.94-8.42-21.83-8.68-.74,0-1.49,0-2.25,0Zm-13.81,20.35a16,16,0,0,1,11.86,4.38c7.5,7.5,5.16,22-5.22,32.37s-24.88,12.72-32.37,5.23-5.16-22,5.22-32.38c6.16-6.16,13.78-9.49,20.51-9.6Z"
    },
    classes: {
      spikes: "fill-bright",
      eyeball: "fill-med",
      iris: "fill-bright"
    }
  },
  ResolveHarm4: {
    viewBox: "0 0 512 512",
    paths: {
      spikes: "M261.14,19.1A237.51,237.51,0,0,0,202,27.22C75.67,61.08.69,191,34.54,317.31,67.63,440.8,192.44,515.21,316,486.92A132.35,132.35,0,0,1,284.78,475a207,207,0,0,1-157.72-57.52l89.22-30-116.34-2a206,206,0,0,1-24.06-47.36L214,333.21,65.76,296.5a205.41,205.41,0,0,1-.18-54.37l164.66,47.21-154-91.08a208,208,0,0,1,29.15-53.84l154.4,108.36L141.75,107a205.85,205.85,0,0,1,63.68-34.49l95.49,158.21L255.85,62.45q6.47-.48,12.9-.54a205.43,205.43,0,0,1,61.65,8.84L359.77,223.5,376.08,90.85a206.76,206.76,0,0,1,57.16,50.05L415.61,243.13,454,173a207.52,207.52,0,0,1,18.93,139,132.33,132.33,0,0,1,7.74,38.31,235.8,235.8,0,0,0,11.48-155.53C463.55,88.09,366.63,18.05,261.14,19.1Z",
      eyeball: "M349.62,242.53a45.38,45.38,0,0,1,9,6.95c12.21,12.21,16.07,29.9,13.25,47.35s-12,35.21-26.82,50-32.55,24-50,26.83-35.13-1-47.34-13.26a48,48,0,0,1-13-24.74,116.19,116.19,0,0,0-2,21.58,114.73,114.73,0,1,0,117-114.7Z",
      iris: "M321.28,254a50.56,50.56,0,0,0-7.08.66c-13,2.09-27.55,9.39-39.75,21.59S255,303,252.86,316s.75,23.89,8,31.16S279,357.3,292,355.2s27.55-9.39,39.76-21.59,19.49-26.76,21.59-39.76-.75-23.89-8-31.16c-5.45-5.45-12.94-8.42-21.83-8.68-.74,0-1.49,0-2.25,0Zm-13.81,20.35a16,16,0,0,1,11.86,4.38c7.5,7.5,5.16,22-5.22,32.37s-24.88,12.72-32.37,5.23-5.16-22,5.22-32.38c6.16-6.16,13.78-9.49,20.51-9.6Z"
    },
    classes: {
      spikes: "fill-bright",
      eyeball: "fill-bright",
      iris: "fill-bright"
    }
  }
};
var jg = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function Kg(r) {
  return r && r.__esModule && Object.prototype.hasOwnProperty.call(r, "default") ? r.default : r;
}
var F0 = { exports: {} };
(function(r, e) {
  (function(t, s) {
    r.exports = s();
  })(jg, function() {
    function t(d, f) {
      var v = Object.keys(d);
      if (Object.getOwnPropertySymbols) {
        var b = Object.getOwnPropertySymbols(d);
        f && (b = b.filter(function(D) {
          return Object.getOwnPropertyDescriptor(d, D).enumerable;
        })), v.push.apply(v, b);
      }
      return v;
    }
    function s(d) {
      for (var f = 1; f < arguments.length; f++) {
        var v = arguments[f] != null ? arguments[f] : {};
        f % 2 ? t(Object(v), !0).forEach(function(b) {
          i(d, b, v[b]);
        }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(d, Object.getOwnPropertyDescriptors(v)) : t(Object(v)).forEach(function(b) {
          Object.defineProperty(d, b, Object.getOwnPropertyDescriptor(v, b));
        });
      }
      return d;
    }
    function i(d, f, v) {
      return (f = function(b) {
        var D = function(E, P) {
          if (typeof E != "object" || E === null)
            return E;
          var N = E[Symbol.toPrimitive];
          if (N !== void 0) {
            var K = N.call(E, P || "default");
            if (typeof K != "object")
              return K;
            throw new TypeError("@@toPrimitive must return a primitive value.");
          }
          return (P === "string" ? String : Number)(E);
        }(b, "string");
        return typeof D == "symbol" ? D : String(D);
      }(f)) in d ? Object.defineProperty(d, f, { value: v, enumerable: !0, configurable: !0, writable: !0 }) : d[f] = v, d;
    }
    const a = (d, f, v, b) => (d = "" + d, f = "" + f, b && (d = d.trim(), f = f.trim()), v ? d == f : d.toLowerCase() == f.toLowerCase()), o = (d, f) => d && Array.isArray(d) && d.map((v) => n(v, f));
    function n(d, f) {
      var v, b = {};
      for (v in d)
        f.indexOf(v) < 0 && (b[v] = d[v]);
      return b;
    }
    function l(d) {
      var f = document.createElement("div");
      return d.replace(/\&#?[0-9a-z]+;/gi, function(v) {
        return f.innerHTML = v, f.innerText;
      });
    }
    function c(d) {
      return new DOMParser().parseFromString(d.trim(), "text/html").body.firstElementChild;
    }
    function u(d, f) {
      for (f = f || "previous"; d = d[f + "Sibling"]; )
        if (d.nodeType == 3)
          return d;
    }
    function g(d) {
      return typeof d == "string" ? d.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/`|'/g, "&#039;") : d;
    }
    function p(d) {
      var f = Object.prototype.toString.call(d).split(" ")[1].slice(0, -1);
      return d === Object(d) && f != "Array" && f != "Function" && f != "RegExp" && f != "HTMLUnknownElement";
    }
    function h(d, f, v) {
      function b(D, E) {
        for (var P in E)
          if (E.hasOwnProperty(P)) {
            if (p(E[P])) {
              p(D[P]) ? b(D[P], E[P]) : D[P] = Object.assign({}, E[P]);
              continue;
            }
            if (Array.isArray(E[P])) {
              D[P] = Object.assign([], E[P]);
              continue;
            }
            D[P] = E[P];
          }
      }
      return d instanceof Object || (d = {}), b(d, f), v && b(d, v), d;
    }
    function m() {
      const d = [], f = {};
      for (let v of arguments)
        for (let b of v)
          p(b) ? f[b.value] || (d.push(b), f[b.value] = 1) : d.includes(b) || d.push(b);
      return d;
    }
    function y(d) {
      return String.prototype.normalize ? typeof d == "string" ? d.normalize("NFD").replace(/[\u0300-\u036f]/g, "") : void 0 : d;
    }
    var k = () => /(?=.*chrome)(?=.*android)/i.test(navigator.userAgent);
    function _() {
      return ("10000000-1000-4000-8000" + -1e11).replace(/[018]/g, (d) => (d ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> d / 4).toString(16));
    }
    function C(d) {
      return d && d.classList && d.classList.contains(this.settings.classNames.tag);
    }
    function T(d, f) {
      var v = window.getSelection();
      return f = f || v.getRangeAt(0), typeof d == "string" && (d = document.createTextNode(d)), f && (f.deleteContents(), f.insertNode(d)), d;
    }
    function x(d, f, v) {
      return d ? (f && (d.__tagifyTagData = v ? f : h({}, d.__tagifyTagData || {}, f)), d.__tagifyTagData) : (console.warn("tag element doesn't exist", d, f), f);
    }
    function S(d) {
      if (d && d.parentNode) {
        var f = d, v = window.getSelection(), b = v.getRangeAt(0);
        v.rangeCount && (b.setStartAfter(f), b.collapse(!0), v.removeAllRanges(), v.addRange(b));
      }
    }
    function O(d, f) {
      d.forEach((v) => {
        if (x(v.previousSibling) || !v.previousSibling) {
          var b = document.createTextNode("​");
          v.before(b), f && S(b);
        }
      });
    }
    var M = { delimiters: ",", pattern: null, tagTextProp: "value", maxTags: 1 / 0, callbacks: {}, addTagOnBlur: !0, addTagOn: ["blur", "tab", "enter"], onChangeAfterBlur: !0, duplicates: !1, whitelist: [], blacklist: [], enforceWhitelist: !1, userInput: !0, keepInvalidTags: !1, createInvalidTags: !0, mixTagsAllowedAfter: /,|\.|\:|\s/, mixTagsInterpolator: ["[[", "]]"], backspace: !0, skipInvalid: !1, pasteAsTags: !0, editTags: { clicks: 2, keepInvalid: !0 }, transformTag: () => {
    }, trim: !0, a11y: { focusableTags: !1 }, mixMode: { insertAfterTag: " " }, autoComplete: { enabled: !0, rightKey: !1, tabKey: !1 }, classNames: { namespace: "tagify", mixMode: "tagify--mix", selectMode: "tagify--select", input: "tagify__input", focus: "tagify--focus", tagNoAnimation: "tagify--noAnim", tagInvalid: "tagify--invalid", tagNotAllowed: "tagify--notAllowed", scopeLoading: "tagify--loading", hasMaxTags: "tagify--hasMaxTags", hasNoTags: "tagify--noTags", empty: "tagify--empty", inputInvalid: "tagify__input--invalid", dropdown: "tagify__dropdown", dropdownWrapper: "tagify__dropdown__wrapper", dropdownHeader: "tagify__dropdown__header", dropdownFooter: "tagify__dropdown__footer", dropdownItem: "tagify__dropdown__item", dropdownItemActive: "tagify__dropdown__item--active", dropdownItemHidden: "tagify__dropdown__item--hidden", dropdownInital: "tagify__dropdown--initial", tag: "tagify__tag", tagText: "tagify__tag-text", tagX: "tagify__tag__removeBtn", tagLoading: "tagify__tag--loading", tagEditing: "tagify__tag--editable", tagFlash: "tagify__tag--flash", tagHide: "tagify__tag--hide" }, dropdown: { classname: "", enabled: 2, maxItems: 10, searchKeys: ["value", "searchBy"], fuzzySearch: !0, caseSensitive: !1, accentedSearch: !0, includeSelectedTags: !1, escapeHTML: !0, highlightFirst: !0, closeOnSelect: !0, clearOnSelect: !0, position: "all", appendTarget: null }, hooks: { beforeRemoveTag: () => Promise.resolve(), beforePaste: () => Promise.resolve(), suggestionClick: () => Promise.resolve(), beforeKeyDown: () => Promise.resolve() } }, R = { events: { binding() {
      let d = !(arguments.length > 0 && arguments[0] !== void 0) || arguments[0];
      var f = this.dropdown.events.callbacks, v = this.listeners.dropdown = this.listeners.dropdown || { position: this.dropdown.position.bind(this, null), onKeyDown: f.onKeyDown.bind(this), onMouseOver: f.onMouseOver.bind(this), onMouseLeave: f.onMouseLeave.bind(this), onClick: f.onClick.bind(this), onScroll: f.onScroll.bind(this) }, b = d ? "addEventListener" : "removeEventListener";
      this.settings.dropdown.position != "manual" && (document[b]("scroll", v.position, !0), window[b]("resize", v.position), window[b]("keydown", v.onKeyDown)), this.DOM.dropdown[b]("mouseover", v.onMouseOver), this.DOM.dropdown[b]("mouseleave", v.onMouseLeave), this.DOM.dropdown[b]("mousedown", v.onClick), this.DOM.dropdown.content[b]("scroll", v.onScroll);
    }, callbacks: { onKeyDown(d) {
      if (this.state.hasFocus && !this.state.composing) {
        var f = this.settings, v = this.DOM.dropdown.querySelector(f.classNames.dropdownItemActiveSelector), b = this.dropdown.getSuggestionDataByNode(v), D = f.mode == "mix";
        f.hooks.beforeKeyDown(d, { tagify: this }).then((E) => {
          switch (d.key) {
            case "ArrowDown":
            case "ArrowUp":
            case "Down":
            case "Up":
              d.preventDefault();
              var P = this.dropdown.getAllSuggestionsRefs(), N = d.key == "ArrowUp" || d.key == "Up";
              v && (v = this.dropdown.getNextOrPrevOption(v, !N)), v && v.matches(f.classNames.dropdownItemSelector) || (v = P[N ? P.length - 1 : 0]), this.dropdown.highlightOption(v, !0);
              break;
            case "Escape":
            case "Esc":
              this.dropdown.hide();
              break;
            case "ArrowRight":
              if (this.state.actions.ArrowLeft)
                return;
            case "Tab": {
              let j = !f.autoComplete.rightKey || !f.autoComplete.tabKey;
              if (!D && v && j && !this.state.editing) {
                d.preventDefault();
                var K = this.dropdown.getMappedValue(b);
                return this.input.autocomplete.set.call(this, K), !1;
              }
              return !0;
            }
            case "Enter":
              d.preventDefault(), f.hooks.suggestionClick(d, { tagify: this, tagData: b, suggestionElm: v }).then(() => {
                if (v)
                  return this.dropdown.selectOption(v), v = this.dropdown.getNextOrPrevOption(v, !N), void this.dropdown.highlightOption(v);
                this.dropdown.hide(), D || this.addTags(this.state.inputText.trim(), !0);
              }).catch((j) => console.warn(j));
              break;
            case "Backspace": {
              if (D || this.state.editing.scope)
                return;
              const j = this.input.raw.call(this);
              j != "" && j.charCodeAt(0) != 8203 || (f.backspace === !0 ? this.removeTags() : f.backspace == "edit" && setTimeout(this.editTag.bind(this), 0));
            }
          }
        });
      }
    }, onMouseOver(d) {
      var f = d.target.closest(this.settings.classNames.dropdownItemSelector);
      this.dropdown.highlightOption(f);
    }, onMouseLeave(d) {
      this.dropdown.highlightOption();
    }, onClick(d) {
      if (d.button == 0 && d.target != this.DOM.dropdown && d.target != this.DOM.dropdown.content) {
        var f = d.target.closest(this.settings.classNames.dropdownItemSelector), v = this.dropdown.getSuggestionDataByNode(f);
        this.state.actions.selectOption = !0, setTimeout(() => this.state.actions.selectOption = !1, 50), this.settings.hooks.suggestionClick(d, { tagify: this, tagData: v, suggestionElm: f }).then(() => {
          f ? this.dropdown.selectOption(f, d) : this.dropdown.hide();
        }).catch((b) => console.warn(b));
      }
    }, onScroll(d) {
      var f = d.target, v = f.scrollTop / (f.scrollHeight - f.parentNode.clientHeight) * 100;
      this.trigger("dropdown:scroll", { percentage: Math.round(v) });
    } } }, refilter(d) {
      d = d || this.state.dropdown.query || "", this.suggestedListItems = this.dropdown.filterListItems(d), this.dropdown.fill(), this.suggestedListItems.length || this.dropdown.hide(), this.trigger("dropdown:updated", this.DOM.dropdown);
    }, getSuggestionDataByNode(d) {
      var f = d && d.getAttribute("value");
      return this.suggestedListItems.find((v) => v.value == f) || null;
    }, getNextOrPrevOption(d) {
      let f = !(arguments.length > 1 && arguments[1] !== void 0) || arguments[1];
      var v = this.dropdown.getAllSuggestionsRefs(), b = v.findIndex((D) => D === d);
      return f ? v[b + 1] : v[b - 1];
    }, highlightOption(d, f) {
      var v, b = this.settings.classNames.dropdownItemActive;
      if (this.state.ddItemElm && (this.state.ddItemElm.classList.remove(b), this.state.ddItemElm.removeAttribute("aria-selected")), !d)
        return this.state.ddItemData = null, this.state.ddItemElm = null, void this.input.autocomplete.suggest.call(this);
      v = this.dropdown.getSuggestionDataByNode(d), this.state.ddItemData = v, this.state.ddItemElm = d, d.classList.add(b), d.setAttribute("aria-selected", !0), f && (d.parentNode.scrollTop = d.clientHeight + d.offsetTop - d.parentNode.clientHeight), this.settings.autoComplete && (this.input.autocomplete.suggest.call(this, v), this.dropdown.position());
    }, selectOption(d, f) {
      var v = this.settings, b = v.dropdown, D = b.clearOnSelect, E = b.closeOnSelect;
      if (!d)
        return this.addTags(this.state.inputText, !0), void (E && this.dropdown.hide());
      f = f || {};
      var P = d.getAttribute("value"), N = P == "noMatch", K = v.mode == "mix", j = this.suggestedListItems.find((ce) => (ce.value ?? ce) == P);
      if (this.trigger("dropdown:select", { data: j, elm: d, event: f }), P && (j || N)) {
        if (this.state.editing) {
          let ce = this.normalizeTags([j])[0];
          j = v.transformTag.call(this, ce) || ce, this.onEditTagDone(null, h({ __isValid: !0 }, j));
        } else
          this[K ? "addMixTags" : "addTags"]([j || this.input.raw.call(this)], D);
        (K || this.DOM.input.parentNode) && (setTimeout(() => {
          this.DOM.input.focus(), this.toggleFocusClass(!0);
        }), E && setTimeout(this.dropdown.hide.bind(this)), d.addEventListener("transitionend", () => {
          this.dropdown.fillHeaderFooter(), setTimeout(() => d.remove(), 100);
        }, { once: !0 }), d.classList.add(this.settings.classNames.dropdownItemHidden));
      } else
        E && setTimeout(this.dropdown.hide.bind(this));
    }, selectAll(d) {
      this.suggestedListItems.length = 0, this.dropdown.hide(), this.dropdown.filterListItems("");
      var f = this.dropdown.filterListItems("");
      return d || (f = this.state.dropdown.suggestions), this.addTags(f, !0), this;
    }, filterListItems(d, f) {
      var v, b, D, E, P, N = this.settings, K = N.dropdown, j = (f = f || {}, []), ce = [], te = N.whitelist, _e = K.maxItems >= 0 ? K.maxItems : 1 / 0, ie = K.searchKeys, pe = 0;
      if (!(d = N.mode == "select" && this.value.length && this.value[0][N.tagTextProp] == d ? "" : d) || !ie.length)
        return j = K.includeSelectedTags ? te : te.filter((ye) => !this.isTagDuplicate(p(ye) ? ye.value : ye)), this.state.dropdown.suggestions = j, j.slice(0, _e);
      function we(ye, fe) {
        return fe.toLowerCase().split(" ").every((ve) => ye.includes(ve.toLowerCase()));
      }
      for (P = K.caseSensitive ? "" + d : ("" + d).toLowerCase(); pe < te.length; pe++) {
        let ye, fe;
        v = te[pe] instanceof Object ? te[pe] : { value: te[pe] };
        let ve = Object.keys(v).some((st) => ie.includes(st)) ? ie : ["value"];
        K.fuzzySearch && !f.exact ? (D = ve.reduce((st, B) => st + " " + (v[B] || ""), "").toLowerCase().trim(), K.accentedSearch && (D = y(D), P = y(P)), ye = D.indexOf(P) == 0, fe = D === P, b = we(D, P)) : (ye = !0, b = ve.some((st) => {
          var B = "" + (v[st] || "");
          return K.accentedSearch && (B = y(B), P = y(P)), K.caseSensitive || (B = B.toLowerCase()), fe = B === P, f.exact ? B === P : B.indexOf(P) == 0;
        })), E = !K.includeSelectedTags && this.isTagDuplicate(p(v) ? v.value : v), b && !E && (fe && ye ? ce.push(v) : K.sortby == "startsWith" && ye ? j.unshift(v) : j.push(v));
      }
      return this.state.dropdown.suggestions = ce.concat(j), typeof K.sortby == "function" ? K.sortby(ce.concat(j), P) : ce.concat(j).slice(0, _e);
    }, getMappedValue(d) {
      var f = this.settings.dropdown.mapValueTo;
      return f ? typeof f == "function" ? f(d) : d[f] || d.value : d.value;
    }, createListHTML(d) {
      return h([], d).map((f, v) => {
        typeof f != "string" && typeof f != "number" || (f = { value: f });
        var b = this.dropdown.getMappedValue(f);
        return b = typeof b == "string" && this.settings.dropdown.escapeHTML ? g(b) : b, this.settings.templates.dropdownItem.apply(this, [s(s({}, f), {}, { mappedValue: b }), this]);
      }).join("");
    } };
    function L() {
      this.dropdown = {};
      for (let d in this._dropdown)
        this.dropdown[d] = typeof this._dropdown[d] == "function" ? this._dropdown[d].bind(this) : this._dropdown[d];
      this.dropdown.refs();
    }
    var q = s(s({}, R), {}, { refs() {
      this.DOM.dropdown = this.parseTemplate("dropdown", [this.settings]), this.DOM.dropdown.content = this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-wrapper']");
    }, getHeaderRef() {
      return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-header']");
    }, getFooterRef() {
      return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-footer']");
    }, getAllSuggestionsRefs() {
      return [...this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector)];
    }, show(d) {
      var f, v, b, D = this.settings, E = D.mode == "mix" && !D.enforceWhitelist, P = !D.whitelist || !D.whitelist.length, N = D.dropdown.position == "manual";
      if (d = d === void 0 ? this.state.inputText : d, !(P && !E && !D.templates.dropdownItemNoMatch || D.dropdown.enable === !1 || this.state.isLoading || this.settings.readonly)) {
        if (clearTimeout(this.dropdownHide__bindEventsTimeout), this.suggestedListItems = this.dropdown.filterListItems(d), d && !this.suggestedListItems.length && (this.trigger("dropdown:noMatch", d), D.templates.dropdownItemNoMatch && (b = D.templates.dropdownItemNoMatch.call(this, { value: d }))), !b) {
          if (this.suggestedListItems.length)
            d && E && !this.state.editing.scope && !a(this.suggestedListItems[0].value, d) && this.suggestedListItems.unshift({ value: d });
          else {
            if (!d || !E || this.state.editing.scope)
              return this.input.autocomplete.suggest.call(this), void this.dropdown.hide();
            this.suggestedListItems = [{ value: d }];
          }
          v = "" + (p(f = this.suggestedListItems[0]) ? f.value : f), D.autoComplete && v && v.indexOf(d) == 0 && this.input.autocomplete.suggest.call(this, f);
        }
        this.dropdown.fill(b), D.dropdown.highlightFirst && this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(D.classNames.dropdownItemSelector)), this.state.dropdown.visible || setTimeout(this.dropdown.events.binding.bind(this)), this.state.dropdown.visible = d || !0, this.state.dropdown.query = d, this.setStateSelection(), N || setTimeout(() => {
          this.dropdown.position(), this.dropdown.render();
        }), setTimeout(() => {
          this.trigger("dropdown:show", this.DOM.dropdown);
        });
      }
    }, hide(d) {
      var f = this.DOM, v = f.scope, b = f.dropdown, D = this.settings.dropdown.position == "manual" && !d;
      if (b && document.body.contains(b) && !D)
        return window.removeEventListener("resize", this.dropdown.position), this.dropdown.events.binding.call(this, !1), v.setAttribute("aria-expanded", !1), b.parentNode.removeChild(b), setTimeout(() => {
          this.state.dropdown.visible = !1;
        }, 100), this.state.dropdown.query = this.state.ddItemData = this.state.ddItemElm = this.state.selection = null, this.state.tag && this.state.tag.value.length && (this.state.flaggedTags[this.state.tag.baseOffset] = this.state.tag), this.trigger("dropdown:hide", b), this;
    }, toggle(d) {
      this.dropdown[this.state.dropdown.visible && !d ? "hide" : "show"]();
    }, getAppendTarget() {
      var d = this.settings.dropdown;
      return typeof d.appendTarget == "function" ? d.appendTarget() : d.appendTarget;
    }, render() {
      var d, f, v, b = (d = this.DOM.dropdown, (v = d.cloneNode(!0)).style.cssText = "position:fixed; top:-9999px; opacity:0", document.body.appendChild(v), f = v.clientHeight, v.parentNode.removeChild(v), f), D = this.settings, E = typeof D.dropdown.enabled == "number" && D.dropdown.enabled >= 0, P = this.dropdown.getAppendTarget();
      return E ? (this.DOM.scope.setAttribute("aria-expanded", !0), document.body.contains(this.DOM.dropdown) || (this.DOM.dropdown.classList.add(D.classNames.dropdownInital), this.dropdown.position(b), P.appendChild(this.DOM.dropdown), setTimeout(() => this.DOM.dropdown.classList.remove(D.classNames.dropdownInital))), this) : this;
    }, fill(d) {
      d = typeof d == "string" ? d : this.dropdown.createListHTML(d || this.suggestedListItems);
      var f, v = this.settings.templates.dropdownContent.call(this, d);
      this.DOM.dropdown.content.innerHTML = (f = v) ? f.replace(/\>[\r\n ]+\</g, "><").split(/>\s+</).join("><").trim() : "";
    }, fillHeaderFooter() {
      var d = this.dropdown.filterListItems(this.state.dropdown.query), f = this.parseTemplate("dropdownHeader", [d]), v = this.parseTemplate("dropdownFooter", [d]), b = this.dropdown.getHeaderRef(), D = this.dropdown.getFooterRef();
      f && (b == null || b.parentNode.replaceChild(f, b)), v && (D == null || D.parentNode.replaceChild(v, D));
    }, position(d) {
      var f = this.settings.dropdown, v = this.dropdown.getAppendTarget();
      if (f.position != "manual" && v) {
        var b, D, E, P, N, K, j, ce, te, _e = this.DOM.dropdown, ie = f.RTL, pe = v === document.body, we = v === this.DOM.scope, ye = pe ? window.pageYOffset : v.scrollTop, fe = document.fullscreenElement || document.webkitFullscreenElement || document.documentElement, ve = fe.clientHeight, st = Math.max(fe.clientWidth || 0, window.innerWidth || 0) > 480 ? f.position : "all", B = this.DOM[st == "input" ? "input" : "scope"];
        if (d = d || _e.clientHeight, this.state.dropdown.visible) {
          if (st == "text" ? (E = (b = function() {
            const De = document.getSelection();
            if (De.rangeCount) {
              const gt = De.getRangeAt(0), Ve = gt.startContainer, be = gt.startOffset;
              let ze, Gs;
              if (be > 0)
                return Gs = document.createRange(), Gs.setStart(Ve, be - 1), Gs.setEnd(Ve, be), ze = Gs.getBoundingClientRect(), { left: ze.right, top: ze.top, bottom: ze.bottom };
              if (Ve.getBoundingClientRect)
                return Ve.getBoundingClientRect();
            }
            return { left: -9999, top: -9999 };
          }()).bottom, D = b.top, P = b.left, N = "auto") : (K = function(De) {
            var gt = 0, Ve = 0;
            for (De = De.parentNode; De && De != fe; )
              gt += De.offsetTop || 0, Ve += De.offsetLeft || 0, De = De.parentNode;
            return { top: gt, left: Ve };
          }(v), b = B.getBoundingClientRect(), D = we ? -1 : b.top - K.top, E = (we ? b.height : b.bottom - K.top) - 1, P = we ? -1 : b.left - K.left, N = b.width + "px"), !pe) {
            let De = function() {
              for (var gt = 0, Ve = f.appendTarget.parentNode; Ve; )
                gt += Ve.scrollTop || 0, Ve = Ve.parentNode;
              return gt;
            }();
            D += De, E += De;
          }
          D = Math.floor(D), E = Math.ceil(E), ce = ((j = f.placeAbove ?? ve - b.bottom < d) ? D : E) + ye, te = `left: ${P + (ie && b.width || 0) + window.pageXOffset}px;`, _e.style.cssText = `${te}; top: ${ce}px; min-width: ${N}; max-width: ${N}`, _e.setAttribute("placement", j ? "top" : "bottom"), _e.setAttribute("position", st);
        }
      }
    } });
    const G = "@yaireo/tagify/";
    var re, U = { empty: "empty", exceed: "number of tags exceeded", pattern: "pattern mismatch", duplicate: "already exists", notAllowed: "not allowed" }, de = { wrapper: (d, f) => `<tags class="${f.classNames.namespace} ${f.mode ? `${f.classNames[f.mode + "Mode"]}` : ""} ${d.className}"
                    ${f.readonly ? "readonly" : ""}
                    ${f.disabled ? "disabled" : ""}
                    ${f.required ? "required" : ""}
                    ${f.mode === "select" ? "spellcheck='false'" : ""}
                    tabIndex="-1">
            <span ${!f.readonly && f.userInput ? "contenteditable" : ""} tabIndex="0" data-placeholder="${f.placeholder || "&#8203;"}" aria-placeholder="${f.placeholder || ""}"
                class="${f.classNames.input}"
                role="textbox"
                aria-autocomplete="both"
                aria-multiline="${f.mode == "mix"}"></span>
                &#8203;
        </tags>`, tag(d, f) {
      let v = f.settings;
      return `<tag title="${d.title || d.value}"
                    contenteditable='false'
                    spellcheck='false'
                    tabIndex="${v.a11y.focusableTags ? 0 : -1}"
                    class="${v.classNames.tag} ${d.class || ""}"
                    ${this.getAttributes(d)}>
            <x title='' class="${v.classNames.tagX}" role='button' aria-label='remove tag'></x>
            <div>
                <span class="${v.classNames.tagText}">${d[v.tagTextProp] || d.value}</span>
            </div>
        </tag>`;
    }, dropdown(d) {
      var f = d.dropdown;
      return `<div class="${f.position == "manual" ? "" : d.classNames.dropdown} ${f.classname}" role="listbox" aria-labelledby="dropdown" dir="${f.RTL ? "rtl" : ""}">
                    <div data-selector='tagify-suggestions-wrapper' class="${d.classNames.dropdownWrapper}"></div>
                </div>`;
    }, dropdownContent(d) {
      var f = this.settings.templates, v = this.state.dropdown.suggestions;
      return `
            ${f.dropdownHeader.call(this, v)}
            ${d}
            ${f.dropdownFooter.call(this, v)}
        `;
    }, dropdownItem(d) {
      return `<div ${this.getAttributes(d)}
                    class='${this.settings.classNames.dropdownItem} ${d.class || ""}'
                    tabindex="0"
                    role="option">${d.mappedValue || d.value}</div>`;
    }, dropdownHeader(d) {
      return `<header data-selector='tagify-suggestions-header' class="${this.settings.classNames.dropdownHeader}"></header>`;
    }, dropdownFooter(d) {
      var f = d.length - this.settings.dropdown.maxItems;
      return f > 0 ? `<footer data-selector='tagify-suggestions-footer' class="${this.settings.classNames.dropdownFooter}">
                ${f} more items. Refine your search.
            </footer>` : "";
    }, dropdownItemNoMatch: null }, ee = { customBinding() {
      this.customEventsList.forEach((d) => {
        this.on(d, this.settings.callbacks[d]);
      });
    }, binding() {
      let d = !(arguments.length > 0 && arguments[0] !== void 0) || arguments[0];
      var f, v = this.settings, b = this.events.callbacks, D = d ? "addEventListener" : "removeEventListener";
      if (!this.state.mainEvents || !d) {
        for (var E in this.state.mainEvents = d, d && !this.listeners.main && (this.events.bindGlobal.call(this), this.settings.isJQueryPlugin && jQuery(this.DOM.originalInput).on("tagify.removeAllTags", this.removeAllTags.bind(this))), f = this.listeners.main = this.listeners.main || { focus: ["input", b.onFocusBlur.bind(this)], keydown: ["input", b.onKeydown.bind(this)], click: ["scope", b.onClickScope.bind(this)], dblclick: v.mode != "select" && ["scope", b.onDoubleClickScope.bind(this)], paste: ["input", b.onPaste.bind(this)], drop: ["input", b.onDrop.bind(this)], compositionstart: ["input", b.onCompositionStart.bind(this)], compositionend: ["input", b.onCompositionEnd.bind(this)] })
          f[E] && this.DOM[f[E][0]][D](E, f[E][1]);
        clearInterval(this.listeners.main.originalInputValueObserverInterval), this.listeners.main.originalInputValueObserverInterval = setInterval(b.observeOriginalInputValue.bind(this), 500);
        var P = this.listeners.main.inputMutationObserver || new MutationObserver(b.onInputDOMChange.bind(this));
        P.disconnect(), v.mode == "mix" && P.observe(this.DOM.input, { childList: !0 });
      }
    }, bindGlobal(d) {
      var f, v = this.events.callbacks, b = d ? "removeEventListener" : "addEventListener";
      if (this.listeners && (d || !this.listeners.global))
        for (f of (this.listeners.global = this.listeners.global || [{ type: this.isIE ? "keydown" : "input", target: this.DOM.input, cb: v[this.isIE ? "onInputIE" : "onInput"].bind(this) }, { type: "keydown", target: window, cb: v.onWindowKeyDown.bind(this) }, { type: "blur", target: this.DOM.input, cb: v.onFocusBlur.bind(this) }, { type: "click", target: document, cb: v.onClickAnywhere.bind(this), useCapture: !0 }], this.listeners.global))
          f.target[b](f.type, f.cb, !!f.useCapture);
    }, unbindGlobal() {
      this.events.bindGlobal.call(this, !0);
    }, callbacks: { onFocusBlur(d) {
      var j, ce;
      var f = this.settings, v = d.target ? this.trim(d.target.textContent) : "", b = (ce = (j = this.value) == null ? void 0 : j[0]) == null ? void 0 : ce[f.tagTextProp], D = d.type, E = f.dropdown.enabled >= 0, P = { relatedTarget: d.relatedTarget }, N = this.state.actions.selectOption && (E || !f.dropdown.closeOnSelect), K = this.state.actions.addNew && E;
      if (D == "blur") {
        if (d.relatedTarget === this.DOM.scope)
          return this.dropdown.hide(), void this.DOM.input.focus();
        this.postUpdate(), f.onChangeAfterBlur && this.triggerChangeEvent();
      }
      if (!N && !K)
        if (this.state.hasFocus = D == "focus" && +/* @__PURE__ */ new Date(), this.toggleFocusClass(this.state.hasFocus), f.mode != "mix") {
          if (D == "focus")
            return this.trigger("focus", P), void (f.dropdown.enabled !== 0 && f.userInput || this.state.dropdown.visible || this.dropdown.show(this.value.length ? "" : void 0));
          D == "blur" && (this.trigger("blur", P), this.loading(!1), f.mode == "select" && b === v && (v = ""), v && !this.state.actions.selectOption && f.addTagOnBlur && f.addTagOn.includes("blur") && this.addTags(v, !0)), this.DOM.input.removeAttribute("style"), this.dropdown.hide();
        } else
          D == "focus" ? this.trigger("focus", P) : d.type == "blur" && (this.trigger("blur", P), this.loading(!1), this.dropdown.hide(), this.state.dropdown.visible = void 0, this.setStateSelection());
    }, onCompositionStart(d) {
      this.state.composing = !0;
    }, onCompositionEnd(d) {
      this.state.composing = !1;
    }, onWindowKeyDown(d) {
      var f, v = document.activeElement, b = C.call(this, v) && this.DOM.scope.contains(document.activeElement), D = b && v.hasAttribute("readonly");
      if (b && !D)
        switch (f = v.nextElementSibling, d.key) {
          case "Backspace":
            this.settings.readonly || (this.removeTags(v), (f || this.DOM.input).focus());
            break;
          case "Enter":
            setTimeout(this.editTag.bind(this), 0, v);
        }
    }, onKeydown(d) {
      var f = this.settings;
      if (!this.state.composing && f.userInput) {
        f.mode == "select" && f.enforceWhitelist && this.value.length && d.key != "Tab" && d.preventDefault();
        var v = this.trim(d.target.textContent);
        this.trigger("keydown", { event: d }), f.hooks.beforeKeyDown(d, { tagify: this }).then((b) => {
          if (f.mode == "mix") {
            switch (d.key) {
              case "Left":
              case "ArrowLeft":
                this.state.actions.ArrowLeft = !0;
                break;
              case "Delete":
              case "Backspace":
                if (this.state.editing)
                  return;
                var D = document.getSelection(), E = d.key == "Delete" && D.anchorOffset == (D.anchorNode.length || 0), P = D.anchorNode.previousSibling, N = D.anchorNode.nodeType == 1 || !D.anchorOffset && P && P.nodeType == 1 && D.anchorNode.previousSibling;
                l(this.DOM.input.innerHTML);
                var K, j, ce, te = this.getTagElms(), _e = D.anchorNode.length === 1 && D.anchorNode.nodeValue == "​";
                if (f.backspace == "edit" && N)
                  return K = D.anchorNode.nodeType == 1 ? null : D.anchorNode.previousElementSibling, setTimeout(this.editTag.bind(this), 0, K), void d.preventDefault();
                if (k() && N instanceof Element)
                  return ce = u(N), N.hasAttribute("readonly") || N.remove(), this.DOM.input.focus(), void setTimeout(() => {
                    S(ce), this.DOM.input.click();
                  });
                if (D.anchorNode.nodeName == "BR")
                  return;
                if ((E || N) && D.anchorNode.nodeType == 1 ? j = D.anchorOffset == 0 ? E ? te[0] : null : te[Math.min(te.length, D.anchorOffset) - 1] : E ? j = D.anchorNode.nextElementSibling : N instanceof Element && (j = N), D.anchorNode.nodeType == 3 && !D.anchorNode.nodeValue && D.anchorNode.previousElementSibling && d.preventDefault(), (N || E) && !f.backspace || D.type != "Range" && !D.anchorOffset && D.anchorNode == this.DOM.input && d.key != "Delete")
                  return void d.preventDefault();
                if (D.type != "Range" && j && j.hasAttribute("readonly"))
                  return void S(u(j));
                d.key == "Delete" && _e && x(D.anchorNode.nextSibling) && this.removeTags(D.anchorNode.nextSibling), clearTimeout(re), re = setTimeout(() => {
                  var pe = document.getSelection();
                  l(this.DOM.input.innerHTML), !E && pe.anchorNode.previousSibling, this.value = [].map.call(te, (we, ye) => {
                    var fe = x(we);
                    if (we.parentNode || fe.readonly)
                      return fe;
                    this.trigger("remove", { tag: we, index: ye, data: fe });
                  }).filter((we) => we);
                }, 20);
            }
            return !0;
          }
          var ie = f.dropdown.position == "manual";
          switch (d.key) {
            case "Backspace":
              f.mode == "select" && f.enforceWhitelist && this.value.length ? this.removeTags() : this.state.dropdown.visible && f.dropdown.position != "manual" || d.target.textContent != "" && v.charCodeAt(0) != 8203 || (f.backspace === !0 ? this.removeTags() : f.backspace == "edit" && setTimeout(this.editTag.bind(this), 0));
              break;
            case "Esc":
            case "Escape":
              if (this.state.dropdown.visible)
                return;
              d.target.blur();
              break;
            case "Down":
            case "ArrowDown":
              this.state.dropdown.visible || this.dropdown.show();
              break;
            case "ArrowRight": {
              let pe = this.state.inputSuggestion || this.state.ddItemData;
              if (pe && f.autoComplete.rightKey)
                return void this.addTags([pe], !0);
              break;
            }
            case "Tab": {
              let pe = f.mode == "select";
              if (!v || pe)
                return !0;
              d.preventDefault();
            }
            case "Enter":
              if (this.state.dropdown.visible && !ie)
                return;
              d.preventDefault(), setTimeout(() => {
                this.state.dropdown.visible && !ie || this.state.actions.selectOption || !f.addTagOn.includes(d.key.toLowerCase()) || this.addTags(v, !0);
              });
          }
        }).catch((b) => b);
      }
    }, onInput(d) {
      this.postUpdate();
      var f = this.settings;
      if (f.mode == "mix")
        return this.events.callbacks.onMixTagsInput.call(this, d);
      var v = this.input.normalize.call(this, void 0, { trim: !1 }), b = v.length >= f.dropdown.enabled, D = { value: v, inputElm: this.DOM.input }, E = this.validateTag({ value: v });
      f.mode == "select" && this.toggleScopeValidation(E), D.isValid = E, this.state.inputText != v && (this.input.set.call(this, v, !1), v.search(f.delimiters) != -1 ? this.addTags(v) && this.input.set.call(this) : f.dropdown.enabled >= 0 && this.dropdown[b ? "show" : "hide"](v), this.trigger("input", D));
    }, onMixTagsInput(d) {
      var f, v, b, D, E, P, N, K, j = this.settings, ce = this.value.length, te = this.getTagElms(), _e = document.createDocumentFragment(), ie = window.getSelection().getRangeAt(0), pe = [].map.call(te, (we) => x(we).value);
      if (d.inputType == "deleteContentBackward" && k() && this.events.callbacks.onKeydown.call(this, { target: d.target, key: "Backspace" }), O(this.getTagElms()), this.value.slice().forEach((we) => {
        we.readonly && !pe.includes(we.value) && _e.appendChild(this.createTagElem(we));
      }), _e.childNodes.length && (ie.insertNode(_e), this.setRangeAtStartEnd(!1, _e.lastChild)), te.length != ce)
        return this.value = [].map.call(this.getTagElms(), (we) => x(we)), void this.update({ withoutChangeEvent: !0 });
      if (this.hasMaxTags())
        return !0;
      if (window.getSelection && (P = window.getSelection()).rangeCount > 0 && P.anchorNode.nodeType == 3) {
        if ((ie = P.getRangeAt(0).cloneRange()).collapse(!0), ie.setStart(P.focusNode, 0), b = (f = ie.toString().slice(0, ie.endOffset)).split(j.pattern).length - 1, (v = f.match(j.pattern)) && (D = f.slice(f.lastIndexOf(v[v.length - 1]))), D) {
          if (this.state.actions.ArrowLeft = !1, this.state.tag = { prefix: D.match(j.pattern)[0], value: D.replace(j.pattern, "") }, this.state.tag.baseOffset = P.baseOffset - this.state.tag.value.length, K = this.state.tag.value.match(j.delimiters))
            return this.state.tag.value = this.state.tag.value.replace(j.delimiters, ""), this.state.tag.delimiters = K[0], this.addTags(this.state.tag.value, j.dropdown.clearOnSelect), void this.dropdown.hide();
          E = this.state.tag.value.length >= j.dropdown.enabled;
          try {
            N = (N = this.state.flaggedTags[this.state.tag.baseOffset]).prefix == this.state.tag.prefix && N.value[0] == this.state.tag.value[0], this.state.flaggedTags[this.state.tag.baseOffset] && !this.state.tag.value && delete this.state.flaggedTags[this.state.tag.baseOffset];
          } catch {
          }
          (N || b < this.state.mixMode.matchedPatternCount) && (E = !1);
        } else
          this.state.flaggedTags = {};
        this.state.mixMode.matchedPatternCount = b;
      }
      setTimeout(() => {
        this.update({ withoutChangeEvent: !0 }), this.trigger("input", h({}, this.state.tag, { textContent: this.DOM.input.textContent })), this.state.tag && this.dropdown[E ? "show" : "hide"](this.state.tag.value);
      }, 10);
    }, onInputIE(d) {
      var f = this;
      setTimeout(function() {
        f.events.callbacks.onInput.call(f, d);
      });
    }, observeOriginalInputValue() {
      this.DOM.originalInput.parentNode || this.destroy(), this.DOM.originalInput.value != this.DOM.originalInput.tagifyValue && this.loadOriginalValues();
    }, onClickAnywhere(d) {
      d.target == this.DOM.scope || this.DOM.scope.contains(d.target) || (this.toggleFocusClass(!1), this.state.hasFocus = !1, !this.settings.userInput && this.dropdown.hide());
    }, onClickScope(d) {
      var f = this.settings, v = d.target.closest("." + f.classNames.tag), b = d.target === this.DOM.scope, D = +/* @__PURE__ */ new Date() - this.state.hasFocus;
      if (b && f.mode != "select")
        this.DOM.input.focus();
      else {
        if (!d.target.classList.contains(f.classNames.tagX))
          return v && !this.state.editing ? (this.trigger("click", { tag: v, index: this.getNodeIndex(v), data: x(v), event: d }), void (f.editTags !== 1 && f.editTags.clicks !== 1 && f.mode != "select" || this.events.callbacks.onDoubleClickScope.call(this, d))) : void (d.target == this.DOM.input && (f.mode == "mix" && this.fixFirefoxLastTagNoCaret(), D > 500) ? this.state.dropdown.visible ? this.dropdown.hide() : f.dropdown.enabled === 0 && f.mode != "mix" && this.dropdown.show(this.value.length ? "" : void 0) : f.mode != "select" || f.dropdown.enabled !== 0 || this.state.dropdown.visible || (this.events.callbacks.onDoubleClickScope.call(this, s(s({}, d), {}, { target: this.getTagElms()[0] })), !f.userInput && this.dropdown.show()));
        this.removeTags(d.target.parentNode);
      }
    }, onPaste(d) {
      d.preventDefault();
      var f, v, b, D = this.settings;
      if (D.mode == "select" && D.enforceWhitelist || !D.userInput)
        return !1;
      D.readonly || (v = d.clipboardData || window.clipboardData, b = v.getData("Text"), D.hooks.beforePaste(d, { tagify: this, pastedText: b, clipboardData: v }).then((E) => {
        E === void 0 && (E = b), E && (this.injectAtCaret(E, window.getSelection().getRangeAt(0)), this.settings.mode == "mix" ? this.events.callbacks.onMixTagsInput.call(this, d) : this.settings.pasteAsTags ? f = this.addTags(this.state.inputText + E, !0) : (this.state.inputText = E, this.dropdown.show(E))), this.trigger("paste", { event: d, pastedText: b, clipboardData: v, tagsElems: f });
      }).catch((E) => E));
    }, onDrop(d) {
      d.preventDefault();
    }, onEditTagInput(d, f) {
      var v = d.closest("." + this.settings.classNames.tag), b = this.getNodeIndex(v), D = x(v), E = this.input.normalize.call(this, d), P = { [this.settings.tagTextProp]: E, __tagId: D.__tagId }, N = this.validateTag(P);
      this.editTagChangeDetected(h(D, P)) || d.originalIsValid !== !0 || (N = !0), v.classList.toggle(this.settings.classNames.tagInvalid, N !== !0), D.__isValid = N, v.title = N === !0 ? D.title || D.value : N, E.length >= this.settings.dropdown.enabled && (this.state.editing && (this.state.editing.value = E), this.dropdown.show(E)), this.trigger("edit:input", { tag: v, index: b, data: h({}, this.value[b], { newValue: E }), event: f });
    }, onEditTagPaste(d, f) {
      var v = (f.clipboardData || window.clipboardData).getData("Text");
      f.preventDefault();
      var b = T(v);
      this.setRangeAtStartEnd(!1, b);
    }, onEditTagClick(d, f) {
      this.events.callbacks.onClickScope.call(this, f);
    }, onEditTagFocus(d) {
      this.state.editing = { scope: d, input: d.querySelector("[contenteditable]") };
    }, onEditTagBlur(d, f) {
      if (C.call(this, f.relatedTarget) && f.relatedTarget.contains(f.target))
        this.dropdown.hide();
      else if (this.state.editing && (this.state.hasFocus || this.toggleFocusClass(), this.DOM.scope.contains(d))) {
        var v, b, D = this.settings, E = d.closest("." + D.classNames.tag), P = x(E), N = this.input.normalize.call(this, d), K = { [D.tagTextProp]: N, __tagId: P.__tagId }, j = P.__originalData, ce = this.editTagChangeDetected(h(P, K)), te = this.validateTag(K);
        if (N)
          if (ce) {
            if (v = this.hasMaxTags(), b = h({}, j, { [D.tagTextProp]: this.trim(N), __isValid: te }), D.transformTag.call(this, b, j), (te = (!v || j.__isValid === !0) && this.validateTag(b)) !== !0) {
              if (this.trigger("invalid", { data: b, tag: E, message: te }), D.editTags.keepInvalid)
                return;
              D.keepInvalidTags ? b.__isValid = te : b = j;
            } else
              D.keepInvalidTags && (delete b.title, delete b["aria-invalid"], delete b.class);
            this.onEditTagDone(E, b);
          } else
            this.onEditTagDone(E, j);
        else
          this.onEditTagDone(E);
      }
    }, onEditTagkeydown(d, f) {
      if (!this.state.composing)
        switch (this.trigger("edit:keydown", { event: d }), d.key) {
          case "Esc":
          case "Escape":
            this.state.editing = !1, f.__tagifyTagData.__originalData.value ? f.parentNode.replaceChild(f.__tagifyTagData.__originalHTML, f) : f.remove();
            break;
          case "Enter":
          case "Tab":
            d.preventDefault(), setTimeout(() => d.target.blur(), 0);
        }
    }, onDoubleClickScope(d) {
      var f, v, b = d.target.closest("." + this.settings.classNames.tag), D = x(b), E = this.settings;
      b && D.editable !== !1 && (f = b.classList.contains(this.settings.classNames.tagEditing), v = b.hasAttribute("readonly"), E.readonly || f || v || !this.settings.editTags || !E.userInput || this.editTag(b), this.toggleFocusClass(!0), E.mode != "select" && this.trigger("dblclick", { tag: b, index: this.getNodeIndex(b), data: x(b) }));
    }, onInputDOMChange(d) {
      d.forEach((v) => {
        v.addedNodes.forEach((b) => {
          var D;
          if (b.outerHTML == "<div><br></div>")
            b.replaceWith(document.createElement("br"));
          else if (b.nodeType == 1 && b.querySelector(this.settings.classNames.tagSelector)) {
            let E = document.createTextNode("");
            b.childNodes[0].nodeType == 3 && b.previousSibling.nodeName != "BR" && (E = document.createTextNode(`
`)), b.replaceWith(E, ...[...b.childNodes].slice(0, -1)), S(E);
          } else if (C.call(this, b))
            if (((D = b.previousSibling) == null ? void 0 : D.nodeType) != 3 || b.previousSibling.textContent || b.previousSibling.remove(), b.previousSibling && b.previousSibling.nodeName == "BR") {
              b.previousSibling.replaceWith(`
​`);
              let E = b.nextSibling, P = "";
              for (; E; )
                P += E.textContent, E = E.nextSibling;
              P.trim() && S(b.previousSibling);
            } else
              b.previousSibling && !x(b.previousSibling) || b.before("​");
        }), v.removedNodes.forEach((b) => {
          b && b.nodeName == "BR" && C.call(this, f) && (this.removeTags(f), this.fixFirefoxLastTagNoCaret());
        });
      });
      var f = this.DOM.input.lastChild;
      f && f.nodeValue == "" && f.remove(), f && f.nodeName == "BR" || this.DOM.input.appendChild(document.createElement("br"));
    } } };
    function le(d, f) {
      if (!d) {
        console.warn("Tagify:", "input element not found", d);
        const b = new Proxy(this, { get: () => () => b });
        return b;
      }
      if (d.__tagify)
        return console.warn("Tagify: ", "input element is already Tagified - Same instance is returned.", d), d.__tagify;
      var v;
      h(this, function(b) {
        var D = document.createTextNode("");
        function E(P, N, K) {
          K && N.split(/\s+/g).forEach((j) => D[P + "EventListener"].call(D, j, K));
        }
        return { off(P, N) {
          return E("remove", P, N), this;
        }, on(P, N) {
          return N && typeof N == "function" && E("add", P, N), this;
        }, trigger(P, N, K) {
          var j;
          if (K = K || { cloneData: !0 }, P)
            if (b.settings.isJQueryPlugin)
              P == "remove" && (P = "removeTag"), jQuery(b.DOM.originalInput).triggerHandler(P, [N]);
            else {
              try {
                var ce = typeof N == "object" ? N : { value: N };
                if ((ce = K.cloneData ? h({}, ce) : ce).tagify = this, N.event && (ce.event = this.cloneEvent(N.event)), N instanceof Object)
                  for (var te in N)
                    N[te] instanceof HTMLElement && (ce[te] = N[te]);
                j = new CustomEvent(P, { detail: ce });
              } catch (_e) {
                console.warn(_e);
              }
              D.dispatchEvent(j);
            }
        } };
      }(this)), this.isFirefox = /firefox|fxios/i.test(navigator.userAgent) && !/seamonkey/i.test(navigator.userAgent), this.isIE = window.document.documentMode, f = f || {}, this.getPersistedData = (v = f.id, (b) => {
        let D, E = "/" + b;
        if (localStorage.getItem(G + v + "/v", 1) == 1)
          try {
            D = JSON.parse(localStorage[G + v + E]);
          } catch {
          }
        return D;
      }), this.setPersistedData = ((b) => b ? (localStorage.setItem(G + b + "/v", 1), (D, E) => {
        let P = "/" + E, N = JSON.stringify(D);
        D && E && (localStorage.setItem(G + b + P, N), dispatchEvent(new Event("storage")));
      }) : () => {
      })(f.id), this.clearPersistedData = /* @__PURE__ */ ((b) => (D) => {
        const E = G + "/" + b + "/";
        if (D)
          localStorage.removeItem(E + D);
        else
          for (let P in localStorage)
            P.includes(E) && localStorage.removeItem(P);
      })(f.id), this.applySettings(d, f), this.state = { inputText: "", editing: !1, composing: !1, actions: {}, mixMode: {}, dropdown: {}, flaggedTags: {} }, this.value = [], this.listeners = {}, this.DOM = {}, this.build(d), L.call(this), this.getCSSVars(), this.loadOriginalValues(), this.events.customBinding.call(this), this.events.binding.call(this), d.autofocus && this.DOM.input.focus(), d.__tagify = this;
    }
    return le.prototype = { _dropdown: q, placeCaretAfterNode: S, getSetTagData: x, helpers: { sameStr: a, removeCollectionProp: o, omit: n, isObject: p, parseHTML: c, escapeHTML: g, extend: h, concatWithoutDups: m, getUID: _, isNodeTag: C }, customEventsList: ["change", "add", "remove", "invalid", "input", "paste", "click", "keydown", "focus", "blur", "edit:input", "edit:beforeUpdate", "edit:updated", "edit:start", "edit:keydown", "dropdown:show", "dropdown:hide", "dropdown:select", "dropdown:updated", "dropdown:noMatch", "dropdown:scroll"], dataProps: ["__isValid", "__removed", "__originalData", "__originalHTML", "__tagId"], trim(d) {
      return this.settings.trim && d && typeof d == "string" ? d.trim() : d;
    }, parseHTML: c, templates: de, parseTemplate(d, f) {
      return c((d = this.settings.templates[d] || d).apply(this, f));
    }, set whitelist(d) {
      const f = d && Array.isArray(d);
      this.settings.whitelist = f ? d : [], this.setPersistedData(f ? d : [], "whitelist");
    }, get whitelist() {
      return this.settings.whitelist;
    }, generateClassSelectors(d) {
      for (let f in d) {
        let v = f;
        Object.defineProperty(d, v + "Selector", { get() {
          return "." + this[v].split(" ")[0];
        } });
      }
    }, applySettings(d, f) {
      var E, P;
      M.templates = this.templates;
      var v = h({}, M, f.mode == "mix" ? { dropdown: { position: "text" } } : {}), b = this.settings = h({}, v, f);
      if (b.disabled = d.hasAttribute("disabled"), b.readonly = b.readonly || d.hasAttribute("readonly"), b.placeholder = g(d.getAttribute("placeholder") || b.placeholder || ""), b.required = d.hasAttribute("required"), this.generateClassSelectors(b.classNames), b.dropdown.includeSelectedTags === void 0 && (b.dropdown.includeSelectedTags = b.duplicates), this.isIE && (b.autoComplete = !1), ["whitelist", "blacklist"].forEach((N) => {
        var K = d.getAttribute("data-" + N);
        K && (K = K.split(b.delimiters)) instanceof Array && (b[N] = K);
      }), "autoComplete" in f && !p(f.autoComplete) && (b.autoComplete = M.autoComplete, b.autoComplete.enabled = f.autoComplete), b.mode == "mix" && (b.pattern = b.pattern || /@/, b.autoComplete.rightKey = !0, b.delimiters = f.delimiters || null, b.tagTextProp && !b.dropdown.searchKeys.includes(b.tagTextProp) && b.dropdown.searchKeys.push(b.tagTextProp)), d.pattern)
        try {
          b.pattern = new RegExp(d.pattern);
        } catch {
        }
      if (b.delimiters) {
        b._delimiters = b.delimiters;
        try {
          b.delimiters = new RegExp(this.settings.delimiters, "g");
        } catch {
        }
      }
      b.disabled && (b.userInput = !1), this.TEXTS = s(s({}, U), b.texts || {}), (b.mode != "select" || (E = f.dropdown) != null && E.enabled) && b.userInput || (b.dropdown.enabled = 0), b.dropdown.appendTarget = ((P = f.dropdown) == null ? void 0 : P.appendTarget) || document.body;
      let D = this.getPersistedData("whitelist");
      Array.isArray(D) && (this.whitelist = Array.isArray(b.whitelist) ? m(b.whitelist, D) : D);
    }, getAttributes(d) {
      var f, v = this.getCustomAttributes(d), b = "";
      for (f in v)
        b += " " + f + (d[f] !== void 0 ? `="${v[f]}"` : "");
      return b;
    }, getCustomAttributes(d) {
      if (!p(d))
        return "";
      var f, v = {};
      for (f in d)
        f.slice(0, 2) != "__" && f != "class" && d.hasOwnProperty(f) && d[f] !== void 0 && (v[f] = g(d[f]));
      return v;
    }, setStateSelection() {
      var d = window.getSelection(), f = { anchorOffset: d.anchorOffset, anchorNode: d.anchorNode, range: d.getRangeAt && d.rangeCount && d.getRangeAt(0) };
      return this.state.selection = f, f;
    }, getCSSVars() {
      var d = getComputedStyle(this.DOM.scope, null), f;
      this.CSSVars = { tagHideTransition: ((v) => {
        let b = v.value;
        return v.unit == "s" ? 1e3 * b : b;
      })(function(v) {
        if (!v)
          return {};
        var b = (v = v.trim().split(" ")[0]).split(/\d+/g).filter((D) => D).pop().trim();
        return { value: +v.split(b).filter((D) => D)[0].trim(), unit: b };
      }((f = "tag-hide-transition", d.getPropertyValue("--" + f)))) };
    }, build(d) {
      var f = this.DOM, v = d.closest("label");
      this.settings.mixMode.integrated ? (f.originalInput = null, f.scope = d, f.input = d) : (f.originalInput = d, f.originalInput_tabIndex = d.tabIndex, f.scope = this.parseTemplate("wrapper", [d, this.settings]), f.input = f.scope.querySelector(this.settings.classNames.inputSelector), d.parentNode.insertBefore(f.scope, d), d.tabIndex = -1), v && v.setAttribute("for", "");
    }, destroy() {
      this.events.unbindGlobal.call(this), this.DOM.scope.parentNode.removeChild(this.DOM.scope), this.DOM.originalInput.tabIndex = this.DOM.originalInput_tabIndex, delete this.DOM.originalInput.__tagify, this.dropdown.hide(!0), clearTimeout(this.dropdownHide__bindEventsTimeout), clearInterval(this.listeners.main.originalInputValueObserverInterval);
    }, loadOriginalValues(d) {
      var f, v = this.settings;
      if (this.state.blockChangeEvent = !0, d === void 0) {
        const b = this.getPersistedData("value");
        d = b && !this.DOM.originalInput.value ? b : v.mixMode.integrated ? this.DOM.input.textContent : this.DOM.originalInput.value;
      }
      if (this.removeAllTags(), d)
        if (v.mode == "mix")
          this.parseMixTags(d), (f = this.DOM.input.lastChild) && f.tagName == "BR" || this.DOM.input.insertAdjacentHTML("beforeend", "<br>");
        else {
          try {
            JSON.parse(d) instanceof Array && (d = JSON.parse(d));
          } catch {
          }
          this.addTags(d, !0).forEach((b) => b && b.classList.add(v.classNames.tagNoAnimation));
        }
      else
        this.postUpdate();
      this.state.lastOriginalValueReported = v.mixMode.integrated ? "" : this.DOM.originalInput.value;
    }, cloneEvent(d) {
      var f = {};
      for (var v in d)
        v != "path" && (f[v] = d[v]);
      return f;
    }, loading(d) {
      return this.state.isLoading = d, this.DOM.scope.classList[d ? "add" : "remove"](this.settings.classNames.scopeLoading), this;
    }, tagLoading(d, f) {
      return d && d.classList[f ? "add" : "remove"](this.settings.classNames.tagLoading), this;
    }, toggleClass(d, f) {
      typeof d == "string" && this.DOM.scope.classList.toggle(d, f);
    }, toggleScopeValidation(d) {
      var f = d === !0 || d === void 0;
      !this.settings.required && d && d === this.TEXTS.empty && (f = !0), this.toggleClass(this.settings.classNames.tagInvalid, !f), this.DOM.scope.title = f ? "" : d;
    }, toggleFocusClass(d) {
      this.toggleClass(this.settings.classNames.focus, !!d);
    }, triggerChangeEvent: function() {
      if (!this.settings.mixMode.integrated) {
        var d = this.DOM.originalInput, f = this.state.lastOriginalValueReported !== d.value, v = new CustomEvent("change", { bubbles: !0 });
        f && (this.state.lastOriginalValueReported = d.value, v.simulated = !0, d._valueTracker && d._valueTracker.setValue(Math.random()), d.dispatchEvent(v), this.trigger("change", this.state.lastOriginalValueReported), d.value = this.state.lastOriginalValueReported);
      }
    }, events: ee, fixFirefoxLastTagNoCaret() {
    }, setRangeAtStartEnd(d, f) {
      if (f) {
        d = typeof d == "number" ? d : !!d, f = f.lastChild || f;
        var v = document.getSelection();
        if (v.focusNode instanceof Element && !this.DOM.input.contains(v.focusNode))
          return !0;
        try {
          v.rangeCount >= 1 && ["Start", "End"].forEach((b) => v.getRangeAt(0)["set" + b](f, d || f.length));
        } catch (b) {
          console.warn("Tagify: ", b);
        }
      }
    }, insertAfterTag(d, f) {
      if (f = f || this.settings.mixMode.insertAfterTag, d && d.parentNode && f)
        return f = typeof f == "string" ? document.createTextNode(f) : f, d.parentNode.insertBefore(f, d.nextSibling), f;
    }, editTagChangeDetected(d) {
      var f = d.__originalData;
      for (var v in f)
        if (!this.dataProps.includes(v) && d[v] != f[v])
          return !0;
      return !1;
    }, getTagTextNode(d) {
      return d.querySelector(this.settings.classNames.tagTextSelector);
    }, setTagTextNode(d, f) {
      this.getTagTextNode(d).innerHTML = g(f);
    }, editTag(d, f) {
      d = d || this.getLastTag(), f = f || {}, this.dropdown.hide();
      var v = this.settings, b = this.getTagTextNode(d), D = this.getNodeIndex(d), E = x(d), P = this.events.callbacks, N = !0;
      if (b) {
        if (!(E instanceof Object && "editable" in E) || E.editable)
          return E = x(d, { __originalData: h({}, E), __originalHTML: d.cloneNode(!0) }), x(E.__originalHTML, E.__originalData), b.setAttribute("contenteditable", !0), d.classList.add(v.classNames.tagEditing), b.addEventListener("click", P.onEditTagClick.bind(this, d)), b.addEventListener("focus", P.onEditTagFocus.bind(this, d)), b.addEventListener("blur", P.onEditTagBlur.bind(this, this.getTagTextNode(d))), b.addEventListener("input", P.onEditTagInput.bind(this, b)), b.addEventListener("paste", P.onEditTagPaste.bind(this, b)), b.addEventListener("keydown", (K) => P.onEditTagkeydown.call(this, K, d)), b.addEventListener("compositionstart", P.onCompositionStart.bind(this)), b.addEventListener("compositionend", P.onCompositionEnd.bind(this)), f.skipValidation || (N = this.editTagToggleValidity(d)), b.originalIsValid = N, this.trigger("edit:start", { tag: d, index: D, data: E, isValid: N }), b.focus(), this.setRangeAtStartEnd(!1, b), v.dropdown.enabled === 0 && this.dropdown.show(), this.state.hasFocus = !0, this;
      } else
        console.warn("Cannot find element in Tag template: .", v.classNames.tagTextSelector);
    }, editTagToggleValidity(d, f) {
      var v;
      if (f = f || x(d))
        return (v = !("__isValid" in f) || f.__isValid === !0) || this.removeTagsFromValue(d), this.update(), d.classList.toggle(this.settings.classNames.tagNotAllowed, !v), f.__isValid = v, f.__isValid;
      console.warn("tag has no data: ", d, f);
    }, onEditTagDone(d, f) {
      var E;
      d = d || this.state.editing.scope, f = f || {};
      var v, b = { tag: d, index: this.getNodeIndex(d), previousData: x(d), data: f }, D = this.settings;
      this.trigger("edit:beforeUpdate", b, { cloneData: !1 }), this.state.editing = !1, delete f.__originalData, delete f.__originalHTML, d && ((v = f[D.tagTextProp]) ? (E = v.trim) != null && E.call(v) : !(D.tagTextProp in f) && f.value) ? (d = this.replaceTag(d, f), this.editTagToggleValidity(d, f), D.a11y.focusableTags ? d.focus() : S(d)) : d && this.removeTags(d), this.trigger("edit:updated", b), this.dropdown.hide(), this.settings.keepInvalidTags && this.reCheckInvalidTags();
    }, replaceTag(d, f) {
      f && f.value !== "" && f.value !== void 0 || (f = d.__tagifyTagData), f.__isValid && f.__isValid != 1 && h(f, this.getInvalidTagAttrs(f, f.__isValid));
      var v = this.createTagElem(f);
      return d.parentNode.replaceChild(v, d), this.updateValueByDOMTags(), v;
    }, updateValueByDOMTags() {
      this.value.length = 0, [].forEach.call(this.getTagElms(), (d) => {
        d.classList.contains(this.settings.classNames.tagNotAllowed.split(" ")[0]) || this.value.push(x(d));
      }), this.update();
    }, injectAtCaret(d, f) {
      var b;
      if (!(f = f || ((b = this.state.selection) == null ? void 0 : b.range)) && d)
        return this.appendMixTags(d), this;
      let v = T(d, f);
      return this.setRangeAtStartEnd(!1, v), this.updateValueByDOMTags(), this.update(), this;
    }, input: { set() {
      let d = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "", f = !(arguments.length > 1 && arguments[1] !== void 0) || arguments[1];
      var v = this.settings.dropdown.closeOnSelect;
      this.state.inputText = d, f && (this.DOM.input.innerHTML = g("" + d)), !d && v && this.dropdown.hide.bind(this), this.input.autocomplete.suggest.call(this), this.input.validate.call(this);
    }, raw() {
      return this.DOM.input.textContent;
    }, validate() {
      var d = !this.state.inputText || this.validateTag({ value: this.state.inputText }) === !0;
      return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid, !d), d;
    }, normalize(d, f) {
      var v = d || this.DOM.input, b = [];
      v.childNodes.forEach((D) => D.nodeType == 3 && b.push(D.nodeValue)), b = b.join(`
`);
      try {
        b = b.replace(/(?:\r\n|\r|\n)/g, this.settings.delimiters.source.charAt(0));
      } catch {
      }
      return b = b.replace(/\s/g, " "), f != null && f.trim ? this.trim(b) : b;
    }, autocomplete: { suggest(d) {
      if (this.settings.autoComplete.enabled) {
        typeof (d = d || { value: "" }) != "object" && (d = { value: d });
        var f = this.dropdown.getMappedValue(d);
        if (typeof f != "number") {
          var v = this.state.inputText.toLowerCase(), b = f.substr(0, this.state.inputText.length).toLowerCase(), D = f.substring(this.state.inputText.length);
          f && this.state.inputText && b == v ? (this.DOM.input.setAttribute("data-suggest", D), this.state.inputSuggestion = d) : (this.DOM.input.removeAttribute("data-suggest"), delete this.state.inputSuggestion);
        }
      }
    }, set(d) {
      var f = this.DOM.input.getAttribute("data-suggest"), v = d || (f ? this.state.inputText + f : null);
      return !!v && (this.settings.mode == "mix" ? this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix + v)) : (this.input.set.call(this, v), this.setRangeAtStartEnd(!1, this.DOM.input)), this.input.autocomplete.suggest.call(this), this.dropdown.hide(), !0);
    } } }, getTagIdx(d) {
      return this.value.findIndex((f) => f.__tagId == (d || {}).__tagId);
    }, getNodeIndex(d) {
      var f = 0;
      if (d)
        for (; d = d.previousElementSibling; )
          f++;
      return f;
    }, getTagElms() {
      for (var d = arguments.length, f = new Array(d), v = 0; v < d; v++)
        f[v] = arguments[v];
      var b = "." + [...this.settings.classNames.tag.split(" "), ...f].join(".");
      return [].slice.call(this.DOM.scope.querySelectorAll(b));
    }, getLastTag() {
      var d = this.DOM.scope.querySelectorAll(`${this.settings.classNames.tagSelector}:not(.${this.settings.classNames.tagHide}):not([readonly])`);
      return d[d.length - 1];
    }, isTagDuplicate(d, f, v) {
      var b = 0;
      if (this.settings.mode == "select")
        return !1;
      for (let D of this.value)
        a(this.trim("" + d), D.value, f) && v != D.__tagId && b++;
      return b;
    }, getTagIndexByValue(d) {
      var f = [], v = this.settings.dropdown.caseSensitive;
      return this.getTagElms().forEach((b, D) => {
        b.__tagifyTagData && a(this.trim(b.__tagifyTagData.value), d, v) && f.push(D);
      }), f;
    }, getTagElmByValue(d) {
      var f = this.getTagIndexByValue(d)[0];
      return this.getTagElms()[f];
    }, flashTag(d) {
      d && (d.classList.add(this.settings.classNames.tagFlash), setTimeout(() => {
        d.classList.remove(this.settings.classNames.tagFlash);
      }, 100));
    }, isTagBlacklisted(d) {
      return d = this.trim(d.toLowerCase()), this.settings.blacklist.filter((f) => ("" + f).toLowerCase() == d).length;
    }, isTagWhitelisted(d) {
      return !!this.getWhitelistItem(d);
    }, getWhitelistItem(d, f, v) {
      f = f || "value";
      var b, D = this.settings;
      return (v = v || D.whitelist).some((E) => {
        var P = typeof E == "string" ? E : E[f] || E.value;
        if (a(P, d, D.dropdown.caseSensitive, D.trim))
          return b = typeof E == "string" ? { value: E } : E, !0;
      }), b || f != "value" || D.tagTextProp == "value" || (b = this.getWhitelistItem(d, D.tagTextProp, v)), b;
    }, validateTag(d) {
      var f = this.settings, v = "value" in d ? "value" : f.tagTextProp, b = this.trim(d[v] + "");
      return (d[v] + "").trim() ? f.mode != "mix" && f.pattern && f.pattern instanceof RegExp && !f.pattern.test(b) ? this.TEXTS.pattern : !f.duplicates && this.isTagDuplicate(b, f.dropdown.caseSensitive, d.__tagId) ? this.TEXTS.duplicate : this.isTagBlacklisted(b) || f.enforceWhitelist && !this.isTagWhitelisted(b) ? this.TEXTS.notAllowed : !f.validate || f.validate(d) : this.TEXTS.empty;
    }, getInvalidTagAttrs(d, f) {
      return { "aria-invalid": !0, class: `${d.class || ""} ${this.settings.classNames.tagNotAllowed}`.trim(), title: f };
    }, hasMaxTags() {
      return this.value.length >= this.settings.maxTags && this.TEXTS.exceed;
    }, setReadonly(d, f) {
      var v = this.settings;
      document.activeElement.blur(), v[f || "readonly"] = d, this.DOM.scope[(d ? "set" : "remove") + "Attribute"](f || "readonly", !0), this.settings.userInput = !0, this.setContentEditable(!d);
    }, setContentEditable(d) {
      this.settings.userInput && (this.DOM.input.contentEditable = d, this.DOM.input.tabIndex = d ? 0 : -1);
    }, setDisabled(d) {
      this.setReadonly(d, "disabled");
    }, normalizeTags(d) {
      var f = this.settings, v = f.whitelist, b = f.delimiters, D = f.mode, E = f.tagTextProp, P = [], N = !!v && v[0] instanceof Object, K = Array.isArray(d), j = K && d[0].value, ce = (te) => (te + "").split(b).filter((_e) => _e).map((_e) => ({ [E]: this.trim(_e), value: this.trim(_e) }));
      if (typeof d == "number" && (d = d.toString()), typeof d == "string") {
        if (!d.trim())
          return [];
        d = ce(d);
      } else
        K && (d = [].concat(...d.map((te) => te.value != null ? te : ce(te))));
      return N && !j && (d.forEach((te) => {
        var _e = P.map((we) => we.value), ie = this.dropdown.filterListItems.call(this, te[E], { exact: !0 });
        this.settings.duplicates || (ie = ie.filter((we) => !_e.includes(we.value)));
        var pe = ie.length > 1 ? this.getWhitelistItem(te[E], E, ie) : ie[0];
        pe && pe instanceof Object ? P.push(pe) : D != "mix" && (te.value == null && (te.value = te[E]), P.push(te));
      }), P.length && (d = P)), d;
    }, parseMixTags(d) {
      var f = this.settings, v = f.mixTagsInterpolator, b = f.duplicates, D = f.transformTag, E = f.enforceWhitelist, P = f.maxTags, N = f.tagTextProp, K = [];
      d = d.split(v[0]).map((ce, te) => {
        var _e, ie, pe, we = ce.split(v[1]), ye = we[0], fe = K.length == P;
        try {
          if (ye == +ye)
            throw Error;
          ie = JSON.parse(ye);
        } catch {
          ie = this.normalizeTags(ye)[0] || { value: ye };
        }
        if (D.call(this, ie), fe || !(we.length > 1) || E && !this.isTagWhitelisted(ie.value) || !b && this.isTagDuplicate(ie.value)) {
          if (ce)
            return te ? v[0] + ce : ce;
        } else
          ie[_e = ie[N] ? N : "value"] = this.trim(ie[_e]), pe = this.createTagElem(ie), K.push(ie), pe.classList.add(this.settings.classNames.tagNoAnimation), we[0] = pe.outerHTML, this.value.push(ie);
        return we.join("");
      }).join(""), this.DOM.input.innerHTML = d, this.DOM.input.appendChild(document.createTextNode("")), this.DOM.input.normalize();
      var j = this.getTagElms();
      return j.forEach((ce, te) => x(ce, K[te])), this.update({ withoutChangeEvent: !0 }), O(j, this.state.hasFocus), d;
    }, replaceTextWithNode(d, f) {
      if (this.state.tag || f) {
        f = f || this.state.tag.prefix + this.state.tag.value;
        var v, b, D = this.state.selection || window.getSelection(), E = D.anchorNode, P = this.state.tag.delimiters ? this.state.tag.delimiters.length : 0;
        return E.splitText(D.anchorOffset - P), (v = E.nodeValue.lastIndexOf(f)) == -1 || (b = E.splitText(v), d && E.parentNode.replaceChild(d, b)), !0;
      }
    }, prepareNewTagNode(d, f) {
      f = f || {};
      var v = this.settings, b = [], D = {}, E = Object.assign({}, d, { value: d.value + "" });
      if (d = Object.assign({}, E), v.transformTag.call(this, d), d.__isValid = this.hasMaxTags() || this.validateTag(d), d.__isValid !== !0) {
        if (f.skipInvalid)
          return;
        if (h(D, this.getInvalidTagAttrs(d, d.__isValid), { __preInvalidData: E }), d.__isValid == this.TEXTS.duplicate && this.flashTag(this.getTagElmByValue(d.value)), !v.createInvalidTags)
          return void b.push(d.value);
      }
      return "readonly" in d && (d.readonly ? D["aria-readonly"] = !0 : delete d.readonly), { tagElm: this.createTagElem(d, D), tagData: d, aggregatedInvalidInput: b };
    }, postProcessNewTagNode(d, f) {
      var v = this.settings, b = f.__isValid;
      b && b === !0 ? (this.value.push(f), this.trigger("add", { tag: d, index: this.value.length - 1, data: f })) : (this.trigger("invalid", { data: f, index: this.value.length, tag: d, message: b }), v.keepInvalidTags || setTimeout(() => this.removeTags(d, !0), 1e3)), this.dropdown.position();
    }, selectTag(d, f) {
      if (!this.settings.enforceWhitelist || this.isTagWhitelisted(f.value)) {
        this.state.actions.selectOption && setTimeout(() => this.setRangeAtStartEnd(!1, this.DOM.input));
        var v = this.getLastTag();
        return v ? this.replaceTag(v, f) : this.appendTag(d), this.value[0] = f, this.update(), this.trigger("add", { tag: d, data: f }), [d];
      }
    }, addEmptyTag(d) {
      var f = h({ value: "" }, d || {}), v = this.createTagElem(f);
      x(v, f), this.appendTag(v), this.editTag(v, { skipValidation: !0 }), this.toggleFocusClass(!0);
    }, addTags(d, f, v) {
      var b = [], D = this.settings, E = [], P = document.createDocumentFragment();
      if (!d || d.length == 0)
        return b;
      switch (d = this.normalizeTags(d), D.mode) {
        case "mix":
          return this.addMixTags(d);
        case "select":
          f = !1, this.removeAllTags();
      }
      return this.DOM.input.removeAttribute("style"), d.forEach((N) => {
        const K = this.prepareNewTagNode(N, { skipInvalid: v || D.skipInvalid }), j = K.tagElm;
        if (N = K.tagData, E = K.aggregatedInvalidInput, b.push(j), D.mode == "select")
          return this.selectTag(j, N);
        P.appendChild(j), this.postProcessNewTagNode(j, N);
      }), this.appendTag(P), this.update(), d.length && f && (this.input.set.call(this, D.createInvalidTags ? "" : E.join(D._delimiters)), this.setRangeAtStartEnd(!1, this.DOM.input)), D.dropdown.enabled && this.dropdown.refilter(), b;
    }, addMixTags(d) {
      if ((d = this.normalizeTags(d))[0].prefix || this.state.tag)
        return this.prefixedTextToTag(d[0]);
      var f = document.createDocumentFragment();
      return d.forEach((v) => {
        const b = this.prepareNewTagNode(v);
        f.appendChild(b.tagElm), this.postProcessNewTagNode(tagElm, b.tagData);
      }), this.appendMixTags(f), f;
    }, appendMixTags(d) {
      var f = !!this.state.selection;
      f ? this.injectAtCaret(d) : (this.DOM.input.focus(), (f = this.setStateSelection()).range.setStart(this.DOM.input, f.range.endOffset), f.range.setEnd(this.DOM.input, f.range.endOffset), this.DOM.input.appendChild(d), this.updateValueByDOMTags(), this.update());
    }, prefixedTextToTag(d) {
      var P;
      var f, v, b = this.settings, D = (P = this.state.tag) == null ? void 0 : P.delimiters;
      if (d.prefix = d.prefix || this.state.tag ? this.state.tag.prefix : (b.pattern.source || b.pattern)[0], v = this.prepareNewTagNode(d), f = v.tagElm, this.replaceTextWithNode(f) || this.DOM.input.appendChild(f), setTimeout(() => f.classList.add(this.settings.classNames.tagNoAnimation), 300), this.value.push(v.tagData), this.update(), !D) {
        var E = this.insertAfterTag(f) || f;
        setTimeout(S, 0, E);
      }
      return this.state.tag = null, this.postProcessNewTagNode(f, v.tagData), f;
    }, appendTag(d) {
      var f = this.DOM, v = f.input;
      f.scope.insertBefore(d, v);
    }, createTagElem(d, f) {
      d.__tagId = _();
      var v, b = h({}, d, s({ value: g(d.value + "") }, f));
      return function(D) {
        for (var E, P = document.createNodeIterator(D, NodeFilter.SHOW_TEXT, null, !1); E = P.nextNode(); )
          E.textContent.trim() || E.parentNode.removeChild(E);
      }(v = this.parseTemplate("tag", [b, this])), x(v, d), v;
    }, reCheckInvalidTags() {
      var d = this.settings;
      this.getTagElms(d.classNames.tagNotAllowed).forEach((f, v) => {
        var b = x(f), D = this.hasMaxTags(), E = this.validateTag(b), P = E === !0 && !D;
        if (d.mode == "select" && this.toggleScopeValidation(E), P)
          return b = b.__preInvalidData ? b.__preInvalidData : { value: b.value }, this.replaceTag(f, b);
        f.title = D || E;
      });
    }, removeTags(d, f, v) {
      var b, D = this.settings;
      if (d = d && d instanceof HTMLElement ? [d] : d instanceof Array ? d : d ? [d] : [this.getLastTag()], b = d.reduce((E, P) => {
        P && typeof P == "string" && (P = this.getTagElmByValue(P));
        var N = x(P);
        return P && N && !N.readonly && E.push({ node: P, idx: this.getTagIdx(N), data: x(P, { __removed: !0 }) }), E;
      }, []), v = typeof v == "number" ? v : this.CSSVars.tagHideTransition, D.mode == "select" && (v = 0, this.input.set.call(this)), b.length == 1 && D.mode != "select" && b[0].node.classList.contains(D.classNames.tagNotAllowed) && (f = !0), b.length)
        return D.hooks.beforeRemoveTag(b, { tagify: this }).then(() => {
          function E(P) {
            P.node.parentNode && (P.node.parentNode.removeChild(P.node), f ? D.keepInvalidTags && this.trigger("remove", { tag: P.node, index: P.idx }) : (this.trigger("remove", { tag: P.node, index: P.idx, data: P.data }), this.dropdown.refilter(), this.dropdown.position(), this.DOM.input.normalize(), D.keepInvalidTags && this.reCheckInvalidTags()));
          }
          v && v > 10 && b.length == 1 ? (function(P) {
            P.node.style.width = parseFloat(window.getComputedStyle(P.node).width) + "px", document.body.clientTop, P.node.classList.add(D.classNames.tagHide), setTimeout(E.bind(this), v, P);
          }).call(this, b[0]) : b.forEach(E.bind(this)), f || (this.removeTagsFromValue(b.map((P) => P.node)), this.update(), D.mode == "select" && this.setContentEditable(!0));
        }).catch((E) => {
        });
    }, removeTagsFromDOM() {
      [].slice.call(this.getTagElms()).forEach((d) => d.parentNode.removeChild(d));
    }, removeTagsFromValue(d) {
      (d = Array.isArray(d) ? d : [d]).forEach((f) => {
        var v = x(f), b = this.getTagIdx(v);
        b > -1 && this.value.splice(b, 1);
      });
    }, removeAllTags(d) {
      d = d || {}, this.value = [], this.settings.mode == "mix" ? this.DOM.input.innerHTML = "" : this.removeTagsFromDOM(), this.dropdown.refilter(), this.dropdown.position(), this.state.dropdown.visible && setTimeout(() => {
        this.DOM.input.focus();
      }), this.settings.mode == "select" && (this.input.set.call(this), this.setContentEditable(!0)), this.update(d);
    }, postUpdate() {
      var b, D;
      this.state.blockChangeEvent = !1;
      var d = this.settings, f = d.classNames, v = d.mode == "mix" ? d.mixMode.integrated ? this.DOM.input.textContent : this.DOM.originalInput.value.trim() : this.value.length + this.input.raw.call(this).length;
      this.toggleClass(f.hasMaxTags, this.value.length >= d.maxTags), this.toggleClass(f.hasNoTags, !this.value.length), this.toggleClass(f.empty, !v), d.mode == "select" && this.toggleScopeValidation((D = (b = this.value) == null ? void 0 : b[0]) == null ? void 0 : D.__isValid);
    }, setOriginalInputValue(d) {
      var f = this.DOM.originalInput;
      this.settings.mixMode.integrated || (f.value = d, f.tagifyValue = f.value, this.setPersistedData(d, "value"));
    }, update(d) {
      clearTimeout(this.debouncedUpdateTimeout), this.debouncedUpdateTimeout = setTimeout((function() {
        var f = this.getInputValue();
        this.setOriginalInputValue(f), this.settings.onChangeAfterBlur && (d || {}).withoutChangeEvent || this.state.blockChangeEvent || this.triggerChangeEvent(), this.postUpdate();
      }).bind(this), 100);
    }, getInputValue() {
      var d = this.getCleanValue();
      return this.settings.mode == "mix" ? this.getMixedTagsAsString(d) : d.length ? this.settings.originalInputValueFormat ? this.settings.originalInputValueFormat(d) : JSON.stringify(d) : "";
    }, getCleanValue(d) {
      return o(d || this.value, this.dataProps);
    }, getMixedTagsAsString() {
      var d = "", f = this, v = this.settings, b = v.originalInputValueFormat || JSON.stringify, D = v.mixTagsInterpolator;
      return function E(P) {
        P.childNodes.forEach((N) => {
          if (N.nodeType == 1) {
            const K = x(N);
            if (N.tagName == "BR" && (d += `\r
`), K && C.call(f, N)) {
              if (K.__removed)
                return;
              d += D[0] + b(n(K, f.dataProps)) + D[1];
            } else
              N.getAttribute("style") || ["B", "I", "U"].includes(N.tagName) ? d += N.textContent : N.tagName != "DIV" && N.tagName != "P" || (d += `\r
`, E(N));
          } else
            d += N.textContent;
        });
      }(this.DOM.input), d;
    } }, le.prototype.removeTag = le.prototype.removeTags, le;
  });
})(F0);
var Gg = F0.exports;
const Vg = /* @__PURE__ */ Kg(Gg);
function di(r) {
  if (r === void 0)
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return r;
}
function L0(r, e) {
  r.prototype = Object.create(e.prototype), r.prototype.constructor = r, r.__proto__ = e;
}
/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var ls = {
  autoSleep: 120,
  force3D: "auto",
  nullTargetWarn: 1,
  units: {
    lineHeight: ""
  }
}, Qr = {
  duration: 0.5,
  overwrite: !1,
  delay: 0
}, ru, Lt, Xe, vs = 1e8, Ge = 1 / vs, lc = Math.PI * 2, zg = lc / 4, qg = 0, R0 = Math.sqrt, Yg = Math.cos, Ug = Math.sin, wt = function(e) {
  return typeof e == "string";
}, it = function(e) {
  return typeof e == "function";
}, Di = function(e) {
  return typeof e == "number";
}, au = function(e) {
  return typeof e > "u";
}, ei = function(e) {
  return typeof e == "object";
}, Xt = function(e) {
  return e !== !1;
}, ou = function() {
  return typeof window < "u";
}, xo = function(e) {
  return it(e) || wt(e);
}, $0 = typeof ArrayBuffer == "function" && ArrayBuffer.isView || function() {
}, Rt = Array.isArray, cc = /(?:-?\.?\d|\.)+/gi, N0 = /[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g, Pr = /[-+=.]*\d+[.e-]*\d*[a-z%]*/g, Al = /[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi, B0 = /[+-]=-?[.\d]+/, H0 = /[^,'"\[\]\s]+/gi, Xg = /^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i, Qe, Us, uc, nu, us = {}, fn = {}, W0, j0 = function(e) {
  return (fn = mr(e, us)) && es;
}, lu = function(e, t) {
  return console.warn("Invalid property", e, "set to", t, "Missing plugin? gsap.registerPlugin()");
}, ro = function(e, t) {
  return !t && console.warn(e);
}, K0 = function(e, t) {
  return e && (us[e] = t) && fn && (fn[e] = t) || us;
}, ao = function() {
  return 0;
}, Zg = {
  suppressEvents: !0,
  isStart: !0,
  kill: !1
}, Go = {
  suppressEvents: !0,
  kill: !1
}, Jg = {
  suppressEvents: !0
}, cu = {}, ji = [], hc = {}, G0, is = {}, xl = {}, nh = 30, Vo = [], uu = "", hu = function(e) {
  var t = e[0], s, i;
  if (ei(t) || it(t) || (e = [e]), !(s = (t._gsap || {}).harness)) {
    for (i = Vo.length; i-- && !Vo[i].targetTest(t); )
      ;
    s = Vo[i];
  }
  for (i = e.length; i--; )
    e[i] && (e[i]._gsap || (e[i]._gsap = new fd(e[i], s))) || e.splice(i, 1);
  return e;
}, cr = function(e) {
  return e._gsap || hu(ks(e))[0]._gsap;
}, V0 = function(e, t, s) {
  return (s = e[t]) && it(s) ? e[t]() : au(s) && e.getAttribute && e.getAttribute(t) || s;
}, Zt = function(e, t) {
  return (e = e.split(",")).forEach(t) || e;
}, nt = function(e) {
  return Math.round(e * 1e5) / 1e5 || 0;
}, yt = function(e) {
  return Math.round(e * 1e7) / 1e7 || 0;
}, Hr = function(e, t) {
  var s = t.charAt(0), i = parseFloat(t.substr(2));
  return e = parseFloat(e), s === "+" ? e + i : s === "-" ? e - i : s === "*" ? e * i : e / i;
}, Qg = function(e, t) {
  for (var s = t.length, i = 0; e.indexOf(t[i]) < 0 && ++i < s; )
    ;
  return i < s;
}, pn = function() {
  var e = ji.length, t = ji.slice(0), s, i;
  for (hc = {}, ji.length = 0, s = 0; s < e; s++)
    i = t[s], i && i._lazy && (i.render(i._lazy[0], i._lazy[1], !0)._lazy = 0);
}, z0 = function(e, t, s, i) {
  ji.length && !Lt && pn(), e.render(t, s, i || Lt && t < 0 && (e._initted || e._startAt)), ji.length && !Lt && pn();
}, q0 = function(e) {
  var t = parseFloat(e);
  return (t || t === 0) && (e + "").match(H0).length < 2 ? t : wt(e) ? e.trim() : e;
}, Y0 = function(e) {
  return e;
}, Ts = function(e, t) {
  for (var s in t)
    s in e || (e[s] = t[s]);
  return e;
}, ef = function(e) {
  return function(t, s) {
    for (var i in s)
      i in t || i === "duration" && e || i === "ease" || (t[i] = s[i]);
  };
}, mr = function(e, t) {
  for (var s in t)
    e[s] = t[s];
  return e;
}, lh = function r(e, t) {
  for (var s in t)
    s !== "__proto__" && s !== "constructor" && s !== "prototype" && (e[s] = ei(t[s]) ? r(e[s] || (e[s] = {}), t[s]) : t[s]);
  return e;
}, mn = function(e, t) {
  var s = {}, i;
  for (i in e)
    i in t || (s[i] = e[i]);
  return s;
}, Ha = function(e) {
  var t = e.parent || Qe, s = e.keyframes ? ef(Rt(e.keyframes)) : Ts;
  if (Xt(e.inherit))
    for (; t; )
      s(e, t.vars.defaults), t = t.parent || t._dp;
  return e;
}, tf = function(e, t) {
  for (var s = e.length, i = s === t.length; i && s-- && e[s] === t[s]; )
    ;
  return s < 0;
}, U0 = function(e, t, s, i, a) {
  s === void 0 && (s = "_first"), i === void 0 && (i = "_last");
  var o = e[i], n;
  if (a)
    for (n = t[a]; o && o[a] > n; )
      o = o._prev;
  return o ? (t._next = o._next, o._next = t) : (t._next = e[s], e[s] = t), t._next ? t._next._prev = t : e[i] = t, t._prev = o, t.parent = t._dp = e, t;
}, nl = function(e, t, s, i) {
  s === void 0 && (s = "_first"), i === void 0 && (i = "_last");
  var a = t._prev, o = t._next;
  a ? a._next = o : e[s] === t && (e[s] = o), o ? o._prev = a : e[i] === t && (e[i] = a), t._next = t._prev = t.parent = null;
}, Gi = function(e, t) {
  e.parent && (!t || e.parent.autoRemoveChildren) && e.parent.remove && e.parent.remove(e), e._act = 0;
}, ur = function(e, t) {
  if (e && (!t || t._end > e._dur || t._start < 0))
    for (var s = e; s; )
      s._dirty = 1, s = s.parent;
  return e;
}, sf = function(e) {
  for (var t = e.parent; t && t.parent; )
    t._dirty = 1, t.totalDuration(), t = t.parent;
  return e;
}, dc = function(e, t, s, i) {
  return e._startAt && (Lt ? e._startAt.revert(Go) : e.vars.immediateRender && !e.vars.autoRevert || e._startAt.render(t, !0, i));
}, rf = function r(e) {
  return !e || e._ts && r(e.parent);
}, ch = function(e) {
  return e._repeat ? ea(e._tTime, e = e.duration() + e._rDelay) * e : 0;
}, ea = function(e, t) {
  var s = Math.floor(e /= t);
  return e && s === e ? s - 1 : s;
}, yn = function(e, t) {
  return (e - t._start) * t._ts + (t._ts >= 0 ? 0 : t._dirty ? t.totalDuration() : t._tDur);
}, ll = function(e) {
  return e._end = yt(e._start + (e._tDur / Math.abs(e._ts || e._rts || Ge) || 0));
}, cl = function(e, t) {
  var s = e._dp;
  return s && s.smoothChildTiming && e._ts && (e._start = yt(s._time - (e._ts > 0 ? t / e._ts : ((e._dirty ? e.totalDuration() : e._tDur) - t) / -e._ts)), ll(e), s._dirty || ur(s, e)), e;
}, X0 = function(e, t) {
  var s;
  if ((t._time || !t._dur && t._initted || t._start < e._time && (t._dur || !t.add)) && (s = yn(e.rawTime(), t), (!t._dur || ko(0, t.totalDuration(), s) - t._tTime > Ge) && t.render(s, !0)), ur(e, t)._dp && e._initted && e._time >= e._dur && e._ts) {
    if (e._dur < e.duration())
      for (s = e; s._dp; )
        s.rawTime() >= 0 && s.totalTime(s._tTime), s = s._dp;
    e._zTime = -Ge;
  }
}, Zs = function(e, t, s, i) {
  return t.parent && Gi(t), t._start = yt((Di(s) ? s : s || e !== Qe ? ps(e, s, t) : e._time) + t._delay), t._end = yt(t._start + (t.totalDuration() / Math.abs(t.timeScale()) || 0)), U0(e, t, "_first", "_last", e._sort ? "_start" : 0), gc(t) || (e._recent = t), i || X0(e, t), e._ts < 0 && cl(e, e._tTime), e;
}, Z0 = function(e, t) {
  return (us.ScrollTrigger || lu("scrollTrigger", t)) && us.ScrollTrigger.create(t, e);
}, J0 = function(e, t, s, i, a) {
  if (gu(e, t, a), !e._initted)
    return 1;
  if (!s && e._pt && !Lt && (e._dur && e.vars.lazy !== !1 || !e._dur && e.vars.lazy) && G0 !== rs.frame)
    return ji.push(e), e._lazy = [a, i], 1;
}, af = function r(e) {
  var t = e.parent;
  return t && t._ts && t._initted && !t._lock && (t.rawTime() < 0 || r(t));
}, gc = function(e) {
  var t = e.data;
  return t === "isFromStart" || t === "isStart";
}, of = function(e, t, s, i) {
  var a = e.ratio, o = t < 0 || !t && (!e._start && af(e) && !(!e._initted && gc(e)) || (e._ts < 0 || e._dp._ts < 0) && !gc(e)) ? 0 : 1, n = e._rDelay, l = 0, c, u, g;
  if (n && e._repeat && (l = ko(0, e._tDur, t), u = ea(l, n), e._yoyo && u & 1 && (o = 1 - o), u !== ea(e._tTime, n) && (a = 1 - o, e.vars.repeatRefresh && e._initted && e.invalidate())), o !== a || Lt || i || e._zTime === Ge || !t && e._zTime) {
    if (!e._initted && J0(e, t, i, s, l))
      return;
    for (g = e._zTime, e._zTime = t || (s ? Ge : 0), s || (s = t && !g), e.ratio = o, e._from && (o = 1 - o), e._time = 0, e._tTime = l, c = e._pt; c; )
      c.r(o, c.d), c = c._next;
    t < 0 && dc(e, t, s, !0), e._onUpdate && !s && ns(e, "onUpdate"), l && e._repeat && !s && e.parent && ns(e, "onRepeat"), (t >= e._tDur || t < 0) && e.ratio === o && (o && Gi(e, 1), !s && !Lt && (ns(e, o ? "onComplete" : "onReverseComplete", !0), e._prom && e._prom()));
  } else
    e._zTime || (e._zTime = t);
}, nf = function(e, t, s) {
  var i;
  if (s > t)
    for (i = e._first; i && i._start <= s; ) {
      if (i.data === "isPause" && i._start > t)
        return i;
      i = i._next;
    }
  else
    for (i = e._last; i && i._start >= s; ) {
      if (i.data === "isPause" && i._start < t)
        return i;
      i = i._prev;
    }
}, ta = function(e, t, s, i) {
  var a = e._repeat, o = yt(t) || 0, n = e._tTime / e._tDur;
  return n && !i && (e._time *= o / e._dur), e._dur = o, e._tDur = a ? a < 0 ? 1e10 : yt(o * (a + 1) + e._rDelay * a) : o, n > 0 && !i && cl(e, e._tTime = e._tDur * n), e.parent && ll(e), s || ur(e.parent, e), e;
}, uh = function(e) {
  return e instanceof Wt ? ur(e) : ta(e, e._dur);
}, lf = {
  _start: 0,
  endTime: ao,
  totalDuration: ao
}, ps = function r(e, t, s) {
  var i = e.labels, a = e._recent || lf, o = e.duration() >= vs ? a.endTime(!1) : e._dur, n, l, c;
  return wt(t) && (isNaN(t) || t in i) ? (l = t.charAt(0), c = t.substr(-1) === "%", n = t.indexOf("="), l === "<" || l === ">" ? (n >= 0 && (t = t.replace(/=/, "")), (l === "<" ? a._start : a.endTime(a._repeat >= 0)) + (parseFloat(t.substr(1)) || 0) * (c ? (n < 0 ? a : s).totalDuration() / 100 : 1)) : n < 0 ? (t in i || (i[t] = o), i[t]) : (l = parseFloat(t.charAt(n - 1) + t.substr(n + 1)), c && s && (l = l / 100 * (Rt(s) ? s[0] : s).totalDuration()), n > 1 ? r(e, t.substr(0, n - 1), s) + l : o + l)) : t == null ? o : +t;
}, Wa = function(e, t, s) {
  var i = Di(t[1]), a = (i ? 2 : 1) + (e < 2 ? 0 : 1), o = t[a], n, l;
  if (i && (o.duration = t[1]), o.parent = s, e) {
    for (n = o, l = s; l && !("immediateRender" in n); )
      n = l.vars.defaults || {}, l = Xt(l.vars.inherit) && l.parent;
    o.immediateRender = Xt(n.immediateRender), e < 2 ? o.runBackwards = 1 : o.startAt = t[a - 1];
  }
  return new ut(t[0], o, t[a + 1]);
}, qi = function(e, t) {
  return e || e === 0 ? t(e) : t;
}, ko = function(e, t, s) {
  return s < e ? e : s > t ? t : s;
}, Ot = function(e, t) {
  return !wt(e) || !(t = Xg.exec(e)) ? "" : t[1];
}, cf = function(e, t, s) {
  return qi(s, function(i) {
    return ko(e, t, i);
  });
}, fc = [].slice, Q0 = function(e, t) {
  return e && ei(e) && "length" in e && (!t && !e.length || e.length - 1 in e && ei(e[0])) && !e.nodeType && e !== Us;
}, uf = function(e, t, s) {
  return s === void 0 && (s = []), e.forEach(function(i) {
    var a;
    return wt(i) && !t || Q0(i, 1) ? (a = s).push.apply(a, ks(i)) : s.push(i);
  }) || s;
}, ks = function(e, t, s) {
  return Xe && !t && Xe.selector ? Xe.selector(e) : wt(e) && !s && (uc || !sa()) ? fc.call((t || nu).querySelectorAll(e), 0) : Rt(e) ? uf(e, s) : Q0(e) ? fc.call(e, 0) : e ? [e] : [];
}, pc = function(e) {
  return e = ks(e)[0] || ro("Invalid scope") || {}, function(t) {
    var s = e.current || e.nativeElement || e;
    return ks(t, s.querySelectorAll ? s : s === e ? ro("Invalid scope") || nu.createElement("div") : e);
  };
}, ed = function(e) {
  return e.sort(function() {
    return 0.5 - Math.random();
  });
}, td = function(e) {
  if (it(e))
    return e;
  var t = ei(e) ? e : {
    each: e
  }, s = hr(t.ease), i = t.from || 0, a = parseFloat(t.base) || 0, o = {}, n = i > 0 && i < 1, l = isNaN(i) || n, c = t.axis, u = i, g = i;
  return wt(i) ? u = g = {
    center: 0.5,
    edges: 0.5,
    end: 1
  }[i] || 0 : !n && l && (u = i[0], g = i[1]), function(p, h, m) {
    var y = (m || t).length, k = o[y], _, C, T, x, S, O, M, R, L;
    if (!k) {
      if (L = t.grid === "auto" ? 0 : (t.grid || [1, vs])[1], !L) {
        for (M = -vs; M < (M = m[L++].getBoundingClientRect().left) && L < y; )
          ;
        L < y && L--;
      }
      for (k = o[y] = [], _ = l ? Math.min(L, y) * u - 0.5 : i % L, C = L === vs ? 0 : l ? y * g / L - 0.5 : i / L | 0, M = 0, R = vs, O = 0; O < y; O++)
        T = O % L - _, x = C - (O / L | 0), k[O] = S = c ? Math.abs(c === "y" ? x : T) : R0(T * T + x * x), S > M && (M = S), S < R && (R = S);
      i === "random" && ed(k), k.max = M - R, k.min = R, k.v = y = (parseFloat(t.amount) || parseFloat(t.each) * (L > y ? y - 1 : c ? c === "y" ? y / L : L : Math.max(L, y / L)) || 0) * (i === "edges" ? -1 : 1), k.b = y < 0 ? a - y : a, k.u = Ot(t.amount || t.each) || 0, s = s && y < 0 ? hd(s) : s;
    }
    return y = (k[p] - k.min) / k.max || 0, yt(k.b + (s ? s(y) : y) * k.v) + k.u;
  };
}, mc = function(e) {
  var t = Math.pow(10, ((e + "").split(".")[1] || "").length);
  return function(s) {
    var i = yt(Math.round(parseFloat(s) / e) * e * t);
    return (i - i % 1) / t + (Di(s) ? 0 : Ot(s));
  };
}, sd = function(e, t) {
  var s = Rt(e), i, a;
  return !s && ei(e) && (i = s = e.radius || vs, e.values ? (e = ks(e.values), (a = !Di(e[0])) && (i *= i)) : e = mc(e.increment)), qi(t, s ? it(e) ? function(o) {
    return a = e(o), Math.abs(a - o) <= i ? a : o;
  } : function(o) {
    for (var n = parseFloat(a ? o.x : o), l = parseFloat(a ? o.y : 0), c = vs, u = 0, g = e.length, p, h; g--; )
      a ? (p = e[g].x - n, h = e[g].y - l, p = p * p + h * h) : p = Math.abs(e[g] - n), p < c && (c = p, u = g);
    return u = !i || c <= i ? e[u] : o, a || u === o || Di(o) ? u : u + Ot(o);
  } : mc(e));
}, id = function(e, t, s, i) {
  return qi(Rt(e) ? !t : s === !0 ? !!(s = 0) : !i, function() {
    return Rt(e) ? e[~~(Math.random() * e.length)] : (s = s || 1e-5) && (i = s < 1 ? Math.pow(10, (s + "").length - 2) : 1) && Math.floor(Math.round((e - s / 2 + Math.random() * (t - e + s * 0.99)) / s) * s * i) / i;
  });
}, hf = function() {
  for (var e = arguments.length, t = new Array(e), s = 0; s < e; s++)
    t[s] = arguments[s];
  return function(i) {
    return t.reduce(function(a, o) {
      return o(a);
    }, i);
  };
}, df = function(e, t) {
  return function(s) {
    return e(parseFloat(s)) + (t || Ot(s));
  };
}, gf = function(e, t, s) {
  return ad(e, t, 0, 1, s);
}, rd = function(e, t, s) {
  return qi(s, function(i) {
    return e[~~t(i)];
  });
}, ff = function r(e, t, s) {
  var i = t - e;
  return Rt(e) ? rd(e, r(0, e.length), t) : qi(s, function(a) {
    return (i + (a - e) % i) % i + e;
  });
}, pf = function r(e, t, s) {
  var i = t - e, a = i * 2;
  return Rt(e) ? rd(e, r(0, e.length - 1), t) : qi(s, function(o) {
    return o = (a + (o - e) % a) % a || 0, e + (o > i ? a - o : o);
  });
}, oo = function(e) {
  for (var t = 0, s = "", i, a, o, n; ~(i = e.indexOf("random(", t)); )
    o = e.indexOf(")", i), n = e.charAt(i + 7) === "[", a = e.substr(i + 7, o - i - 7).match(n ? H0 : cc), s += e.substr(t, i - t) + id(n ? a : +a[0], n ? 0 : +a[1], +a[2] || 1e-5), t = o + 1;
  return s + e.substr(t, e.length - t);
}, ad = function(e, t, s, i, a) {
  var o = t - e, n = i - s;
  return qi(a, function(l) {
    return s + ((l - e) / o * n || 0);
  });
}, mf = function r(e, t, s, i) {
  var a = isNaN(e + t) ? 0 : function(h) {
    return (1 - h) * e + h * t;
  };
  if (!a) {
    var o = wt(e), n = {}, l, c, u, g, p;
    if (s === !0 && (i = 1) && (s = null), o)
      e = {
        p: e
      }, t = {
        p: t
      };
    else if (Rt(e) && !Rt(t)) {
      for (u = [], g = e.length, p = g - 2, c = 1; c < g; c++)
        u.push(r(e[c - 1], e[c]));
      g--, a = function(m) {
        m *= g;
        var y = Math.min(p, ~~m);
        return u[y](m - y);
      }, s = t;
    } else
      i || (e = mr(Rt(e) ? [] : {}, e));
    if (!u) {
      for (l in t)
        du.call(n, e, l, "get", t[l]);
      a = function(m) {
        return mu(m, n) || (o ? e.p : e);
      };
    }
  }
  return qi(s, a);
}, hh = function(e, t, s) {
  var i = e.labels, a = vs, o, n, l;
  for (o in i)
    n = i[o] - t, n < 0 == !!s && n && a > (n = Math.abs(n)) && (l = o, a = n);
  return l;
}, ns = function(e, t, s) {
  var i = e.vars, a = i[t], o = Xe, n = e._ctx, l, c, u;
  if (a)
    return l = i[t + "Params"], c = i.callbackScope || e, s && ji.length && pn(), n && (Xe = n), u = l ? a.apply(c, l) : a.call(c), Xe = o, u;
}, Da = function(e) {
  return Gi(e), e.scrollTrigger && e.scrollTrigger.kill(!!Lt), e.progress() < 1 && ns(e, "onInterrupt"), e;
}, Mr, od = [], nd = function(e) {
  if (e)
    if (e = !e.name && e.default || e, ou() || e.headless) {
      var t = e.name, s = it(e), i = t && !s && e.init ? function() {
        this._props = [];
      } : e, a = {
        init: ao,
        render: mu,
        add: du,
        kill: Mf,
        modifier: Pf,
        rawVars: 0
      }, o = {
        targetTest: 0,
        get: 0,
        getSetter: pu,
        aliases: {},
        register: 0
      };
      if (sa(), e !== i) {
        if (is[t])
          return;
        Ts(i, Ts(mn(e, a), o)), mr(i.prototype, mr(a, mn(e, o))), is[i.prop = t] = i, e.targetTest && (Vo.push(i), cu[t] = 1), t = (t === "css" ? "CSS" : t.charAt(0).toUpperCase() + t.substr(1)) + "Plugin";
      }
      K0(t, i), e.register && e.register(es, i, Jt);
    } else
      od.push(e);
}, He = 255, Ta = {
  aqua: [0, He, He],
  lime: [0, He, 0],
  silver: [192, 192, 192],
  black: [0, 0, 0],
  maroon: [128, 0, 0],
  teal: [0, 128, 128],
  blue: [0, 0, He],
  navy: [0, 0, 128],
  white: [He, He, He],
  olive: [128, 128, 0],
  yellow: [He, He, 0],
  orange: [He, 165, 0],
  gray: [128, 128, 128],
  purple: [128, 0, 128],
  green: [0, 128, 0],
  red: [He, 0, 0],
  pink: [He, 192, 203],
  cyan: [0, He, He],
  transparent: [He, He, He, 0]
}, Il = function(e, t, s) {
  return e += e < 0 ? 1 : e > 1 ? -1 : 0, (e * 6 < 1 ? t + (s - t) * e * 6 : e < 0.5 ? s : e * 3 < 2 ? t + (s - t) * (2 / 3 - e) * 6 : t) * He + 0.5 | 0;
}, ld = function(e, t, s) {
  var i = e ? Di(e) ? [e >> 16, e >> 8 & He, e & He] : 0 : Ta.black, a, o, n, l, c, u, g, p, h, m;
  if (!i) {
    if (e.substr(-1) === "," && (e = e.substr(0, e.length - 1)), Ta[e])
      i = Ta[e];
    else if (e.charAt(0) === "#") {
      if (e.length < 6 && (a = e.charAt(1), o = e.charAt(2), n = e.charAt(3), e = "#" + a + a + o + o + n + n + (e.length === 5 ? e.charAt(4) + e.charAt(4) : "")), e.length === 9)
        return i = parseInt(e.substr(1, 6), 16), [i >> 16, i >> 8 & He, i & He, parseInt(e.substr(7), 16) / 255];
      e = parseInt(e.substr(1), 16), i = [e >> 16, e >> 8 & He, e & He];
    } else if (e.substr(0, 3) === "hsl") {
      if (i = m = e.match(cc), !t)
        l = +i[0] % 360 / 360, c = +i[1] / 100, u = +i[2] / 100, o = u <= 0.5 ? u * (c + 1) : u + c - u * c, a = u * 2 - o, i.length > 3 && (i[3] *= 1), i[0] = Il(l + 1 / 3, a, o), i[1] = Il(l, a, o), i[2] = Il(l - 1 / 3, a, o);
      else if (~e.indexOf("="))
        return i = e.match(N0), s && i.length < 4 && (i[3] = 1), i;
    } else
      i = e.match(cc) || Ta.transparent;
    i = i.map(Number);
  }
  return t && !m && (a = i[0] / He, o = i[1] / He, n = i[2] / He, g = Math.max(a, o, n), p = Math.min(a, o, n), u = (g + p) / 2, g === p ? l = c = 0 : (h = g - p, c = u > 0.5 ? h / (2 - g - p) : h / (g + p), l = g === a ? (o - n) / h + (o < n ? 6 : 0) : g === o ? (n - a) / h + 2 : (a - o) / h + 4, l *= 60), i[0] = ~~(l + 0.5), i[1] = ~~(c * 100 + 0.5), i[2] = ~~(u * 100 + 0.5)), s && i.length < 4 && (i[3] = 1), i;
}, cd = function(e) {
  var t = [], s = [], i = -1;
  return e.split(Ki).forEach(function(a) {
    var o = a.match(Pr) || [];
    t.push.apply(t, o), s.push(i += o.length + 1);
  }), t.c = s, t;
}, dh = function(e, t, s) {
  var i = "", a = (e + i).match(Ki), o = t ? "hsla(" : "rgba(", n = 0, l, c, u, g;
  if (!a)
    return e;
  if (a = a.map(function(p) {
    return (p = ld(p, t, 1)) && o + (t ? p[0] + "," + p[1] + "%," + p[2] + "%," + p[3] : p.join(",")) + ")";
  }), s && (u = cd(e), l = s.c, l.join(i) !== u.c.join(i)))
    for (c = e.replace(Ki, "1").split(Pr), g = c.length - 1; n < g; n++)
      i += c[n] + (~l.indexOf(n) ? a.shift() || o + "0,0,0,0)" : (u.length ? u : a.length ? a : s).shift());
  if (!c)
    for (c = e.split(Ki), g = c.length - 1; n < g; n++)
      i += c[n] + a[n];
  return i + c[g];
}, Ki = function() {
  var r = "(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b", e;
  for (e in Ta)
    r += "|" + e + "\\b";
  return new RegExp(r + ")", "gi");
}(), yf = /hsl[a]?\(/, ud = function(e) {
  var t = e.join(" "), s;
  if (Ki.lastIndex = 0, Ki.test(t))
    return s = yf.test(t), e[1] = dh(e[1], s), e[0] = dh(e[0], s, cd(e[1])), !0;
}, no, rs = function() {
  var r = Date.now, e = 500, t = 33, s = r(), i = s, a = 1e3 / 240, o = a, n = [], l, c, u, g, p, h, m = function y(k) {
    var _ = r() - i, C = k === !0, T, x, S, O;
    if ((_ > e || _ < 0) && (s += _ - t), i += _, S = i - s, T = S - o, (T > 0 || C) && (O = ++g.frame, p = S - g.time * 1e3, g.time = S = S / 1e3, o += T + (T >= a ? 4 : a - T), x = 1), C || (l = c(y)), x)
      for (h = 0; h < n.length; h++)
        n[h](S, p, O, k);
  };
  return g = {
    time: 0,
    frame: 0,
    tick: function() {
      m(!0);
    },
    deltaRatio: function(k) {
      return p / (1e3 / (k || 60));
    },
    wake: function() {
      W0 && (!uc && ou() && (Us = uc = window, nu = Us.document || {}, us.gsap = es, (Us.gsapVersions || (Us.gsapVersions = [])).push(es.version), j0(fn || Us.GreenSockGlobals || !Us.gsap && Us || {}), od.forEach(nd)), u = typeof requestAnimationFrame < "u" && requestAnimationFrame, l && g.sleep(), c = u || function(k) {
        return setTimeout(k, o - g.time * 1e3 + 1 | 0);
      }, no = 1, m(2));
    },
    sleep: function() {
      (u ? cancelAnimationFrame : clearTimeout)(l), no = 0, c = ao;
    },
    lagSmoothing: function(k, _) {
      e = k || 1 / 0, t = Math.min(_ || 33, e);
    },
    fps: function(k) {
      a = 1e3 / (k || 240), o = g.time * 1e3 + a;
    },
    add: function(k, _, C) {
      var T = _ ? function(x, S, O, M) {
        k(x, S, O, M), g.remove(T);
      } : k;
      return g.remove(k), n[C ? "unshift" : "push"](T), sa(), T;
    },
    remove: function(k, _) {
      ~(_ = n.indexOf(k)) && n.splice(_, 1) && h >= _ && h--;
    },
    _listeners: n
  }, g;
}(), sa = function() {
  return !no && rs.wake();
}, Ee = {}, bf = /^[\d.\-M][\d.\-,\s]/, wf = /["']/g, vf = function(e) {
  for (var t = {}, s = e.substr(1, e.length - 3).split(":"), i = s[0], a = 1, o = s.length, n, l, c; a < o; a++)
    l = s[a], n = a !== o - 1 ? l.lastIndexOf(",") : l.length, c = l.substr(0, n), t[i] = isNaN(c) ? c.replace(wf, "").trim() : +c, i = l.substr(n + 1).trim();
  return t;
}, kf = function(e) {
  var t = e.indexOf("(") + 1, s = e.indexOf(")"), i = e.indexOf("(", t);
  return e.substring(t, ~i && i < s ? e.indexOf(")", s + 1) : s);
}, _f = function(e) {
  var t = (e + "").split("("), s = Ee[t[0]];
  return s && t.length > 1 && s.config ? s.config.apply(null, ~e.indexOf("{") ? [vf(t[1])] : kf(e).split(",").map(q0)) : Ee._CE && bf.test(e) ? Ee._CE("", e) : s;
}, hd = function(e) {
  return function(t) {
    return 1 - e(1 - t);
  };
}, dd = function r(e, t) {
  for (var s = e._first, i; s; )
    s instanceof Wt ? r(s, t) : s.vars.yoyoEase && (!s._yoyo || !s._repeat) && s._yoyo !== t && (s.timeline ? r(s.timeline, t) : (i = s._ease, s._ease = s._yEase, s._yEase = i, s._yoyo = t)), s = s._next;
}, hr = function(e, t) {
  return e && (it(e) ? e : Ee[e] || _f(e)) || t;
}, kr = function(e, t, s, i) {
  s === void 0 && (s = function(l) {
    return 1 - t(1 - l);
  }), i === void 0 && (i = function(l) {
    return l < 0.5 ? t(l * 2) / 2 : 1 - t((1 - l) * 2) / 2;
  });
  var a = {
    easeIn: t,
    easeOut: s,
    easeInOut: i
  }, o;
  return Zt(e, function(n) {
    Ee[n] = us[n] = a, Ee[o = n.toLowerCase()] = s;
    for (var l in a)
      Ee[o + (l === "easeIn" ? ".in" : l === "easeOut" ? ".out" : ".inOut")] = Ee[n + "." + l] = a[l];
  }), a;
}, gd = function(e) {
  return function(t) {
    return t < 0.5 ? (1 - e(1 - t * 2)) / 2 : 0.5 + e((t - 0.5) * 2) / 2;
  };
}, Pl = function r(e, t, s) {
  var i = t >= 1 ? t : 1, a = (s || (e ? 0.3 : 0.45)) / (t < 1 ? t : 1), o = a / lc * (Math.asin(1 / i) || 0), n = function(u) {
    return u === 1 ? 1 : i * Math.pow(2, -10 * u) * Ug((u - o) * a) + 1;
  }, l = e === "out" ? n : e === "in" ? function(c) {
    return 1 - n(1 - c);
  } : gd(n);
  return a = lc / a, l.config = function(c, u) {
    return r(e, c, u);
  }, l;
}, Ml = function r(e, t) {
  t === void 0 && (t = 1.70158);
  var s = function(o) {
    return o ? --o * o * ((t + 1) * o + t) + 1 : 0;
  }, i = e === "out" ? s : e === "in" ? function(a) {
    return 1 - s(1 - a);
  } : gd(s);
  return i.config = function(a) {
    return r(e, a);
  }, i;
};
Zt("Linear,Quad,Cubic,Quart,Quint,Strong", function(r, e) {
  var t = e < 5 ? e + 1 : e;
  kr(r + ",Power" + (t - 1), e ? function(s) {
    return Math.pow(s, t);
  } : function(s) {
    return s;
  }, function(s) {
    return 1 - Math.pow(1 - s, t);
  }, function(s) {
    return s < 0.5 ? Math.pow(s * 2, t) / 2 : 1 - Math.pow((1 - s) * 2, t) / 2;
  });
});
Ee.Linear.easeNone = Ee.none = Ee.Linear.easeIn;
kr("Elastic", Pl("in"), Pl("out"), Pl());
(function(r, e) {
  var t = 1 / e, s = 2 * t, i = 2.5 * t, a = function(n) {
    return n < t ? r * n * n : n < s ? r * Math.pow(n - 1.5 / e, 2) + 0.75 : n < i ? r * (n -= 2.25 / e) * n + 0.9375 : r * Math.pow(n - 2.625 / e, 2) + 0.984375;
  };
  kr("Bounce", function(o) {
    return 1 - a(1 - o);
  }, a);
})(7.5625, 2.75);
kr("Expo", function(r) {
  return r ? Math.pow(2, 10 * (r - 1)) : 0;
});
kr("Circ", function(r) {
  return -(R0(1 - r * r) - 1);
});
kr("Sine", function(r) {
  return r === 1 ? 1 : -Yg(r * zg) + 1;
});
kr("Back", Ml("in"), Ml("out"), Ml());
Ee.SteppedEase = Ee.steps = us.SteppedEase = {
  config: function(e, t) {
    e === void 0 && (e = 1);
    var s = 1 / e, i = e + (t ? 0 : 1), a = t ? 1 : 0, o = 1 - Ge;
    return function(n) {
      return ((i * ko(0, o, n) | 0) + a) * s;
    };
  }
};
Qr.ease = Ee["quad.out"];
Zt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt", function(r) {
  return uu += r + "," + r + "Params,";
});
var fd = function(e, t) {
  this.id = qg++, e._gsap = this, this.target = e, this.harness = t, this.get = t ? t.get : V0, this.set = t ? t.getSetter : pu;
}, lo = /* @__PURE__ */ function() {
  function r(t) {
    this.vars = t, this._delay = +t.delay || 0, (this._repeat = t.repeat === 1 / 0 ? -2 : t.repeat || 0) && (this._rDelay = t.repeatDelay || 0, this._yoyo = !!t.yoyo || !!t.yoyoEase), this._ts = 1, ta(this, +t.duration, 1, 1), this.data = t.data, Xe && (this._ctx = Xe, Xe.data.push(this)), no || rs.wake();
  }
  var e = r.prototype;
  return e.delay = function(s) {
    return s || s === 0 ? (this.parent && this.parent.smoothChildTiming && this.startTime(this._start + s - this._delay), this._delay = s, this) : this._delay;
  }, e.duration = function(s) {
    return arguments.length ? this.totalDuration(this._repeat > 0 ? s + (s + this._rDelay) * this._repeat : s) : this.totalDuration() && this._dur;
  }, e.totalDuration = function(s) {
    return arguments.length ? (this._dirty = 0, ta(this, this._repeat < 0 ? s : (s - this._repeat * this._rDelay) / (this._repeat + 1))) : this._tDur;
  }, e.totalTime = function(s, i) {
    if (sa(), !arguments.length)
      return this._tTime;
    var a = this._dp;
    if (a && a.smoothChildTiming && this._ts) {
      for (cl(this, s), !a._dp || a.parent || X0(a, this); a && a.parent; )
        a.parent._time !== a._start + (a._ts >= 0 ? a._tTime / a._ts : (a.totalDuration() - a._tTime) / -a._ts) && a.totalTime(a._tTime, !0), a = a.parent;
      !this.parent && this._dp.autoRemoveChildren && (this._ts > 0 && s < this._tDur || this._ts < 0 && s > 0 || !this._tDur && !s) && Zs(this._dp, this, this._start - this._delay);
    }
    return (this._tTime !== s || !this._dur && !i || this._initted && Math.abs(this._zTime) === Ge || !s && !this._initted && (this.add || this._ptLookup)) && (this._ts || (this._pTime = s), z0(this, s, i)), this;
  }, e.time = function(s, i) {
    return arguments.length ? this.totalTime(Math.min(this.totalDuration(), s + ch(this)) % (this._dur + this._rDelay) || (s ? this._dur : 0), i) : this._time;
  }, e.totalProgress = function(s, i) {
    return arguments.length ? this.totalTime(this.totalDuration() * s, i) : this.totalDuration() ? Math.min(1, this._tTime / this._tDur) : this.rawTime() > 0 ? 1 : 0;
  }, e.progress = function(s, i) {
    return arguments.length ? this.totalTime(this.duration() * (this._yoyo && !(this.iteration() & 1) ? 1 - s : s) + ch(this), i) : this.duration() ? Math.min(1, this._time / this._dur) : this.rawTime() > 0 ? 1 : 0;
  }, e.iteration = function(s, i) {
    var a = this.duration() + this._rDelay;
    return arguments.length ? this.totalTime(this._time + (s - 1) * a, i) : this._repeat ? ea(this._tTime, a) + 1 : 1;
  }, e.timeScale = function(s, i) {
    if (!arguments.length)
      return this._rts === -Ge ? 0 : this._rts;
    if (this._rts === s)
      return this;
    var a = this.parent && this._ts ? yn(this.parent._time, this) : this._tTime;
    return this._rts = +s || 0, this._ts = this._ps || s === -Ge ? 0 : this._rts, this.totalTime(ko(-Math.abs(this._delay), this._tDur, a), i !== !1), ll(this), sf(this);
  }, e.paused = function(s) {
    return arguments.length ? (this._ps !== s && (this._ps = s, s ? (this._pTime = this._tTime || Math.max(-this._delay, this.rawTime()), this._ts = this._act = 0) : (sa(), this._ts = this._rts, this.totalTime(this.parent && !this.parent.smoothChildTiming ? this.rawTime() : this._tTime || this._pTime, this.progress() === 1 && Math.abs(this._zTime) !== Ge && (this._tTime -= Ge)))), this) : this._ps;
  }, e.startTime = function(s) {
    if (arguments.length) {
      this._start = s;
      var i = this.parent || this._dp;
      return i && (i._sort || !this.parent) && Zs(i, this, s - this._delay), this;
    }
    return this._start;
  }, e.endTime = function(s) {
    return this._start + (Xt(s) ? this.totalDuration() : this.duration()) / Math.abs(this._ts || 1);
  }, e.rawTime = function(s) {
    var i = this.parent || this._dp;
    return i ? s && (!this._ts || this._repeat && this._time && this.totalProgress() < 1) ? this._tTime % (this._dur + this._rDelay) : this._ts ? yn(i.rawTime(s), this) : this._tTime : this._tTime;
  }, e.revert = function(s) {
    s === void 0 && (s = Jg);
    var i = Lt;
    return Lt = s, (this._initted || this._startAt) && (this.timeline && this.timeline.revert(s), this.totalTime(-0.01, s.suppressEvents)), this.data !== "nested" && s.kill !== !1 && this.kill(), Lt = i, this;
  }, e.globalTime = function(s) {
    for (var i = this, a = arguments.length ? s : i.rawTime(); i; )
      a = i._start + a / (Math.abs(i._ts) || 1), i = i._dp;
    return !this.parent && this._sat ? this._sat.globalTime(s) : a;
  }, e.repeat = function(s) {
    return arguments.length ? (this._repeat = s === 1 / 0 ? -2 : s, uh(this)) : this._repeat === -2 ? 1 / 0 : this._repeat;
  }, e.repeatDelay = function(s) {
    if (arguments.length) {
      var i = this._time;
      return this._rDelay = s, uh(this), i ? this.time(i) : this;
    }
    return this._rDelay;
  }, e.yoyo = function(s) {
    return arguments.length ? (this._yoyo = s, this) : this._yoyo;
  }, e.seek = function(s, i) {
    return this.totalTime(ps(this, s), Xt(i));
  }, e.restart = function(s, i) {
    return this.play().totalTime(s ? -this._delay : 0, Xt(i));
  }, e.play = function(s, i) {
    return s != null && this.seek(s, i), this.reversed(!1).paused(!1);
  }, e.reverse = function(s, i) {
    return s != null && this.seek(s || this.totalDuration(), i), this.reversed(!0).paused(!1);
  }, e.pause = function(s, i) {
    return s != null && this.seek(s, i), this.paused(!0);
  }, e.resume = function() {
    return this.paused(!1);
  }, e.reversed = function(s) {
    return arguments.length ? (!!s !== this.reversed() && this.timeScale(-this._rts || (s ? -Ge : 0)), this) : this._rts < 0;
  }, e.invalidate = function() {
    return this._initted = this._act = 0, this._zTime = -Ge, this;
  }, e.isActive = function() {
    var s = this.parent || this._dp, i = this._start, a;
    return !!(!s || this._ts && this._initted && s.isActive() && (a = s.rawTime(!0)) >= i && a < this.endTime(!0) - Ge);
  }, e.eventCallback = function(s, i, a) {
    var o = this.vars;
    return arguments.length > 1 ? (i ? (o[s] = i, a && (o[s + "Params"] = a), s === "onUpdate" && (this._onUpdate = i)) : delete o[s], this) : o[s];
  }, e.then = function(s) {
    var i = this;
    return new Promise(function(a) {
      var o = it(s) ? s : Y0, n = function() {
        var c = i.then;
        i.then = null, it(o) && (o = o(i)) && (o.then || o === i) && (i.then = c), a(o), i.then = c;
      };
      i._initted && i.totalProgress() === 1 && i._ts >= 0 || !i._tTime && i._ts < 0 ? n() : i._prom = n;
    });
  }, e.kill = function() {
    Da(this);
  }, r;
}();
Ts(lo.prototype, {
  _time: 0,
  _start: 0,
  _end: 0,
  _tTime: 0,
  _tDur: 0,
  _dirty: 0,
  _repeat: 0,
  _yoyo: !1,
  parent: null,
  _initted: !1,
  _rDelay: 0,
  _ts: 1,
  _dp: 0,
  ratio: 0,
  _zTime: -Ge,
  _prom: 0,
  _ps: !1,
  _rts: 1
});
var Wt = /* @__PURE__ */ function(r) {
  L0(e, r);
  function e(s, i) {
    var a;
    return s === void 0 && (s = {}), a = r.call(this, s) || this, a.labels = {}, a.smoothChildTiming = !!s.smoothChildTiming, a.autoRemoveChildren = !!s.autoRemoveChildren, a._sort = Xt(s.sortChildren), Qe && Zs(s.parent || Qe, di(a), i), s.reversed && a.reverse(), s.paused && a.paused(!0), s.scrollTrigger && Z0(di(a), s.scrollTrigger), a;
  }
  var t = e.prototype;
  return t.to = function(i, a, o) {
    return Wa(0, arguments, this), this;
  }, t.from = function(i, a, o) {
    return Wa(1, arguments, this), this;
  }, t.fromTo = function(i, a, o, n) {
    return Wa(2, arguments, this), this;
  }, t.set = function(i, a, o) {
    return a.duration = 0, a.parent = this, Ha(a).repeatDelay || (a.repeat = 0), a.immediateRender = !!a.immediateRender, new ut(i, a, ps(this, o), 1), this;
  }, t.call = function(i, a, o) {
    return Zs(this, ut.delayedCall(0, i, a), o);
  }, t.staggerTo = function(i, a, o, n, l, c, u) {
    return o.duration = a, o.stagger = o.stagger || n, o.onComplete = c, o.onCompleteParams = u, o.parent = this, new ut(i, o, ps(this, l)), this;
  }, t.staggerFrom = function(i, a, o, n, l, c, u) {
    return o.runBackwards = 1, Ha(o).immediateRender = Xt(o.immediateRender), this.staggerTo(i, a, o, n, l, c, u);
  }, t.staggerFromTo = function(i, a, o, n, l, c, u, g) {
    return n.startAt = o, Ha(n).immediateRender = Xt(n.immediateRender), this.staggerTo(i, a, n, l, c, u, g);
  }, t.render = function(i, a, o) {
    var n = this._time, l = this._dirty ? this.totalDuration() : this._tDur, c = this._dur, u = i <= 0 ? 0 : yt(i), g = this._zTime < 0 != i < 0 && (this._initted || !c), p, h, m, y, k, _, C, T, x, S, O, M;
    if (this !== Qe && u > l && i >= 0 && (u = l), u !== this._tTime || o || g) {
      if (n !== this._time && c && (u += this._time - n, i += this._time - n), p = u, x = this._start, T = this._ts, _ = !T, g && (c || (n = this._zTime), (i || !a) && (this._zTime = i)), this._repeat) {
        if (O = this._yoyo, k = c + this._rDelay, this._repeat < -1 && i < 0)
          return this.totalTime(k * 100 + i, a, o);
        if (p = yt(u % k), u === l ? (y = this._repeat, p = c) : (y = ~~(u / k), y && y === u / k && (p = c, y--), p > c && (p = c)), S = ea(this._tTime, k), !n && this._tTime && S !== y && this._tTime - S * k - this._dur <= 0 && (S = y), O && y & 1 && (p = c - p, M = 1), y !== S && !this._lock) {
          var R = O && S & 1, L = R === (O && y & 1);
          if (y < S && (R = !R), n = R ? 0 : u % c ? c : u, this._lock = 1, this.render(n || (M ? 0 : yt(y * k)), a, !c)._lock = 0, this._tTime = u, !a && this.parent && ns(this, "onRepeat"), this.vars.repeatRefresh && !M && (this.invalidate()._lock = 1), n && n !== this._time || _ !== !this._ts || this.vars.onRepeat && !this.parent && !this._act)
            return this;
          if (c = this._dur, l = this._tDur, L && (this._lock = 2, n = R ? c : -1e-4, this.render(n, !0), this.vars.repeatRefresh && !M && this.invalidate()), this._lock = 0, !this._ts && !_)
            return this;
          dd(this, M);
        }
      }
      if (this._hasPause && !this._forcing && this._lock < 2 && (C = nf(this, yt(n), yt(p)), C && (u -= p - (p = C._start))), this._tTime = u, this._time = p, this._act = !T, this._initted || (this._onUpdate = this.vars.onUpdate, this._initted = 1, this._zTime = i, n = 0), !n && p && !a && !y && (ns(this, "onStart"), this._tTime !== u))
        return this;
      if (p >= n && i >= 0)
        for (h = this._first; h; ) {
          if (m = h._next, (h._act || p >= h._start) && h._ts && C !== h) {
            if (h.parent !== this)
              return this.render(i, a, o);
            if (h.render(h._ts > 0 ? (p - h._start) * h._ts : (h._dirty ? h.totalDuration() : h._tDur) + (p - h._start) * h._ts, a, o), p !== this._time || !this._ts && !_) {
              C = 0, m && (u += this._zTime = -Ge);
              break;
            }
          }
          h = m;
        }
      else {
        h = this._last;
        for (var q = i < 0 ? i : p; h; ) {
          if (m = h._prev, (h._act || q <= h._end) && h._ts && C !== h) {
            if (h.parent !== this)
              return this.render(i, a, o);
            if (h.render(h._ts > 0 ? (q - h._start) * h._ts : (h._dirty ? h.totalDuration() : h._tDur) + (q - h._start) * h._ts, a, o || Lt && (h._initted || h._startAt)), p !== this._time || !this._ts && !_) {
              C = 0, m && (u += this._zTime = q ? -Ge : Ge);
              break;
            }
          }
          h = m;
        }
      }
      if (C && !a && (this.pause(), C.render(p >= n ? 0 : -Ge)._zTime = p >= n ? 1 : -1, this._ts))
        return this._start = x, ll(this), this.render(i, a, o);
      this._onUpdate && !a && ns(this, "onUpdate", !0), (u === l && this._tTime >= this.totalDuration() || !u && n) && (x === this._start || Math.abs(T) !== Math.abs(this._ts)) && (this._lock || ((i || !c) && (u === l && this._ts > 0 || !u && this._ts < 0) && Gi(this, 1), !a && !(i < 0 && !n) && (u || n || !l) && (ns(this, u === l && i >= 0 ? "onComplete" : "onReverseComplete", !0), this._prom && !(u < l && this.timeScale() > 0) && this._prom())));
    }
    return this;
  }, t.add = function(i, a) {
    var o = this;
    if (Di(a) || (a = ps(this, a, i)), !(i instanceof lo)) {
      if (Rt(i))
        return i.forEach(function(n) {
          return o.add(n, a);
        }), this;
      if (wt(i))
        return this.addLabel(i, a);
      if (it(i))
        i = ut.delayedCall(0, i);
      else
        return this;
    }
    return this !== i ? Zs(this, i, a) : this;
  }, t.getChildren = function(i, a, o, n) {
    i === void 0 && (i = !0), a === void 0 && (a = !0), o === void 0 && (o = !0), n === void 0 && (n = -vs);
    for (var l = [], c = this._first; c; )
      c._start >= n && (c instanceof ut ? a && l.push(c) : (o && l.push(c), i && l.push.apply(l, c.getChildren(!0, a, o)))), c = c._next;
    return l;
  }, t.getById = function(i) {
    for (var a = this.getChildren(1, 1, 1), o = a.length; o--; )
      if (a[o].vars.id === i)
        return a[o];
  }, t.remove = function(i) {
    return wt(i) ? this.removeLabel(i) : it(i) ? this.killTweensOf(i) : (nl(this, i), i === this._recent && (this._recent = this._last), ur(this));
  }, t.totalTime = function(i, a) {
    return arguments.length ? (this._forcing = 1, !this._dp && this._ts && (this._start = yt(rs.time - (this._ts > 0 ? i / this._ts : (this.totalDuration() - i) / -this._ts))), r.prototype.totalTime.call(this, i, a), this._forcing = 0, this) : this._tTime;
  }, t.addLabel = function(i, a) {
    return this.labels[i] = ps(this, a), this;
  }, t.removeLabel = function(i) {
    return delete this.labels[i], this;
  }, t.addPause = function(i, a, o) {
    var n = ut.delayedCall(0, a || ao, o);
    return n.data = "isPause", this._hasPause = 1, Zs(this, n, ps(this, i));
  }, t.removePause = function(i) {
    var a = this._first;
    for (i = ps(this, i); a; )
      a._start === i && a.data === "isPause" && Gi(a), a = a._next;
  }, t.killTweensOf = function(i, a, o) {
    for (var n = this.getTweensOf(i, o), l = n.length; l--; )
      Ri !== n[l] && n[l].kill(i, a);
    return this;
  }, t.getTweensOf = function(i, a) {
    for (var o = [], n = ks(i), l = this._first, c = Di(a), u; l; )
      l instanceof ut ? Qg(l._targets, n) && (c ? (!Ri || l._initted && l._ts) && l.globalTime(0) <= a && l.globalTime(l.totalDuration()) > a : !a || l.isActive()) && o.push(l) : (u = l.getTweensOf(n, a)).length && o.push.apply(o, u), l = l._next;
    return o;
  }, t.tweenTo = function(i, a) {
    a = a || {};
    var o = this, n = ps(o, i), l = a, c = l.startAt, u = l.onStart, g = l.onStartParams, p = l.immediateRender, h, m = ut.to(o, Ts({
      ease: a.ease || "none",
      lazy: !1,
      immediateRender: !1,
      time: n,
      overwrite: "auto",
      duration: a.duration || Math.abs((n - (c && "time" in c ? c.time : o._time)) / o.timeScale()) || Ge,
      onStart: function() {
        if (o.pause(), !h) {
          var k = a.duration || Math.abs((n - (c && "time" in c ? c.time : o._time)) / o.timeScale());
          m._dur !== k && ta(m, k, 0, 1).render(m._time, !0, !0), h = 1;
        }
        u && u.apply(m, g || []);
      }
    }, a));
    return p ? m.render(0) : m;
  }, t.tweenFromTo = function(i, a, o) {
    return this.tweenTo(a, Ts({
      startAt: {
        time: ps(this, i)
      }
    }, o));
  }, t.recent = function() {
    return this._recent;
  }, t.nextLabel = function(i) {
    return i === void 0 && (i = this._time), hh(this, ps(this, i));
  }, t.previousLabel = function(i) {
    return i === void 0 && (i = this._time), hh(this, ps(this, i), 1);
  }, t.currentLabel = function(i) {
    return arguments.length ? this.seek(i, !0) : this.previousLabel(this._time + Ge);
  }, t.shiftChildren = function(i, a, o) {
    o === void 0 && (o = 0);
    for (var n = this._first, l = this.labels, c; n; )
      n._start >= o && (n._start += i, n._end += i), n = n._next;
    if (a)
      for (c in l)
        l[c] >= o && (l[c] += i);
    return ur(this);
  }, t.invalidate = function(i) {
    var a = this._first;
    for (this._lock = 0; a; )
      a.invalidate(i), a = a._next;
    return r.prototype.invalidate.call(this, i);
  }, t.clear = function(i) {
    i === void 0 && (i = !0);
    for (var a = this._first, o; a; )
      o = a._next, this.remove(a), a = o;
    return this._dp && (this._time = this._tTime = this._pTime = 0), i && (this.labels = {}), ur(this);
  }, t.totalDuration = function(i) {
    var a = 0, o = this, n = o._last, l = vs, c, u, g;
    if (arguments.length)
      return o.timeScale((o._repeat < 0 ? o.duration() : o.totalDuration()) / (o.reversed() ? -i : i));
    if (o._dirty) {
      for (g = o.parent; n; )
        c = n._prev, n._dirty && n.totalDuration(), u = n._start, u > l && o._sort && n._ts && !o._lock ? (o._lock = 1, Zs(o, n, u - n._delay, 1)._lock = 0) : l = u, u < 0 && n._ts && (a -= u, (!g && !o._dp || g && g.smoothChildTiming) && (o._start += u / o._ts, o._time -= u, o._tTime -= u), o.shiftChildren(-u, !1, -1 / 0), l = 0), n._end > a && n._ts && (a = n._end), n = c;
      ta(o, o === Qe && o._time > a ? o._time : a, 1, 1), o._dirty = 0;
    }
    return o._tDur;
  }, e.updateRoot = function(i) {
    if (Qe._ts && (z0(Qe, yn(i, Qe)), G0 = rs.frame), rs.frame >= nh) {
      nh += ls.autoSleep || 120;
      var a = Qe._first;
      if ((!a || !a._ts) && ls.autoSleep && rs._listeners.length < 2) {
        for (; a && !a._ts; )
          a = a._next;
        a || rs.sleep();
      }
    }
  }, e;
}(lo);
Ts(Wt.prototype, {
  _lock: 0,
  _hasPause: 0,
  _forcing: 0
});
var Df = function(e, t, s, i, a, o, n) {
  var l = new Jt(this._pt, e, t, 0, 1, vd, null, a), c = 0, u = 0, g, p, h, m, y, k, _, C;
  for (l.b = s, l.e = i, s += "", i += "", (_ = ~i.indexOf("random(")) && (i = oo(i)), o && (C = [s, i], o(C, e, t), s = C[0], i = C[1]), p = s.match(Al) || []; g = Al.exec(i); )
    m = g[0], y = i.substring(c, g.index), h ? h = (h + 1) % 5 : y.substr(-5) === "rgba(" && (h = 1), m !== p[u++] && (k = parseFloat(p[u - 1]) || 0, l._pt = {
      _next: l._pt,
      p: y || u === 1 ? y : ",",
      //note: SVG spec allows omission of comma/space when a negative sign is wedged between two numbers, like 2.5-5.3 instead of 2.5,-5.3 but when tweening, the negative value may switch to positive, so we insert the comma just in case.
      s: k,
      c: m.charAt(1) === "=" ? Hr(k, m) - k : parseFloat(m) - k,
      m: h && h < 4 ? Math.round : 0
    }, c = Al.lastIndex);
  return l.c = c < i.length ? i.substring(c, i.length) : "", l.fp = n, (B0.test(i) || _) && (l.e = 0), this._pt = l, l;
}, du = function(e, t, s, i, a, o, n, l, c, u) {
  it(i) && (i = i(a || 0, e, o));
  var g = e[t], p = s !== "get" ? s : it(g) ? c ? e[t.indexOf("set") || !it(e["get" + t.substr(3)]) ? t : "get" + t.substr(3)](c) : e[t]() : g, h = it(g) ? c ? Af : bd : fu, m;
  if (wt(i) && (~i.indexOf("random(") && (i = oo(i)), i.charAt(1) === "=" && (m = Hr(p, i) + (Ot(p) || 0), (m || m === 0) && (i = m))), !u || p !== i || yc)
    return !isNaN(p * i) && i !== "" ? (m = new Jt(this._pt, e, t, +p || 0, i - (p || 0), typeof g == "boolean" ? If : wd, 0, h), c && (m.fp = c), n && m.modifier(n, this, e), this._pt = m) : (!g && !(t in e) && lu(t, i), Df.call(this, e, t, p, i, h, l || ls.stringFilter, c));
}, Tf = function(e, t, s, i, a) {
  if (it(e) && (e = ja(e, a, t, s, i)), !ei(e) || e.style && e.nodeType || Rt(e) || $0(e))
    return wt(e) ? ja(e, a, t, s, i) : e;
  var o = {}, n;
  for (n in e)
    o[n] = ja(e[n], a, t, s, i);
  return o;
}, pd = function(e, t, s, i, a, o) {
  var n, l, c, u;
  if (is[e] && (n = new is[e]()).init(a, n.rawVars ? t[e] : Tf(t[e], i, a, o, s), s, i, o) !== !1 && (s._pt = l = new Jt(s._pt, a, e, 0, 1, n.render, n, 0, n.priority), s !== Mr))
    for (c = s._ptLookup[s._targets.indexOf(a)], u = n._props.length; u--; )
      c[n._props[u]] = l;
  return n;
}, Ri, yc, gu = function r(e, t, s) {
  var i = e.vars, a = i.ease, o = i.startAt, n = i.immediateRender, l = i.lazy, c = i.onUpdate, u = i.runBackwards, g = i.yoyoEase, p = i.keyframes, h = i.autoRevert, m = e._dur, y = e._startAt, k = e._targets, _ = e.parent, C = _ && _.data === "nested" ? _.vars.targets : k, T = e._overwrite === "auto" && !ru, x = e.timeline, S, O, M, R, L, q, G, re, U, de, ee, le, d;
  if (x && (!p || !a) && (a = "none"), e._ease = hr(a, Qr.ease), e._yEase = g ? hd(hr(g === !0 ? a : g, Qr.ease)) : 0, g && e._yoyo && !e._repeat && (g = e._yEase, e._yEase = e._ease, e._ease = g), e._from = !x && !!i.runBackwards, !x || p && !i.stagger) {
    if (re = k[0] ? cr(k[0]).harness : 0, le = re && i[re.prop], S = mn(i, cu), y && (y._zTime < 0 && y.progress(1), t < 0 && u && n && !h ? y.render(-1, !0) : y.revert(u && m ? Go : Zg), y._lazy = 0), o) {
      if (Gi(e._startAt = ut.set(k, Ts({
        data: "isStart",
        overwrite: !1,
        parent: _,
        immediateRender: !0,
        lazy: !y && Xt(l),
        startAt: null,
        delay: 0,
        onUpdate: c && function() {
          return ns(e, "onUpdate");
        },
        stagger: 0
      }, o))), e._startAt._dp = 0, e._startAt._sat = e, t < 0 && (Lt || !n && !h) && e._startAt.revert(Go), n && m && t <= 0 && s <= 0) {
        t && (e._zTime = t);
        return;
      }
    } else if (u && m && !y) {
      if (t && (n = !1), M = Ts({
        overwrite: !1,
        data: "isFromStart",
        //we tag the tween with as "isFromStart" so that if [inside a plugin] we need to only do something at the very END of a tween, we have a way of identifying this tween as merely the one that's setting the beginning values for a "from()" tween. For example, clearProps in CSSPlugin should only get applied at the very END of a tween and without this tag, from(...{height:100, clearProps:"height", delay:1}) would wipe the height at the beginning of the tween and after 1 second, it'd kick back in.
        lazy: n && !y && Xt(l),
        immediateRender: n,
        //zero-duration tweens render immediately by default, but if we're not specifically instructed to render this tween immediately, we should skip this and merely _init() to record the starting values (rendering them immediately would push them to completion which is wasteful in that case - we'd have to render(-1) immediately after)
        stagger: 0,
        parent: _
        //ensures that nested tweens that had a stagger are handled properly, like gsap.from(".class", {y: gsap.utils.wrap([-100,100]), stagger: 0.5})
      }, S), le && (M[re.prop] = le), Gi(e._startAt = ut.set(k, M)), e._startAt._dp = 0, e._startAt._sat = e, t < 0 && (Lt ? e._startAt.revert(Go) : e._startAt.render(-1, !0)), e._zTime = t, !n)
        r(e._startAt, Ge, Ge);
      else if (!t)
        return;
    }
    for (e._pt = e._ptCache = 0, l = m && Xt(l) || l && !m, O = 0; O < k.length; O++) {
      if (L = k[O], G = L._gsap || hu(k)[O]._gsap, e._ptLookup[O] = de = {}, hc[G.id] && ji.length && pn(), ee = C === k ? O : C.indexOf(L), re && (U = new re()).init(L, le || S, e, ee, C) !== !1 && (e._pt = R = new Jt(e._pt, L, U.name, 0, 1, U.render, U, 0, U.priority), U._props.forEach(function(f) {
        de[f] = R;
      }), U.priority && (q = 1)), !re || le)
        for (M in S)
          is[M] && (U = pd(M, S, e, ee, L, C)) ? U.priority && (q = 1) : de[M] = R = du.call(e, L, M, "get", S[M], ee, C, 0, i.stringFilter);
      e._op && e._op[O] && e.kill(L, e._op[O]), T && e._pt && (Ri = e, Qe.killTweensOf(L, de, e.globalTime(t)), d = !e.parent, Ri = 0), e._pt && l && (hc[G.id] = 1);
    }
    q && kd(e), e._onInit && e._onInit(e);
  }
  e._onUpdate = c, e._initted = (!e._op || e._pt) && !d, p && t <= 0 && x.render(vs, !0, !0);
}, Cf = function(e, t, s, i, a, o, n, l) {
  var c = (e._pt && e._ptCache || (e._ptCache = {}))[t], u, g, p, h;
  if (!c)
    for (c = e._ptCache[t] = [], p = e._ptLookup, h = e._targets.length; h--; ) {
      if (u = p[h][t], u && u.d && u.d._pt)
        for (u = u.d._pt; u && u.p !== t && u.fp !== t; )
          u = u._next;
      if (!u)
        return yc = 1, e.vars[t] = "+=0", gu(e, n), yc = 0, l ? ro(t + " not eligible for reset") : 1;
      c.push(u);
    }
  for (h = c.length; h--; )
    g = c[h], u = g._pt || g, u.s = (i || i === 0) && !a ? i : u.s + (i || 0) + o * u.c, u.c = s - u.s, g.e && (g.e = nt(s) + Ot(g.e)), g.b && (g.b = u.s + Ot(g.b));
}, Sf = function(e, t) {
  var s = e[0] ? cr(e[0]).harness : 0, i = s && s.aliases, a, o, n, l;
  if (!i)
    return t;
  a = mr({}, t);
  for (o in i)
    if (o in a)
      for (l = i[o].split(","), n = l.length; n--; )
        a[l[n]] = a[o];
  return a;
}, Ef = function(e, t, s, i) {
  var a = t.ease || i || "power1.inOut", o, n;
  if (Rt(t))
    n = s[e] || (s[e] = []), t.forEach(function(l, c) {
      return n.push({
        t: c / (t.length - 1) * 100,
        v: l,
        e: a
      });
    });
  else
    for (o in t)
      n = s[o] || (s[o] = []), o === "ease" || n.push({
        t: parseFloat(e),
        v: t[o],
        e: a
      });
}, ja = function(e, t, s, i, a) {
  return it(e) ? e.call(t, s, i, a) : wt(e) && ~e.indexOf("random(") ? oo(e) : e;
}, md = uu + "repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert", yd = {};
Zt(md + ",id,stagger,delay,duration,paused,scrollTrigger", function(r) {
  return yd[r] = 1;
});
var ut = /* @__PURE__ */ function(r) {
  L0(e, r);
  function e(s, i, a, o) {
    var n;
    typeof i == "number" && (a.duration = i, i = a, a = null), n = r.call(this, o ? i : Ha(i)) || this;
    var l = n.vars, c = l.duration, u = l.delay, g = l.immediateRender, p = l.stagger, h = l.overwrite, m = l.keyframes, y = l.defaults, k = l.scrollTrigger, _ = l.yoyoEase, C = i.parent || Qe, T = (Rt(s) || $0(s) ? Di(s[0]) : "length" in i) ? [s] : ks(s), x, S, O, M, R, L, q, G;
    if (n._targets = T.length ? hu(T) : ro("GSAP target " + s + " not found. https://gsap.com", !ls.nullTargetWarn) || [], n._ptLookup = [], n._overwrite = h, m || p || xo(c) || xo(u)) {
      if (i = n.vars, x = n.timeline = new Wt({
        data: "nested",
        defaults: y || {},
        targets: C && C.data === "nested" ? C.vars.targets : T
      }), x.kill(), x.parent = x._dp = di(n), x._start = 0, p || xo(c) || xo(u)) {
        if (M = T.length, q = p && td(p), ei(p))
          for (R in p)
            ~md.indexOf(R) && (G || (G = {}), G[R] = p[R]);
        for (S = 0; S < M; S++)
          O = mn(i, yd), O.stagger = 0, _ && (O.yoyoEase = _), G && mr(O, G), L = T[S], O.duration = +ja(c, di(n), S, L, T), O.delay = (+ja(u, di(n), S, L, T) || 0) - n._delay, !p && M === 1 && O.delay && (n._delay = u = O.delay, n._start += u, O.delay = 0), x.to(L, O, q ? q(S, L, T) : 0), x._ease = Ee.none;
        x.duration() ? c = u = 0 : n.timeline = 0;
      } else if (m) {
        Ha(Ts(x.vars.defaults, {
          ease: "none"
        })), x._ease = hr(m.ease || i.ease || "none");
        var re = 0, U, de, ee;
        if (Rt(m))
          m.forEach(function(le) {
            return x.to(T, le, ">");
          }), x.duration();
        else {
          O = {};
          for (R in m)
            R === "ease" || R === "easeEach" || Ef(R, m[R], O, m.easeEach);
          for (R in O)
            for (U = O[R].sort(function(le, d) {
              return le.t - d.t;
            }), re = 0, S = 0; S < U.length; S++)
              de = U[S], ee = {
                ease: de.e,
                duration: (de.t - (S ? U[S - 1].t : 0)) / 100 * c
              }, ee[R] = de.v, x.to(T, ee, re), re += ee.duration;
          x.duration() < c && x.to({}, {
            duration: c - x.duration()
          });
        }
      }
      c || n.duration(c = x.duration());
    } else
      n.timeline = 0;
    return h === !0 && !ru && (Ri = di(n), Qe.killTweensOf(T), Ri = 0), Zs(C, di(n), a), i.reversed && n.reverse(), i.paused && n.paused(!0), (g || !c && !m && n._start === yt(C._time) && Xt(g) && rf(di(n)) && C.data !== "nested") && (n._tTime = -Ge, n.render(Math.max(0, -u) || 0)), k && Z0(di(n), k), n;
  }
  var t = e.prototype;
  return t.render = function(i, a, o) {
    var n = this._time, l = this._tDur, c = this._dur, u = i < 0, g = i > l - Ge && !u ? l : i < Ge ? 0 : i, p, h, m, y, k, _, C, T, x;
    if (!c)
      of(this, i, a, o);
    else if (g !== this._tTime || !i || o || !this._initted && this._tTime || this._startAt && this._zTime < 0 !== u) {
      if (p = g, T = this.timeline, this._repeat) {
        if (y = c + this._rDelay, this._repeat < -1 && u)
          return this.totalTime(y * 100 + i, a, o);
        if (p = yt(g % y), g === l ? (m = this._repeat, p = c) : (m = ~~(g / y), m && m === yt(g / y) && (p = c, m--), p > c && (p = c)), _ = this._yoyo && m & 1, _ && (x = this._yEase, p = c - p), k = ea(this._tTime, y), p === n && !o && this._initted && m === k)
          return this._tTime = g, this;
        m !== k && (T && this._yEase && dd(T, _), this.vars.repeatRefresh && !_ && !this._lock && this._time !== y && this._initted && (this._lock = o = 1, this.render(yt(y * m), !0).invalidate()._lock = 0));
      }
      if (!this._initted) {
        if (J0(this, u ? i : p, o, a, g))
          return this._tTime = 0, this;
        if (n !== this._time && !(o && this.vars.repeatRefresh && m !== k))
          return this;
        if (c !== this._dur)
          return this.render(i, a, o);
      }
      if (this._tTime = g, this._time = p, !this._act && this._ts && (this._act = 1, this._lazy = 0), this.ratio = C = (x || this._ease)(p / c), this._from && (this.ratio = C = 1 - C), p && !n && !a && !m && (ns(this, "onStart"), this._tTime !== g))
        return this;
      for (h = this._pt; h; )
        h.r(C, h.d), h = h._next;
      T && T.render(i < 0 ? i : T._dur * T._ease(p / this._dur), a, o) || this._startAt && (this._zTime = i), this._onUpdate && !a && (u && dc(this, i, a, o), ns(this, "onUpdate")), this._repeat && m !== k && this.vars.onRepeat && !a && this.parent && ns(this, "onRepeat"), (g === this._tDur || !g) && this._tTime === g && (u && !this._onUpdate && dc(this, i, !0, !0), (i || !c) && (g === this._tDur && this._ts > 0 || !g && this._ts < 0) && Gi(this, 1), !a && !(u && !n) && (g || n || _) && (ns(this, g === l ? "onComplete" : "onReverseComplete", !0), this._prom && !(g < l && this.timeScale() > 0) && this._prom()));
    }
    return this;
  }, t.targets = function() {
    return this._targets;
  }, t.invalidate = function(i) {
    return (!i || !this.vars.runBackwards) && (this._startAt = 0), this._pt = this._op = this._onUpdate = this._lazy = this.ratio = 0, this._ptLookup = [], this.timeline && this.timeline.invalidate(i), r.prototype.invalidate.call(this, i);
  }, t.resetTo = function(i, a, o, n, l) {
    no || rs.wake(), this._ts || this.play();
    var c = Math.min(this._dur, (this._dp._time - this._start) * this._ts), u;
    return this._initted || gu(this, c), u = this._ease(c / this._dur), Cf(this, i, a, o, n, u, c, l) ? this.resetTo(i, a, o, n, 1) : (cl(this, 0), this.parent || U0(this._dp, this, "_first", "_last", this._dp._sort ? "_start" : 0), this.render(0));
  }, t.kill = function(i, a) {
    if (a === void 0 && (a = "all"), !i && (!a || a === "all"))
      return this._lazy = this._pt = 0, this.parent ? Da(this) : this;
    if (this.timeline) {
      var o = this.timeline.totalDuration();
      return this.timeline.killTweensOf(i, a, Ri && Ri.vars.overwrite !== !0)._first || Da(this), this.parent && o !== this.timeline.totalDuration() && ta(this, this._dur * this.timeline._tDur / o, 0, 1), this;
    }
    var n = this._targets, l = i ? ks(i) : n, c = this._ptLookup, u = this._pt, g, p, h, m, y, k, _;
    if ((!a || a === "all") && tf(n, l))
      return a === "all" && (this._pt = 0), Da(this);
    for (g = this._op = this._op || [], a !== "all" && (wt(a) && (y = {}, Zt(a, function(C) {
      return y[C] = 1;
    }), a = y), a = Sf(n, a)), _ = n.length; _--; )
      if (~l.indexOf(n[_])) {
        p = c[_], a === "all" ? (g[_] = a, m = p, h = {}) : (h = g[_] = g[_] || {}, m = a);
        for (y in m)
          k = p && p[y], k && ((!("kill" in k.d) || k.d.kill(y) === !0) && nl(this, k, "_pt"), delete p[y]), h !== "all" && (h[y] = 1);
      }
    return this._initted && !this._pt && u && Da(this), this;
  }, e.to = function(i, a) {
    return new e(i, a, arguments[2]);
  }, e.from = function(i, a) {
    return Wa(1, arguments);
  }, e.delayedCall = function(i, a, o, n) {
    return new e(a, 0, {
      immediateRender: !1,
      lazy: !1,
      overwrite: !1,
      delay: i,
      onComplete: a,
      onReverseComplete: a,
      onCompleteParams: o,
      onReverseCompleteParams: o,
      callbackScope: n
    });
  }, e.fromTo = function(i, a, o) {
    return Wa(2, arguments);
  }, e.set = function(i, a) {
    return a.duration = 0, a.repeatDelay || (a.repeat = 0), new e(i, a);
  }, e.killTweensOf = function(i, a, o) {
    return Qe.killTweensOf(i, a, o);
  }, e;
}(lo);
Ts(ut.prototype, {
  _targets: [],
  _lazy: 0,
  _startAt: 0,
  _op: 0,
  _onInit: 0
});
Zt("staggerTo,staggerFrom,staggerFromTo", function(r) {
  ut[r] = function() {
    var e = new Wt(), t = fc.call(arguments, 0);
    return t.splice(r === "staggerFromTo" ? 5 : 4, 0, 0), e[r].apply(e, t);
  };
});
var fu = function(e, t, s) {
  return e[t] = s;
}, bd = function(e, t, s) {
  return e[t](s);
}, Af = function(e, t, s, i) {
  return e[t](i.fp, s);
}, xf = function(e, t, s) {
  return e.setAttribute(t, s);
}, pu = function(e, t) {
  return it(e[t]) ? bd : au(e[t]) && e.setAttribute ? xf : fu;
}, wd = function(e, t) {
  return t.set(t.t, t.p, Math.round((t.s + t.c * e) * 1e6) / 1e6, t);
}, If = function(e, t) {
  return t.set(t.t, t.p, !!(t.s + t.c * e), t);
}, vd = function(e, t) {
  var s = t._pt, i = "";
  if (!e && t.b)
    i = t.b;
  else if (e === 1 && t.e)
    i = t.e;
  else {
    for (; s; )
      i = s.p + (s.m ? s.m(s.s + s.c * e) : Math.round((s.s + s.c * e) * 1e4) / 1e4) + i, s = s._next;
    i += t.c;
  }
  t.set(t.t, t.p, i, t);
}, mu = function(e, t) {
  for (var s = t._pt; s; )
    s.r(e, s.d), s = s._next;
}, Pf = function(e, t, s, i) {
  for (var a = this._pt, o; a; )
    o = a._next, a.p === i && a.modifier(e, t, s), a = o;
}, Mf = function(e) {
  for (var t = this._pt, s, i; t; )
    i = t._next, t.p === e && !t.op || t.op === e ? nl(this, t, "_pt") : t.dep || (s = 1), t = i;
  return !s;
}, Of = function(e, t, s, i) {
  i.mSet(e, t, i.m.call(i.tween, s, i.mt), i);
}, kd = function(e) {
  for (var t = e._pt, s, i, a, o; t; ) {
    for (s = t._next, i = a; i && i.pr > t.pr; )
      i = i._next;
    (t._prev = i ? i._prev : o) ? t._prev._next = t : a = t, (t._next = i) ? i._prev = t : o = t, t = s;
  }
  e._pt = a;
}, Jt = /* @__PURE__ */ function() {
  function r(t, s, i, a, o, n, l, c, u) {
    this.t = s, this.s = a, this.c = o, this.p = i, this.r = n || wd, this.d = l || this, this.set = c || fu, this.pr = u || 0, this._next = t, t && (t._prev = this);
  }
  var e = r.prototype;
  return e.modifier = function(s, i, a) {
    this.mSet = this.mSet || this.set, this.set = Of, this.m = s, this.mt = a, this.tween = i;
  }, r;
}();
Zt(uu + "parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger", function(r) {
  return cu[r] = 1;
});
us.TweenMax = us.TweenLite = ut;
us.TimelineLite = us.TimelineMax = Wt;
Qe = new Wt({
  sortChildren: !1,
  defaults: Qr,
  autoRemoveChildren: !0,
  id: "root",
  smoothChildTiming: !0
});
ls.stringFilter = ud;
var dr = [], zo = {}, Ff = [], gh = 0, Lf = 0, Ol = function(e) {
  return (zo[e] || Ff).map(function(t) {
    return t();
  });
}, bc = function() {
  var e = Date.now(), t = [];
  e - gh > 2 && (Ol("matchMediaInit"), dr.forEach(function(s) {
    var i = s.queries, a = s.conditions, o, n, l, c;
    for (n in i)
      o = Us.matchMedia(i[n]).matches, o && (l = 1), o !== a[n] && (a[n] = o, c = 1);
    c && (s.revert(), l && t.push(s));
  }), Ol("matchMediaRevert"), t.forEach(function(s) {
    return s.onMatch(s, function(i) {
      return s.add(null, i);
    });
  }), gh = e, Ol("matchMedia"));
}, _d = /* @__PURE__ */ function() {
  function r(t, s) {
    this.selector = s && pc(s), this.data = [], this._r = [], this.isReverted = !1, this.id = Lf++, t && this.add(t);
  }
  var e = r.prototype;
  return e.add = function(s, i, a) {
    it(s) && (a = i, i = s, s = it);
    var o = this, n = function() {
      var c = Xe, u = o.selector, g;
      return c && c !== o && c.data.push(o), a && (o.selector = pc(a)), Xe = o, g = i.apply(o, arguments), it(g) && o._r.push(g), Xe = c, o.selector = u, o.isReverted = !1, g;
    };
    return o.last = n, s === it ? n(o, function(l) {
      return o.add(null, l);
    }) : s ? o[s] = n : n;
  }, e.ignore = function(s) {
    var i = Xe;
    Xe = null, s(this), Xe = i;
  }, e.getTweens = function() {
    var s = [];
    return this.data.forEach(function(i) {
      return i instanceof r ? s.push.apply(s, i.getTweens()) : i instanceof ut && !(i.parent && i.parent.data === "nested") && s.push(i);
    }), s;
  }, e.clear = function() {
    this._r.length = this.data.length = 0;
  }, e.kill = function(s, i) {
    var a = this;
    if (s ? function() {
      for (var n = a.getTweens(), l = a.data.length, c; l--; )
        c = a.data[l], c.data === "isFlip" && (c.revert(), c.getChildren(!0, !0, !1).forEach(function(u) {
          return n.splice(n.indexOf(u), 1);
        }));
      for (n.map(function(u) {
        return {
          g: u._dur || u._delay || u._sat && !u._sat.vars.immediateRender ? u.globalTime(0) : -1 / 0,
          t: u
        };
      }).sort(function(u, g) {
        return g.g - u.g || -1 / 0;
      }).forEach(function(u) {
        return u.t.revert(s);
      }), l = a.data.length; l--; )
        c = a.data[l], c instanceof Wt ? c.data !== "nested" && (c.scrollTrigger && c.scrollTrigger.revert(), c.kill()) : !(c instanceof ut) && c.revert && c.revert(s);
      a._r.forEach(function(u) {
        return u(s, a);
      }), a.isReverted = !0;
    }() : this.data.forEach(function(n) {
      return n.kill && n.kill();
    }), this.clear(), i)
      for (var o = dr.length; o--; )
        dr[o].id === this.id && dr.splice(o, 1);
  }, e.revert = function(s) {
    this.kill(s || {});
  }, r;
}(), Rf = /* @__PURE__ */ function() {
  function r(t) {
    this.contexts = [], this.scope = t, Xe && Xe.data.push(this);
  }
  var e = r.prototype;
  return e.add = function(s, i, a) {
    ei(s) || (s = {
      matches: s
    });
    var o = new _d(0, a || this.scope), n = o.conditions = {}, l, c, u;
    Xe && !o.selector && (o.selector = Xe.selector), this.contexts.push(o), i = o.add("onMatch", i), o.queries = s;
    for (c in s)
      c === "all" ? u = 1 : (l = Us.matchMedia(s[c]), l && (dr.indexOf(o) < 0 && dr.push(o), (n[c] = l.matches) && (u = 1), l.addListener ? l.addListener(bc) : l.addEventListener("change", bc)));
    return u && i(o, function(g) {
      return o.add(null, g);
    }), this;
  }, e.revert = function(s) {
    this.kill(s || {});
  }, e.kill = function(s) {
    this.contexts.forEach(function(i) {
      return i.kill(s, !0);
    });
  }, r;
}(), bn = {
  registerPlugin: function() {
    for (var e = arguments.length, t = new Array(e), s = 0; s < e; s++)
      t[s] = arguments[s];
    t.forEach(function(i) {
      return nd(i);
    });
  },
  timeline: function(e) {
    return new Wt(e);
  },
  getTweensOf: function(e, t) {
    return Qe.getTweensOf(e, t);
  },
  getProperty: function(e, t, s, i) {
    wt(e) && (e = ks(e)[0]);
    var a = cr(e || {}).get, o = s ? Y0 : q0;
    return s === "native" && (s = ""), e && (t ? o((is[t] && is[t].get || a)(e, t, s, i)) : function(n, l, c) {
      return o((is[n] && is[n].get || a)(e, n, l, c));
    });
  },
  quickSetter: function(e, t, s) {
    if (e = ks(e), e.length > 1) {
      var i = e.map(function(u) {
        return es.quickSetter(u, t, s);
      }), a = i.length;
      return function(u) {
        for (var g = a; g--; )
          i[g](u);
      };
    }
    e = e[0] || {};
    var o = is[t], n = cr(e), l = n.harness && (n.harness.aliases || {})[t] || t, c = o ? function(u) {
      var g = new o();
      Mr._pt = 0, g.init(e, s ? u + s : u, Mr, 0, [e]), g.render(1, g), Mr._pt && mu(1, Mr);
    } : n.set(e, l);
    return o ? c : function(u) {
      return c(e, l, s ? u + s : u, n, 1);
    };
  },
  quickTo: function(e, t, s) {
    var i, a = es.to(e, mr((i = {}, i[t] = "+=0.1", i.paused = !0, i), s || {})), o = function(l, c, u) {
      return a.resetTo(t, l, c, u);
    };
    return o.tween = a, o;
  },
  isTweening: function(e) {
    return Qe.getTweensOf(e, !0).length > 0;
  },
  defaults: function(e) {
    return e && e.ease && (e.ease = hr(e.ease, Qr.ease)), lh(Qr, e || {});
  },
  config: function(e) {
    return lh(ls, e || {});
  },
  registerEffect: function(e) {
    var t = e.name, s = e.effect, i = e.plugins, a = e.defaults, o = e.extendTimeline;
    (i || "").split(",").forEach(function(n) {
      return n && !is[n] && !us[n] && ro(t + " effect requires " + n + " plugin.");
    }), xl[t] = function(n, l, c) {
      return s(ks(n), Ts(l || {}, a), c);
    }, o && (Wt.prototype[t] = function(n, l, c) {
      return this.add(xl[t](n, ei(l) ? l : (c = l) && {}, this), c);
    });
  },
  registerEase: function(e, t) {
    Ee[e] = hr(t);
  },
  parseEase: function(e, t) {
    return arguments.length ? hr(e, t) : Ee;
  },
  getById: function(e) {
    return Qe.getById(e);
  },
  exportRoot: function(e, t) {
    e === void 0 && (e = {});
    var s = new Wt(e), i, a;
    for (s.smoothChildTiming = Xt(e.smoothChildTiming), Qe.remove(s), s._dp = 0, s._time = s._tTime = Qe._time, i = Qe._first; i; )
      a = i._next, (t || !(!i._dur && i instanceof ut && i.vars.onComplete === i._targets[0])) && Zs(s, i, i._start - i._delay), i = a;
    return Zs(Qe, s, 0), s;
  },
  context: function(e, t) {
    return e ? new _d(e, t) : Xe;
  },
  matchMedia: function(e) {
    return new Rf(e);
  },
  matchMediaRefresh: function() {
    return dr.forEach(function(e) {
      var t = e.conditions, s, i;
      for (i in t)
        t[i] && (t[i] = !1, s = 1);
      s && e.revert();
    }) || bc();
  },
  addEventListener: function(e, t) {
    var s = zo[e] || (zo[e] = []);
    ~s.indexOf(t) || s.push(t);
  },
  removeEventListener: function(e, t) {
    var s = zo[e], i = s && s.indexOf(t);
    i >= 0 && s.splice(i, 1);
  },
  utils: {
    wrap: ff,
    wrapYoyo: pf,
    distribute: td,
    random: id,
    snap: sd,
    normalize: gf,
    getUnit: Ot,
    clamp: cf,
    splitColor: ld,
    toArray: ks,
    selector: pc,
    mapRange: ad,
    pipe: hf,
    unitize: df,
    interpolate: mf,
    shuffle: ed
  },
  install: j0,
  effects: xl,
  ticker: rs,
  updateRoot: Wt.updateRoot,
  plugins: is,
  globalTimeline: Qe,
  core: {
    PropTween: Jt,
    globals: K0,
    Tween: ut,
    Timeline: Wt,
    Animation: lo,
    getCache: cr,
    _removeLinkedListItem: nl,
    reverting: function() {
      return Lt;
    },
    context: function(e) {
      return e && Xe && (Xe.data.push(e), e._ctx = Xe), Xe;
    },
    suppressOverwrites: function(e) {
      return ru = e;
    }
  }
};
Zt("to,from,fromTo,delayedCall,set,killTweensOf", function(r) {
  return bn[r] = ut[r];
});
rs.add(Wt.updateRoot);
Mr = bn.to({}, {
  duration: 0
});
var $f = function(e, t) {
  for (var s = e._pt; s && s.p !== t && s.op !== t && s.fp !== t; )
    s = s._next;
  return s;
}, Nf = function(e, t) {
  var s = e._targets, i, a, o;
  for (i in t)
    for (a = s.length; a--; )
      o = e._ptLookup[a][i], o && (o = o.d) && (o._pt && (o = $f(o, i)), o && o.modifier && o.modifier(t[i], e, s[a], i));
}, Fl = function(e, t) {
  return {
    name: e,
    rawVars: 1,
    //don't pre-process function-based values or "random()" strings.
    init: function(i, a, o) {
      o._onInit = function(n) {
        var l, c;
        if (wt(a) && (l = {}, Zt(a, function(u) {
          return l[u] = 1;
        }), a = l), t) {
          l = {};
          for (c in a)
            l[c] = t(a[c]);
          a = l;
        }
        Nf(n, a);
      };
    }
  };
}, es = bn.registerPlugin({
  name: "attr",
  init: function(e, t, s, i, a) {
    var o, n, l;
    this.tween = s;
    for (o in t)
      l = e.getAttribute(o) || "", n = this.add(e, "setAttribute", (l || 0) + "", t[o], i, a, 0, 0, o), n.op = o, n.b = l, this._props.push(o);
  },
  render: function(e, t) {
    for (var s = t._pt; s; )
      Lt ? s.set(s.t, s.p, s.b, s) : s.r(e, s.d), s = s._next;
  }
}, {
  name: "endArray",
  init: function(e, t) {
    for (var s = t.length; s--; )
      this.add(e, s, e[s] || 0, t[s], 0, 0, 0, 0, 0, 1);
  }
}, Fl("roundProps", mc), Fl("modifiers"), Fl("snap", sd)) || bn;
ut.version = Wt.version = es.version = "3.12.5";
W0 = 1;
ou() && sa();
Ee.Power0;
Ee.Power1;
Ee.Power2;
Ee.Power3;
Ee.Power4;
Ee.Linear;
Ee.Quad;
Ee.Cubic;
Ee.Quart;
Ee.Quint;
Ee.Strong;
Ee.Elastic;
Ee.Back;
Ee.SteppedEase;
Ee.Bounce;
Ee.Sine;
Ee.Expo;
Ee.Circ;
/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var fh, $i, Wr, yu, nr, ph, bu, Bf = function() {
  return typeof window < "u";
}, Ti = {}, ir = 180 / Math.PI, jr = Math.PI / 180, Tr = Math.atan2, mh = 1e8, wu = /([A-Z])/g, Hf = /(left|right|width|margin|padding|x)/i, Wf = /[\s,\(]\S/, Js = {
  autoAlpha: "opacity,visibility",
  scale: "scaleX,scaleY",
  alpha: "opacity"
}, wc = function(e, t) {
  return t.set(t.t, t.p, Math.round((t.s + t.c * e) * 1e4) / 1e4 + t.u, t);
}, jf = function(e, t) {
  return t.set(t.t, t.p, e === 1 ? t.e : Math.round((t.s + t.c * e) * 1e4) / 1e4 + t.u, t);
}, Kf = function(e, t) {
  return t.set(t.t, t.p, e ? Math.round((t.s + t.c * e) * 1e4) / 1e4 + t.u : t.b, t);
}, Gf = function(e, t) {
  var s = t.s + t.c * e;
  t.set(t.t, t.p, ~~(s + (s < 0 ? -0.5 : 0.5)) + t.u, t);
}, Dd = function(e, t) {
  return t.set(t.t, t.p, e ? t.e : t.b, t);
}, Td = function(e, t) {
  return t.set(t.t, t.p, e !== 1 ? t.b : t.e, t);
}, Vf = function(e, t, s) {
  return e.style[t] = s;
}, zf = function(e, t, s) {
  return e.style.setProperty(t, s);
}, qf = function(e, t, s) {
  return e._gsap[t] = s;
}, Yf = function(e, t, s) {
  return e._gsap.scaleX = e._gsap.scaleY = s;
}, Uf = function(e, t, s, i, a) {
  var o = e._gsap;
  o.scaleX = o.scaleY = s, o.renderTransform(a, o);
}, Xf = function(e, t, s, i, a) {
  var o = e._gsap;
  o[t] = s, o.renderTransform(a, o);
}, et = "transform", Qt = et + "Origin", Zf = function r(e, t) {
  var s = this, i = this.target, a = i.style, o = i._gsap;
  if (e in Ti && a) {
    if (this.tfm = this.tfm || {}, e !== "transform")
      e = Js[e] || e, ~e.indexOf(",") ? e.split(",").forEach(function(n) {
        return s.tfm[n] = gi(i, n);
      }) : this.tfm[e] = o.x ? o[e] : gi(i, e), e === Qt && (this.tfm.zOrigin = o.zOrigin);
    else
      return Js.transform.split(",").forEach(function(n) {
        return r.call(s, n, t);
      });
    if (this.props.indexOf(et) >= 0)
      return;
    o.svg && (this.svgo = i.getAttribute("data-svg-origin"), this.props.push(Qt, t, "")), e = et;
  }
  (a || t) && this.props.push(e, t, a[e]);
}, Cd = function(e) {
  e.translate && (e.removeProperty("translate"), e.removeProperty("scale"), e.removeProperty("rotate"));
}, Jf = function() {
  var e = this.props, t = this.target, s = t.style, i = t._gsap, a, o;
  for (a = 0; a < e.length; a += 3)
    e[a + 1] ? t[e[a]] = e[a + 2] : e[a + 2] ? s[e[a]] = e[a + 2] : s.removeProperty(e[a].substr(0, 2) === "--" ? e[a] : e[a].replace(wu, "-$1").toLowerCase());
  if (this.tfm) {
    for (o in this.tfm)
      i[o] = this.tfm[o];
    i.svg && (i.renderTransform(), t.setAttribute("data-svg-origin", this.svgo || "")), a = bu(), (!a || !a.isStart) && !s[et] && (Cd(s), i.zOrigin && s[Qt] && (s[Qt] += " " + i.zOrigin + "px", i.zOrigin = 0, i.renderTransform()), i.uncache = 1);
  }
}, Sd = function(e, t) {
  var s = {
    target: e,
    props: [],
    revert: Jf,
    save: Zf
  };
  return e._gsap || es.core.getCache(e), t && t.split(",").forEach(function(i) {
    return s.save(i);
  }), s;
}, Ed, vc = function(e, t) {
  var s = $i.createElementNS ? $i.createElementNS((t || "http://www.w3.org/1999/xhtml").replace(/^https/, "http"), e) : $i.createElement(e);
  return s && s.style ? s : $i.createElement(e);
}, Qs = function r(e, t, s) {
  var i = getComputedStyle(e);
  return i[t] || i.getPropertyValue(t.replace(wu, "-$1").toLowerCase()) || i.getPropertyValue(t) || !s && r(e, ia(t) || t, 1) || "";
}, yh = "O,Moz,ms,Ms,Webkit".split(","), ia = function(e, t, s) {
  var i = t || nr, a = i.style, o = 5;
  if (e in a && !s)
    return e;
  for (e = e.charAt(0).toUpperCase() + e.substr(1); o-- && !(yh[o] + e in a); )
    ;
  return o < 0 ? null : (o === 3 ? "ms" : o >= 0 ? yh[o] : "") + e;
}, kc = function() {
  Bf() && window.document && (fh = window, $i = fh.document, Wr = $i.documentElement, nr = vc("div") || {
    style: {}
  }, vc("div"), et = ia(et), Qt = et + "Origin", nr.style.cssText = "border-width:0;line-height:0;position:absolute;padding:0", Ed = !!ia("perspective"), bu = es.core.reverting, yu = 1);
}, Ll = function r(e) {
  var t = vc("svg", this.ownerSVGElement && this.ownerSVGElement.getAttribute("xmlns") || "http://www.w3.org/2000/svg"), s = this.parentNode, i = this.nextSibling, a = this.style.cssText, o;
  if (Wr.appendChild(t), t.appendChild(this), this.style.display = "block", e)
    try {
      o = this.getBBox(), this._gsapBBox = this.getBBox, this.getBBox = r;
    } catch {
    }
  else
    this._gsapBBox && (o = this._gsapBBox());
  return s && (i ? s.insertBefore(this, i) : s.appendChild(this)), Wr.removeChild(t), this.style.cssText = a, o;
}, bh = function(e, t) {
  for (var s = t.length; s--; )
    if (e.hasAttribute(t[s]))
      return e.getAttribute(t[s]);
}, Ad = function(e) {
  var t;
  try {
    t = e.getBBox();
  } catch {
    t = Ll.call(e, !0);
  }
  return t && (t.width || t.height) || e.getBBox === Ll || (t = Ll.call(e, !0)), t && !t.width && !t.x && !t.y ? {
    x: +bh(e, ["x", "cx", "x1"]) || 0,
    y: +bh(e, ["y", "cy", "y1"]) || 0,
    width: 0,
    height: 0
  } : t;
}, xd = function(e) {
  return !!(e.getCTM && (!e.parentNode || e.ownerSVGElement) && Ad(e));
}, yr = function(e, t) {
  if (t) {
    var s = e.style, i;
    t in Ti && t !== Qt && (t = et), s.removeProperty ? (i = t.substr(0, 2), (i === "ms" || t.substr(0, 6) === "webkit") && (t = "-" + t), s.removeProperty(i === "--" ? t : t.replace(wu, "-$1").toLowerCase())) : s.removeAttribute(t);
  }
}, Ni = function(e, t, s, i, a, o) {
  var n = new Jt(e._pt, t, s, 0, 1, o ? Td : Dd);
  return e._pt = n, n.b = i, n.e = a, e._props.push(s), n;
}, wh = {
  deg: 1,
  rad: 1,
  turn: 1
}, Qf = {
  grid: 1,
  flex: 1
}, Vi = function r(e, t, s, i) {
  var a = parseFloat(s) || 0, o = (s + "").trim().substr((a + "").length) || "px", n = nr.style, l = Hf.test(t), c = e.tagName.toLowerCase() === "svg", u = (c ? "client" : "offset") + (l ? "Width" : "Height"), g = 100, p = i === "px", h = i === "%", m, y, k, _;
  if (i === o || !a || wh[i] || wh[o])
    return a;
  if (o !== "px" && !p && (a = r(e, t, s, "px")), _ = e.getCTM && xd(e), (h || o === "%") && (Ti[t] || ~t.indexOf("adius")))
    return m = _ ? e.getBBox()[l ? "width" : "height"] : e[u], nt(h ? a / m * g : a / 100 * m);
  if (n[l ? "width" : "height"] = g + (p ? o : i), y = ~t.indexOf("adius") || i === "em" && e.appendChild && !c ? e : e.parentNode, _ && (y = (e.ownerSVGElement || {}).parentNode), (!y || y === $i || !y.appendChild) && (y = $i.body), k = y._gsap, k && h && k.width && l && k.time === rs.time && !k.uncache)
    return nt(a / k.width * g);
  if (h && (t === "height" || t === "width")) {
    var C = e.style[t];
    e.style[t] = g + i, m = e[u], C ? e.style[t] = C : yr(e, t);
  } else
    (h || o === "%") && !Qf[Qs(y, "display")] && (n.position = Qs(e, "position")), y === e && (n.position = "static"), y.appendChild(nr), m = nr[u], y.removeChild(nr), n.position = "absolute";
  return l && h && (k = cr(y), k.time = rs.time, k.width = y[u]), nt(p ? m * a / g : m && a ? g / m * a : 0);
}, gi = function(e, t, s, i) {
  var a;
  return yu || kc(), t in Js && t !== "transform" && (t = Js[t], ~t.indexOf(",") && (t = t.split(",")[0])), Ti[t] && t !== "transform" ? (a = uo(e, i), a = t !== "transformOrigin" ? a[t] : a.svg ? a.origin : vn(Qs(e, Qt)) + " " + a.zOrigin + "px") : (a = e.style[t], (!a || a === "auto" || i || ~(a + "").indexOf("calc(")) && (a = wn[t] && wn[t](e, t, s) || Qs(e, t) || V0(e, t) || (t === "opacity" ? 1 : 0))), s && !~(a + "").trim().indexOf(" ") ? Vi(e, t, a, s) + s : a;
}, ep = function(e, t, s, i) {
  if (!s || s === "none") {
    var a = ia(t, e, 1), o = a && Qs(e, a, 1);
    o && o !== s ? (t = a, s = o) : t === "borderColor" && (s = Qs(e, "borderTopColor"));
  }
  var n = new Jt(this._pt, e.style, t, 0, 1, vd), l = 0, c = 0, u, g, p, h, m, y, k, _, C, T, x, S;
  if (n.b = s, n.e = i, s += "", i += "", i === "auto" && (y = e.style[t], e.style[t] = i, i = Qs(e, t) || i, y ? e.style[t] = y : yr(e, t)), u = [s, i], ud(u), s = u[0], i = u[1], p = s.match(Pr) || [], S = i.match(Pr) || [], S.length) {
    for (; g = Pr.exec(i); )
      k = g[0], C = i.substring(l, g.index), m ? m = (m + 1) % 5 : (C.substr(-5) === "rgba(" || C.substr(-5) === "hsla(") && (m = 1), k !== (y = p[c++] || "") && (h = parseFloat(y) || 0, x = y.substr((h + "").length), k.charAt(1) === "=" && (k = Hr(h, k) + x), _ = parseFloat(k), T = k.substr((_ + "").length), l = Pr.lastIndex - T.length, T || (T = T || ls.units[t] || x, l === i.length && (i += T, n.e += T)), x !== T && (h = Vi(e, t, y, T) || 0), n._pt = {
        _next: n._pt,
        p: C || c === 1 ? C : ",",
        //note: SVG spec allows omission of comma/space when a negative sign is wedged between two numbers, like 2.5-5.3 instead of 2.5,-5.3 but when tweening, the negative value may switch to positive, so we insert the comma just in case.
        s: h,
        c: _ - h,
        m: m && m < 4 || t === "zIndex" ? Math.round : 0
      });
    n.c = l < i.length ? i.substring(l, i.length) : "";
  } else
    n.r = t === "display" && i === "none" ? Td : Dd;
  return B0.test(i) && (n.e = 0), this._pt = n, n;
}, vh = {
  top: "0%",
  bottom: "100%",
  left: "0%",
  right: "100%",
  center: "50%"
}, tp = function(e) {
  var t = e.split(" "), s = t[0], i = t[1] || "50%";
  return (s === "top" || s === "bottom" || i === "left" || i === "right") && (e = s, s = i, i = e), t[0] = vh[s] || s, t[1] = vh[i] || i, t.join(" ");
}, sp = function(e, t) {
  if (t.tween && t.tween._time === t.tween._dur) {
    var s = t.t, i = s.style, a = t.u, o = s._gsap, n, l, c;
    if (a === "all" || a === !0)
      i.cssText = "", l = 1;
    else
      for (a = a.split(","), c = a.length; --c > -1; )
        n = a[c], Ti[n] && (l = 1, n = n === "transformOrigin" ? Qt : et), yr(s, n);
    l && (yr(s, et), o && (o.svg && s.removeAttribute("transform"), uo(s, 1), o.uncache = 1, Cd(i)));
  }
}, wn = {
  clearProps: function(e, t, s, i, a) {
    if (a.data !== "isFromStart") {
      var o = e._pt = new Jt(e._pt, t, s, 0, 0, sp);
      return o.u = i, o.pr = -10, o.tween = a, e._props.push(s), 1;
    }
  }
  /* className feature (about 0.4kb gzipped).
  , className(plugin, target, property, endValue, tween) {
  	let _renderClassName = (ratio, data) => {
  			data.css.render(ratio, data.css);
  			if (!ratio || ratio === 1) {
  				let inline = data.rmv,
  					target = data.t,
  					p;
  				target.setAttribute("class", ratio ? data.e : data.b);
  				for (p in inline) {
  					_removeProperty(target, p);
  				}
  			}
  		},
  		_getAllStyles = (target) => {
  			let styles = {},
  				computed = getComputedStyle(target),
  				p;
  			for (p in computed) {
  				if (isNaN(p) && p !== "cssText" && p !== "length") {
  					styles[p] = computed[p];
  				}
  			}
  			_setDefaults(styles, _parseTransform(target, 1));
  			return styles;
  		},
  		startClassList = target.getAttribute("class"),
  		style = target.style,
  		cssText = style.cssText,
  		cache = target._gsap,
  		classPT = cache.classPT,
  		inlineToRemoveAtEnd = {},
  		data = {t:target, plugin:plugin, rmv:inlineToRemoveAtEnd, b:startClassList, e:(endValue.charAt(1) !== "=") ? endValue : startClassList.replace(new RegExp("(?:\\s|^)" + endValue.substr(2) + "(?![\\w-])"), "") + ((endValue.charAt(0) === "+") ? " " + endValue.substr(2) : "")},
  		changingVars = {},
  		startVars = _getAllStyles(target),
  		transformRelated = /(transform|perspective)/i,
  		endVars, p;
  	if (classPT) {
  		classPT.r(1, classPT.d);
  		_removeLinkedListItem(classPT.d.plugin, classPT, "_pt");
  	}
  	target.setAttribute("class", data.e);
  	endVars = _getAllStyles(target, true);
  	target.setAttribute("class", startClassList);
  	for (p in endVars) {
  		if (endVars[p] !== startVars[p] && !transformRelated.test(p)) {
  			changingVars[p] = endVars[p];
  			if (!style[p] && style[p] !== "0") {
  				inlineToRemoveAtEnd[p] = 1;
  			}
  		}
  	}
  	cache.classPT = plugin._pt = new PropTween(plugin._pt, target, "className", 0, 0, _renderClassName, data, 0, -11);
  	if (style.cssText !== cssText) { //only apply if things change. Otherwise, in cases like a background-image that's pulled dynamically, it could cause a refresh. See https://gsap.com/forums/topic/20368-possible-gsap-bug-switching-classnames-in-chrome/.
  		style.cssText = cssText; //we recorded cssText before we swapped classes and ran _getAllStyles() because in cases when a className tween is overwritten, we remove all the related tweening properties from that class change (otherwise class-specific stuff can't override properties we've directly set on the target's style object due to specificity).
  	}
  	_parseTransform(target, true); //to clear the caching of transforms
  	data.css = new gsap.plugins.css();
  	data.css.init(target, changingVars, tween);
  	plugin._props.push(...data.css._props);
  	return 1;
  }
  */
}, co = [1, 0, 0, 1, 0, 0], Id = {}, Pd = function(e) {
  return e === "matrix(1, 0, 0, 1, 0, 0)" || e === "none" || !e;
}, kh = function(e) {
  var t = Qs(e, et);
  return Pd(t) ? co : t.substr(7).match(N0).map(nt);
}, vu = function(e, t) {
  var s = e._gsap || cr(e), i = e.style, a = kh(e), o, n, l, c;
  return s.svg && e.getAttribute("transform") ? (l = e.transform.baseVal.consolidate().matrix, a = [l.a, l.b, l.c, l.d, l.e, l.f], a.join(",") === "1,0,0,1,0,0" ? co : a) : (a === co && !e.offsetParent && e !== Wr && !s.svg && (l = i.display, i.display = "block", o = e.parentNode, (!o || !e.offsetParent) && (c = 1, n = e.nextElementSibling, Wr.appendChild(e)), a = kh(e), l ? i.display = l : yr(e, "display"), c && (n ? o.insertBefore(e, n) : o ? o.appendChild(e) : Wr.removeChild(e))), t && a.length > 6 ? [a[0], a[1], a[4], a[5], a[12], a[13]] : a);
}, _c = function(e, t, s, i, a, o) {
  var n = e._gsap, l = a || vu(e, !0), c = n.xOrigin || 0, u = n.yOrigin || 0, g = n.xOffset || 0, p = n.yOffset || 0, h = l[0], m = l[1], y = l[2], k = l[3], _ = l[4], C = l[5], T = t.split(" "), x = parseFloat(T[0]) || 0, S = parseFloat(T[1]) || 0, O, M, R, L;
  s ? l !== co && (M = h * k - m * y) && (R = x * (k / M) + S * (-y / M) + (y * C - k * _) / M, L = x * (-m / M) + S * (h / M) - (h * C - m * _) / M, x = R, S = L) : (O = Ad(e), x = O.x + (~T[0].indexOf("%") ? x / 100 * O.width : x), S = O.y + (~(T[1] || T[0]).indexOf("%") ? S / 100 * O.height : S)), i || i !== !1 && n.smooth ? (_ = x - c, C = S - u, n.xOffset = g + (_ * h + C * y) - _, n.yOffset = p + (_ * m + C * k) - C) : n.xOffset = n.yOffset = 0, n.xOrigin = x, n.yOrigin = S, n.smooth = !!i, n.origin = t, n.originIsAbsolute = !!s, e.style[Qt] = "0px 0px", o && (Ni(o, n, "xOrigin", c, x), Ni(o, n, "yOrigin", u, S), Ni(o, n, "xOffset", g, n.xOffset), Ni(o, n, "yOffset", p, n.yOffset)), e.setAttribute("data-svg-origin", x + " " + S);
}, uo = function(e, t) {
  var s = e._gsap || new fd(e);
  if ("x" in s && !t && !s.uncache)
    return s;
  var i = e.style, a = s.scaleX < 0, o = "px", n = "deg", l = getComputedStyle(e), c = Qs(e, Qt) || "0", u, g, p, h, m, y, k, _, C, T, x, S, O, M, R, L, q, G, re, U, de, ee, le, d, f, v, b, D, E, P, N, K;
  return u = g = p = y = k = _ = C = T = x = 0, h = m = 1, s.svg = !!(e.getCTM && xd(e)), l.translate && ((l.translate !== "none" || l.scale !== "none" || l.rotate !== "none") && (i[et] = (l.translate !== "none" ? "translate3d(" + (l.translate + " 0 0").split(" ").slice(0, 3).join(", ") + ") " : "") + (l.rotate !== "none" ? "rotate(" + l.rotate + ") " : "") + (l.scale !== "none" ? "scale(" + l.scale.split(" ").join(",") + ") " : "") + (l[et] !== "none" ? l[et] : "")), i.scale = i.rotate = i.translate = "none"), M = vu(e, s.svg), s.svg && (s.uncache ? (f = e.getBBox(), c = s.xOrigin - f.x + "px " + (s.yOrigin - f.y) + "px", d = "") : d = !t && e.getAttribute("data-svg-origin"), _c(e, d || c, !!d || s.originIsAbsolute, s.smooth !== !1, M)), S = s.xOrigin || 0, O = s.yOrigin || 0, M !== co && (G = M[0], re = M[1], U = M[2], de = M[3], u = ee = M[4], g = le = M[5], M.length === 6 ? (h = Math.sqrt(G * G + re * re), m = Math.sqrt(de * de + U * U), y = G || re ? Tr(re, G) * ir : 0, C = U || de ? Tr(U, de) * ir + y : 0, C && (m *= Math.abs(Math.cos(C * jr))), s.svg && (u -= S - (S * G + O * U), g -= O - (S * re + O * de))) : (K = M[6], P = M[7], b = M[8], D = M[9], E = M[10], N = M[11], u = M[12], g = M[13], p = M[14], R = Tr(K, E), k = R * ir, R && (L = Math.cos(-R), q = Math.sin(-R), d = ee * L + b * q, f = le * L + D * q, v = K * L + E * q, b = ee * -q + b * L, D = le * -q + D * L, E = K * -q + E * L, N = P * -q + N * L, ee = d, le = f, K = v), R = Tr(-U, E), _ = R * ir, R && (L = Math.cos(-R), q = Math.sin(-R), d = G * L - b * q, f = re * L - D * q, v = U * L - E * q, N = de * q + N * L, G = d, re = f, U = v), R = Tr(re, G), y = R * ir, R && (L = Math.cos(R), q = Math.sin(R), d = G * L + re * q, f = ee * L + le * q, re = re * L - G * q, le = le * L - ee * q, G = d, ee = f), k && Math.abs(k) + Math.abs(y) > 359.9 && (k = y = 0, _ = 180 - _), h = nt(Math.sqrt(G * G + re * re + U * U)), m = nt(Math.sqrt(le * le + K * K)), R = Tr(ee, le), C = Math.abs(R) > 2e-4 ? R * ir : 0, x = N ? 1 / (N < 0 ? -N : N) : 0), s.svg && (d = e.getAttribute("transform"), s.forceCSS = e.setAttribute("transform", "") || !Pd(Qs(e, et)), d && e.setAttribute("transform", d))), Math.abs(C) > 90 && Math.abs(C) < 270 && (a ? (h *= -1, C += y <= 0 ? 180 : -180, y += y <= 0 ? 180 : -180) : (m *= -1, C += C <= 0 ? 180 : -180)), t = t || s.uncache, s.x = u - ((s.xPercent = u && (!t && s.xPercent || (Math.round(e.offsetWidth / 2) === Math.round(-u) ? -50 : 0))) ? e.offsetWidth * s.xPercent / 100 : 0) + o, s.y = g - ((s.yPercent = g && (!t && s.yPercent || (Math.round(e.offsetHeight / 2) === Math.round(-g) ? -50 : 0))) ? e.offsetHeight * s.yPercent / 100 : 0) + o, s.z = p + o, s.scaleX = nt(h), s.scaleY = nt(m), s.rotation = nt(y) + n, s.rotationX = nt(k) + n, s.rotationY = nt(_) + n, s.skewX = C + n, s.skewY = T + n, s.transformPerspective = x + o, (s.zOrigin = parseFloat(c.split(" ")[2]) || !t && s.zOrigin || 0) && (i[Qt] = vn(c)), s.xOffset = s.yOffset = 0, s.force3D = ls.force3D, s.renderTransform = s.svg ? rp : Ed ? Md : ip, s.uncache = 0, s;
}, vn = function(e) {
  return (e = e.split(" "))[0] + " " + e[1];
}, Rl = function(e, t, s) {
  var i = Ot(t);
  return nt(parseFloat(t) + parseFloat(Vi(e, "x", s + "px", i))) + i;
}, ip = function(e, t) {
  t.z = "0px", t.rotationY = t.rotationX = "0deg", t.force3D = 0, Md(e, t);
}, Qi = "0deg", ba = "0px", er = ") ", Md = function(e, t) {
  var s = t || this, i = s.xPercent, a = s.yPercent, o = s.x, n = s.y, l = s.z, c = s.rotation, u = s.rotationY, g = s.rotationX, p = s.skewX, h = s.skewY, m = s.scaleX, y = s.scaleY, k = s.transformPerspective, _ = s.force3D, C = s.target, T = s.zOrigin, x = "", S = _ === "auto" && e && e !== 1 || _ === !0;
  if (T && (g !== Qi || u !== Qi)) {
    var O = parseFloat(u) * jr, M = Math.sin(O), R = Math.cos(O), L;
    O = parseFloat(g) * jr, L = Math.cos(O), o = Rl(C, o, M * L * -T), n = Rl(C, n, -Math.sin(O) * -T), l = Rl(C, l, R * L * -T + T);
  }
  k !== ba && (x += "perspective(" + k + er), (i || a) && (x += "translate(" + i + "%, " + a + "%) "), (S || o !== ba || n !== ba || l !== ba) && (x += l !== ba || S ? "translate3d(" + o + ", " + n + ", " + l + ") " : "translate(" + o + ", " + n + er), c !== Qi && (x += "rotate(" + c + er), u !== Qi && (x += "rotateY(" + u + er), g !== Qi && (x += "rotateX(" + g + er), (p !== Qi || h !== Qi) && (x += "skew(" + p + ", " + h + er), (m !== 1 || y !== 1) && (x += "scale(" + m + ", " + y + er), C.style[et] = x || "translate(0, 0)";
}, rp = function(e, t) {
  var s = t || this, i = s.xPercent, a = s.yPercent, o = s.x, n = s.y, l = s.rotation, c = s.skewX, u = s.skewY, g = s.scaleX, p = s.scaleY, h = s.target, m = s.xOrigin, y = s.yOrigin, k = s.xOffset, _ = s.yOffset, C = s.forceCSS, T = parseFloat(o), x = parseFloat(n), S, O, M, R, L;
  l = parseFloat(l), c = parseFloat(c), u = parseFloat(u), u && (u = parseFloat(u), c += u, l += u), l || c ? (l *= jr, c *= jr, S = Math.cos(l) * g, O = Math.sin(l) * g, M = Math.sin(l - c) * -p, R = Math.cos(l - c) * p, c && (u *= jr, L = Math.tan(c - u), L = Math.sqrt(1 + L * L), M *= L, R *= L, u && (L = Math.tan(u), L = Math.sqrt(1 + L * L), S *= L, O *= L)), S = nt(S), O = nt(O), M = nt(M), R = nt(R)) : (S = g, R = p, O = M = 0), (T && !~(o + "").indexOf("px") || x && !~(n + "").indexOf("px")) && (T = Vi(h, "x", o, "px"), x = Vi(h, "y", n, "px")), (m || y || k || _) && (T = nt(T + m - (m * S + y * M) + k), x = nt(x + y - (m * O + y * R) + _)), (i || a) && (L = h.getBBox(), T = nt(T + i / 100 * L.width), x = nt(x + a / 100 * L.height)), L = "matrix(" + S + "," + O + "," + M + "," + R + "," + T + "," + x + ")", h.setAttribute("transform", L), C && (h.style[et] = L);
}, ap = function(e, t, s, i, a) {
  var o = 360, n = wt(a), l = parseFloat(a) * (n && ~a.indexOf("rad") ? ir : 1), c = l - i, u = i + c + "deg", g, p;
  return n && (g = a.split("_")[1], g === "short" && (c %= o, c !== c % (o / 2) && (c += c < 0 ? o : -o)), g === "cw" && c < 0 ? c = (c + o * mh) % o - ~~(c / o) * o : g === "ccw" && c > 0 && (c = (c - o * mh) % o - ~~(c / o) * o)), e._pt = p = new Jt(e._pt, t, s, i, c, jf), p.e = u, p.u = "deg", e._props.push(s), p;
}, _h = function(e, t) {
  for (var s in t)
    e[s] = t[s];
  return e;
}, op = function(e, t, s) {
  var i = _h({}, s._gsap), a = "perspective,force3D,transformOrigin,svgOrigin", o = s.style, n, l, c, u, g, p, h, m;
  i.svg ? (c = s.getAttribute("transform"), s.setAttribute("transform", ""), o[et] = t, n = uo(s, 1), yr(s, et), s.setAttribute("transform", c)) : (c = getComputedStyle(s)[et], o[et] = t, n = uo(s, 1), o[et] = c);
  for (l in Ti)
    c = i[l], u = n[l], c !== u && a.indexOf(l) < 0 && (h = Ot(c), m = Ot(u), g = h !== m ? Vi(s, l, c, m) : parseFloat(c), p = parseFloat(u), e._pt = new Jt(e._pt, n, l, g, p - g, wc), e._pt.u = m || 0, e._props.push(l));
  _h(n, i);
};
Zt("padding,margin,Width,Radius", function(r, e) {
  var t = "Top", s = "Right", i = "Bottom", a = "Left", o = (e < 3 ? [t, s, i, a] : [t + a, t + s, i + s, i + a]).map(function(n) {
    return e < 2 ? r + n : "border" + n + r;
  });
  wn[e > 1 ? "border" + r : r] = function(n, l, c, u, g) {
    var p, h;
    if (arguments.length < 4)
      return p = o.map(function(m) {
        return gi(n, m, c);
      }), h = p.join(" "), h.split(p[0]).length === 5 ? p[0] : h;
    p = (u + "").split(" "), h = {}, o.forEach(function(m, y) {
      return h[m] = p[y] = p[y] || p[(y - 1) / 2 | 0];
    }), n.init(l, h, g);
  };
});
var Od = {
  name: "css",
  register: kc,
  targetTest: function(e) {
    return e.style && e.nodeType;
  },
  init: function(e, t, s, i, a) {
    var o = this._props, n = e.style, l = s.vars.startAt, c, u, g, p, h, m, y, k, _, C, T, x, S, O, M, R;
    yu || kc(), this.styles = this.styles || Sd(e), R = this.styles.props, this.tween = s;
    for (y in t)
      if (y !== "autoRound" && (u = t[y], !(is[y] && pd(y, t, s, i, e, a)))) {
        if (h = typeof u, m = wn[y], h === "function" && (u = u.call(s, i, e, a), h = typeof u), h === "string" && ~u.indexOf("random(") && (u = oo(u)), m)
          m(this, e, y, u, s) && (M = 1);
        else if (y.substr(0, 2) === "--")
          c = (getComputedStyle(e).getPropertyValue(y) + "").trim(), u += "", Ki.lastIndex = 0, Ki.test(c) || (k = Ot(c), _ = Ot(u)), _ ? k !== _ && (c = Vi(e, y, c, _) + _) : k && (u += k), this.add(n, "setProperty", c, u, i, a, 0, 0, y), o.push(y), R.push(y, 0, n[y]);
        else if (h !== "undefined") {
          if (l && y in l ? (c = typeof l[y] == "function" ? l[y].call(s, i, e, a) : l[y], wt(c) && ~c.indexOf("random(") && (c = oo(c)), Ot(c + "") || c === "auto" || (c += ls.units[y] || Ot(gi(e, y)) || ""), (c + "").charAt(1) === "=" && (c = gi(e, y))) : c = gi(e, y), p = parseFloat(c), C = h === "string" && u.charAt(1) === "=" && u.substr(0, 2), C && (u = u.substr(2)), g = parseFloat(u), y in Js && (y === "autoAlpha" && (p === 1 && gi(e, "visibility") === "hidden" && g && (p = 0), R.push("visibility", 0, n.visibility), Ni(this, n, "visibility", p ? "inherit" : "hidden", g ? "inherit" : "hidden", !g)), y !== "scale" && y !== "transform" && (y = Js[y], ~y.indexOf(",") && (y = y.split(",")[0]))), T = y in Ti, T) {
            if (this.styles.save(y), x || (S = e._gsap, S.renderTransform && !t.parseTransform || uo(e, t.parseTransform), O = t.smoothOrigin !== !1 && S.smooth, x = this._pt = new Jt(this._pt, n, et, 0, 1, S.renderTransform, S, 0, -1), x.dep = 1), y === "scale")
              this._pt = new Jt(this._pt, S, "scaleY", S.scaleY, (C ? Hr(S.scaleY, C + g) : g) - S.scaleY || 0, wc), this._pt.u = 0, o.push("scaleY", y), y += "X";
            else if (y === "transformOrigin") {
              R.push(Qt, 0, n[Qt]), u = tp(u), S.svg ? _c(e, u, 0, O, 0, this) : (_ = parseFloat(u.split(" ")[2]) || 0, _ !== S.zOrigin && Ni(this, S, "zOrigin", S.zOrigin, _), Ni(this, n, y, vn(c), vn(u)));
              continue;
            } else if (y === "svgOrigin") {
              _c(e, u, 1, O, 0, this);
              continue;
            } else if (y in Id) {
              ap(this, S, y, p, C ? Hr(p, C + u) : u);
              continue;
            } else if (y === "smoothOrigin") {
              Ni(this, S, "smooth", S.smooth, u);
              continue;
            } else if (y === "force3D") {
              S[y] = u;
              continue;
            } else if (y === "transform") {
              op(this, u, e);
              continue;
            }
          } else
            y in n || (y = ia(y) || y);
          if (T || (g || g === 0) && (p || p === 0) && !Wf.test(u) && y in n)
            k = (c + "").substr((p + "").length), g || (g = 0), _ = Ot(u) || (y in ls.units ? ls.units[y] : k), k !== _ && (p = Vi(e, y, c, _)), this._pt = new Jt(this._pt, T ? S : n, y, p, (C ? Hr(p, C + g) : g) - p, !T && (_ === "px" || y === "zIndex") && t.autoRound !== !1 ? Gf : wc), this._pt.u = _ || 0, k !== _ && _ !== "%" && (this._pt.b = c, this._pt.r = Kf);
          else if (y in n)
            ep.call(this, e, y, c, C ? C + u : u);
          else if (y in e)
            this.add(e, y, c || e[y], C ? C + u : u, i, a);
          else if (y !== "parseTransform") {
            lu(y, u);
            continue;
          }
          T || (y in n ? R.push(y, 0, n[y]) : R.push(y, 1, c || e[y])), o.push(y);
        }
      }
    M && kd(this);
  },
  render: function(e, t) {
    if (t.tween._time || !bu())
      for (var s = t._pt; s; )
        s.r(e, s.d), s = s._next;
    else
      t.styles.revert();
  },
  get: gi,
  aliases: Js,
  getSetter: function(e, t, s) {
    var i = Js[t];
    return i && i.indexOf(",") < 0 && (t = i), t in Ti && t !== Qt && (e._gsap.x || gi(e, "x")) ? s && ph === s ? t === "scale" ? Yf : qf : (ph = s || {}) && (t === "scale" ? Uf : Xf) : e.style && !au(e.style[t]) ? Vf : ~t.indexOf("-") ? zf : pu(e, t);
  },
  core: {
    _removeProperty: yr,
    _getMatrix: vu
  }
};
es.utils.checkPrefix = ia;
es.core.getStyleSaver = Sd;
(function(r, e, t, s) {
  var i = Zt(r + "," + e + "," + t, function(a) {
    Ti[a] = 1;
  });
  Zt(e, function(a) {
    ls.units[a] = "deg", Id[a] = 1;
  }), Js[i[13]] = r + "," + e, Zt(s, function(a) {
    var o = a.split(":");
    Js[o[1]] = i[o[0]];
  });
})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent", "rotation,rotationX,rotationY,skewX,skewY", "transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective", "0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");
Zt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective", function(r) {
  ls.units[r] = "px";
});
es.registerPlugin(Od);
var ht = es.registerPlugin(Od) || es;
ht.core.Tween;
/*!
 * paths 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var np = /[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/ig, lp = /(?:(-)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/ig, cp = /[\+\-]?\d*\.?\d+e[\+\-]?\d+/ig, up = /(^[#\.][a-z]|[a-y][a-z])/i, hp = Math.PI / 180, dp = 180 / Math.PI, Io = Math.sin, Po = Math.cos, _s = Math.abs, pi = Math.sqrt, gp = Math.atan2, Dc = 1e8, Dh = function(e) {
  return typeof e == "string";
}, Fd = function(e) {
  return typeof e == "number";
}, fp = function(e) {
  return typeof e > "u";
}, pp = {}, mp = {}, kn = 1e5, Ld = function(e) {
  return Math.round((e + Dc) % 1 * kn) / kn || (e < 0 ? 0 : 1);
}, Fe = function(e) {
  return Math.round(e * kn) / kn || 0;
}, Th = function(e) {
  return Math.round(e * 1e10) / 1e10 || 0;
}, Ch = function(e, t, s, i) {
  var a = e[t], o = i === 1 ? 6 : Tc(a, s, i);
  if ((o || !i) && o + s + 2 < a.length)
    return e.splice(t, 0, a.slice(0, s + o + 2)), a.splice(0, s + o), 1;
}, Rd = function(e, t, s) {
  var i = e.length, a = ~~(s * i);
  if (e[a] > t) {
    for (; --a && e[a] > t; )
      ;
    a < 0 && (a = 0);
  } else
    for (; e[++a] < t && a < i; )
      ;
  return a < i ? a : i - 1;
}, yp = function(e, t) {
  var s = e.length;
  for (t || e.reverse(); s--; )
    e[s].reversed || vp(e[s]);
}, Sh = function(e, t) {
  return t.totalLength = e.totalLength, e.samples ? (t.samples = e.samples.slice(0), t.lookup = e.lookup.slice(0), t.minLength = e.minLength, t.resolution = e.resolution) : e.totalPoints && (t.totalPoints = e.totalPoints), t;
}, bp = function(e, t) {
  var s = e.length, i = e[s - 1] || [], a = i.length;
  s && t[0] === i[a - 2] && t[1] === i[a - 1] && (t = i.concat(t.slice(2)), s--), e[s] = t;
};
function qo(r) {
  r = Dh(r) && up.test(r) && document.querySelector(r) || r;
  var e = r.getAttribute ? r : 0, t;
  return e && (r = r.getAttribute("d")) ? (e._gsPath || (e._gsPath = {}), t = e._gsPath[r], t && !t._dirty ? t : e._gsPath[r] = ho(r)) : r ? Dh(r) ? ho(r) : Fd(r[0]) ? [r] : r : console.warn("Expecting a <path> element or an SVG path data string");
}
function wp(r) {
  for (var e = [], t = 0; t < r.length; t++)
    e[t] = Sh(r[t], r[t].slice(0));
  return Sh(r, e);
}
function vp(r) {
  var e = 0, t;
  for (r.reverse(); e < r.length; e += 2)
    t = r[e], r[e] = r[e + 1], r[e + 1] = t;
  r.reversed = !r.reversed;
}
var kp = function(e, t) {
  var s = document.createElementNS("http://www.w3.org/2000/svg", "path"), i = [].slice.call(e.attributes), a = i.length, o;
  for (t = "," + t + ","; --a > -1; )
    o = i[a].nodeName.toLowerCase(), t.indexOf("," + o + ",") < 0 && s.setAttributeNS(null, o, i[a].nodeValue);
  return s;
}, _p = {
  rect: "rx,ry,x,y,width,height",
  circle: "r,cx,cy",
  ellipse: "rx,ry,cx,cy",
  line: "x1,x2,y1,y2"
}, Dp = function(e, t) {
  for (var s = t ? t.split(",") : [], i = {}, a = s.length; --a > -1; )
    i[s[a]] = +e.getAttribute(s[a]) || 0;
  return i;
};
function Tp(r, e) {
  var t = r.tagName.toLowerCase(), s = 0.552284749831, i, a, o, n, l, c, u, g, p, h, m, y, k, _, C, T, x, S, O, M, R, L;
  return t === "path" || !r.getBBox ? r : (c = kp(r, "x,y,width,height,cx,cy,rx,ry,r,x1,x2,y1,y2,points"), L = Dp(r, _p[t]), t === "rect" ? (n = L.rx, l = L.ry || n, a = L.x, o = L.y, h = L.width - n * 2, m = L.height - l * 2, n || l ? (y = a + n * (1 - s), k = a + n, _ = k + h, C = _ + n * s, T = _ + n, x = o + l * (1 - s), S = o + l, O = S + m, M = O + l * s, R = O + l, i = "M" + T + "," + S + " V" + O + " C" + [T, M, C, R, _, R, _ - (_ - k) / 3, R, k + (_ - k) / 3, R, k, R, y, R, a, M, a, O, a, O - (O - S) / 3, a, S + (O - S) / 3, a, S, a, x, y, o, k, o, k + (_ - k) / 3, o, _ - (_ - k) / 3, o, _, o, C, o, T, x, T, S].join(",") + "z") : i = "M" + (a + h) + "," + o + " v" + m + " h" + -h + " v" + -m + " h" + h + "z") : t === "circle" || t === "ellipse" ? (t === "circle" ? (n = l = L.r, g = n * s) : (n = L.rx, l = L.ry, g = l * s), a = L.cx, o = L.cy, u = n * s, i = "M" + (a + n) + "," + o + " C" + [a + n, o + g, a + u, o + l, a, o + l, a - u, o + l, a - n, o + g, a - n, o, a - n, o - g, a - u, o - l, a, o - l, a + u, o - l, a + n, o - g, a + n, o].join(",") + "z") : t === "line" ? i = "M" + L.x1 + "," + L.y1 + " L" + L.x2 + "," + L.y2 : (t === "polyline" || t === "polygon") && (p = (r.getAttribute("points") + "").match(lp) || [], a = p.shift(), o = p.shift(), i = "M" + a + "," + o + " L" + p.join(","), t === "polygon" && (i += "," + a + "," + o + "z")), c.setAttribute("d", ku(c._gsRawPath = ho(i))), e && r.parentNode && (r.parentNode.insertBefore(c, r), r.parentNode.removeChild(r)), c);
}
function $d(r, e, t) {
  var s = r[e], i = r[e + 2], a = r[e + 4], o;
  return s += (i - s) * t, i += (a - i) * t, s += (i - s) * t, o = i + (a + (r[e + 6] - a) * t - i) * t - s, s = r[e + 1], i = r[e + 3], a = r[e + 5], s += (i - s) * t, i += (a - i) * t, s += (i - s) * t, Fe(gp(i + (a + (r[e + 7] - a) * t - i) * t - s, o) * dp);
}
function Nd(r, e, t) {
  t = fp(t) ? 1 : Th(t) || 0, e = Th(e) || 0;
  var s = Math.max(0, ~~(_s(t - e) - 1e-8)), i = wp(r);
  if (e > t && (e = 1 - e, t = 1 - t, yp(i), i.totalLength = 0), e < 0 || t < 0) {
    var a = Math.abs(~~Math.min(e, t)) + 1;
    e += a, t += a;
  }
  i.totalLength || gr(i);
  var o = t > 1, n = Eh(i, e, pp, !0), l = Eh(i, t, mp), c = l.segment, u = n.segment, g = l.segIndex, p = n.segIndex, h = l.i, m = n.i, y = p === g, k = h === m && y, _, C, T, x, S, O, M, R;
  if (o || s) {
    for (_ = g < p || y && h < m || k && l.t < n.t, Ch(i, p, m, n.t) && (p++, _ || (g++, k ? (l.t = (l.t - n.t) / (1 - n.t), h = 0) : y && (h -= m))), Math.abs(1 - (t - e)) < 1e-5 ? g = p - 1 : !l.t && g ? g-- : Ch(i, g, h, l.t) && _ && p++, n.t === 1 && (p = (p + 1) % i.length), S = [], O = i.length, M = 1 + O * s, R = p, M += (O - p + g) % O, x = 0; x < M; x++)
      bp(S, i[R++ % O]);
    i = S;
  } else if (T = l.t === 1 ? 6 : Tc(c, h, l.t), e !== t)
    for (C = Tc(u, m, k ? n.t / l.t : n.t), y && (T += C), c.splice(h + T + 2), (C || m) && u.splice(0, m + C), x = i.length; x--; )
      (x < p || x > g) && i.splice(x, 1);
  else
    c.angle = $d(c, h + T, 0), h += T, n = c[h], l = c[h + 1], c.length = c.totalLength = 0, c.totalPoints = i.totalPoints = 8, c.push(n, l, n, l, n, l, n, l);
  return i.totalLength = 0, i;
}
function Cp(r, e, t) {
  e = e || 0, r.samples || (r.samples = [], r.lookup = []);
  var s = ~~r.resolution || 12, i = 1 / s, a = t ? e + t * 6 + 1 : r.length, o = r[e], n = r[e + 1], l = e ? e / 6 * s : 0, c = r.samples, u = r.lookup, g = (e ? r.minLength : Dc) || Dc, p = c[l + t * s - 1], h = e ? c[l - 1] : 0, m, y, k, _, C, T, x, S, O, M, R, L, q, G, re, U, de;
  for (c.length = u.length = 0, y = e + 2; y < a; y += 6) {
    if (k = r[y + 4] - o, _ = r[y + 2] - o, C = r[y] - o, S = r[y + 5] - n, O = r[y + 3] - n, M = r[y + 1] - n, T = x = R = L = 0, _s(k) < 0.01 && _s(S) < 0.01 && _s(C) + _s(M) < 0.01)
      r.length > 8 && (r.splice(y, 6), y -= 6, a -= 6);
    else
      for (m = 1; m <= s; m++)
        G = i * m, q = 1 - G, T = x - (x = (G * G * k + 3 * q * (G * _ + q * C)) * G), R = L - (L = (G * G * S + 3 * q * (G * O + q * M)) * G), U = pi(R * R + T * T), U < g && (g = U), h += U, c[l++] = h;
    o += k, n += S;
  }
  if (p)
    for (p -= h; l < c.length; l++)
      c[l] += p;
  if (c.length && g) {
    if (r.totalLength = de = c[c.length - 1] || 0, r.minLength = g, de / g < 9999)
      for (U = re = 0, m = 0; m < de; m += g)
        u[U++] = c[re] < m ? ++re : re;
  } else
    r.totalLength = c[0] = 0;
  return e ? h - c[e / 2 - 1] : h;
}
function gr(r, e) {
  var t, s, i;
  for (i = t = s = 0; i < r.length; i++)
    r[i].resolution = ~~e || 12, s += r[i].length, t += Cp(r[i]);
  return r.totalPoints = s, r.totalLength = t, r;
}
function Tc(r, e, t) {
  if (t <= 0 || t >= 1)
    return 0;
  var s = r[e], i = r[e + 1], a = r[e + 2], o = r[e + 3], n = r[e + 4], l = r[e + 5], c = r[e + 6], u = r[e + 7], g = s + (a - s) * t, p = a + (n - a) * t, h = i + (o - i) * t, m = o + (l - o) * t, y = g + (p - g) * t, k = h + (m - h) * t, _ = n + (c - n) * t, C = l + (u - l) * t;
  return p += (_ - p) * t, m += (C - m) * t, r.splice(
    e + 2,
    4,
    Fe(g),
    //first control point
    Fe(h),
    Fe(y),
    //second control point
    Fe(k),
    Fe(y + (p - y) * t),
    //new fabricated anchor on line
    Fe(k + (m - k) * t),
    Fe(p),
    //third control point
    Fe(m),
    Fe(_),
    //fourth control point
    Fe(C)
  ), r.samples && r.samples.splice(e / 6 * r.resolution | 0, 0, 0, 0, 0, 0, 0, 0), 6;
}
function Eh(r, e, t, s) {
  t = t || {}, r.totalLength || gr(r), (e < 0 || e > 1) && (e = Ld(e));
  var i = 0, a = r[0], o, n, l, c, u, g, p;
  if (!e)
    p = g = i = 0, a = r[0];
  else if (e === 1)
    p = 1, i = r.length - 1, a = r[i], g = a.length - 8;
  else {
    if (r.length > 1) {
      for (l = r.totalLength * e, u = g = 0; (u += r[g++].totalLength) < l; )
        i = g;
      a = r[i], c = u - a.totalLength, e = (l - c) / (u - c) || 0;
    }
    o = a.samples, n = a.resolution, l = a.totalLength * e, g = a.lookup.length ? a.lookup[~~(l / a.minLength)] || 0 : Rd(o, l, e), c = g ? o[g - 1] : 0, u = o[g], u < l && (c = u, u = o[++g]), p = 1 / n * ((l - c) / (u - c) + g % n), g = ~~(g / n) * 6, s && p === 1 && (g + 6 < a.length ? (g += 6, p = 0) : i + 1 < r.length && (g = p = 0, a = r[++i]));
  }
  return t.t = p, t.i = g, t.path = r, t.segment = a, t.segIndex = i, t;
}
function Ah(r, e, t, s) {
  var i = r[0], a = s || {}, o, n, l, c, u, g, p, h, m;
  if ((e < 0 || e > 1) && (e = Ld(e)), i.lookup || gr(r), r.length > 1) {
    for (l = r.totalLength * e, u = g = 0; (u += r[g++].totalLength) < l; )
      i = r[g];
    c = u - i.totalLength, e = (l - c) / (u - c) || 0;
  }
  return o = i.samples, n = i.resolution, l = i.totalLength * e, g = i.lookup.length ? i.lookup[e < 1 ? ~~(l / i.minLength) : i.lookup.length - 1] || 0 : Rd(o, l, e), c = g ? o[g - 1] : 0, u = o[g], u < l && (c = u, u = o[++g]), p = 1 / n * ((l - c) / (u - c) + g % n) || 0, m = 1 - p, g = ~~(g / n) * 6, h = i[g], a.x = Fe((p * p * (i[g + 6] - h) + 3 * m * (p * (i[g + 4] - h) + m * (i[g + 2] - h))) * p + h), a.y = Fe((p * p * (i[g + 7] - (h = i[g + 1])) + 3 * m * (p * (i[g + 5] - h) + m * (i[g + 3] - h))) * p + h), t && (a.angle = i.totalLength ? $d(i, g, p >= 1 ? 1 - 1e-9 : p || 1e-9) : i.angle || 0), a;
}
function Or(r, e, t, s, i, a, o) {
  for (var n = r.length, l, c, u, g, p; --n > -1; )
    for (l = r[n], c = l.length, u = 0; u < c; u += 2)
      g = l[u], p = l[u + 1], l[u] = g * e + p * s + a, l[u + 1] = g * t + p * i + o;
  return r._dirty = 1, r;
}
function Sp(r, e, t, s, i, a, o, n, l) {
  if (!(r === n && e === l)) {
    t = _s(t), s = _s(s);
    var c = i % 360 * hp, u = Po(c), g = Io(c), p = Math.PI, h = p * 2, m = (r - n) / 2, y = (e - l) / 2, k = u * m + g * y, _ = -g * m + u * y, C = k * k, T = _ * _, x = C / (t * t) + T / (s * s);
    x > 1 && (t = pi(x) * t, s = pi(x) * s);
    var S = t * t, O = s * s, M = (S * O - S * T - O * C) / (S * T + O * C);
    M < 0 && (M = 0);
    var R = (a === o ? -1 : 1) * pi(M), L = R * (t * _ / s), q = R * -(s * k / t), G = (r + n) / 2, re = (e + l) / 2, U = G + (u * L - g * q), de = re + (g * L + u * q), ee = (k - L) / t, le = (_ - q) / s, d = (-k - L) / t, f = (-_ - q) / s, v = ee * ee + le * le, b = (le < 0 ? -1 : 1) * Math.acos(ee / pi(v)), D = (ee * f - le * d < 0 ? -1 : 1) * Math.acos((ee * d + le * f) / pi(v * (d * d + f * f)));
    isNaN(D) && (D = p), !o && D > 0 ? D -= h : o && D < 0 && (D += h), b %= h, D %= h;
    var E = Math.ceil(_s(D) / (h / 4)), P = [], N = D / E, K = 4 / 3 * Io(N / 2) / (1 + Po(N / 2)), j = u * t, ce = g * t, te = g * -s, _e = u * s, ie;
    for (ie = 0; ie < E; ie++)
      i = b + ie * N, k = Po(i), _ = Io(i), ee = Po(i += N), le = Io(i), P.push(k - K * _, _ + K * k, ee + K * le, le - K * ee, ee, le);
    for (ie = 0; ie < P.length; ie += 2)
      k = P[ie], _ = P[ie + 1], P[ie] = k * j + _ * te + U, P[ie + 1] = k * ce + _ * _e + de;
    return P[ie - 2] = n, P[ie - 1] = l, P;
  }
}
function ho(r) {
  var e = (r + "").replace(cp, function(L) {
    var q = +L;
    return q < 1e-4 && q > -1e-4 ? 0 : q;
  }).match(np) || [], t = [], s = 0, i = 0, a = 2 / 3, o = e.length, n = 0, l = "ERROR: malformed path: " + r, c, u, g, p, h, m, y, k, _, C, T, x, S, O, M, R = function(q, G, re, U) {
    C = (re - q) / 3, T = (U - G) / 3, y.push(q + C, G + T, re - C, U - T, re, U);
  };
  if (!r || !isNaN(e[0]) || isNaN(e[1]))
    return console.log(l), t;
  for (c = 0; c < o; c++)
    if (S = h, isNaN(e[c]) ? (h = e[c].toUpperCase(), m = h !== e[c]) : c--, g = +e[c + 1], p = +e[c + 2], m && (g += s, p += i), c || (k = g, _ = p), h === "M")
      y && (y.length < 8 ? t.length -= 1 : n += y.length), s = k = g, i = _ = p, y = [g, p], t.push(y), c += 2, h = "L";
    else if (h === "C")
      y || (y = [0, 0]), m || (s = i = 0), y.push(g, p, s + e[c + 3] * 1, i + e[c + 4] * 1, s += e[c + 5] * 1, i += e[c + 6] * 1), c += 6;
    else if (h === "S")
      C = s, T = i, (S === "C" || S === "S") && (C += s - y[y.length - 4], T += i - y[y.length - 3]), m || (s = i = 0), y.push(C, T, g, p, s += e[c + 3] * 1, i += e[c + 4] * 1), c += 4;
    else if (h === "Q")
      C = s + (g - s) * a, T = i + (p - i) * a, m || (s = i = 0), s += e[c + 3] * 1, i += e[c + 4] * 1, y.push(C, T, s + (g - s) * a, i + (p - i) * a, s, i), c += 4;
    else if (h === "T")
      C = s - y[y.length - 4], T = i - y[y.length - 3], y.push(s + C, i + T, g + (s + C * 1.5 - g) * a, p + (i + T * 1.5 - p) * a, s = g, i = p), c += 2;
    else if (h === "H")
      R(s, i, s = g, i), c += 1;
    else if (h === "V")
      R(s, i, s, i = g + (m ? i - s : 0)), c += 1;
    else if (h === "L" || h === "Z")
      h === "Z" && (g = k, p = _, y.closed = !0), (h === "L" || _s(s - g) > 0.5 || _s(i - p) > 0.5) && (R(s, i, g, p), h === "L" && (c += 2)), s = g, i = p;
    else if (h === "A") {
      if (O = e[c + 4], M = e[c + 5], C = e[c + 6], T = e[c + 7], u = 7, O.length > 1 && (O.length < 3 ? (T = C, C = M, u--) : (T = M, C = O.substr(2), u -= 2), M = O.charAt(1), O = O.charAt(0)), x = Sp(s, i, +e[c + 1], +e[c + 2], +e[c + 3], +O, +M, (m ? s : 0) + C * 1, (m ? i : 0) + T * 1), c += u, x)
        for (u = 0; u < x.length; u++)
          y.push(x[u]);
      s = y[y.length - 2], i = y[y.length - 1];
    } else
      console.log(l);
  return c = y.length, c < 6 ? (t.pop(), c = 0) : y[0] === y[c - 2] && y[1] === y[c - 1] && (y.closed = !0), t.totalPoints = n + c, t;
}
function Ep(r, e) {
  e === void 0 && (e = 1);
  for (var t = r[0], s = 0, i = [t, s], a = 2; a < r.length; a += 2)
    i.push(t, s, r[a], s = (r[a] - t) * e / 2, t = r[a], -s);
  return i;
}
function Cc(r, e) {
  _s(r[0] - r[2]) < 1e-4 && _s(r[1] - r[3]) < 1e-4 && (r = r.slice(2));
  var t = r.length - 2, s = +r[0], i = +r[1], a = +r[2], o = +r[3], n = [s, i, s, i], l = a - s, c = o - i, u = Math.abs(r[t] - s) < 1e-3 && Math.abs(r[t + 1] - i) < 1e-3, g, p, h, m, y, k, _, C, T, x, S, O, M, R, L;
  for (u && (r.push(a, o), a = s, o = i, s = r[t - 2], i = r[t - 1], r.unshift(s, i), t += 4), e = e || e === 0 ? +e : 1, h = 2; h < t; h += 2)
    g = s, p = i, s = a, i = o, a = +r[h + 2], o = +r[h + 3], !(s === a && i === o) && (m = l, y = c, l = a - s, c = o - i, k = pi(m * m + y * y), _ = pi(l * l + c * c), C = pi(Math.pow(l / _ + m / k, 2) + Math.pow(c / _ + y / k, 2)), T = (k + _) * e * 0.25 / C, x = s - (s - g) * (k ? T / k : 0), S = s + (a - s) * (_ ? T / _ : 0), O = s - (x + ((S - x) * (k * 3 / (k + _) + 0.5) / 4 || 0)), M = i - (i - p) * (k ? T / k : 0), R = i + (o - i) * (_ ? T / _ : 0), L = i - (M + ((R - M) * (k * 3 / (k + _) + 0.5) / 4 || 0)), (s !== g || i !== p) && n.push(
      Fe(x + O),
      // first control point
      Fe(M + L),
      Fe(s),
      // anchor
      Fe(i),
      Fe(S + O),
      // second control point
      Fe(R + L)
    ));
  return s !== a || i !== o || n.length < 4 ? n.push(Fe(a), Fe(o), Fe(a), Fe(o)) : n.length -= 2, n.length === 2 ? n.push(s, i, s, i, s, i) : u && (n.splice(0, 6), n.length = n.length - 6), n;
}
function ku(r) {
  Fd(r[0]) && (r = [r]);
  var e = "", t = r.length, s, i, a, o;
  for (i = 0; i < t; i++) {
    for (o = r[i], e += "M" + Fe(o[0]) + "," + Fe(o[1]) + " C", s = o.length, a = 2; a < s; a++)
      e += Fe(o[a++]) + "," + Fe(o[a++]) + " " + Fe(o[a++]) + "," + Fe(o[a++]) + " " + Fe(o[a++]) + "," + Fe(o[a]) + " ";
    o.closed && (e += "z");
  }
  return e;
}
/*!
 * CustomEase 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var Ut, Bd, Hd = function() {
  return Ut || typeof window < "u" && (Ut = window.gsap) && Ut.registerPlugin && Ut;
}, xh = function() {
  Ut = Hd(), Ut ? (Ut.registerEase("_CE", _o.create), Bd = 1) : console.warn("Please gsap.registerPlugin(CustomEase)");
}, Ap = 1e20, Mo = function(e) {
  return ~~(e * 1e3 + (e < 0 ? -0.5 : 0.5)) / 1e3;
}, xp = /[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/gi, Ip = /[cLlsSaAhHvVtTqQ]/g, Pp = function(e) {
  var t = e.length, s = Ap, i;
  for (i = 1; i < t; i += 6)
    +e[i] < s && (s = +e[i]);
  return s;
}, Mp = function(e, t, s) {
  !s && s !== 0 && (s = Math.max(+e[e.length - 1], +e[1]));
  var i = +e[0] * -1, a = -s, o = e.length, n = 1 / (+e[o - 2] + i), l = -t || (Math.abs(+e[o - 1] - +e[1]) < 0.01 * (+e[o - 2] - +e[0]) ? Pp(e) + a : +e[o - 1] + a), c;
  for (l ? l = 1 / l : l = -n, c = 0; c < o; c += 2)
    e[c] = (+e[c] + i) * n, e[c + 1] = (+e[c + 1] + a) * l;
}, Op = function r(e, t, s, i, a, o, n, l, c, u, g) {
  var p = (e + s) / 2, h = (t + i) / 2, m = (s + a) / 2, y = (i + o) / 2, k = (a + n) / 2, _ = (o + l) / 2, C = (p + m) / 2, T = (h + y) / 2, x = (m + k) / 2, S = (y + _) / 2, O = (C + x) / 2, M = (T + S) / 2, R = n - e, L = l - t, q = Math.abs((s - n) * L - (i - l) * R), G = Math.abs((a - n) * L - (o - l) * R), re;
  return u || (u = [{
    x: e,
    y: t
  }, {
    x: n,
    y: l
  }], g = 1), u.splice(g || u.length - 1, 0, {
    x: O,
    y: M
  }), (q + G) * (q + G) > c * (R * R + L * L) && (re = u.length, r(e, t, p, h, C, T, O, M, c, u, g), r(O, M, x, S, k, _, n, l, c, u, g + 1 + (u.length - re))), u;
}, _o = /* @__PURE__ */ function() {
  function r(t, s, i) {
    Bd || xh(), this.id = t, this.setData(s, i);
  }
  var e = r.prototype;
  return e.setData = function(s, i) {
    i = i || {}, s = s || "0,0,1,1";
    var a = s.match(xp), o = 1, n = [], l = [], c = i.precision || 1, u = c <= 1, g, p, h, m, y, k, _, C, T;
    if (this.data = s, (Ip.test(s) || ~s.indexOf("M") && s.indexOf("C") < 0) && (a = ho(s)[0]), g = a.length, g === 4)
      a.unshift(0, 0), a.push(1, 1), g = 8;
    else if ((g - 2) % 6)
      throw "Invalid CustomEase";
    for ((+a[0] != 0 || +a[g - 2] != 1) && Mp(a, i.height, i.originY), this.segment = a, m = 2; m < g; m += 6)
      p = {
        x: +a[m - 2],
        y: +a[m - 1]
      }, h = {
        x: +a[m + 4],
        y: +a[m + 5]
      }, n.push(p, h), Op(p.x, p.y, +a[m], +a[m + 1], +a[m + 2], +a[m + 3], h.x, h.y, 1 / (c * 2e5), n, n.length - 1);
    for (g = n.length, m = 0; m < g; m++)
      _ = n[m], C = n[m - 1] || _, (_.x > C.x || C.y !== _.y && C.x === _.x || _ === C) && _.x <= 1 ? (C.cx = _.x - C.x, C.cy = _.y - C.y, C.n = _, C.nx = _.x, u && m > 1 && Math.abs(C.cy / C.cx - n[m - 2].cy / n[m - 2].cx) > 2 && (u = 0), C.cx < o && (C.cx ? o = C.cx : (C.cx = 1e-3, m === g - 1 && (C.x -= 1e-3, o = Math.min(o, 1e-3), u = 0)))) : (n.splice(m--, 1), g--);
    if (g = 1 / o + 1 | 0, y = 1 / g, k = 0, _ = n[0], u) {
      for (m = 0; m < g; m++)
        T = m * y, _.nx < T && (_ = n[++k]), p = _.y + (T - _.x) / _.cx * _.cy, l[m] = {
          x: T,
          cx: y,
          y: p,
          cy: 0,
          nx: 9
        }, m && (l[m - 1].cy = p - l[m - 1].y);
      l[g - 1].cy = n[n.length - 1].y - p;
    } else {
      for (m = 0; m < g; m++)
        _.nx < m * y && (_ = n[++k]), l[m] = _;
      k < n.length - 1 && (l[m - 1] = n[n.length - 2]);
    }
    return this.ease = function(x) {
      var S = l[x * g | 0] || l[g - 1];
      return S.nx < x && (S = S.n), S.y + (x - S.x) / S.cx * S.cy;
    }, this.ease.custom = this, this.id && Ut && Ut.registerEase(this.id, this.ease), this;
  }, e.getSVGData = function(s) {
    return r.getSVGData(this, s);
  }, r.create = function(s, i, a) {
    return new r(s, i, a).ease;
  }, r.register = function(s) {
    Ut = s, xh();
  }, r.get = function(s) {
    return Ut.parseEase(s);
  }, r.getSVGData = function(s, i) {
    i = i || {};
    var a = i.width || 100, o = i.height || 100, n = i.x || 0, l = (i.y || 0) + o, c = Ut.utils.toArray(i.path)[0], u, g, p, h, m, y, k, _, C, T;
    if (i.invert && (o = -o, l = 0), typeof s == "string" && (s = Ut.parseEase(s)), s.custom && (s = s.custom), s instanceof r)
      u = ku(Or([s.segment], a, 0, 0, -o, n, l));
    else {
      for (u = [n, l], k = Math.max(5, (i.precision || 1) * 200), h = 1 / k, k += 2, _ = 5 / k, C = Mo(n + h * a), T = Mo(l + s(h) * -o), g = (T - l) / (C - n), p = 2; p < k; p++)
        m = Mo(n + p * h * a), y = Mo(l + s(p * h) * -o), (Math.abs((y - T) / (m - C) - g) > _ || p === k - 1) && (u.push(C, T), g = (y - T) / (m - C)), C = m, T = y;
      u = "M" + u.join(",");
    }
    return c && c.setAttribute("d", u), u;
  }, r;
}();
Hd() && Ut.registerPlugin(_o);
_o.version = "3.12.5";
/*!
 * matrix 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var mi, fr, _u, ul, Ca, Yo, _n, Ka, Rs = "transform", Sc = Rs + "Origin", Wd, Du = function(e) {
  var t = e.ownerDocument || e;
  for (!(Rs in e.style) && ("msTransform" in e.style) && (Rs = "msTransform", Sc = Rs + "Origin"); t.parentNode && (t = t.parentNode); )
    ;
  if (fr = window, _n = new Ci(), t) {
    mi = t, _u = t.documentElement, ul = t.body, Ka = mi.createElementNS("http://www.w3.org/2000/svg", "g"), Ka.style.transform = "none";
    var s = t.createElement("div"), i = t.createElement("div"), a = t && (t.body || t.firstElementChild);
    a && a.appendChild && (a.appendChild(s), s.appendChild(i), s.setAttribute("style", "position:static;transform:translate3d(0,0,1px)"), Wd = i.offsetParent !== s, a.removeChild(s));
  }
  return t;
}, Fp = function(e) {
  for (var t, s; e && e !== ul; )
    s = e._gsap, s && s.uncache && s.get(e, "x"), s && !s.scaleX && !s.scaleY && s.renderTransform && (s.scaleX = s.scaleY = 1e-4, s.renderTransform(1, s), t ? t.push(s) : t = [s]), e = e.parentNode;
  return t;
}, jd = [], Kd = [], Tu = function() {
  return fr.pageYOffset || mi.scrollTop || _u.scrollTop || ul.scrollTop || 0;
}, Cu = function() {
  return fr.pageXOffset || mi.scrollLeft || _u.scrollLeft || ul.scrollLeft || 0;
}, Su = function(e) {
  return e.ownerSVGElement || ((e.tagName + "").toLowerCase() === "svg" ? e : null);
}, Lp = function r(e) {
  if (fr.getComputedStyle(e).position === "fixed")
    return !0;
  if (e = e.parentNode, e && e.nodeType === 1)
    return r(e);
}, $l = function r(e, t) {
  if (e.parentNode && (mi || Du(e))) {
    var s = Su(e), i = s ? s.getAttribute("xmlns") || "http://www.w3.org/2000/svg" : "http://www.w3.org/1999/xhtml", a = s ? t ? "rect" : "g" : "div", o = t !== 2 ? 0 : 100, n = t === 3 ? 100 : 0, l = "position:absolute;display:block;pointer-events:none;margin:0;padding:0;", c = mi.createElementNS ? mi.createElementNS(i.replace(/^https/, "http"), a) : mi.createElement(a);
    return t && (s ? (Yo || (Yo = r(e)), c.setAttribute("width", 0.01), c.setAttribute("height", 0.01), c.setAttribute("transform", "translate(" + o + "," + n + ")"), Yo.appendChild(c)) : (Ca || (Ca = r(e), Ca.style.cssText = l), c.style.cssText = l + "width:0.1px;height:0.1px;top:" + n + "px;left:" + o + "px", Ca.appendChild(c))), c;
  }
  throw "Need document and parent.";
}, Rp = function(e) {
  for (var t = new Ci(), s = 0; s < e.numberOfItems; s++)
    t.multiply(e.getItem(s).matrix);
  return t;
}, Gd = function(e) {
  var t = e.getCTM(), s;
  return t || (s = e.style[Rs], e.style[Rs] = "none", e.appendChild(Ka), t = Ka.getCTM(), e.removeChild(Ka), s ? e.style[Rs] = s : e.style.removeProperty(Rs.replace(/([A-Z])/g, "-$1").toLowerCase())), t || _n.clone();
}, $p = function(e, t) {
  var s = Su(e), i = e === s, a = s ? jd : Kd, o = e.parentNode, n, l, c, u, g, p;
  if (e === fr)
    return e;
  if (a.length || a.push($l(e, 1), $l(e, 2), $l(e, 3)), n = s ? Yo : Ca, s)
    i ? (c = Gd(e), u = -c.e / c.a, g = -c.f / c.d, l = _n) : e.getBBox ? (c = e.getBBox(), l = e.transform ? e.transform.baseVal : {}, l = l.numberOfItems ? l.numberOfItems > 1 ? Rp(l) : l.getItem(0).matrix : _n, u = l.a * c.x + l.c * c.y, g = l.b * c.x + l.d * c.y) : (l = new Ci(), u = g = 0), t && e.tagName.toLowerCase() === "g" && (u = g = 0), (i ? s : o).appendChild(n), n.setAttribute("transform", "matrix(" + l.a + "," + l.b + "," + l.c + "," + l.d + "," + (l.e + u) + "," + (l.f + g) + ")");
  else {
    if (u = g = 0, Wd)
      for (l = e.offsetParent, c = e; c && (c = c.parentNode) && c !== l && c.parentNode; )
        (fr.getComputedStyle(c)[Rs] + "").length > 4 && (u = c.offsetLeft, g = c.offsetTop, c = 0);
    if (p = fr.getComputedStyle(e), p.position !== "absolute" && p.position !== "fixed")
      for (l = e.offsetParent; o && o !== l; )
        u += o.scrollLeft || 0, g += o.scrollTop || 0, o = o.parentNode;
    c = n.style, c.top = e.offsetTop - g + "px", c.left = e.offsetLeft - u + "px", c[Rs] = p[Rs], c[Sc] = p[Sc], c.position = p.position === "fixed" ? "fixed" : "absolute", e.parentNode.appendChild(n);
  }
  return n;
}, Nl = function(e, t, s, i, a, o, n) {
  return e.a = t, e.b = s, e.c = i, e.d = a, e.e = o, e.f = n, e;
}, Ci = /* @__PURE__ */ function() {
  function r(t, s, i, a, o, n) {
    t === void 0 && (t = 1), s === void 0 && (s = 0), i === void 0 && (i = 0), a === void 0 && (a = 1), o === void 0 && (o = 0), n === void 0 && (n = 0), Nl(this, t, s, i, a, o, n);
  }
  var e = r.prototype;
  return e.inverse = function() {
    var s = this.a, i = this.b, a = this.c, o = this.d, n = this.e, l = this.f, c = s * o - i * a || 1e-10;
    return Nl(this, o / c, -i / c, -a / c, s / c, (a * l - o * n) / c, -(s * l - i * n) / c);
  }, e.multiply = function(s) {
    var i = this.a, a = this.b, o = this.c, n = this.d, l = this.e, c = this.f, u = s.a, g = s.c, p = s.b, h = s.d, m = s.e, y = s.f;
    return Nl(this, u * i + p * o, u * a + p * n, g * i + h * o, g * a + h * n, l + m * i + y * o, c + m * a + y * n);
  }, e.clone = function() {
    return new r(this.a, this.b, this.c, this.d, this.e, this.f);
  }, e.equals = function(s) {
    var i = this.a, a = this.b, o = this.c, n = this.d, l = this.e, c = this.f;
    return i === s.a && a === s.b && o === s.c && n === s.d && l === s.e && c === s.f;
  }, e.apply = function(s, i) {
    i === void 0 && (i = {});
    var a = s.x, o = s.y, n = this.a, l = this.b, c = this.c, u = this.d, g = this.e, p = this.f;
    return i.x = a * n + o * c + g || 0, i.y = a * l + o * u + p || 0, i;
  }, r;
}();
function tt(r, e, t, s) {
  if (!r || !r.parentNode || (mi || Du(r)).documentElement === r)
    return new Ci();
  var i = Fp(r), a = Su(r), o = a ? jd : Kd, n = $p(r, t), l = o[0].getBoundingClientRect(), c = o[1].getBoundingClientRect(), u = o[2].getBoundingClientRect(), g = n.parentNode, p = !s && Lp(r), h = new Ci((c.left - l.left) / 100, (c.top - l.top) / 100, (u.left - l.left) / 100, (u.top - l.top) / 100, l.left + (p ? 0 : Cu()), l.top + (p ? 0 : Tu()));
  if (g.removeChild(n), i)
    for (l = i.length; l--; )
      c = i[l], c.scaleX = c.scaleY = 0, c.renderTransform(1, c);
  return e ? h.inverse() : h;
}
/*!
 * Flip 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var Np = 1, ra, Mt, Ye, Ga, Li, yi, Ec, Ih = function(e, t) {
  return e.actions.forEach(function(s) {
    return s.vars[t] && s.vars[t](s);
  });
}, Ac = {}, Ph = 180 / Math.PI, Bp = Math.PI / 180, Dn = {}, Mh = {}, hl = {}, Eu = function(e) {
  return typeof e == "string" ? e.split(" ").join("").split(",") : e;
}, Hp = Eu("onStart,onUpdate,onComplete,onReverseComplete,onInterrupt"), dl = Eu("transform,transformOrigin,width,height,position,top,left,opacity,zIndex,maxWidth,maxHeight,minWidth,minHeight"), Va = function(e) {
  return ra(e)[0] || console.warn("Element not found:", e);
}, Fr = function(e) {
  return Math.round(e * 1e4) / 1e4 || 0;
}, Bl = function(e, t, s) {
  return e.forEach(function(i) {
    return i.classList[s](t);
  });
}, Oh = {
  zIndex: 1,
  kill: 1,
  simple: 1,
  spin: 1,
  clearProps: 1,
  targets: 1,
  toggleClass: 1,
  onComplete: 1,
  onUpdate: 1,
  onInterrupt: 1,
  onStart: 1,
  delay: 1,
  repeat: 1,
  repeatDelay: 1,
  yoyo: 1,
  scale: 1,
  fade: 1,
  absolute: 1,
  props: 1,
  onEnter: 1,
  onLeave: 1,
  custom: 1,
  paused: 1,
  nested: 1,
  prune: 1,
  absoluteOnLeave: 1
}, Vd = {
  zIndex: 1,
  simple: 1,
  clearProps: 1,
  scale: 1,
  absolute: 1,
  fitChild: 1,
  getVars: 1,
  props: 1
}, zd = function(e) {
  return e.replace(/([A-Z])/g, "-$1").toLowerCase();
}, Lr = function(e, t) {
  var s = {}, i;
  for (i in e)
    t[i] || (s[i] = e[i]);
  return s;
}, Au = {}, qd = function(e) {
  var t = Au[e] = Eu(e);
  return hl[e] = t.concat(dl), t;
}, Wp = function(e) {
  var t = e._gsap || Mt.core.getCache(e);
  return t.gmCache === Mt.ticker.frame ? t.gMatrix : (t.gmCache = Mt.ticker.frame, t.gMatrix = tt(e, !0, !1, !0));
}, jp = function r(e, t, s) {
  s === void 0 && (s = 0);
  for (var i = e.parentNode, a = 1e3 * Math.pow(10, s) * (t ? -1 : 1), o = t ? -a * 900 : 0; e; )
    o += a, e = e.previousSibling;
  return i ? o + r(i, t, s + 1) : o;
}, Tn = function(e, t, s) {
  return e.forEach(function(i) {
    return i.d = jp(s ? i.element : i.t, t);
  }), e.sort(function(i, a) {
    return i.d - a.d;
  }), e;
}, go = function(e, t) {
  for (var s = e.element.style, i = e.css = e.css || [], a = t.length, o, n; a--; )
    o = t[a], n = s[o] || s.getPropertyValue(o), i.push(n ? o : Mh[o] || (Mh[o] = zd(o)), n);
  return s;
}, Cn = function(e) {
  var t = e.css, s = e.element.style, i = 0;
  for (e.cache.uncache = 1; i < t.length; i += 2)
    t[i + 1] ? s[t[i]] = t[i + 1] : s.removeProperty(t[i]);
  !t[t.indexOf("transform") + 1] && s.translate && (s.removeProperty("translate"), s.removeProperty("scale"), s.removeProperty("rotate"));
}, Fh = function(e, t) {
  e.forEach(function(s) {
    return s.a.cache.uncache = 1;
  }), t || e.finalStates.forEach(Cn);
}, Hl = "paddingTop,paddingRight,paddingBottom,paddingLeft,gridArea,transition".split(","), xu = function(e, t, s) {
  var i = e.element, a = e.width, o = e.height, n = e.uncache, l = e.getProp, c = i.style, u = 4, g, p, h;
  if (typeof t != "object" && (t = e), Ye && s !== 1)
    return Ye._abs.push({
      t: i,
      b: e,
      a: e,
      sd: 0
    }), Ye._final.push(function() {
      return (e.cache.uncache = 1) && Cn(e);
    }), i;
  for (p = l("display") === "none", (!e.isVisible || p) && (p && (go(e, ["display"]).display = t.display), e.matrix = t.matrix, e.width = a = e.width || t.width, e.height = o = e.height || t.height), go(e, Hl), h = window.getComputedStyle(i); u--; )
    c[Hl[u]] = h[Hl[u]];
  if (c.gridArea = "1 / 1 / 1 / 1", c.transition = "none", c.position = "absolute", c.width = a + "px", c.height = o + "px", c.top || (c.top = "0px"), c.left || (c.left = "0px"), n)
    g = new br(i);
  else if (g = Lr(e, Dn), g.position = "absolute", e.simple) {
    var m = i.getBoundingClientRect();
    g.matrix = new Ci(1, 0, 0, 1, m.left + Cu(), m.top + Tu());
  } else
    g.matrix = tt(i, !1, !1, !0);
  return g = Kr(g, e, !0), e.x = yi(g.x, 0.01), e.y = yi(g.y, 0.01), i;
}, Lh = function(e, t) {
  return t !== !0 && (t = ra(t), e = e.filter(function(s) {
    if (t.indexOf((s.sd < 0 ? s.b : s.a).element) !== -1)
      return !0;
    s.t._gsap.renderTransform(1), s.b.isVisible && (s.t.style.width = s.b.width + "px", s.t.style.height = s.b.height + "px");
  })), e;
}, Yd = function(e) {
  return Tn(e, !0).forEach(function(t) {
    return (t.a.isVisible || t.b.isVisible) && xu(t.sd < 0 ? t.b : t.a, t.b, 1);
  });
}, Kp = function(e, t) {
  return t && e.idLookup[xc(t).id] || e.elementStates[0];
}, xc = function(e, t, s, i) {
  return e instanceof br ? e : e instanceof Ns ? Kp(e, i) : new br(typeof e == "string" ? Va(e) || console.warn(e + " not found") : e, t, s);
}, Gp = function(e, t) {
  for (var s = Mt.getProperty(e.element, null, "native"), i = e.props = {}, a = t.length; a--; )
    i[t[a]] = (s(t[a]) + "").trim();
  return i.zIndex && (i.zIndex = parseFloat(i.zIndex) || 0), e;
}, Ud = function(e, t) {
  var s = e.style || e, i;
  for (i in t)
    s[i] = t[i];
}, Vp = function(e) {
  var t = e.getAttribute("data-flip-id");
  return t || e.setAttribute("data-flip-id", t = "auto-" + Np++), t;
}, Xd = function(e) {
  return e.map(function(t) {
    return t.element;
  });
}, Rh = function(e, t, s) {
  return e && t.length && s.add(e(Xd(t), s, new Ns(t, 0, !0)), 0);
}, Kr = function(e, t, s, i, a, o) {
  var n = e.element, l = e.cache, c = e.parent, u = e.x, g = e.y, p = t.width, h = t.height, m = t.scaleX, y = t.scaleY, k = t.rotation, _ = t.bounds, C = o && Ec && Ec(n, "transform"), T = e, x = t.matrix, S = x.e, O = x.f, M = e.bounds.width !== _.width || e.bounds.height !== _.height || e.scaleX !== m || e.scaleY !== y || e.rotation !== k, R = !M && e.simple && t.simple && !a, L, q, G, re, U, de, ee;
  return R || !c ? (m = y = 1, k = L = 0) : (U = Wp(c), de = U.clone().multiply(t.ctm ? t.matrix.clone().multiply(t.ctm) : t.matrix), k = Fr(Math.atan2(de.b, de.a) * Ph), L = Fr(Math.atan2(de.c, de.d) * Ph + k) % 360, m = Math.sqrt(Math.pow(de.a, 2) + Math.pow(de.b, 2)), y = Math.sqrt(Math.pow(de.c, 2) + Math.pow(de.d, 2)) * Math.cos(L * Bp), a && (a = ra(a)[0], re = Mt.getProperty(a), ee = a.getBBox && typeof a.getBBox == "function" && a.getBBox(), T = {
    scaleX: re("scaleX"),
    scaleY: re("scaleY"),
    width: ee ? ee.width : Math.ceil(parseFloat(re("width", "px"))),
    height: ee ? ee.height : parseFloat(re("height", "px"))
  }), l.rotation = k + "deg", l.skewX = L + "deg"), s ? (m *= p === T.width || !T.width ? 1 : p / T.width, y *= h === T.height || !T.height ? 1 : h / T.height, l.scaleX = m, l.scaleY = y) : (p = yi(p * m / T.scaleX, 0), h = yi(h * y / T.scaleY, 0), n.style.width = p + "px", n.style.height = h + "px"), i && Ud(n, t.props), R || !c ? (u += S - e.matrix.e, g += O - e.matrix.f) : M || c !== t.parent ? (l.renderTransform(1, l), de = tt(a || n, !1, !1, !0), q = U.apply({
    x: de.e,
    y: de.f
  }), G = U.apply({
    x: S,
    y: O
  }), u += G.x - q.x, g += G.y - q.y) : (U.e = U.f = 0, G = U.apply({
    x: S - e.matrix.e,
    y: O - e.matrix.f
  }), u += G.x, g += G.y), u = yi(u, 0.02), g = yi(g, 0.02), o && !(o instanceof br) ? C && C.revert() : (l.x = u + "px", l.y = g + "px", l.renderTransform(1, l)), o && (o.x = u, o.y = g, o.rotation = k, o.skewX = L, s ? (o.scaleX = m, o.scaleY = y) : (o.width = p, o.height = h)), o || l;
}, Wl = function(e, t) {
  return e instanceof Ns ? e : new Ns(e, t);
}, Zd = function(e, t, s) {
  var i = e.idLookup[s], a = e.alt[s];
  return a.isVisible && (!(t.getElementState(a.element) || a).isVisible || !i.isVisible) ? a : i;
}, jl = [], Kl = "width,height,overflowX,overflowY".split(","), Oo, $h = function(e) {
  if (e !== Oo) {
    var t = Li.style, s = Li.clientWidth === window.outerWidth, i = Li.clientHeight === window.outerHeight, a = 4;
    if (e && (s || i)) {
      for (; a--; )
        jl[a] = t[Kl[a]];
      s && (t.width = Li.clientWidth + "px", t.overflowY = "hidden"), i && (t.height = Li.clientHeight + "px", t.overflowX = "hidden"), Oo = e;
    } else if (Oo) {
      for (; a--; )
        jl[a] ? t[Kl[a]] = jl[a] : t.removeProperty(zd(Kl[a]));
      Oo = e;
    }
  }
}, Gl = function(e, t, s, i) {
  e instanceof Ns && t instanceof Ns || console.warn("Not a valid state object."), s = s || {};
  var a = s, o = a.clearProps, n = a.onEnter, l = a.onLeave, c = a.absolute, u = a.absoluteOnLeave, g = a.custom, p = a.delay, h = a.paused, m = a.repeat, y = a.repeatDelay, k = a.yoyo, _ = a.toggleClass, C = a.nested, T = a.zIndex, x = a.scale, S = a.fade, O = a.stagger, M = a.spin, R = a.prune, L = ("props" in s ? s : e).props, q = Lr(s, Oh), G = Mt.timeline({
    delay: p,
    paused: h,
    repeat: m,
    repeatDelay: y,
    yoyo: k,
    data: "isFlip"
  }), re = q, U = [], de = [], ee = [], le = [], d = M === !0 ? 1 : M || 0, f = typeof M == "function" ? M : function() {
    return d;
  }, v = e.interrupted || t.interrupted, b = G[i !== 1 ? "to" : "from"], D, E, P, N, K, j, ce, te, _e, ie, pe, we, ye, fe;
  for (E in t.idLookup)
    pe = t.alt[E] ? Zd(t, e, E) : t.idLookup[E], K = pe.element, ie = e.idLookup[E], e.alt[E] && K === ie.element && (e.alt[E].isVisible || !pe.isVisible) && (ie = e.alt[E]), ie ? (j = {
      t: K,
      b: ie,
      a: pe,
      sd: ie.element === K ? 0 : pe.isVisible ? 1 : -1
    }, ee.push(j), j.sd && (j.sd < 0 && (j.b = pe, j.a = ie), v && go(j.b, L ? hl[L] : dl), S && ee.push(j.swap = {
      t: ie.element,
      b: j.b,
      a: j.a,
      sd: -j.sd,
      swap: j
    })), K._flip = ie.element._flip = Ye ? Ye.timeline : G) : pe.isVisible && (ee.push({
      t: K,
      b: Lr(pe, {
        isVisible: 1
      }),
      a: pe,
      sd: 0,
      entering: 1
    }), K._flip = Ye ? Ye.timeline : G);
  if (L && (Au[L] || qd(L)).forEach(function(B) {
    return q[B] = function(De) {
      return ee[De].a.props[B];
    };
  }), ee.finalStates = _e = [], we = function() {
    for (Tn(ee), $h(!0), N = 0; N < ee.length; N++)
      j = ee[N], ye = j.a, fe = j.b, R && !ye.isDifferent(fe) && !j.entering ? ee.splice(N--, 1) : (K = j.t, C && !(j.sd < 0) && N && (ye.matrix = tt(K, !1, !1, !0)), fe.isVisible && ye.isVisible ? (j.sd < 0 ? (ce = new br(K, L, e.simple), Kr(ce, ye, x, 0, 0, ce), ce.matrix = tt(K, !1, !1, !0), ce.css = j.b.css, j.a = ye = ce, S && (K.style.opacity = v ? fe.opacity : ye.opacity), O && le.push(K)) : j.sd > 0 && S && (K.style.opacity = v ? ye.opacity - fe.opacity : "0"), Kr(ye, fe, x, L)) : fe.isVisible !== ye.isVisible && (fe.isVisible ? ye.isVisible || (fe.css = ye.css, de.push(fe), ee.splice(N--, 1), c && C && Kr(ye, fe, x, L)) : (ye.isVisible && U.push(ye), ee.splice(N--, 1))), x || (K.style.maxWidth = Math.max(ye.width, fe.width) + "px", K.style.maxHeight = Math.max(ye.height, fe.height) + "px", K.style.minWidth = Math.min(ye.width, fe.width) + "px", K.style.minHeight = Math.min(ye.height, fe.height) + "px"), C && _ && K.classList.add(_)), _e.push(ye);
    var De;
    if (_ && (De = _e.map(function(be) {
      return be.element;
    }), C && De.forEach(function(be) {
      return be.classList.remove(_);
    })), $h(!1), x ? (q.scaleX = function(be) {
      return ee[be].a.scaleX;
    }, q.scaleY = function(be) {
      return ee[be].a.scaleY;
    }) : (q.width = function(be) {
      return ee[be].a.width + "px";
    }, q.height = function(be) {
      return ee[be].a.height + "px";
    }, q.autoRound = s.autoRound || !1), q.x = function(be) {
      return ee[be].a.x + "px";
    }, q.y = function(be) {
      return ee[be].a.y + "px";
    }, q.rotation = function(be) {
      return ee[be].a.rotation + (M ? f(be, te[be], te) * 360 : 0);
    }, q.skewX = function(be) {
      return ee[be].a.skewX;
    }, te = ee.map(function(be) {
      return be.t;
    }), (T || T === 0) && (q.modifiers = {
      zIndex: function() {
        return T;
      }
    }, q.zIndex = T, q.immediateRender = s.immediateRender !== !1), S && (q.opacity = function(be) {
      return ee[be].sd < 0 ? 0 : ee[be].sd > 0 ? ee[be].a.opacity : "+=0";
    }), le.length) {
      O = Mt.utils.distribute(O);
      var gt = te.slice(le.length);
      q.stagger = function(be, ze) {
        return O(~le.indexOf(ze) ? te.indexOf(ee[be].swap.t) : be, ze, gt);
      };
    }
    if (Hp.forEach(function(be) {
      return s[be] && G.eventCallback(be, s[be], s[be + "Params"]);
    }), g && te.length) {
      re = Lr(q, Oh), "scale" in g && (g.scaleX = g.scaleY = g.scale, delete g.scale);
      for (E in g)
        D = Lr(g[E], Vd), D[E] = q[E], !("duration" in D) && "duration" in q && (D.duration = q.duration), D.stagger = q.stagger, b.call(G, te, D, 0), delete re[E];
    }
    (te.length || de.length || U.length) && (_ && G.add(function() {
      return Bl(De, _, G._zTime < 0 ? "remove" : "add");
    }, 0) && !h && Bl(De, _, "add"), te.length && b.call(G, te, re, 0)), Rh(n, U, G), Rh(l, de, G);
    var Ve = Ye && Ye.timeline;
    Ve && (Ve.add(G, 0), Ye._final.push(function() {
      return Fh(ee, !o);
    })), P = G.duration(), G.call(function() {
      var be = G.time() >= P;
      be && !Ve && Fh(ee, !o), _ && Bl(De, _, be ? "remove" : "add");
    });
  }, u && (c = ee.filter(function(B) {
    return !B.sd && !B.a.isVisible && B.b.isVisible;
  }).map(function(B) {
    return B.a.element;
  })), Ye) {
    var ve;
    c && (ve = Ye._abs).push.apply(ve, Lh(ee, c)), Ye._run.push(we);
  } else
    c && Yd(Lh(ee, c)), we();
  var st = Ye ? Ye.timeline : G;
  return st.revert = function() {
    return Iu(st, 1, 1);
  }, st;
}, zp = function r(e) {
  e.vars.onInterrupt && e.vars.onInterrupt.apply(e, e.vars.onInterruptParams || []), e.getChildren(!0, !1, !0).forEach(r);
}, Iu = function(e, t, s) {
  if (e && e.progress() < 1 && (!e.paused() || s))
    return t && (zp(e), t < 2 && e.progress(1), e.kill()), !0;
}, Fo = function(e) {
  for (var t = e.idLookup = {}, s = e.alt = {}, i = e.elementStates, a = i.length, o; a--; )
    o = i[a], t[o.id] ? s[o.id] = o : t[o.id] = o;
}, Ns = /* @__PURE__ */ function() {
  function r(t, s, i) {
    if (this.props = s && s.props, this.simple = !!(s && s.simple), i)
      this.targets = Xd(t), this.elementStates = t, Fo(this);
    else {
      this.targets = ra(t);
      var a = s && (s.kill === !1 || s.batch && !s.kill);
      Ye && !a && Ye._kill.push(this), this.update(a || !!Ye);
    }
  }
  var e = r.prototype;
  return e.update = function(s) {
    var i = this;
    return this.elementStates = this.targets.map(function(a) {
      return new br(a, i.props, i.simple);
    }), Fo(this), this.interrupt(s), this.recordInlineStyles(), this;
  }, e.clear = function() {
    return this.targets.length = this.elementStates.length = 0, Fo(this), this;
  }, e.fit = function(s, i, a) {
    for (var o = Tn(this.elementStates.slice(0), !1, !0), n = (s || this).idLookup, l = 0, c, u; l < o.length; l++)
      c = o[l], a && (c.matrix = tt(c.element, !1, !1, !0)), u = n[c.id], u && Kr(c, u, i, !0, 0, c), c.matrix = tt(c.element, !1, !1, !0);
    return this;
  }, e.getProperty = function(s, i) {
    var a = this.getElementState(s) || Dn;
    return (i in a ? a : a.props || Dn)[i];
  }, e.add = function(s) {
    for (var i = s.targets.length, a = this.idLookup, o = this.alt, n, l, c; i--; )
      l = s.elementStates[i], c = a[l.id], c && (l.element === c.element || o[l.id] && o[l.id].element === l.element) ? (n = this.elementStates.indexOf(l.element === c.element ? c : o[l.id]), this.targets.splice(n, 1, s.targets[i]), this.elementStates.splice(n, 1, l)) : (this.targets.push(s.targets[i]), this.elementStates.push(l));
    return s.interrupted && (this.interrupted = !0), s.simple || (this.simple = !1), Fo(this), this;
  }, e.compare = function(s) {
    var i = s.idLookup, a = this.idLookup, o = [], n = [], l = [], c = [], u = [], g = s.alt, p = this.alt, h = function(R, L, q) {
      return (R.isVisible !== L.isVisible ? R.isVisible ? l : c : R.isVisible ? n : o).push(q) && u.push(q);
    }, m = function(R, L, q) {
      return u.indexOf(q) < 0 && h(R, L, q);
    }, y, k, _, C, T, x, S, O;
    for (_ in i)
      T = g[_], x = p[_], y = T ? Zd(s, this, _) : i[_], C = y.element, k = a[_], x ? (O = k.isVisible || !x.isVisible && C === k.element ? k : x, S = T && !y.isVisible && !T.isVisible && O.element === T.element ? T : y, S.isVisible && O.isVisible && S.element !== O.element ? ((S.isDifferent(O) ? n : o).push(S.element, O.element), u.push(S.element, O.element)) : h(S, O, S.element), T && S.element === T.element && (T = i[_]), m(S.element !== k.element && T ? T : S, k, k.element), m(T && T.element === x.element ? T : S, x, x.element), T && m(T, x.element === T.element ? x : k, T.element)) : (k ? k.isDifferent(y) ? h(y, k, C) : o.push(C) : l.push(C), T && m(T, k, T.element));
    for (_ in a)
      i[_] || (c.push(a[_].element), p[_] && c.push(p[_].element));
    return {
      changed: n,
      unchanged: o,
      enter: l,
      leave: c
    };
  }, e.recordInlineStyles = function() {
    for (var s = hl[this.props] || dl, i = this.elementStates.length; i--; )
      go(this.elementStates[i], s);
  }, e.interrupt = function(s) {
    var i = this, a = [];
    this.targets.forEach(function(o) {
      var n = o._flip, l = Iu(n, s ? 0 : 1);
      s && l && a.indexOf(n) < 0 && n.add(function() {
        return i.updateVisibility();
      }), l && a.push(n);
    }), !s && a.length && this.updateVisibility(), this.interrupted || (this.interrupted = !!a.length);
  }, e.updateVisibility = function() {
    this.elementStates.forEach(function(s) {
      var i = s.element.getBoundingClientRect();
      s.isVisible = !!(i.width || i.height || i.top || i.left), s.uncache = 1;
    });
  }, e.getElementState = function(s) {
    return this.elementStates[this.targets.indexOf(Va(s))];
  }, e.makeAbsolute = function() {
    return Tn(this.elementStates.slice(0), !0, !0).map(xu);
  }, r;
}(), br = /* @__PURE__ */ function() {
  function r(t, s, i) {
    this.element = t, this.update(s, i);
  }
  var e = r.prototype;
  return e.isDifferent = function(s) {
    var i = this.bounds, a = s.bounds;
    return i.top !== a.top || i.left !== a.left || i.width !== a.width || i.height !== a.height || !this.matrix.equals(s.matrix) || this.opacity !== s.opacity || this.props && s.props && JSON.stringify(this.props) !== JSON.stringify(s.props);
  }, e.update = function(s, i) {
    var a = this, o = a.element, n = Mt.getProperty(o), l = Mt.core.getCache(o), c = o.getBoundingClientRect(), u = o.getBBox && typeof o.getBBox == "function" && o.nodeName.toLowerCase() !== "svg" && o.getBBox(), g = i ? new Ci(1, 0, 0, 1, c.left + Cu(), c.top + Tu()) : tt(o, !1, !1, !0);
    a.getProp = n, a.element = o, a.id = Vp(o), a.matrix = g, a.cache = l, a.bounds = c, a.isVisible = !!(c.width || c.height || c.left || c.top), a.display = n("display"), a.position = n("position"), a.parent = o.parentNode, a.x = n("x"), a.y = n("y"), a.scaleX = l.scaleX, a.scaleY = l.scaleY, a.rotation = n("rotation"), a.skewX = n("skewX"), a.opacity = n("opacity"), a.width = u ? u.width : yi(n("width", "px"), 0.04), a.height = u ? u.height : yi(n("height", "px"), 0.04), s && Gp(a, Au[s] || qd(s)), a.ctm = o.getCTM && o.nodeName.toLowerCase() === "svg" && Gd(o).inverse(), a.simple = i || Fr(g.a) === 1 && !Fr(g.b) && !Fr(g.c) && Fr(g.d) === 1, a.uncache = 0;
  }, r;
}(), qp = /* @__PURE__ */ function() {
  function r(t, s) {
    this.vars = t, this.batch = s, this.states = [], this.timeline = s.timeline;
  }
  var e = r.prototype;
  return e.getStateById = function(s) {
    for (var i = this.states.length; i--; )
      if (this.states[i].idLookup[s])
        return this.states[i];
  }, e.kill = function() {
    this.batch.remove(this);
  }, r;
}(), Yp = /* @__PURE__ */ function() {
  function r(t) {
    this.id = t, this.actions = [], this._kill = [], this._final = [], this._abs = [], this._run = [], this.data = {}, this.state = new Ns(), this.timeline = Mt.timeline();
  }
  var e = r.prototype;
  return e.add = function(s) {
    var i = this.actions.filter(function(a) {
      return a.vars === s;
    });
    return i.length ? i[0] : (i = new qp(typeof s == "function" ? {
      animate: s
    } : s, this), this.actions.push(i), i);
  }, e.remove = function(s) {
    var i = this.actions.indexOf(s);
    return i >= 0 && this.actions.splice(i, 1), this;
  }, e.getState = function(s) {
    var i = this, a = Ye, o = Ga;
    return Ye = this, this.state.clear(), this._kill.length = 0, this.actions.forEach(function(n) {
      n.vars.getState && (n.states.length = 0, Ga = n, n.state = n.vars.getState(n)), s && n.states.forEach(function(l) {
        return i.state.add(l);
      });
    }), Ga = o, Ye = a, this.killConflicts(), this;
  }, e.animate = function() {
    var s = this, i = Ye, a = this.timeline, o = this.actions.length, n, l;
    for (Ye = this, a.clear(), this._abs.length = this._final.length = this._run.length = 0, this.actions.forEach(function(c) {
      c.vars.animate && c.vars.animate(c);
      var u = c.vars.onEnter, g = c.vars.onLeave, p = c.targets, h, m;
      p && p.length && (u || g) && (h = new Ns(), c.states.forEach(function(y) {
        return h.add(y);
      }), m = h.compare(Do.getState(p)), m.enter.length && u && u(m.enter), m.leave.length && g && g(m.leave));
    }), Yd(this._abs), this._run.forEach(function(c) {
      return c();
    }), l = a.duration(), n = this._final.slice(0), a.add(function() {
      l <= a.time() && (n.forEach(function(c) {
        return c();
      }), Ih(s, "onComplete"));
    }), Ye = i; o--; )
      this.actions[o].vars.once && this.actions[o].kill();
    return Ih(this, "onStart"), a.restart(), this;
  }, e.loadState = function(s) {
    s || (s = function() {
      return 0;
    });
    var i = [];
    return this.actions.forEach(function(a) {
      if (a.vars.loadState) {
        var o, n = function l(c) {
          c && (a.targets = c), o = i.indexOf(l), ~o && (i.splice(o, 1), i.length || s());
        };
        i.push(n), a.vars.loadState(n);
      }
    }), i.length || s(), this;
  }, e.setState = function() {
    return this.actions.forEach(function(s) {
      return s.targets = s.vars.setState && s.vars.setState(s);
    }), this;
  }, e.killConflicts = function(s) {
    return this.state.interrupt(s), this._kill.forEach(function(i) {
      return i.interrupt(s);
    }), this;
  }, e.run = function(s, i) {
    var a = this;
    return this !== Ye && (s || this.getState(i), this.loadState(function() {
      a._killed || (a.setState(), a.animate());
    })), this;
  }, e.clear = function(s) {
    this.state.clear(), s || (this.actions.length = 0);
  }, e.getStateById = function(s) {
    for (var i = this.actions.length, a; i--; )
      if (a = this.actions[i].getStateById(s), a)
        return a;
    return this.state.idLookup[s] && this.state;
  }, e.kill = function() {
    this._killed = 1, this.clear(), delete Ac[this.id];
  }, r;
}(), Do = /* @__PURE__ */ function() {
  function r() {
  }
  return r.getState = function(t, s) {
    var i = Wl(t, s);
    return Ga && Ga.states.push(i), s && s.batch && r.batch(s.batch).state.add(i), i;
  }, r.from = function(t, s) {
    return s = s || {}, "clearProps" in s || (s.clearProps = !0), Gl(t, Wl(s.targets || t.targets, {
      props: s.props || t.props,
      simple: s.simple,
      kill: !!s.kill
    }), s, -1);
  }, r.to = function(t, s) {
    return Gl(t, Wl(s.targets || t.targets, {
      props: s.props || t.props,
      simple: s.simple,
      kill: !!s.kill
    }), s, 1);
  }, r.fromTo = function(t, s, i) {
    return Gl(t, s, i);
  }, r.fit = function(t, s, i) {
    var a = i ? Lr(i, Vd) : {}, o = i || a, n = o.absolute, l = o.scale, c = o.getVars, u = o.props, g = o.runBackwards, p = o.onComplete, h = o.simple, m = i && i.fitChild && Va(i.fitChild), y = xc(s, u, h, t), k = xc(t, 0, h, y), _ = u ? hl[u] : dl, C = Mt.context();
    return u && Ud(a, y.props), go(k, _), g && ("immediateRender" in a || (a.immediateRender = !0), a.onComplete = function() {
      Cn(k), p && p.apply(this, arguments);
    }), n && xu(k, y), a = Kr(k, y, l || m, u, m, a.duration || c ? a : 0), C && !c && C.add(function() {
      return function() {
        return Cn(k);
      };
    }), c ? a : a.duration ? Mt.to(k.element, a) : null;
  }, r.makeAbsolute = function(t, s) {
    return (t instanceof Ns ? t : new Ns(t, s)).makeAbsolute();
  }, r.batch = function(t) {
    return t || (t = "default"), Ac[t] || (Ac[t] = new Yp(t));
  }, r.killFlipsOf = function(t, s) {
    (t instanceof Ns ? t.targets : ra(t)).forEach(function(i) {
      return i && Iu(i._flip, s !== !1 ? 1 : 2);
    });
  }, r.isFlipping = function(t) {
    var s = r.getByTarget(t);
    return !!s && s.isActive();
  }, r.getByTarget = function(t) {
    return (Va(t) || Dn)._flip;
  }, r.getElementState = function(t, s) {
    return new br(Va(t), s);
  }, r.convertCoordinates = function(t, s, i) {
    var a = tt(s, !0, !0).multiply(tt(t));
    return i ? a.apply(i) : a;
  }, r.register = function(t) {
    if (Li = typeof document < "u" && document.body, Li) {
      Mt = t, Du(Li), ra = Mt.utils.toArray, Ec = Mt.core.getStyleSaver;
      var s = Mt.utils.snap(0.1);
      yi = function(a, o) {
        return s(parseFloat(a) + o);
      };
    }
  }, r;
}();
Do.version = "3.12.5";
typeof window < "u" && window.gsap && window.gsap.registerPlugin(Do);
function Nh(r, e) {
  for (var t = 0; t < e.length; t++) {
    var s = e[t];
    s.enumerable = s.enumerable || !1, s.configurable = !0, "value" in s && (s.writable = !0), Object.defineProperty(r, s.key, s);
  }
}
function Up(r, e, t) {
  return e && Nh(r.prototype, e), t && Nh(r, t), r;
}
/*!
 * Observer 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var Et, Uo, as, Bi, Hi, Gr, Jd, rr, za, Qd, bi, Ps, e1, t1 = function() {
  return Et || typeof window < "u" && (Et = window.gsap) && Et.registerPlugin && Et;
}, s1 = 1, Rr = [], bs = [], qa = [], Ya = Date.now, Ic = function(e, t) {
  return t;
}, Xp = function() {
  var e = za.core, t = e.bridge || {}, s = e._scrollers, i = e._proxies;
  s.push.apply(s, bs), i.push.apply(i, qa), bs = s, qa = i, Ic = function(o, n) {
    return t[o](n);
  };
}, Zp = function(e, t) {
  return ~qa.indexOf(e) && qa[qa.indexOf(e) + 1][t];
}, Ua = function(e) {
  return !!~Qd.indexOf(e);
}, Bt = function(e, t, s, i, a) {
  return e.addEventListener(t, s, {
    passive: i !== !1,
    capture: !!a
  });
}, Nt = function(e, t, s, i) {
  return e.removeEventListener(t, s, !!i);
}, Lo = "scrollLeft", Ro = "scrollTop", Pc = function() {
  return bi && bi.isPressed || bs.cache++;
}, Sn = function(e, t) {
  var s = function i(a) {
    if (a || a === 0) {
      s1 && (as.history.scrollRestoration = "manual");
      var o = bi && bi.isPressed;
      a = i.v = Math.round(a) || (bi && bi.iOS ? 1 : 0), e(a), i.cacheID = bs.cache, o && Ic("ss", a);
    } else
      (t || bs.cache !== i.cacheID || Ic("ref")) && (i.cacheID = bs.cache, i.v = e());
    return i.v + i.offset;
  };
  return s.offset = 0, e && s;
}, En = {
  s: Lo,
  p: "left",
  p2: "Left",
  os: "right",
  os2: "Right",
  d: "width",
  d2: "Width",
  a: "x",
  sc: Sn(function(r) {
    return arguments.length ? as.scrollTo(r, gl.sc()) : as.pageXOffset || Bi[Lo] || Hi[Lo] || Gr[Lo] || 0;
  })
}, gl = {
  s: Ro,
  p: "top",
  p2: "Top",
  os: "bottom",
  os2: "Bottom",
  d: "height",
  d2: "Height",
  a: "y",
  op: En,
  sc: Sn(function(r) {
    return arguments.length ? as.scrollTo(En.sc(), r) : as.pageYOffset || Bi[Ro] || Hi[Ro] || Gr[Ro] || 0;
  })
}, Jp = function(e, t) {
  return (t && t._ctx && t._ctx.selector || Et.utils.toArray)(e)[0] || (typeof e == "string" && Et.config().nullTargetWarn !== !1 ? console.warn("Element not found:", e) : null);
}, Bh = function(e, t) {
  var s = t.s, i = t.sc;
  Ua(e) && (e = Bi.scrollingElement || Hi);
  var a = bs.indexOf(e), o = i === gl.sc ? 1 : 2;
  !~a && (a = bs.push(e) - 1), bs[a + o] || Bt(e, "scroll", Pc);
  var n = bs[a + o], l = n || (bs[a + o] = Sn(Zp(e, s), !0) || (Ua(e) ? i : Sn(function(c) {
    return arguments.length ? e[s] = c : e[s];
  })));
  return l.target = e, n || (l.smooth = Et.getProperty(e, "scrollBehavior") === "smooth"), l;
}, Hh = function(e, t, s) {
  var i = e, a = e, o = Ya(), n = o, l = t || 50, c = Math.max(500, l * 3), u = function(m, y) {
    var k = Ya();
    y || k - o > l ? (a = i, i = m, n = o, o = k) : s ? i += m : i = a + (m - a) / (k - n) * (o - n);
  }, g = function() {
    a = i = s ? 0 : i, n = o = 0;
  }, p = function(m) {
    var y = n, k = a, _ = Ya();
    return (m || m === 0) && m !== i && u(m), o === n || _ - n > c ? 0 : (i + (s ? k : -k)) / ((s ? _ : o) - y) * 1e3;
  };
  return {
    update: u,
    reset: g,
    getVelocity: p
  };
}, wa = function(e, t) {
  return t && !e._gsapAllow && e.preventDefault(), e.changedTouches ? e.changedTouches[0] : e;
}, Wh = function(e) {
  var t = Math.max.apply(Math, e), s = Math.min.apply(Math, e);
  return Math.abs(t) >= Math.abs(s) ? t : s;
}, i1 = function() {
  za = Et.core.globals().ScrollTrigger, za && za.core && Xp();
}, r1 = function(e) {
  return Et = e || t1(), !Uo && Et && typeof document < "u" && document.body && (as = window, Bi = document, Hi = Bi.documentElement, Gr = Bi.body, Qd = [as, Bi, Hi, Gr], Et.utils.clamp, e1 = Et.core.context || function() {
  }, rr = "onpointerenter" in Gr ? "pointer" : "mouse", Jd = Ks.isTouch = as.matchMedia && as.matchMedia("(hover: none), (pointer: coarse)").matches ? 1 : "ontouchstart" in as || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0 ? 2 : 0, Ps = Ks.eventTypes = ("ontouchstart" in Hi ? "touchstart,touchmove,touchcancel,touchend" : "onpointerdown" in Hi ? "pointerdown,pointermove,pointercancel,pointerup" : "mousedown,mousemove,mouseup,mouseup").split(","), setTimeout(function() {
    return s1 = 0;
  }, 500), i1(), Uo = 1), Uo;
};
En.op = gl;
bs.cache = 0;
var Ks = /* @__PURE__ */ function() {
  function r(t) {
    this.init(t);
  }
  var e = r.prototype;
  return e.init = function(s) {
    Uo || r1(Et) || console.warn("Please gsap.registerPlugin(Observer)"), za || i1();
    var i = s.tolerance, a = s.dragMinimum, o = s.type, n = s.target, l = s.lineHeight, c = s.debounce, u = s.preventDefault, g = s.onStop, p = s.onStopDelay, h = s.ignore, m = s.wheelSpeed, y = s.event, k = s.onDragStart, _ = s.onDragEnd, C = s.onDrag, T = s.onPress, x = s.onRelease, S = s.onRight, O = s.onLeft, M = s.onUp, R = s.onDown, L = s.onChangeX, q = s.onChangeY, G = s.onChange, re = s.onToggleX, U = s.onToggleY, de = s.onHover, ee = s.onHoverEnd, le = s.onMove, d = s.ignoreCheck, f = s.isNormalizer, v = s.onGestureStart, b = s.onGestureEnd, D = s.onWheel, E = s.onEnable, P = s.onDisable, N = s.onClick, K = s.scrollSpeed, j = s.capture, ce = s.allowClicks, te = s.lockAxis, _e = s.onLockAxis;
    this.target = n = Jp(n) || Hi, this.vars = s, h && (h = Et.utils.toArray(h)), i = i || 1e-9, a = a || 0, m = m || 1, K = K || 1, o = o || "wheel,touch,pointer", c = c !== !1, l || (l = parseFloat(as.getComputedStyle(Gr).lineHeight) || 22);
    var ie, pe, we, ye, fe, ve, st, B = this, De = 0, gt = 0, Ve = s.passive || !u, be = Bh(n, En), ze = Bh(n, gl), Gs = be(), Ui = ze(), Eo = ~o.indexOf("touch") && !~o.indexOf("pointer") && Ps[0] === "pointerdown", $t = Ua(n), qe = n.ownerDocument || Bi, Ss = [0, 0, 0], ri = [0, 0, 0], _r = 0, Ao = function() {
      return _r = Ya();
    }, ai = function(W, V) {
      return (B.event = W) && h && ~h.indexOf(W.target) || V && Eo && W.pointerType !== "touch" || d && d(W, V);
    }, ga = function() {
      B._vx.reset(), B._vy.reset(), pe.pause(), g && g(B);
    }, Xi = function() {
      var W = B.deltaX = Wh(Ss), V = B.deltaY = Wh(ri), Q = Math.abs(W) >= i, me = Math.abs(V) >= i;
      G && (Q || me) && G(B, W, V, Ss, ri), Q && (S && B.deltaX > 0 && S(B), O && B.deltaX < 0 && O(B), L && L(B), re && B.deltaX < 0 != De < 0 && re(B), De = B.deltaX, Ss[0] = Ss[1] = Ss[2] = 0), me && (R && B.deltaY > 0 && R(B), M && B.deltaY < 0 && M(B), q && q(B), U && B.deltaY < 0 != gt < 0 && U(B), gt = B.deltaY, ri[0] = ri[1] = ri[2] = 0), (ye || we) && (le && le(B), we && (C(B), we = !1), ye = !1), ve && !(ve = !1) && _e && _e(B), fe && (D(B), fe = !1), ie = 0;
    }, Zi = function(W, V, Q) {
      Ss[Q] += W, ri[Q] += V, B._vx.update(W), B._vy.update(V), c ? ie || (ie = requestAnimationFrame(Xi)) : Xi();
    }, Ei = function(W, V) {
      te && !st && (B.axis = st = Math.abs(W) > Math.abs(V) ? "x" : "y", ve = !0), st !== "y" && (Ss[2] += W, B._vx.update(W, !0)), st !== "x" && (ri[2] += V, B._vy.update(V, !0)), c ? ie || (ie = requestAnimationFrame(Xi)) : Xi();
    }, fa = function(W) {
      if (!ai(W, 1)) {
        W = wa(W, u);
        var V = W.clientX, Q = W.clientY, me = V - B.x, ne = Q - B.y, Pe = B.isDragging;
        B.x = V, B.y = Q, (Pe || Math.abs(B.startX - V) >= a || Math.abs(B.startY - Q) >= a) && (C && (we = !0), Pe || (B.isDragging = !0), Ei(me, ne), Pe || k && k(B));
      }
    }, oi = B.onPress = function(F) {
      ai(F, 1) || F && F.button || (B.axis = st = null, pe.pause(), B.isPressed = !0, F = wa(F), De = gt = 0, B.startX = B.x = F.clientX, B.startY = B.y = F.clientY, B._vx.reset(), B._vy.reset(), Bt(f ? n : qe, Ps[1], fa, Ve, !0), B.deltaX = B.deltaY = 0, T && T(B));
    }, hs = B.onRelease = function(F) {
      if (!ai(F, 1)) {
        Nt(f ? n : qe, Ps[1], fa, !0);
        var W = !isNaN(B.y - B.startY), V = B.isDragging, Q = V && (Math.abs(B.x - B.startX) > 3 || Math.abs(B.y - B.startY) > 3), me = wa(F);
        !Q && W && (B._vx.reset(), B._vy.reset(), u && ce && Et.delayedCall(0.08, function() {
          if (Ya() - _r > 300 && !F.defaultPrevented) {
            if (F.target.click)
              F.target.click();
            else if (qe.createEvent) {
              var ne = qe.createEvent("MouseEvents");
              ne.initMouseEvent("click", !0, !0, as, 1, me.screenX, me.screenY, me.clientX, me.clientY, !1, !1, !1, !1, 0, null), F.target.dispatchEvent(ne);
            }
          }
        })), B.isDragging = B.isGesturing = B.isPressed = !1, g && V && !f && pe.restart(!0), _ && V && _(B), x && x(B, Q);
      }
    }, Ai = function(W) {
      return W.touches && W.touches.length > 1 && (B.isGesturing = !0) && v(W, B.isDragging);
    }, Gt = function() {
      return (B.isGesturing = !1) || b(B);
    }, Ji = function(W) {
      if (!ai(W)) {
        var V = be(), Q = ze();
        Zi((V - Gs) * K, (Q - Ui) * K, 1), Gs = V, Ui = Q, g && pe.restart(!0);
      }
    }, pa = function(W) {
      if (!ai(W)) {
        W = wa(W, u), D && (fe = !0);
        var V = (W.deltaMode === 1 ? l : W.deltaMode === 2 ? as.innerHeight : 1) * m;
        Zi(W.deltaX * V, W.deltaY * V, 0), g && !f && pe.restart(!0);
      }
    }, ma = function(W) {
      if (!ai(W)) {
        var V = W.clientX, Q = W.clientY, me = V - B.x, ne = Q - B.y;
        B.x = V, B.y = Q, ye = !0, g && pe.restart(!0), (me || ne) && Ei(me, ne);
      }
    }, ue = function(W) {
      B.event = W, de(B);
    }, I = function(W) {
      B.event = W, ee(B);
    }, Y = function(W) {
      return ai(W) || wa(W, u) && N(B);
    };
    pe = B._dc = Et.delayedCall(p || 0.25, ga).pause(), B.deltaX = B.deltaY = 0, B._vx = Hh(0, 50, !0), B._vy = Hh(0, 50, !0), B.scrollX = be, B.scrollY = ze, B.isDragging = B.isGesturing = B.isPressed = !1, e1(this), B.enable = function(F) {
      return B.isEnabled || (Bt($t ? qe : n, "scroll", Pc), o.indexOf("scroll") >= 0 && Bt($t ? qe : n, "scroll", Ji, Ve, j), o.indexOf("wheel") >= 0 && Bt(n, "wheel", pa, Ve, j), (o.indexOf("touch") >= 0 && Jd || o.indexOf("pointer") >= 0) && (Bt(n, Ps[0], oi, Ve, j), Bt(qe, Ps[2], hs), Bt(qe, Ps[3], hs), ce && Bt(n, "click", Ao, !0, !0), N && Bt(n, "click", Y), v && Bt(qe, "gesturestart", Ai), b && Bt(qe, "gestureend", Gt), de && Bt(n, rr + "enter", ue), ee && Bt(n, rr + "leave", I), le && Bt(n, rr + "move", ma)), B.isEnabled = !0, F && F.type && oi(F), E && E(B)), B;
    }, B.disable = function() {
      B.isEnabled && (Rr.filter(function(F) {
        return F !== B && Ua(F.target);
      }).length || Nt($t ? qe : n, "scroll", Pc), B.isPressed && (B._vx.reset(), B._vy.reset(), Nt(f ? n : qe, Ps[1], fa, !0)), Nt($t ? qe : n, "scroll", Ji, j), Nt(n, "wheel", pa, j), Nt(n, Ps[0], oi, j), Nt(qe, Ps[2], hs), Nt(qe, Ps[3], hs), Nt(n, "click", Ao, !0), Nt(n, "click", Y), Nt(qe, "gesturestart", Ai), Nt(qe, "gestureend", Gt), Nt(n, rr + "enter", ue), Nt(n, rr + "leave", I), Nt(n, rr + "move", ma), B.isEnabled = B.isPressed = B.isDragging = !1, P && P(B));
    }, B.kill = B.revert = function() {
      B.disable();
      var F = Rr.indexOf(B);
      F >= 0 && Rr.splice(F, 1), bi === B && (bi = 0);
    }, Rr.push(B), f && Ua(n) && (bi = B), B.enable(y);
  }, Up(r, [{
    key: "velocityX",
    get: function() {
      return this._vx.getVelocity();
    }
  }, {
    key: "velocityY",
    get: function() {
      return this._vy.getVelocity();
    }
  }]), r;
}();
Ks.version = "3.12.5";
Ks.create = function(r) {
  return new Ks(r);
};
Ks.register = r1;
Ks.getAll = function() {
  return Rr.slice();
};
Ks.getById = function(r) {
  return Rr.filter(function(e) {
    return e.vars.id === r;
  })[0];
};
t1() && Et.registerPlugin(Ks);
function jh(r) {
  if (r === void 0)
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return r;
}
function Qp(r, e) {
  r.prototype = Object.create(e.prototype), r.prototype.constructor = r, r.__proto__ = e;
}
var Se, We, os, Bs, wi, Vl, fi, Mc, Sa, Wi, a1, Oc, fo, Pu, Ea, Ms, Aa, Xo, o1, Fc, An = 0, n1 = function() {
  return typeof window < "u";
}, l1 = function() {
  return Se || n1() && (Se = window.gsap) && Se.registerPlugin && Se;
}, Fi = function(e) {
  return typeof e == "function";
}, Xa = function(e) {
  return typeof e == "object";
}, Fs = function(e) {
  return typeof e > "u";
}, Zo = function() {
  return !1;
}, Za = "transform", Lc = "transformOrigin", Ii = function(e) {
  return Math.round(e * 1e4) / 1e4;
}, va = Array.isArray, $o = function(e, t) {
  var s = os.createElementNS ? os.createElementNS((t || "http://www.w3.org/1999/xhtml").replace(/^https/, "http"), e) : os.createElement(e);
  return s.style ? s : os.createElement(e);
}, Kh = 180 / Math.PI, tr = 1e20, e2 = new Ci(), Pi = Date.now || function() {
  return (/* @__PURE__ */ new Date()).getTime();
}, pr = [], Vr = {}, t2 = 0, s2 = /^(?:a|input|textarea|button|select)$/i, Gh = 0, Cr = {}, li = {}, c1 = function(e, t) {
  var s = {}, i;
  for (i in e)
    s[i] = t ? e[i] * t : e[i];
  return s;
}, i2 = function(e, t) {
  for (var s in t)
    s in e || (e[s] = t[s]);
  return e;
}, Vh = function r(e, t) {
  for (var s = e.length, i; s--; )
    t ? e[s].style.touchAction = t : e[s].style.removeProperty("touch-action"), i = e[s].children, i && i.length && r(i, t);
}, u1 = function() {
  return pr.forEach(function(e) {
    return e();
  });
}, r2 = function(e) {
  pr.push(e), pr.length === 1 && Se.ticker.add(u1);
}, zh = function() {
  return !pr.length && Se.ticker.remove(u1);
}, qh = function(e) {
  for (var t = pr.length; t--; )
    pr[t] === e && pr.splice(t, 1);
  Se.to(zh, {
    overwrite: !0,
    delay: 15,
    duration: 0,
    onComplete: zh,
    data: "_draggable"
  });
}, a2 = function(e, t) {
  for (var s in t)
    s in e || (e[s] = t[s]);
  return e;
}, dt = function(e, t, s, i) {
  if (e.addEventListener) {
    var a = fo[t];
    i = i || (a1 ? {
      passive: !1
    } : null), e.addEventListener(a || t, s, i), a && t !== a && e.addEventListener(t, s, i);
  }
}, ct = function(e, t, s, i) {
  if (e.removeEventListener) {
    var a = fo[t];
    e.removeEventListener(a || t, s, i), a && t !== a && e.removeEventListener(t, s, i);
  }
}, gs = function(e) {
  e.preventDefault && e.preventDefault(), e.preventManipulation && e.preventManipulation();
}, o2 = function(e, t) {
  for (var s = e.length; s--; )
    if (e[s].identifier === t)
      return !0;
}, n2 = function r(e) {
  Pu = e.touches && An < e.touches.length, ct(e.target, "touchend", r);
}, Yh = function(e) {
  Pu = e.touches && An < e.touches.length, dt(e.target, "touchend", n2);
}, zr = function(e) {
  return We.pageYOffset || e.scrollTop || e.documentElement.scrollTop || e.body.scrollTop || 0;
}, qr = function(e) {
  return We.pageXOffset || e.scrollLeft || e.documentElement.scrollLeft || e.body.scrollLeft || 0;
}, Uh = function r(e, t) {
  dt(e, "scroll", t), aa(e.parentNode) || r(e.parentNode, t);
}, Xh = function r(e, t) {
  ct(e, "scroll", t), aa(e.parentNode) || r(e.parentNode, t);
}, aa = function(e) {
  return !e || e === Bs || e.nodeType === 9 || e === os.body || e === We || !e.nodeType || !e.parentNode;
}, Zh = function(e, t) {
  var s = t === "x" ? "Width" : "Height", i = "scroll" + s, a = "client" + s;
  return Math.max(0, aa(e) ? Math.max(Bs[i], wi[i]) - (We["inner" + s] || Bs[a] || wi[a]) : e[i] - e[a]);
}, zl = function r(e, t) {
  var s = Zh(e, "x"), i = Zh(e, "y");
  aa(e) ? e = li : r(e.parentNode, t), e._gsMaxScrollX = s, e._gsMaxScrollY = i, t || (e._gsScrollX = e.scrollLeft || 0, e._gsScrollY = e.scrollTop || 0);
}, ql = function(e, t, s) {
  var i = e.style;
  i && (Fs(i[t]) && (t = Sa(t, e) || t), s == null ? i.removeProperty && i.removeProperty(t.replace(/([A-Z])/g, "-$1").toLowerCase()) : i[t] = s);
}, po = function(e) {
  return We.getComputedStyle(e instanceof Element ? e : e.host || (e.parentNode || {}).host || e);
}, sr = {}, Sr = function(e) {
  if (e === We)
    return sr.left = sr.top = 0, sr.width = sr.right = Bs.clientWidth || e.innerWidth || wi.clientWidth || 0, sr.height = sr.bottom = (e.innerHeight || 0) - 20 < Bs.clientHeight ? Bs.clientHeight : e.innerHeight || wi.clientHeight || 0, sr;
  var t = e.ownerDocument || os, s = Fs(e.pageX) ? !e.nodeType && !Fs(e.left) && !Fs(e.top) ? e : Wi(e)[0].getBoundingClientRect() : {
    left: e.pageX - qr(t),
    top: e.pageY - zr(t),
    right: e.pageX - qr(t) + 1,
    bottom: e.pageY - zr(t) + 1
  };
  return Fs(s.right) && !Fs(s.width) ? (s.right = s.left + s.width, s.bottom = s.top + s.height) : Fs(s.width) && (s = {
    width: s.right - s.left,
    height: s.bottom - s.top,
    right: s.right,
    left: s.left,
    bottom: s.bottom,
    top: s.top
  }), s;
}, ot = function(e, t, s) {
  var i = e.vars, a = i[s], o = e._listeners[t], n;
  return Fi(a) && (n = a.apply(i.callbackScope || e, i[s + "Params"] || [e.pointerEvent])), o && e.dispatchEvent(t) === !1 && (n = !1), n;
}, Jh = function(e, t) {
  var s = Wi(e)[0], i, a, o;
  return !s.nodeType && s !== We ? Fs(e.left) ? (a = e.min || e.minX || e.minRotation || 0, i = e.min || e.minY || 0, {
    left: a,
    top: i,
    width: (e.max || e.maxX || e.maxRotation || 0) - a,
    height: (e.max || e.maxY || 0) - i
  }) : (o = {
    x: 0,
    y: 0
  }, {
    left: e.left - o.x,
    top: e.top - o.y,
    width: e.width,
    height: e.height
  }) : l2(s, t);
}, fs = {}, l2 = function(e, t) {
  t = Wi(t)[0];
  var s = e.getBBox && e.ownerSVGElement, i = e.ownerDocument || os, a, o, n, l, c, u, g, p, h, m, y, k, _;
  if (e === We)
    n = zr(i), a = qr(i), o = a + (i.documentElement.clientWidth || e.innerWidth || i.body.clientWidth || 0), l = n + ((e.innerHeight || 0) - 20 < i.documentElement.clientHeight ? i.documentElement.clientHeight : e.innerHeight || i.body.clientHeight || 0);
  else {
    if (t === We || Fs(t))
      return e.getBoundingClientRect();
    a = n = 0, s ? (m = e.getBBox(), y = m.width, k = m.height) : (e.viewBox && (m = e.viewBox.baseVal) && (a = m.x || 0, n = m.y || 0, y = m.width, k = m.height), y || (_ = po(e), m = _.boxSizing === "border-box", y = (parseFloat(_.width) || e.clientWidth || 0) + (m ? 0 : parseFloat(_.borderLeftWidth) + parseFloat(_.borderRightWidth)), k = (parseFloat(_.height) || e.clientHeight || 0) + (m ? 0 : parseFloat(_.borderTopWidth) + parseFloat(_.borderBottomWidth)))), o = y, l = k;
  }
  return e === t ? {
    left: a,
    top: n,
    width: o - a,
    height: l - n
  } : (c = tt(t, !0).multiply(tt(e)), u = c.apply({
    x: a,
    y: n
  }), g = c.apply({
    x: o,
    y: n
  }), p = c.apply({
    x: o,
    y: l
  }), h = c.apply({
    x: a,
    y: l
  }), a = Math.min(u.x, g.x, p.x, h.x), n = Math.min(u.y, g.y, p.y, h.y), {
    left: a,
    top: n,
    width: Math.max(u.x, g.x, p.x, h.x) - a,
    height: Math.max(u.y, g.y, p.y, h.y) - n
  });
}, Yl = function(e, t, s, i, a, o) {
  var n = {}, l, c, u;
  if (t)
    if (a !== 1 && t instanceof Array) {
      if (n.end = l = [], u = t.length, Xa(t[0]))
        for (c = 0; c < u; c++)
          l[c] = c1(t[c], a);
      else
        for (c = 0; c < u; c++)
          l[c] = t[c] * a;
      s += 1.1, i -= 1.1;
    } else
      Fi(t) ? n.end = function(g) {
        var p = t.call(e, g), h, m;
        if (a !== 1)
          if (Xa(p)) {
            h = {};
            for (m in p)
              h[m] = p[m] * a;
            p = h;
          } else
            p *= a;
        return p;
      } : n.end = t;
  return (s || s === 0) && (n.max = s), (i || i === 0) && (n.min = i), o && (n.velocity = 0), n;
}, c2 = function r(e) {
  var t;
  return !e || !e.getAttribute || e === wi ? !1 : (t = e.getAttribute("data-clickable")) === "true" || t !== "false" && (s2.test(e.nodeName + "") || e.getAttribute("contentEditable") === "true") ? !0 : r(e.parentNode);
}, No = function(e, t) {
  for (var s = e.length, i; s--; )
    i = e[s], i.ondragstart = i.onselectstart = t ? null : Zo, Se.set(i, {
      lazy: !0,
      userSelect: t ? "text" : "none"
    });
}, u2 = function r(e) {
  if (po(e).position === "fixed")
    return !0;
  if (e = e.parentNode, e && e.nodeType === 1)
    return r(e);
}, h1, Rc, h2 = function(e, t) {
  e = Se.utils.toArray(e)[0], t = t || {};
  var s = document.createElement("div"), i = s.style, a = e.firstChild, o = 0, n = 0, l = e.scrollTop, c = e.scrollLeft, u = e.scrollWidth, g = e.scrollHeight, p = 0, h = 0, m = 0, y, k, _, C, T, x;
  h1 && t.force3D !== !1 ? (T = "translate3d(", x = "px,0px)") : Za && (T = "translate(", x = "px)"), this.scrollTop = function(S, O) {
    if (!arguments.length)
      return -this.top();
    this.top(-S, O);
  }, this.scrollLeft = function(S, O) {
    if (!arguments.length)
      return -this.left();
    this.left(-S, O);
  }, this.left = function(S, O) {
    if (!arguments.length)
      return -(e.scrollLeft + n);
    var M = e.scrollLeft - c, R = n;
    if ((M > 2 || M < -2) && !O) {
      c = e.scrollLeft, Se.killTweensOf(this, {
        left: 1,
        scrollLeft: 1
      }), this.left(-c), t.onKill && t.onKill();
      return;
    }
    S = -S, S < 0 ? (n = S - 0.5 | 0, S = 0) : S > h ? (n = S - h | 0, S = h) : n = 0, (n || R) && (this._skip || (i[Za] = T + -n + "px," + -o + x), n + p >= 0 && (i.paddingRight = n + p + "px")), e.scrollLeft = S | 0, c = e.scrollLeft;
  }, this.top = function(S, O) {
    if (!arguments.length)
      return -(e.scrollTop + o);
    var M = e.scrollTop - l, R = o;
    if ((M > 2 || M < -2) && !O) {
      l = e.scrollTop, Se.killTweensOf(this, {
        top: 1,
        scrollTop: 1
      }), this.top(-l), t.onKill && t.onKill();
      return;
    }
    S = -S, S < 0 ? (o = S - 0.5 | 0, S = 0) : S > m ? (o = S - m | 0, S = m) : o = 0, (o || R) && (this._skip || (i[Za] = T + -n + "px," + -o + x)), e.scrollTop = S | 0, l = e.scrollTop;
  }, this.maxScrollTop = function() {
    return m;
  }, this.maxScrollLeft = function() {
    return h;
  }, this.disable = function() {
    for (a = s.firstChild; a; )
      C = a.nextSibling, e.appendChild(a), a = C;
    e === s.parentNode && e.removeChild(s);
  }, this.enable = function() {
    if (a = e.firstChild, a !== s) {
      for (; a; )
        C = a.nextSibling, s.appendChild(a), a = C;
      e.appendChild(s), this.calibrate();
    }
  }, this.calibrate = function(S) {
    var O = e.clientWidth === y, M, R, L;
    l = e.scrollTop, c = e.scrollLeft, !(O && e.clientHeight === k && s.offsetHeight === _ && u === e.scrollWidth && g === e.scrollHeight && !S) && ((o || n) && (R = this.left(), L = this.top(), this.left(-e.scrollLeft), this.top(-e.scrollTop)), M = po(e), (!O || S) && (i.display = "block", i.width = "auto", i.paddingRight = "0px", p = Math.max(0, e.scrollWidth - e.clientWidth), p && (p += parseFloat(M.paddingLeft) + (Rc ? parseFloat(M.paddingRight) : 0))), i.display = "inline-block", i.position = "relative", i.overflow = "visible", i.verticalAlign = "top", i.boxSizing = "content-box", i.width = "100%", i.paddingRight = p + "px", Rc && (i.paddingBottom = M.paddingBottom), y = e.clientWidth, k = e.clientHeight, u = e.scrollWidth, g = e.scrollHeight, h = e.scrollWidth - y, m = e.scrollHeight - k, _ = s.offsetHeight, i.display = "block", (R || L) && (this.left(R), this.top(L)));
  }, this.content = s, this.element = e, this._skip = !1, this.enable();
}, Ul = function(e) {
  if (n1() && document.body) {
    var t = window && window.navigator;
    We = window, os = document, Bs = os.documentElement, wi = os.body, Vl = $o("div"), Xo = !!window.PointerEvent, fi = $o("div"), fi.style.cssText = "visibility:hidden;height:1px;top:-1px;pointer-events:none;position:relative;clear:both;cursor:grab", Aa = fi.style.cursor === "grab" ? "grab" : "move", Ea = t && t.userAgent.toLowerCase().indexOf("android") !== -1, Oc = "ontouchstart" in Bs && "orientation" in We || t && (t.MaxTouchPoints > 0 || t.msMaxTouchPoints > 0), Rc = function() {
      var s = $o("div"), i = $o("div"), a = i.style, o = wi, n;
      return a.display = "inline-block", a.position = "relative", s.style.cssText = "width:90px;height:40px;padding:10px;overflow:auto;visibility:hidden", s.appendChild(i), o.appendChild(s), n = i.offsetHeight + 18 > s.scrollHeight, o.removeChild(s), n;
    }(), fo = function(s) {
      for (var i = s.split(","), a = ("onpointerdown" in Vl ? "pointerdown,pointermove,pointerup,pointercancel" : "onmspointerdown" in Vl ? "MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel" : s).split(","), o = {}, n = 4; --n > -1; )
        o[i[n]] = a[n], o[a[n]] = i[n];
      try {
        Bs.addEventListener("test", null, Object.defineProperty({}, "passive", {
          get: function() {
            a1 = 1;
          }
        }));
      } catch {
      }
      return o;
    }("touchstart,touchmove,touchend,touchcancel"), dt(os, "touchcancel", Zo), dt(We, "touchmove", Zo), wi && wi.addEventListener("touchstart", Zo), dt(os, "contextmenu", function() {
      for (var s in Vr)
        Vr[s].isPressed && Vr[s].endDrag();
    }), Se = Mc = l1();
  }
  Se ? (Ms = Se.plugins.inertia, o1 = Se.core.context || function() {
  }, Sa = Se.utils.checkPrefix, Za = Sa(Za), Lc = Sa(Lc), Wi = Se.utils.toArray, Fc = Se.core.getStyleSaver, h1 = !!Sa("perspective")) : e && console.warn("Please gsap.registerPlugin(Draggable)");
}, d2 = /* @__PURE__ */ function() {
  function r(t) {
    this._listeners = {}, this.target = t || this;
  }
  var e = r.prototype;
  return e.addEventListener = function(s, i) {
    var a = this._listeners[s] || (this._listeners[s] = []);
    ~a.indexOf(i) || a.push(i);
  }, e.removeEventListener = function(s, i) {
    var a = this._listeners[s], o = a && a.indexOf(i);
    o >= 0 && a.splice(o, 1);
  }, e.dispatchEvent = function(s) {
    var i = this, a;
    return (this._listeners[s] || []).forEach(function(o) {
      return o.call(i, {
        type: s,
        target: i.target
      }) === !1 && (a = !1);
    }), a;
  }, r;
}(), Yi = /* @__PURE__ */ function(r) {
  Qp(e, r);
  function e(t, s) {
    var i;
    i = r.call(this) || this, Mc || Ul(1), t = Wi(t)[0], i.styles = Fc && Fc(t, "transform,left,top"), Ms || (Ms = Se.plugins.inertia), i.vars = s = c1(s || {}), i.target = t, i.x = i.y = i.rotation = 0, i.dragResistance = parseFloat(s.dragResistance) || 0, i.edgeResistance = isNaN(s.edgeResistance) ? 1 : parseFloat(s.edgeResistance) || 0, i.lockAxis = s.lockAxis, i.autoScroll = s.autoScroll || 0, i.lockedAxis = null, i.allowEventDefault = !!s.allowEventDefault, Se.getProperty(t, "x");
    var a = (s.type || "x,y").toLowerCase(), o = ~a.indexOf("x") || ~a.indexOf("y"), n = a.indexOf("rotation") !== -1, l = n ? "rotation" : o ? "x" : "left", c = o ? "y" : "top", u = !!(~a.indexOf("x") || ~a.indexOf("left") || a === "scroll"), g = !!(~a.indexOf("y") || ~a.indexOf("top") || a === "scroll"), p = s.minimumMovement || 2, h = jh(i), m = Wi(s.trigger || s.handle || t), y = {}, k = 0, _ = !1, C = s.autoScrollMarginTop || 40, T = s.autoScrollMarginRight || 40, x = s.autoScrollMarginBottom || 40, S = s.autoScrollMarginLeft || 40, O = s.clickableTest || c2, M = 0, R = t._gsap || Se.core.getCache(t), L = u2(t), q = function(I, Y) {
      return parseFloat(R.get(t, I, Y));
    }, G = t.ownerDocument || os, re, U, de, ee, le, d, f, v, b, D, E, P, N, K, j, ce, te, _e, ie, pe, we, ye, fe, ve, st, B, De, gt, Ve, be, ze, Gs, Ui, Eo = function(I) {
      return gs(I), I.stopImmediatePropagation && I.stopImmediatePropagation(), !1;
    }, $t = function ue(I) {
      if (h.autoScroll && h.isDragging && (_ || te)) {
        var Y = t, F = h.autoScroll * 15, W, V, Q, me, ne, Pe, Ae, Ne;
        for (_ = !1, li.scrollTop = We.pageYOffset != null ? We.pageYOffset : G.documentElement.scrollTop != null ? G.documentElement.scrollTop : G.body.scrollTop, li.scrollLeft = We.pageXOffset != null ? We.pageXOffset : G.documentElement.scrollLeft != null ? G.documentElement.scrollLeft : G.body.scrollLeft, me = h.pointerX - li.scrollLeft, ne = h.pointerY - li.scrollTop; Y && !V; )
          V = aa(Y.parentNode), W = V ? li : Y.parentNode, Q = V ? {
            bottom: Math.max(Bs.clientHeight, We.innerHeight || 0),
            right: Math.max(Bs.clientWidth, We.innerWidth || 0),
            left: 0,
            top: 0
          } : W.getBoundingClientRect(), Pe = Ae = 0, g && (Ne = W._gsMaxScrollY - W.scrollTop, Ne < 0 ? Ae = Ne : ne > Q.bottom - x && Ne ? (_ = !0, Ae = Math.min(Ne, F * (1 - Math.max(0, Q.bottom - ne) / x) | 0)) : ne < Q.top + C && W.scrollTop && (_ = !0, Ae = -Math.min(W.scrollTop, F * (1 - Math.max(0, ne - Q.top) / C) | 0)), Ae && (W.scrollTop += Ae)), u && (Ne = W._gsMaxScrollX - W.scrollLeft, Ne < 0 ? Pe = Ne : me > Q.right - T && Ne ? (_ = !0, Pe = Math.min(Ne, F * (1 - Math.max(0, Q.right - me) / T) | 0)) : me < Q.left + S && W.scrollLeft && (_ = !0, Pe = -Math.min(W.scrollLeft, F * (1 - Math.max(0, me - Q.left) / S) | 0)), Pe && (W.scrollLeft += Pe)), V && (Pe || Ae) && (We.scrollTo(W.scrollLeft, W.scrollTop), Ai(h.pointerX + Pe, h.pointerY + Ae)), Y = W;
      }
      if (te) {
        var rt = h.x, xt = h.y;
        n ? (h.deltaX = rt - parseFloat(R.rotation), h.rotation = rt, R.rotation = rt + "deg", R.renderTransform(1, R)) : U ? (g && (h.deltaY = xt - U.top(), U.top(xt)), u && (h.deltaX = rt - U.left(), U.left(rt))) : o ? (g && (h.deltaY = xt - parseFloat(R.y), R.y = xt + "px"), u && (h.deltaX = rt - parseFloat(R.x), R.x = rt + "px"), R.renderTransform(1, R)) : (g && (h.deltaY = xt - parseFloat(t.style.top || 0), t.style.top = xt + "px"), u && (h.deltaX = rt - parseFloat(t.style.left || 0), t.style.left = rt + "px")), v && !I && !gt && (gt = !0, ot(h, "drag", "onDrag") === !1 && (u && (h.x -= h.deltaX), g && (h.y -= h.deltaY), ue(!0)), gt = !1);
      }
      te = !1;
    }, qe = function(I, Y) {
      var F = h.x, W = h.y, V, Q;
      t._gsap || (R = Se.core.getCache(t)), R.uncache && Se.getProperty(t, "x"), o ? (h.x = parseFloat(R.x), h.y = parseFloat(R.y)) : n ? h.x = h.rotation = parseFloat(R.rotation) : U ? (h.y = U.top(), h.x = U.left()) : (h.y = parseFloat(t.style.top || (Q = po(t)) && Q.top) || 0, h.x = parseFloat(t.style.left || (Q || {}).left) || 0), (ie || pe || we) && !Y && (h.isDragging || h.isThrowing) && (we && (Cr.x = h.x, Cr.y = h.y, V = we(Cr), V.x !== h.x && (h.x = V.x, te = !0), V.y !== h.y && (h.y = V.y, te = !0)), ie && (V = ie(h.x), V !== h.x && (h.x = V, n && (h.rotation = V), te = !0)), pe && (V = pe(h.y), V !== h.y && (h.y = V), te = !0)), te && $t(!0), I || (h.deltaX = h.x - F, h.deltaY = h.y - W, ot(h, "throwupdate", "onThrowUpdate"));
    }, Ss = function(I, Y, F, W) {
      return Y == null && (Y = -tr), F == null && (F = tr), Fi(I) ? function(V) {
        var Q = h.isPressed ? 1 - h.edgeResistance : 1;
        return I.call(h, (V > F ? F + (V - F) * Q : V < Y ? Y + (V - Y) * Q : V) * W) * W;
      } : va(I) ? function(V) {
        for (var Q = I.length, me = 0, ne = tr, Pe, Ae; --Q > -1; )
          Pe = I[Q], Ae = Pe - V, Ae < 0 && (Ae = -Ae), Ae < ne && Pe >= Y && Pe <= F && (me = Q, ne = Ae);
        return I[me];
      } : isNaN(I) ? function(V) {
        return V;
      } : function() {
        return I * W;
      };
    }, ri = function(I, Y, F, W, V, Q, me) {
      return Q = Q && Q < tr ? Q * Q : tr, Fi(I) ? function(ne) {
        var Pe = h.isPressed ? 1 - h.edgeResistance : 1, Ae = ne.x, Ne = ne.y, rt, xt, ni;
        return ne.x = Ae = Ae > F ? F + (Ae - F) * Pe : Ae < Y ? Y + (Ae - Y) * Pe : Ae, ne.y = Ne = Ne > V ? V + (Ne - V) * Pe : Ne < W ? W + (Ne - W) * Pe : Ne, rt = I.call(h, ne), rt !== ne && (ne.x = rt.x, ne.y = rt.y), me !== 1 && (ne.x *= me, ne.y *= me), Q < tr && (xt = ne.x - Ae, ni = ne.y - Ne, xt * xt + ni * ni > Q && (ne.x = Ae, ne.y = Ne)), ne;
      } : va(I) ? function(ne) {
        for (var Pe = I.length, Ae = 0, Ne = tr, rt, xt, ni, ds; --Pe > -1; )
          ni = I[Pe], rt = ni.x - ne.x, xt = ni.y - ne.y, ds = rt * rt + xt * xt, ds < Ne && (Ae = Pe, Ne = ds);
        return Ne <= Q ? I[Ae] : ne;
      } : function(ne) {
        return ne;
      };
    }, _r = function() {
      var I, Y, F, W;
      f = !1, U ? (U.calibrate(), h.minX = E = -U.maxScrollLeft(), h.minY = N = -U.maxScrollTop(), h.maxX = D = h.maxY = P = 0, f = !0) : s.bounds && (I = Jh(s.bounds, t.parentNode), n ? (h.minX = E = I.left, h.maxX = D = I.left + I.width, h.minY = N = h.maxY = P = 0) : !Fs(s.bounds.maxX) || !Fs(s.bounds.maxY) ? (I = s.bounds, h.minX = E = I.minX, h.minY = N = I.minY, h.maxX = D = I.maxX, h.maxY = P = I.maxY) : (Y = Jh(t, t.parentNode), h.minX = E = Math.round(q(l, "px") + I.left - Y.left), h.minY = N = Math.round(q(c, "px") + I.top - Y.top), h.maxX = D = Math.round(E + (I.width - Y.width)), h.maxY = P = Math.round(N + (I.height - Y.height))), E > D && (h.minX = D, h.maxX = D = E, E = h.minX), N > P && (h.minY = P, h.maxY = P = N, N = h.minY), n && (h.minRotation = E, h.maxRotation = D), f = !0), s.liveSnap && (F = s.liveSnap === !0 ? s.snap || {} : s.liveSnap, W = va(F) || Fi(F), n ? (ie = Ss(W ? F : F.rotation, E, D, 1), pe = null) : F.points ? we = ri(W ? F : F.points, E, D, N, P, F.radius, U ? -1 : 1) : (u && (ie = Ss(W ? F : F.x || F.left || F.scrollLeft, E, D, U ? -1 : 1)), g && (pe = Ss(W ? F : F.y || F.top || F.scrollTop, N, P, U ? -1 : 1))));
    }, Ao = function() {
      h.isThrowing = !1, ot(h, "throwcomplete", "onThrowComplete");
    }, ai = function() {
      h.isThrowing = !1;
    }, ga = function(I, Y) {
      var F, W, V, Q;
      I && Ms ? (I === !0 && (F = s.snap || s.liveSnap || {}, W = va(F) || Fi(F), I = {
        resistance: (s.throwResistance || s.resistance || 1e3) / (n ? 10 : 1)
      }, n ? I.rotation = Yl(h, W ? F : F.rotation, D, E, 1, Y) : (u && (I[l] = Yl(h, W ? F : F.points || F.x || F.left, D, E, U ? -1 : 1, Y || h.lockedAxis === "x")), g && (I[c] = Yl(h, W ? F : F.points || F.y || F.top, P, N, U ? -1 : 1, Y || h.lockedAxis === "y")), (F.points || va(F) && Xa(F[0])) && (I.linkedProps = l + "," + c, I.radius = F.radius))), h.isThrowing = !0, Q = isNaN(s.overshootTolerance) ? s.edgeResistance === 1 ? 0 : 1 - h.edgeResistance + 0.2 : s.overshootTolerance, I.duration || (I.duration = {
        max: Math.max(s.minDuration || 0, "maxDuration" in s ? s.maxDuration : 2),
        min: isNaN(s.minDuration) ? Q === 0 || Xa(I) && I.resistance > 1e3 ? 0 : 0.5 : s.minDuration,
        overshoot: Q
      }), h.tween = V = Se.to(U || t, {
        inertia: I,
        data: "_draggable",
        inherit: !1,
        onComplete: Ao,
        onInterrupt: ai,
        onUpdate: s.fastMode ? ot : qe,
        onUpdateParams: s.fastMode ? [h, "onthrowupdate", "onThrowUpdate"] : F && F.radius ? [!1, !0] : []
      }), s.fastMode || (U && (U._skip = !0), V.render(1e9, !0, !0), qe(!0, !0), h.endX = h.x, h.endY = h.y, n && (h.endRotation = h.x), V.play(0), qe(!0, !0), U && (U._skip = !1))) : f && h.applyBounds();
    }, Xi = function(I) {
      var Y = ve, F;
      ve = tt(t.parentNode, !0), I && h.isPressed && !ve.equals(Y || new Ci()) && (F = Y.inverse().apply({
        x: de,
        y: ee
      }), ve.apply(F, F), de = F.x, ee = F.y), ve.equals(e2) && (ve = null);
    }, Zi = function() {
      var I = 1 - h.edgeResistance, Y = L ? qr(G) : 0, F = L ? zr(G) : 0, W, V, Q;
      o && (R.x = q(l, "px") + "px", R.y = q(c, "px") + "px", R.renderTransform()), Xi(!1), fs.x = h.pointerX - Y, fs.y = h.pointerY - F, ve && ve.apply(fs, fs), de = fs.x, ee = fs.y, te && (Ai(h.pointerX, h.pointerY), $t(!0)), Gs = tt(t), U ? (_r(), d = U.top(), le = U.left()) : (Ei() ? (qe(!0, !0), _r()) : h.applyBounds(), n ? (W = t.ownerSVGElement ? [R.xOrigin - t.getBBox().x, R.yOrigin - t.getBBox().y] : (po(t)[Lc] || "0 0").split(" "), ce = h.rotationOrigin = tt(t).apply({
        x: parseFloat(W[0]) || 0,
        y: parseFloat(W[1]) || 0
      }), qe(!0, !0), V = h.pointerX - ce.x - Y, Q = ce.y - h.pointerY + F, le = h.x, d = h.y = Math.atan2(Q, V) * Kh) : (d = q(c, "px"), le = q(l, "px"))), f && I && (le > D ? le = D + (le - D) / I : le < E && (le = E - (E - le) / I), n || (d > P ? d = P + (d - P) / I : d < N && (d = N - (N - d) / I))), h.startX = le = Ii(le), h.startY = d = Ii(d);
    }, Ei = function() {
      return h.tween && h.tween.isActive();
    }, fa = function() {
      fi.parentNode && !Ei() && !h.isDragging && fi.parentNode.removeChild(fi);
    }, oi = function(I, Y) {
      var F;
      if (!re || h.isPressed || !I || (I.type === "mousedown" || I.type === "pointerdown") && !Y && Pi() - M < 30 && fo[h.pointerEvent.type]) {
        ze && I && re && gs(I);
        return;
      }
      if (st = Ei(), Ui = !1, h.pointerEvent = I, fo[I.type] ? (fe = ~I.type.indexOf("touch") ? I.currentTarget || I.target : G, dt(fe, "touchend", Gt), dt(fe, "touchmove", hs), dt(fe, "touchcancel", Gt), dt(G, "touchstart", Yh)) : (fe = null, dt(G, "mousemove", hs)), De = null, (!Xo || !fe) && (dt(G, "mouseup", Gt), I && I.target && dt(I.target, "mouseup", Gt)), ye = O.call(h, I.target) && s.dragClickables === !1 && !Y, ye) {
        dt(I.target, "change", Gt), ot(h, "pressInit", "onPressInit"), ot(h, "press", "onPress"), No(m, !0), ze = !1;
        return;
      }
      if (B = !fe || u === g || h.vars.allowNativeTouchScrolling === !1 || h.vars.allowContextMenu && I && (I.ctrlKey || I.which > 2) ? !1 : u ? "y" : "x", ze = !B && !h.allowEventDefault, ze && (gs(I), dt(We, "touchforcechange", gs)), I.changedTouches ? (I = K = I.changedTouches[0], j = I.identifier) : I.pointerId ? j = I.pointerId : K = j = null, An++, r2($t), ee = h.pointerY = I.pageY, de = h.pointerX = I.pageX, ot(h, "pressInit", "onPressInit"), (B || h.autoScroll) && zl(t.parentNode), t.parentNode && h.autoScroll && !U && !n && t.parentNode._gsMaxScrollX && !fi.parentNode && !t.getBBox && (fi.style.width = t.parentNode.scrollWidth + "px", t.parentNode.appendChild(fi)), Zi(), h.tween && h.tween.kill(), h.isThrowing = !1, Se.killTweensOf(U || t, y, !0), U && Se.killTweensOf(t, {
        scrollTo: 1
      }, !0), h.tween = h.lockedAxis = null, (s.zIndexBoost || !n && !U && s.zIndexBoost !== !1) && (t.style.zIndex = e.zIndex++), h.isPressed = !0, v = !!(s.onDrag || h._listeners.drag), b = !!(s.onMove || h._listeners.move), s.cursor !== !1 || s.activeCursor)
        for (F = m.length; --F > -1; )
          Se.set(m[F], {
            cursor: s.activeCursor || s.cursor || (Aa === "grab" ? "grabbing" : Aa)
          });
      ot(h, "press", "onPress");
    }, hs = function(I) {
      var Y = I, F, W, V, Q, me, ne;
      if (!re || Pu || !h.isPressed || !I) {
        ze && I && re && gs(I);
        return;
      }
      if (h.pointerEvent = I, F = I.changedTouches, F) {
        if (I = F[0], I !== K && I.identifier !== j) {
          for (Q = F.length; --Q > -1 && (I = F[Q]).identifier !== j && I.target !== t; )
            ;
          if (Q < 0)
            return;
        }
      } else if (I.pointerId && j && I.pointerId !== j)
        return;
      if (fe && B && !De && (fs.x = I.pageX - (L ? qr(G) : 0), fs.y = I.pageY - (L ? zr(G) : 0), ve && ve.apply(fs, fs), W = fs.x, V = fs.y, me = Math.abs(W - de), ne = Math.abs(V - ee), (me !== ne && (me > p || ne > p) || Ea && B === De) && (De = me > ne && u ? "x" : "y", B && De !== B && dt(We, "touchforcechange", gs), h.vars.lockAxisOnTouchScroll !== !1 && u && g && (h.lockedAxis = De === "x" ? "y" : "x", Fi(h.vars.onLockAxis) && h.vars.onLockAxis.call(h, Y)), Ea && B === De))) {
        Gt(Y);
        return;
      }
      !h.allowEventDefault && (!B || De && B !== De) && Y.cancelable !== !1 ? (gs(Y), ze = !0) : ze && (ze = !1), h.autoScroll && (_ = !0), Ai(I.pageX, I.pageY, b);
    }, Ai = function(I, Y, F) {
      var W = 1 - h.dragResistance, V = 1 - h.edgeResistance, Q = h.pointerX, me = h.pointerY, ne = d, Pe = h.x, Ae = h.y, Ne = h.endX, rt = h.endY, xt = h.endRotation, ni = te, ds, xi, kt, at, El, Es;
      h.pointerX = I, h.pointerY = Y, L && (I -= qr(G), Y -= zr(G)), n ? (at = Math.atan2(ce.y - Y, I - ce.x) * Kh, El = h.y - at, El > 180 ? (d -= 360, h.y = at) : El < -180 && (d += 360, h.y = at), h.x !== le || Math.abs(d - at) > p ? (h.y = at, kt = le + (d - at) * W) : kt = le) : (ve && (Es = I * ve.a + Y * ve.c + ve.e, Y = I * ve.b + Y * ve.d + ve.f, I = Es), xi = Y - ee, ds = I - de, xi < p && xi > -p && (xi = 0), ds < p && ds > -p && (ds = 0), (h.lockAxis || h.lockedAxis) && (ds || xi) && (Es = h.lockedAxis, Es || (h.lockedAxis = Es = u && Math.abs(ds) > Math.abs(xi) ? "y" : g ? "x" : null, Es && Fi(h.vars.onLockAxis) && h.vars.onLockAxis.call(h, h.pointerEvent)), Es === "y" ? xi = 0 : Es === "x" && (ds = 0)), kt = Ii(le + ds * W), at = Ii(d + xi * W)), (ie || pe || we) && (h.x !== kt || h.y !== at && !n) && (we && (Cr.x = kt, Cr.y = at, Es = we(Cr), kt = Ii(Es.x), at = Ii(Es.y)), ie && (kt = Ii(ie(kt))), pe && (at = Ii(pe(at)))), f && (kt > D ? kt = D + Math.round((kt - D) * V) : kt < E && (kt = E + Math.round((kt - E) * V)), n || (at > P ? at = Math.round(P + (at - P) * V) : at < N && (at = Math.round(N + (at - N) * V)))), (h.x !== kt || h.y !== at && !n) && (n ? (h.endRotation = h.x = h.endX = kt, te = !0) : (g && (h.y = h.endY = at, te = !0), u && (h.x = h.endX = kt, te = !0)), !F || ot(h, "move", "onMove") !== !1 ? !h.isDragging && h.isPressed && (h.isDragging = Ui = !0, ot(h, "dragstart", "onDragStart")) : (h.pointerX = Q, h.pointerY = me, d = ne, h.x = Pe, h.y = Ae, h.endX = Ne, h.endY = rt, h.endRotation = xt, te = ni));
    }, Gt = function ue(I, Y) {
      if (!re || !h.isPressed || I && j != null && !Y && (I.pointerId && I.pointerId !== j && I.target !== t || I.changedTouches && !o2(I.changedTouches, j))) {
        ze && I && re && gs(I);
        return;
      }
      h.isPressed = !1;
      var F = I, W = h.isDragging, V = h.vars.allowContextMenu && I && (I.ctrlKey || I.which > 2), Q = Se.delayedCall(1e-3, fa), me, ne, Pe, Ae, Ne;
      if (fe ? (ct(fe, "touchend", ue), ct(fe, "touchmove", hs), ct(fe, "touchcancel", ue), ct(G, "touchstart", Yh)) : ct(G, "mousemove", hs), ct(We, "touchforcechange", gs), (!Xo || !fe) && (ct(G, "mouseup", ue), I && I.target && ct(I.target, "mouseup", ue)), te = !1, W && (k = Gh = Pi(), h.isDragging = !1), qh($t), ye && !V) {
        I && (ct(I.target, "change", ue), h.pointerEvent = F), No(m, !1), ot(h, "release", "onRelease"), ot(h, "click", "onClick"), ye = !1;
        return;
      }
      for (ne = m.length; --ne > -1; )
        ql(m[ne], "cursor", s.cursor || (s.cursor !== !1 ? Aa : null));
      if (An--, I) {
        if (me = I.changedTouches, me && (I = me[0], I !== K && I.identifier !== j)) {
          for (ne = me.length; --ne > -1 && (I = me[ne]).identifier !== j && I.target !== t; )
            ;
          if (ne < 0 && !Y)
            return;
        }
        h.pointerEvent = F, h.pointerX = I.pageX, h.pointerY = I.pageY;
      }
      return V && F ? (gs(F), ze = !0, ot(h, "release", "onRelease")) : F && !W ? (ze = !1, st && (s.snap || s.bounds) && ga(s.inertia || s.throwProps), ot(h, "release", "onRelease"), (!Ea || F.type !== "touchmove") && F.type.indexOf("cancel") === -1 && (ot(h, "click", "onClick"), Pi() - M < 300 && ot(h, "doubleclick", "onDoubleClick"), Ae = F.target || t, M = Pi(), Ne = function() {
        M !== Ve && h.enabled() && !h.isPressed && !F.defaultPrevented && (Ae.click ? Ae.click() : G.createEvent && (Pe = G.createEvent("MouseEvents"), Pe.initMouseEvent("click", !0, !0, We, 1, h.pointerEvent.screenX, h.pointerEvent.screenY, h.pointerX, h.pointerY, !1, !1, !1, !1, 0, null), Ae.dispatchEvent(Pe)));
      }, !Ea && !F.defaultPrevented && Se.delayedCall(0.05, Ne))) : (ga(s.inertia || s.throwProps), !h.allowEventDefault && F && (s.dragClickables !== !1 || !O.call(h, F.target)) && W && (!B || De && B === De) && F.cancelable !== !1 ? (ze = !0, gs(F)) : ze = !1, ot(h, "release", "onRelease")), Ei() && Q.duration(h.tween.duration()), W && ot(h, "dragend", "onDragEnd"), !0;
    }, Ji = function(I) {
      if (I && h.isDragging && !U) {
        var Y = I.target || t.parentNode, F = Y.scrollLeft - Y._gsScrollX, W = Y.scrollTop - Y._gsScrollY;
        (F || W) && (ve ? (de -= F * ve.a + W * ve.c, ee -= W * ve.d + F * ve.b) : (de -= F, ee -= W), Y._gsScrollX += F, Y._gsScrollY += W, Ai(h.pointerX, h.pointerY));
      }
    }, pa = function(I) {
      var Y = Pi(), F = Y - M < 100, W = Y - k < 50, V = F && Ve === M, Q = h.pointerEvent && h.pointerEvent.defaultPrevented, me = F && be === M, ne = I.isTrusted || I.isTrusted == null && F && V;
      if ((V || W && h.vars.suppressClickOnDrag !== !1) && I.stopImmediatePropagation && I.stopImmediatePropagation(), F && !(h.pointerEvent && h.pointerEvent.defaultPrevented) && (!V || ne && !me)) {
        ne && V && (be = M), Ve = M;
        return;
      }
      (h.isPressed || W || F) && (!ne || !I.detail || !F || Q) && gs(I), !F && !W && !Ui && (I && I.target && (h.pointerEvent = I), ot(h, "click", "onClick"));
    }, ma = function(I) {
      return ve ? {
        x: I.x * ve.a + I.y * ve.c + ve.e,
        y: I.x * ve.b + I.y * ve.d + ve.f
      } : {
        x: I.x,
        y: I.y
      };
    };
    return _e = e.get(t), _e && _e.kill(), i.startDrag = function(ue, I) {
      var Y, F, W, V;
      oi(ue || h.pointerEvent, !0), I && !h.hitTest(ue || h.pointerEvent) && (Y = Sr(ue || h.pointerEvent), F = Sr(t), W = ma({
        x: Y.left + Y.width / 2,
        y: Y.top + Y.height / 2
      }), V = ma({
        x: F.left + F.width / 2,
        y: F.top + F.height / 2
      }), de -= W.x - V.x, ee -= W.y - V.y), h.isDragging || (h.isDragging = Ui = !0, ot(h, "dragstart", "onDragStart"));
    }, i.drag = hs, i.endDrag = function(ue) {
      return Gt(ue || h.pointerEvent, !0);
    }, i.timeSinceDrag = function() {
      return h.isDragging ? 0 : (Pi() - k) / 1e3;
    }, i.timeSinceClick = function() {
      return (Pi() - M) / 1e3;
    }, i.hitTest = function(ue, I) {
      return e.hitTest(h.target, ue, I);
    }, i.getDirection = function(ue, I) {
      var Y = ue === "velocity" && Ms ? ue : Xa(ue) && !n ? "element" : "start", F, W, V, Q, me, ne;
      return Y === "element" && (me = Sr(h.target), ne = Sr(ue)), F = Y === "start" ? h.x - le : Y === "velocity" ? Ms.getVelocity(t, l) : me.left + me.width / 2 - (ne.left + ne.width / 2), n ? F < 0 ? "counter-clockwise" : "clockwise" : (I = I || 2, W = Y === "start" ? h.y - d : Y === "velocity" ? Ms.getVelocity(t, c) : me.top + me.height / 2 - (ne.top + ne.height / 2), V = Math.abs(F / W), Q = V < 1 / I ? "" : F < 0 ? "left" : "right", V < I && (Q !== "" && (Q += "-"), Q += W < 0 ? "up" : "down"), Q);
    }, i.applyBounds = function(ue, I) {
      var Y, F, W, V, Q, me;
      if (ue && s.bounds !== ue)
        return s.bounds = ue, h.update(!0, I);
      if (qe(!0), _r(), f && !Ei()) {
        if (Y = h.x, F = h.y, Y > D ? Y = D : Y < E && (Y = E), F > P ? F = P : F < N && (F = N), (h.x !== Y || h.y !== F) && (W = !0, h.x = h.endX = Y, n ? h.endRotation = Y : h.y = h.endY = F, te = !0, $t(!0), h.autoScroll && !h.isDragging))
          for (zl(t.parentNode), V = t, li.scrollTop = We.pageYOffset != null ? We.pageYOffset : G.documentElement.scrollTop != null ? G.documentElement.scrollTop : G.body.scrollTop, li.scrollLeft = We.pageXOffset != null ? We.pageXOffset : G.documentElement.scrollLeft != null ? G.documentElement.scrollLeft : G.body.scrollLeft; V && !me; )
            me = aa(V.parentNode), Q = me ? li : V.parentNode, g && Q.scrollTop > Q._gsMaxScrollY && (Q.scrollTop = Q._gsMaxScrollY), u && Q.scrollLeft > Q._gsMaxScrollX && (Q.scrollLeft = Q._gsMaxScrollX), V = Q;
        h.isThrowing && (W || h.endX > D || h.endX < E || h.endY > P || h.endY < N) && ga(s.inertia || s.throwProps, W);
      }
      return h;
    }, i.update = function(ue, I, Y) {
      if (I && h.isPressed) {
        var F = tt(t), W = Gs.apply({
          x: h.x - le,
          y: h.y - d
        }), V = tt(t.parentNode, !0);
        V.apply({
          x: F.e - W.x,
          y: F.f - W.y
        }, W), h.x -= W.x - V.e, h.y -= W.y - V.f, $t(!0), Zi();
      }
      var Q = h.x, me = h.y;
      return Xi(!I), ue ? h.applyBounds() : (te && Y && $t(!0), qe(!0)), I && (Ai(h.pointerX, h.pointerY), te && $t(!0)), h.isPressed && !I && (u && Math.abs(Q - h.x) > 0.01 || g && Math.abs(me - h.y) > 0.01 && !n) && Zi(), h.autoScroll && (zl(t.parentNode, h.isDragging), _ = h.isDragging, $t(!0), Xh(t, Ji), Uh(t, Ji)), h;
    }, i.enable = function(ue) {
      var I = {
        lazy: !0
      }, Y, F, W;
      if (s.cursor !== !1 && (I.cursor = s.cursor || Aa), Se.utils.checkPrefix("touchCallout") && (I.touchCallout = "none"), ue !== "soft") {
        for (Vh(m, u === g ? "none" : s.allowNativeTouchScrolling && t.scrollHeight === t.clientHeight == (t.scrollWidth === t.clientHeight) || s.allowEventDefault ? "manipulation" : u ? "pan-y" : "pan-x"), F = m.length; --F > -1; )
          W = m[F], Xo || dt(W, "mousedown", oi), dt(W, "touchstart", oi), dt(W, "click", pa, !0), Se.set(W, I), W.getBBox && W.ownerSVGElement && u !== g && Se.set(W.ownerSVGElement, {
            touchAction: s.allowNativeTouchScrolling || s.allowEventDefault ? "manipulation" : u ? "pan-y" : "pan-x"
          }), s.allowContextMenu || dt(W, "contextmenu", Eo);
        No(m, !1);
      }
      return Uh(t, Ji), re = !0, Ms && ue !== "soft" && Ms.track(U || t, o ? "x,y" : n ? "rotation" : "top,left"), t._gsDragID = Y = "d" + t2++, Vr[Y] = h, U && (U.enable(), U.element._gsDragID = Y), (s.bounds || n) && Zi(), s.bounds && h.applyBounds(), h;
    }, i.disable = function(ue) {
      for (var I = h.isDragging, Y = m.length, F; --Y > -1; )
        ql(m[Y], "cursor", null);
      if (ue !== "soft") {
        for (Vh(m, null), Y = m.length; --Y > -1; )
          F = m[Y], ql(F, "touchCallout", null), ct(F, "mousedown", oi), ct(F, "touchstart", oi), ct(F, "click", pa, !0), ct(F, "contextmenu", Eo);
        No(m, !0), fe && (ct(fe, "touchcancel", Gt), ct(fe, "touchend", Gt), ct(fe, "touchmove", hs)), ct(G, "mouseup", Gt), ct(G, "mousemove", hs);
      }
      return Xh(t, Ji), re = !1, Ms && ue !== "soft" && (Ms.untrack(U || t, o ? "x,y" : n ? "rotation" : "top,left"), h.tween && h.tween.kill()), U && U.disable(), qh($t), h.isDragging = h.isPressed = ye = !1, I && ot(h, "dragend", "onDragEnd"), h;
    }, i.enabled = function(ue, I) {
      return arguments.length ? ue ? h.enable(I) : h.disable(I) : re;
    }, i.kill = function() {
      return h.isThrowing = !1, h.tween && h.tween.kill(), h.disable(), Se.set(m, {
        clearProps: "userSelect"
      }), delete Vr[t._gsDragID], h;
    }, i.revert = function() {
      this.kill(), this.styles && this.styles.revert();
    }, ~a.indexOf("scroll") && (U = i.scrollProxy = new h2(t, i2({
      onKill: function() {
        h.isPressed && Gt(null);
      }
    }, s)), t.style.overflowY = g && !Oc ? "auto" : "hidden", t.style.overflowX = u && !Oc ? "auto" : "hidden", t = U.content), n ? y.rotation = 1 : (u && (y[l] = 1), g && (y[c] = 1)), R.force3D = "force3D" in s ? s.force3D : !0, o1(jh(i)), i.enable(), i;
  }
  return e.register = function(s) {
    Se = s, Ul();
  }, e.create = function(s, i) {
    return Mc || Ul(!0), Wi(s).map(function(a) {
      return new e(a, i);
    });
  }, e.get = function(s) {
    return Vr[(Wi(s)[0] || {})._gsDragID];
  }, e.timeSinceDrag = function() {
    return (Pi() - Gh) / 1e3;
  }, e.hitTest = function(s, i, a) {
    if (s === i)
      return !1;
    var o = Sr(s), n = Sr(i), l = o.top, c = o.left, u = o.right, g = o.bottom, p = o.width, h = o.height, m = n.left > u || n.right < c || n.top > g || n.bottom < l, y, k, _;
    return m || !a ? !m : (_ = (a + "").indexOf("%") !== -1, a = parseFloat(a) || 0, y = {
      left: Math.max(c, n.left),
      top: Math.max(l, n.top)
    }, y.width = Math.min(u, n.right) - y.left, y.height = Math.min(g, n.bottom) - y.top, y.width < 0 || y.height < 0 ? !1 : _ ? (a *= 0.01, k = y.width * y.height, k >= p * h * a || k >= n.width * n.height * a) : y.width > a && y.height > a);
  }, e;
}(d2);
a2(Yi.prototype, {
  pointerX: 0,
  pointerY: 0,
  startX: 0,
  startY: 0,
  deltaX: 0,
  deltaY: 0,
  isDragging: !1,
  isPressed: !1
});
Yi.zIndex = 1e3;
Yi.version = "3.12.5";
l1() && Se.registerPlugin(Yi);
/*!
 * MotionPathPlugin 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var g2 = "x,translateX,left,marginLeft,xPercent".split(","), f2 = "y,translateY,top,marginTop,yPercent".split(","), p2 = Math.PI / 180, ys, d1, Er, $c, Xl, Qh, m2 = function() {
  return ys || typeof window < "u" && (ys = window.gsap) && ys.registerPlugin && ys;
}, ka = function(e, t, s, i) {
  for (var a = t.length, o = i === 2 ? 0 : i, n = 0; n < a; n++)
    e[o] = parseFloat(t[n][s]), i === 2 && (e[o + 1] = 0), o += 2;
  return e;
}, $r = function(e, t, s) {
  return parseFloat(e._gsap.get(e, t, s || "px")) || 0;
}, g1 = function(e) {
  var t = e[0], s = e[1], i;
  for (i = 2; i < e.length; i += 2)
    t = e[i] += t, s = e[i + 1] += s;
}, e0 = function(e, t, s, i, a, o, n, l, c) {
  if (n.type === "cubic")
    t = [t];
  else {
    n.fromCurrent !== !1 && t.unshift($r(s, i, l), a ? $r(s, a, c) : 0), n.relative && g1(t);
    var u = a ? Cc : Ep;
    t = [u(t, n.curviness)];
  }
  return t = o(f1(t, s, n)), xn(e, s, i, t, "x", l), a && xn(e, s, a, t, "y", c), gr(t, n.resolution || (n.curviness === 0 ? 20 : 12));
}, y2 = function(e) {
  return e;
}, b2 = /[-+\.]*\d+\.?(?:e-|e\+)?\d*/g, t0 = function(e, t, s) {
  var i = tt(e), a = 0, o = 0, n;
  return (e.tagName + "").toLowerCase() === "svg" ? (n = e.viewBox.baseVal, n.width || (n = {
    width: +e.getAttribute("width"),
    height: +e.getAttribute("height")
  })) : n = t && e.getBBox && e.getBBox(), t && t !== "auto" && (a = t.push ? t[0] * (n ? n.width : e.offsetWidth || 0) : t.x, o = t.push ? t[1] * (n ? n.height : e.offsetHeight || 0) : t.y), s.apply(a || o ? i.apply({
    x: a,
    y: o
  }) : {
    x: i.e,
    y: i.f
  });
}, Nc = function(e, t, s, i) {
  var a = tt(e.parentNode, !0, !0), o = a.clone().multiply(tt(t)), n = t0(e, s, a), l = t0(t, i, a), c = l.x, u = l.y, g;
  return o.e = o.f = 0, i === "auto" && t.getTotalLength && t.tagName.toLowerCase() === "path" && (g = t.getAttribute("d").match(b2) || [], g = o.apply({
    x: +g[0],
    y: +g[1]
  }), c += g.x, u += g.y), g && (g = o.apply(t.getBBox()), c -= g.x, u -= g.y), o.e = c - n.x, o.f = u - n.y, o;
}, f1 = function(e, t, s) {
  var i = s.align, a = s.matrix, o = s.offsetX, n = s.offsetY, l = s.alignOrigin, c = e[0][0], u = e[0][1], g = $r(t, "x"), p = $r(t, "y"), h, m, y;
  return !e || !e.length ? qo("M0,0L0,0") : (i && (i === "self" || (h = $c(i)[0] || t) === t ? Or(e, 1, 0, 0, 1, g - c, p - u) : (l && l[2] !== !1 ? ys.set(t, {
    transformOrigin: l[0] * 100 + "% " + l[1] * 100 + "%"
  }) : l = [$r(t, "xPercent") / -100, $r(t, "yPercent") / -100], m = Nc(t, h, l, "auto"), y = m.apply({
    x: c,
    y: u
  }), Or(e, m.a, m.b, m.c, m.d, g + m.e - (y.x - m.e), p + m.f - (y.y - m.f)))), a ? Or(e, a.a, a.b, a.c, a.d, a.e, a.f) : (o || n) && Or(e, 1, 0, 0, 1, o || 0, n || 0), e);
}, xn = function(e, t, s, i, a, o) {
  var n = t._gsap, l = n.harness, c = l && l.aliases && l.aliases[s], u = c && c.indexOf(",") < 0 ? c : s, g = e._pt = new d1(e._pt, t, u, 0, 0, y2, 0, n.set(t, u, e));
  g.u = Er(n.get(t, u, o)) || 0, g.path = i, g.pp = a, e._props.push(u);
}, w2 = function(e, t) {
  return function(s) {
    return e || t !== 1 ? Nd(s, e, t) : s;
  };
}, la = {
  version: "3.12.5",
  name: "motionPath",
  register: function(e, t, s) {
    ys = e, Er = ys.utils.getUnit, $c = ys.utils.toArray, Xl = ys.core.getStyleSaver, Qh = ys.core.reverting || function() {
    }, d1 = s;
  },
  init: function(e, t, s) {
    if (!ys)
      return console.warn("Please gsap.registerPlugin(MotionPathPlugin)"), !1;
    (!(typeof t == "object" && !t.style) || !t.path) && (t = {
      path: t
    });
    var i = [], a = t, o = a.path, n = a.autoRotate, l = a.unitX, c = a.unitY, u = a.x, g = a.y, p = o[0], h = w2(t.start, "end" in t ? t.end : 1), m, y;
    if (this.rawPaths = i, this.target = e, this.tween = s, this.styles = Xl && Xl(e, "transform"), (this.rotate = n || n === 0) && (this.rOffset = parseFloat(n) || 0, this.radians = !!t.useRadians, this.rProp = t.rotation || "rotation", this.rSet = e._gsap.set(e, this.rProp, this), this.ru = Er(e._gsap.get(e, this.rProp)) || 0), Array.isArray(o) && !("closed" in o) && typeof p != "number") {
      for (y in p)
        !u && ~g2.indexOf(y) ? u = y : !g && ~f2.indexOf(y) && (g = y);
      u && g ? i.push(e0(this, ka(ka([], o, u, 0), o, g, 1), e, u, g, h, t, l || Er(o[0][u]), c || Er(o[0][g]))) : u = g = 0;
      for (y in p)
        y !== u && y !== g && i.push(e0(this, ka([], o, y, 2), e, y, 0, h, t, Er(o[0][y])));
    } else
      m = h(f1(qo(t.path), e, t)), gr(m, t.resolution), i.push(m), xn(this, e, t.x || "x", m, "x", t.unitX || "px"), xn(this, e, t.y || "y", m, "y", t.unitY || "px");
  },
  render: function(e, t) {
    var s = t.rawPaths, i = s.length, a = t._pt;
    if (t.tween._time || !Qh()) {
      for (e > 1 ? e = 1 : e < 0 && (e = 0); i--; )
        Ah(s[i], e, !i && t.rotate, s[i]);
      for (; a; )
        a.set(a.t, a.p, a.path[a.pp] + a.u, a.d, e), a = a._next;
      t.rotate && t.rSet(t.target, t.rProp, s[0].angle * (t.radians ? p2 : 1) + t.rOffset + t.ru, t, e);
    } else
      t.styles.revert();
  },
  getLength: function(e) {
    return gr(qo(e)).totalLength;
  },
  sliceRawPath: Nd,
  getRawPath: qo,
  pointsToSegment: Cc,
  stringToRawPath: ho,
  rawPathToString: ku,
  transformRawPath: Or,
  getGlobalMatrix: tt,
  getPositionOnPath: Ah,
  cacheRawPathMeasurements: gr,
  convertToPath: function(e, t) {
    return $c(e).map(function(s) {
      return Tp(s, t !== !1);
    });
  },
  convertCoordinates: function(e, t, s) {
    var i = tt(t, !0, !0).multiply(tt(e));
    return s ? i.apply(s) : i;
  },
  getAlignMatrix: Nc,
  getRelativePosition: function(e, t, s, i) {
    var a = Nc(e, t, s, i);
    return {
      x: a.e,
      y: a.f
    };
  },
  arrayToRawPath: function(e, t) {
    t = t || {};
    var s = ka(ka([], e, t.x || "x", 0), e, t.y || "y", 1);
    return t.relative && g1(s), [t.type === "cubic" ? s : Cc(s, t.curviness)];
  }
};
m2() && ys.registerPlugin(la);
/*!
 * strings: 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var v2 = /(?:^\s+|\s+$)/g, k2 = /([\uD800-\uDBFF][\uDC00-\uDFFF](?:[\u200D\uFE0F][\uD800-\uDBFF][\uDC00-\uDFFF]){2,}|\uD83D\uDC69(?:\u200D(?:(?:\uD83D\uDC69\u200D)?\uD83D\uDC67|(?:\uD83D\uDC69\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]\uFE0F|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC6F\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3C-\uDD3E\uDDD6-\uDDDF])\u200D[\u2640\u2642]\uFE0F|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F\u200D[\u2640\u2642]|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\uD83D\uDC69\u200D[\u2695\u2696\u2708]|\uD83D\uDC68(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708]))\uFE0F|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83D\uDC69\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]))|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\u200D(?:(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F)/;
function p1(r) {
  var e = r.nodeType, t = "";
  if (e === 1 || e === 9 || e === 11) {
    if (typeof r.textContent == "string")
      return r.textContent;
    for (r = r.firstChild; r; r = r.nextSibling)
      t += p1(r);
  } else if (e === 3 || e === 4)
    return r.nodeValue;
  return t;
}
function Bc(r, e, t, s) {
  for (var i = r.firstChild, a = [], o; i; )
    i.nodeType === 3 ? (o = (i.nodeValue + "").replace(/^\n+/g, ""), s || (o = o.replace(/\s+/g, " ")), a.push.apply(a, m1(o, e, t, s))) : (i.nodeName + "").toLowerCase() === "br" ? a[a.length - 1] += "<br>" : a.push(i.outerHTML), i = i.nextSibling;
  for (o = a.length; o--; )
    a[o] === "&" && a.splice(o, 1, "&amp;");
  return a;
}
function m1(r, e, t, s) {
  if (r += "", t && (r = r.trim ? r.trim() : r.replace(v2, "")), e && e !== "")
    return r.replace(/>/g, "&gt;").replace(/</g, "&lt;").split(e);
  for (var i = [], a = r.length, o = 0, n, l; o < a; o++)
    l = r.charAt(o), (l.charCodeAt(0) >= 55296 && l.charCodeAt(0) <= 56319 || r.charCodeAt(o + 1) >= 65024 && r.charCodeAt(o + 1) <= 65039) && (n = ((r.substr(o, 12).split(k2) || [])[1] || "").length || 2, l = r.substr(o, n), i.emoji = 1, o += n - 1), i.push(l === ">" ? "&gt;" : l === "<" ? "&lt;" : s && l === " " && (r.charAt(o - 1) === " " || r.charAt(o + 1) === " ") ? "&nbsp;" : l);
  return i;
}
/*!
 * TextPlugin 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var xa, Bo, _2 = function() {
  return xa || typeof window < "u" && (xa = window.gsap) && xa.registerPlugin && xa;
}, ca = {
  version: "3.12.5",
  name: "text",
  init: function(e, t, s) {
    typeof t != "object" && (t = {
      value: t
    });
    var i = e.nodeName.toUpperCase(), a = this, o = t, n = o.newClass, l = o.oldClass, c = o.preserveSpaces, u = o.rtl, g = a.delimiter = t.delimiter || "", p = a.fillChar = t.fillChar || (t.padSpace ? "&nbsp;" : ""), h, m, y, k, _, C, T, x;
    if (a.svg = e.getBBox && (i === "TEXT" || i === "TSPAN"), !("innerHTML" in e) && !a.svg)
      return !1;
    if (a.target = e, !("value" in t)) {
      a.text = a.original = [""];
      return;
    }
    for (y = Bc(e, g, !1, c), Bo || (Bo = document.createElement("div")), Bo.innerHTML = t.value, m = Bc(Bo, g, !1, c), a.from = s._from, (a.from || u) && !(u && a.from) && (i = y, y = m, m = i), a.hasClass = !!(n || l), a.newClass = u ? l : n, a.oldClass = u ? n : l, i = y.length - m.length, h = i < 0 ? y : m, i < 0 && (i = -i); --i > -1; )
      h.push(p);
    if (t.type === "diff") {
      for (k = 0, _ = [], C = [], T = "", i = 0; i < m.length; i++)
        x = m[i], x === y[i] ? T += x : (_[k] = T + x, C[k++] = T + y[i], T = "");
      m = _, y = C, T && (m.push(T), y.push(T));
    }
    t.speed && s.duration(Math.min(0.05 / t.speed * h.length, t.maxDuration || 9999)), a.rtl = u, a.original = y, a.text = m, a._props.push("text");
  },
  render: function(e, t) {
    e > 1 ? e = 1 : e < 0 && (e = 0), t.from && (e = 1 - e);
    var s = t.text, i = t.hasClass, a = t.newClass, o = t.oldClass, n = t.delimiter, l = t.target, c = t.fillChar, u = t.original, g = t.rtl, p = s.length, h = (g ? 1 - e : e) * p + 0.5 | 0, m, y, k;
    i && e ? (m = a && h, y = o && h !== p, k = (m ? "<span class='" + a + "'>" : "") + s.slice(0, h).join(n) + (m ? "</span>" : "") + (y ? "<span class='" + o + "'>" : "") + n + u.slice(h).join(n) + (y ? "</span>" : "")) : k = s.slice(0, h).join(n) + n + u.slice(h).join(n), t.svg ? l.textContent = k : l.innerHTML = c === "&nbsp;" && ~k.indexOf("  ") ? k.split("  ").join("&nbsp;&nbsp;") : k;
  }
};
ca.splitInnerHTML = Bc;
ca.emojiSafeSplit = m1;
ca.getText = p1;
_2() && xa.registerPlugin(ca);
ht.registerPlugin(la);
const D2 = "a|above|after|an|and|at|below|but|by|down|for|for|from|in|nor|of|off|on|onto|or|out|so|the|to|under|up|with|yet".split("|").map((r) => new RegExp(`\\b${r}\\b`, "gui")), s0 = [
  "I",
  /[^a-z]{3,}|[.0-9]/gu
].map((r) => /RegExp/.test(Object.prototype.toString.call(r)) ? r : new RegExp(`\\b${r}\\b`, "gui")), T2 = `Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse ultricies
nibh sed massa euismod lacinia. Aliquam nec est ac nunc ultricies scelerisque porta vulputate odio.
Integer gravida mattis odio, semper volutpat tellus. Ut elit leo, auctor eget fermentum hendrerit,
aliquet ac nunc. Suspendisse porta turpis vitae mi posuere molestie. Cras lectus lacus, vulputate a
vestibulum in, mattis vel mi. Mauris quis semper mauris. Praesent blandit nec diam eget tincidunt. Nunc
aliquet consequat massa ac lacinia. Ut posuere velit sagittis, vehicula nisl eget, fringilla nibh. Duis
volutpat mattis libero, a porttitor sapien viverra ut. Phasellus vulputate imperdiet ligula, eget
eleifend metus tempor nec. Nam eget sapien risus. Praesent id suscipit elit. Sed pellentesque ligula
diam, non aliquet magna feugiat vitae. Pellentesque ut tortor id erat placerat dignissim. Pellentesque
ut dui vel leo laoreet sodales nec ac tellus. In hac habitasse platea dictumst. Proin sed ex sed augue
sollicitudin interdum. Sed id lacus porttitor nisi vestibulum tincidunt. Nulla facilisi. Vestibulum
feugiat finibus magna in pretium. Proin consectetur lectus nisi, non commodo lectus tempor et. Cras
viverra, mi in consequat aliquet, justo mauris fringilla tellus, at accumsan magna metus in eros. Sed
vehicula, diam ut sagittis semper, purus massa mattis dolor, in posuere.`, C2 = `
aboveboard|account|achiever|acoustics|act|action|activity|actor|addition|adjustment|advertisement|advice|afterglow|afterimage|afterlife|aftermath|afternoon|afterthought|agreement
air|aircraft|airfield|airlift|airline|airmen|airplane|airport|airtime|alarm|allover|allspice|alongside|also|amount|amusement|anger|angle|animal|another|ants|anyhow|anymore
anyone|anyplace|anytime|anywhere|apparatus|apparel|appliance|approval|arch|argument|arithmetic|arm|army|around|art|ashtray|attack|attraction|aunt|authority|babies|baby|babysitter
back|backache|backbone|backbreaker|backdrop|backfire|background|backhand|backlash|backlog|backpack|backside|backslap|backslide|backspace|backspin|backstroke|backtrack|backward
badge|bag|bait|balance|ball|ballroom|bankbook|bankroll|base|baseball|basin|basket|basketball|bat|bath|battle|beachcomb|bead|bear|because|become|bed|bedrock|bedroll|bedroom
beds|bee|beef|beginner|behavior|belief|believe|bell|bellboy|bellhop|bells|below|berry|bike|bikes|bird|birds|birth|birthday|bit|bite|blackball|blackberries|blackbird|blackboard
blackjack|blacklist|blackmail|blackout|blacksmith|blacktop|blade|blood|blow|blowgun|bluebell|blueberry|bluebird|bluefish|bluegrass|blueprint|board|boardwalk|boat|bodyguard
bomb|bone|book|bookcase|bookend|bookkeeper|bookmark|bookmobile|books|bookseller|bookshelf|bookworm|boot|border|bottle|boundary|bowlegs|bowtie|box|boy|brainchild|brake|branch
brass|breath|brick|bridge|brother|bubble|bucket|bugspray|building|bulb|burst|bushes|business|butter|butterball|buttercup|butterfingers|buttermilk|butternut|butterscotch|button
bypass|cabbage|cabdriver|cable|cactus|cake|cakes|calculator|calendar|camera|camp|can|cancan|candlelight|candlestick|cannon|cannot|canvas|cap|caption|car|card|cardsharp|care
carefree|careworn|carfare|carload|carpenter|carpool|carport|carriage|cars|carsick|cart|cartwheel|cast|cat|cats|cattle|catwalk|cause|cave|caveman|celery|cellar|cemetery|cent
centercut|chalk|chance|change|channel|cheese|cheeseburger|cherries|cherry|chess|chicken|chickens|children|chin|church|circle|clam|class|clockwise|cloth|clover|club|coach|coal
coast|coat|cobweb|coffeemaker|coil|collar|color|comeback|committee|commonplace|commonwealth|company|comparison|competition|condition|connection|control|cook|copper|corn|cornmeal
cough|country|courthouse|cover|cow|cows|crack|cracker|crate|crayon|cream|creator|creature|credit|crewcut|crib|crime|crook|crossbow|crossbreed|crosscut|crossover|crosswalk
crow|crowd|crown|cub|cup|current|curtain|curve|cushion|dad|dairymaid|daisywheel|daughter|day|daybed|daybook|daybreak|daydream|daylight|daytime|deadend|deadline|death|debt
decision|deer|degree|design|desire|desk|destruction|detail|development|digestion|dime|dinner|dinosaurs|direction|dirt|discovery|discussion|dishcloth|dishpan|dishwasher|dishwater
diskdrive|distance|distribution|division|dock|doctor|dog|dogs|doll|dolls|donkey|door|doorstop|downtown|downunder|drain|drawbridge|drawer|dress|drink|driveway|driving|drop
duck|duckbill|duckpin|ducks|dust|ear|earache|earring|earth|earthquake|earthward|earthworm|edge|education|effect|egg|egghead|eggnog|eggs|eggshell|elbow|end|engine|error|event
everything|example|exchange|existence|expansion|experience|expert|eye|eyeballs|eyecatching|eyeglasses|eyelash|eyelid|eyes|eyesight|eyewitness|face|fact|fairies|fall|fang|farm
fatherland|fear|feeling|field|finger|fire|fireball|fireboat|firebomb|firebreak|firecracker|firefighter|firehouse|fireman|fireproof|fireworks|fish|fishbowl|fisherman|fisheye
fishhook|fishmonger|fishnet|fishpond|fishtail|flag|flame|flavor|flesh|flight|flock|floor|flower|flowers|fly|fog|fold|food|foot|football|foothill|footlights|footlocker|footprints
forbearer|force|forearm|forebear|forebrain|forecast|foreclose|foreclosure|foredoom|forefather|forefeet|forefinger|forefoot|forego|foregone|forehand|forehead|foreknowledge
foreleg|foreman|forepaws|foresee|foreshadow|forestall|forethought|foretold|forever|forewarn|foreword|forget|fork|forklift|form|fowl|frame|friction|friend|friends|frog|frogs
front|fruit|fruitcup|fuel|furniture|gate|gearshift|geese|ghost|giants|giraffe|girl|girls|glass|glassmaking|glove|gold|goodbye|goodnight|government|governor|grade|grain|grandaunt
granddaughter|grandfather|grandmaster|grandmother|grandnephew|grandparent|grandson|grandstand|granduncle|grape|grass|grassland|graveyard|grip|ground|group|growth|guide|guitar
gumball|gun|hair|haircut|hall|hamburger|hammer|hand|handbook|handgun|handmade|handout|hands|harbor|harmony|hat|hate|head|headache|headlight|headline|headquarters|health|heat
hereafter|hereby|herein|hereupon|highchair|highland|highway|hill|himself|history|hobbies|hole|holiday|home|homemade|hometown|honey|honeybee|honeydew|honeysuckle|hook|hookup
hope|horn|horse|horseback|horsefly|horsehair|horseman|horseplay|horsepower|horseradish|horses|hose|hospital|hot|hour|house|houseboat|household|housekeeper|houses|housetop
however|humor|hydrant|ice|icicle|idea|impulse|income|increase|industry|ink|insect|inside|instrument|insurance|intake|interest|invention|iron|island|itself|jail|jailbait|jam
jar|jeans|jelly|jellybean|jellyfish|jetliner|jetport|jewel|join|judge|juice|jump|jumpshot|kettle|key|keyboard|keyhole|keynote|keypad|keypunch|keystone|keystroke|keyword|kick
kiss|kittens|kitty|knee|knife|knot|knowledge|laborer|lace|ladybug|lake|lamp|land|language|laugh|leather|leg|legs|letter|letters|lettuce|level|library|lifeblood|lifeguard|lifelike
lifeline|lifelong|lifetime|lifework|limelight|limestone|limit|line|linen|lip|liquid|loaf|lock|locket|longhand|look|loss|love|low|lukewarm|lumber|lunch|lunchroom|machine|magic
maid|mailbox|mainline|man|marble|mark|market|mask|mass|match|matchbox|meal|meantime|meanwhile|measure|meat|meeting|memory|men|metal|mice|middle|milk|mind|mine|minister|mint
minute|mist|mitten|mom|money|monkey|month|moon|moonbeam|moonlight|moonlit|moonscape|moonshine|moonstruck|moonwalk|moreover|morning|mother|motion|motorcycle|mountain|mouth
move|muscle|name|nation|nearby|neck|need|needle|nerve|nest|nevermore|newsboy|newsbreak|newscaster|newsdealer|newsletter|newsman|newspaper|newsprint|newsreel|newsroom|night
nightfall|nobody|noise|noisemaker|north|northeast|nose|note|notebook|nowhere|number|nursemaid|nut|nutcracker|oatmeal|observation|ocean|offer|office|oil|oneself|onetime|orange
oranges|order|oven|overboard|overcoat|overflow|overland|pacemaker|page|pail|pan|pancake|paper|parcel|part|partner|party|passbook|passenger|passkey|Passover|passport|payment
peace|pear|pen|pencil|peppermint|person|pest|pet|pets|pickle|pickup|picture|pie|pies|pig|pigs|pin|pinhole|pinstripe|pinup|pinwheel|pipe|pizzas|place|plane|planes|plant|plantation
plants|plastic|plate|play|playback|playground|playhouse|playthings|pleasure|plot|plough|pocket|point|poison|pollution|ponytail|popcorn|porter|position|postcard|pot|potato
powder|power|price|produce|profit|property|prose|protest|pull|pump|punishment|purpose|push|quarter|quartz|queen|question|quicksand|quiet|quill|quilt|quince|quiver|rabbit|rabbits
racquetball|rail|railroad|railway|rain|raincheck|raincoat|rainstorm|rainwater|rake|range|rat|rate|rattlesnake|rattletrap|ray|reaction|reading|reason|receipt|recess|record
regret|relation|religion|repairman|representative|request|respect|rest|reward|rhythm|rice|riddle|rifle|ring|rings|river|riverbanks|road|robin|rock|rod|roll|roof|room|root
rose|route|rub|rubberband|rule|run|sack|sail|sailboat|salesclerk|salt|sand|sandlot|sandstone|saucepan|scale|scapegoat|scarecrow|scarf|scene|scent|school|schoolbook|schoolboy
schoolbus|schoolhouse|science|scissors|screw|sea|seashore|seat|secretary|seed|selection|self|sense|servant|shade|shadyside|shake|shame|shape|sharecropper|sharpshooter|sheep
sheepskin|sheet|shelf|ship|shirt|shock|shoe|shoelace|shoemaker|shoes|shop|shortbread|show|showoff|showplace|side|sidekick|sidewalk|sign|silk|silver|silversmith|sink|sister
sisterhood|sisters|sixfold|size|skate|skateboard|skin|skintight|skirt|sky|skylark|skylight|slave|sleep|sleet|slip|slope|slowdown|slumlord|smash|smell|smile|smoke|snail|snails
snake|snakes|snakeskin|sneeze|snow|snowball|snowbank|snowbird|snowdrift|snowshovel|soap|society|sock|soda|sofa|softball|somebody|someday|somehow|someone|someplace|something
sometimes|somewhat|somewhere|son|song|songs|sort|sound|soundproof|soup|southeast|southwest|soybean|space|spacewalk|spade|spark|spearmint|spiders|spillway|spokesperson|sponge
spoon|spot|spring|spy|square|squirrel|stage|stagehand|stamp|standby|standoff|standout|standpoint|star|starfish|start|statement|station|steam|steamship|steel|stem|step|stepson
stew|stick|sticks|stitch|stocking|stockroom|stomach|stone|stop|stoplight|stopwatch|store|story|stove|stranger|straw|stream|street|stretch|string|stronghold|structure|substance
subway|sugar|suggestion|suit|summer|sun|sunbaked|sunbathe|sundial|sundown|sunfish|sunflower|sunglasses|sunlit|sunray|sunroof|sunup|supercargo|supercharge|supercool|superego
superfine|supergiant|superhero|superhighways|superhuman|superimpose|supermarket|supermen|supernatural|superpower|superscript|supersensitive|supersonic|superstar|superstrong
superstructure|supertanker|superweapon|superwoman|support|surprise|sweater|sweetheart|sweetmeat|swim|swing|system|table|tablecloth|tablespoon|tabletop|tableware|tail|tailcoat
tailgate|taillight|taillike|tailpiece|tailspin|takeoff|takeout|takeover|talebearer|taleteller|talk|tank|tapeworm|taproom|taproot|target|taskmaster|taste|tax|taxicab|taxpayer
teaching|teacup|team|teammate|teamwork|teapot|teaspoon|teenager|teeth|telltale|temper|tendency|tenderfoot|tenfold|tent|territory|test|textbook|texture|theory|therefore|thing
things|thought|thread|thrill|throat|throne|throwaway|throwback|thumb|thunder|thunderbird|thunderstorm|ticket|tiger|time|timekeeper|timesaving|timeshare|timetable|tin|title
toad|toe|toes|together|tomatoes|tongue|toolbox|tooth|toothbrush|toothpaste|toothpick|top|touch|touchdown|town|township|toy|toys|trade|trail|train|trains|tramp|transport|tray
treatment|tree|trees|trick|trip|trouble|trousers|truck|trucks|tub|turkey|turn|turnabout|turnaround|turnbuckle|turndown|turnkey|turnoff|turntable|twig|twist|typewriter|umbrella
uncle|underachieve|underage|underarm|underbelly|underbid|undercharge|underclothes|undercover|undercut|underdevelop|underestimate|underexpose|underfoot|underground|underwear
unit|upbeat|upbringing|upcoming|update|upend|upgrade|upheaval|uphill|uphold|upkeep|upland|uplift|upload|upmarket|upon|uppercase|upperclassman|uppercut|uproar|uproot|upset
upshot|upside|upstage|upstairs|upstanding|upstart|upstate|upstream|uptake|upthrust|uptight|uptime|uptown|upward|upwind|use|vacation|value|van|vase|vegetable|veil|vein|verse
vessel|vest|view|visitor|voice|volcano|volleyball|voyage|waistline|walk|walkways|wall|walleyed|wallpaper|war|wardroom|warfare|warmblooded|warpath|wash|washbowl|washcloth|washhouse
washout|washrag|washroom|washstand|washtub|waste|wastebasket|wasteland|wastepaper|wastewater|watch|watchband|watchdog|watchmaker|watchman|watchtower|watchword|water|watercolor
watercooler|watercraft|waterfall|waterfront|waterline|waterlog|watermelon|waterpower|waterproof|waterscape|watershed|waterside|waterspout|watertight|wave|wavelike|waves|wax
waxwork|way|waybill|wayfarer|waylaid|wayside|wayward|wealth|weather|weathercock|weatherman|weatherproof|week|weekday|weekend|weeknight|weight|whatever|whatsoever|wheel|wheelchair
wheelhouse|whip|whistle|whitecap|whitefish|whitewall|whitewash|widespread|wilderness|wind|window|wine|wing|winter|wipeout|wire|wish|without|woman|women|wood|woodshop|wool
word|work|worm|wound|wren|wrench|wrist|writer|writing|yak|yam|yard|yarn|year|yoke|zebra|zephyr|zinc|zipper|zoo
`.split("|"), Vs = {
  ones: [
    "zero",
    "one",
    "two",
    "three",
    "four",
    "five",
    "six",
    "seven",
    "eight",
    "nine",
    "ten",
    "eleven",
    "twelve",
    "thirteen",
    "fourteen",
    "fifteen",
    "sixteen",
    "seventeen",
    "eighteen",
    "nineteen",
    "twenty"
  ],
  tens: ["", "", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"],
  tiers: ["", "thousand", "million", "billion", "trillion", "quadrillion", "quintillion", "sextillion", "septillion", "octillion", "nonillion"],
  bigPrefixes: ["", "un", "duo", "tre", "quattuor", "quin", "sex", "octo", "novem"],
  bigSuffixes: ["", "decillion", "vigintillion", "trigintillion", "quadragintillion", "quinquagintillion", "sexagintillion", "septuagintillion", "octogintillion", "nonagintillion", "centillion"]
}, i0 = {
  zero: "zeroeth",
  one: "first",
  two: "second",
  three: "third",
  four: "fourth",
  five: "fifth",
  eight: "eighth",
  nine: "ninth",
  twelve: "twelfth",
  twenty: "twentieth",
  thirty: "thirtieth",
  forty: "fortieth",
  fifty: "fiftieth",
  sixty: "sixtieth",
  seventy: "seventieth",
  eighty: "eightieth",
  ninety: "ninetieth"
}, S2 = {
  grouped: [
    ["", "Ⅰ", "Ⅱ", "Ⅲ", "Ⅳ", "Ⅴ", "Ⅵ", "Ⅶ", "Ⅷ", "Ⅸ"],
    ["", "Ⅹ", "ⅩⅩ", "ⅩⅩⅩ", "ⅩⅬ", "Ⅼ", "ⅬⅩ", "ⅬⅩⅩ", "ⅬⅩⅩⅩ", "ⅩⅭ"],
    ["", "Ⅽ", "ⅭⅭ", "ⅭⅭⅭ", "ⅭⅮ", "Ⅾ", "ⅮⅭ", "ⅮⅭⅭ", "ⅮⅭⅭⅭ", "ⅭⅯ"],
    ["", "Ⅿ", "ⅯⅯ", "ⅯⅯⅯ", "Ⅿↁ", "ↁ", "ↁⅯ", "ↁⅯⅯ", "ↁⅯⅯⅯ", "ↁↂ"],
    ["", "ↂ", "ↂↂ", "ↂↂↂ", "ↂↇ", "ↇ", "ↇↂ", "ↇↂↂ", "ↇↂↂↂ", "ↇↈ"],
    ["", "ↈ", "ↈↈ", "ↈↈↈ"]
  ],
  ungrouped: [
    ["", "Ⅰ", "ⅠⅠ", "ⅠⅠⅠ", "ⅠⅤ", "Ⅴ", "ⅤⅠ", "ⅤⅠⅠ", "ⅤⅠⅠⅠ", "ⅠⅩ"],
    ["", "Ⅹ", "ⅩⅩ", "ⅩⅩⅩ", "ⅩⅬ", "Ⅼ", "ⅬⅩ", "ⅬⅩⅩ", "ⅬⅩⅩⅩ", "ⅩⅭ"],
    ["", "Ⅽ", "ⅭⅭ", "ⅭⅭⅭ", "ⅭⅮ", "Ⅾ", "ⅮⅭ", "ⅮⅭⅭ", "ⅮⅭⅭⅭ", "ⅭⅯ"],
    ["", "Ⅿ", "ⅯⅯ", "ⅯⅯⅯ", "Ⅿↁ", "ↁ", "ↁⅯ", "ↁⅯⅯ", "ↁⅯⅯⅯ", "ↁↂ"],
    ["", "ↂ", "ↂↂ", "ↂↂↂ", "ↂↇ", "ↇ", "ↇↂ", "ↇↂↂ", "ↇↂↂↂ", "ↇↈ"],
    ["", "ↈ", "ↈↈ", "ↈↈↈ"]
  ]
}, Zl = [], E2 = () => {
  var r, e;
  return ((e = (r = game == null ? void 0 : game.user) == null ? void 0 : r.find((t) => t.isGM)) == null ? void 0 : e.id) ?? !1;
}, fl = (r) => typeof r == "number" && !isNaN(r), y1 = (r) => typeof r == "string" && !isNaN(parseFloat(r)) && isFinite(parseFloat(r)), b1 = (r) => typeof r == "string" && (r === "true" || r === "false"), lt = (r) => Array.isArray(r), w1 = (r) => r === Object(r) && !lt(r), ti = (r) => r === Object(r) && !lt(r), v1 = (r) => typeof r == "function", Ja = (r) => fl(r) && Math.round(r) === r, k1 = (r) => fl(r) && /\./.test(`${r}`), Hc = (r) => Ja(r) && r >= 0, _1 = (r) => ti(r) || lt(r), A2 = (r) => typeof r == "object" && r !== null && Symbol.iterator in r, x2 = (r) => typeof r == "string" && /^<.*>$/u.test(r), pl = (r) => typeof r == "string" && /^#(([0-9a-fA-F]{2}){3,4}|[0-9a-fA-F]{3,4})$/.test(r), ml = (r) => typeof r == "string" && /^rgba?\((\d{1,3},\s*){1,2}?\d{1,3},\s*\d{1,3}(\.\d+)?\)$/.test(r), Hs = (r) => r === void 0, Yr = (r) => !Hs(r), Mu = (r) => Object.keys(r).length === 0, Ou = (r) => !Mu(r), I2 = (r, e) => e instanceof r, P2 = (r) => Hs(r) || r === null;
function D1(r, e) {
  let t;
  try {
    t = JSON.stringify(r);
  } catch {
    t = String(r);
  }
  if (r === void 0)
    throw new Error(`Value ${t} is undefined!`);
  if (typeof e == "string") {
    if (typeof r !== e)
      throw new Error(`Value ${t} is not a ${e}!`);
  } else if (!(r instanceof e))
    throw new Error(`Value ${t} is not a ${e.name}!`);
}
const T1 = (r, e) => [null, void 0].includes(r) && [null, void 0].includes(e) ? !0 : [null, void 0].includes(r) || [null, void 0].includes(e) ? !1 : typeof r == "number" && typeof e == "number" || typeof r == "boolean" && typeof e == "boolean" || typeof r == "string" && typeof e == "string" ? r === e : typeof r == "number" && typeof e == "string" ? r === Number(e) : typeof r == "string" && typeof e == "number" ? Number(r) === e : typeof r == "boolean" && typeof e == "object" || typeof r == "object" && typeof e == "boolean" ? !1 : typeof r == "boolean" && typeof e == "string" ? r && e !== "" || !r && e === "" : typeof r == "string" && typeof e == "boolean" ? e && r !== "" || !e && r === "" : (typeof r == "number" || typeof r == "string") && typeof e == "object" || typeof r == "object" && (typeof e == "number" || typeof e == "string") ? !1 : typeof r == "object" && typeof e == "object" ? r === e : !1, M2 = (...r) => {
  do {
    const e = r.pop();
    if (r.length && !T1(e, r[0]))
      return !1;
  } while (r.length);
  return !0;
}, cs = (r, e, t = !1) => (typeof r == "string" && (r = parseFloat(r)), typeof r == "number" ? isNaN(r) ? t ? NaN : 0 : Hs(e) ? r : Math.round(r * 10 ** e) / 10 ** e : t ? NaN : 0), qt = (r, e, t) => {
  let s = !1;
  return typeof e == "boolean" && (s = e), isNaN(cs(r, 0, s)) ? NaN : Math.round(cs(r, 0, s));
}, O2 = (r) => typeof r == "boolean" ? r : [0, null, void 0, ""].includes(r) ? !1 : typeof r == "string" ? !["0", "false", "null", "undefined", ""].includes(r) : !(lt(r) && r.length === 0 || ti(r) && Mu(r)), C1 = (r, e = !0) => (r = e ? r % (2 * Math.PI) : r, r *= 180 / Math.PI, r), F2 = (r, e = !0) => (r = e ? r % 360 : r, r *= Math.PI / 180, r), L2 = (r, e) => r in e ? e[r] : null, R2 = {
  IsInstance: (r) => (e) => typeof r == "function" && e instanceof r
}, S1 = (r) => String(r).toUpperCase(), si = (r) => String(r).toLowerCase(), Fu = (r) => {
  let [e, ...t] = `${r ?? ""}`.split(/\s+/);
  return e = In(e, s0) ? e : `${S1(e.charAt(0))}${si(e.slice(1))}`, Ou(t) && (t = t.map((s) => In(s, s0) ? s : si(s))), [e, ...t].join(" ").trim();
}, $2 = (r) => String(r).split(/\s/).map((e, t) => t && In(e, D2) ? si(e) : Fu(e)).join(" ").trim(), In = (r, e = [], t = "gui", s = !1) => e.map((i) => i instanceof RegExp ? i : new RegExp(`\\b${i}\\b`, t))[s ? "every" : "some"]((i) => i.test(`${r}`)), Nr = (r, e, t) => {
  const s = [];
  [...(t ?? "").replace(/g/g, ""), "u"].forEach((o) => {
    o && !s.includes(o) && s.push(o);
  });
  const i = /[)(]/.test(e.toString().replace(/\\\)|\\\(/g, ""));
  i && s.push("g"), t = s.join(""), e = new RegExp(e, t);
  const a = `${r}`.match(e) || [];
  return i ? Array.from(a) : a.pop();
}, N2 = (r) => `${r}`.replace(/[\u00AD\u200B]/gu, ""), B2 = (r) => `${r}`.replace(/\b([aA])\s([aeiouAEIOU])/gu, "$1n $2"), H2 = (r, e = 2, t) => cs(e) === 1 ? r : t ?? `${r.replace(/y$/, "ie").replace(/s$/, "se")}s`, W2 = (r, e = !0, t = "and") => {
  if (r.length === 0)
    return "";
  if (r.length === 1)
    return `${r[0]}`;
  const s = r.pop();
  return [
    r.join(", "),
    e ? "," : "",
    ` ${t} `,
    s
  ].join("");
}, j2 = (r, e) => {
  const t = String(r);
  return t.length > e ? `${t.slice(0, e - 3)}…` : t;
}, K2 = (r, e, t = " ") => {
  const s = `${r}`;
  return s.length < e ? `${t.repeat(e - s.length)}${s}` : s;
}, G2 = (r) => (r ?? "").toLowerCase().replace(/ /g, "-").replace(/default/, "DEFAULT"), E1 = (r, e = "", t = "+") => {
  let s;
  const i = cs(r);
  return i < 0 ? s = "-" : i === 0 ? s = t : s = "+", `${s}${e}${Math.abs(i)}`;
}, V2 = (r, e, t = !1) => {
  const s = t && r >= 0 ? "+" : "", [i, a] = `${cs(r)}`.split(/\./);
  return getType(a) === "int" ? a.length > e ? `${s}${cs(r, e)}` : a.length < e ? `${s}${i}.${a}${"0".repeat(e - a.length)}` : `${s}${cs(r)}` : `${s}${i}.${"0".repeat(e)}`;
}, Lu = (r) => {
  var i;
  if (cs(r) === 0)
    return "0";
  const e = si(r).replace(/[^\d.e+-]/g, ""), t = Nr(e, /^-?[\d.]+/), s = qt(Nr(e, /e([+-]?\d+)$/));
  if (typeof t == "string" && typeof s == "string") {
    let a = Nr(t, /^-?(\d+)/), o = Nr(t, /\.(\d+)/);
    if (lt(a) && lt(o) && (a = (i = a.pop()) == null ? void 0 : i.replace(/^0+/, ""), o = si(o == null ? void 0 : o.pop()).replace(/0+$/, ""), !Hs(a) && !Hs(o))) {
      const n = Math.max(0, a.length + s), l = Math.max(0, o.length - s), c = [
        a.slice(0, n),
        o.slice(0, Math.max(0, s))
      ].join("") || "0", u = [
        a.length - n > 0 ? a.slice(a.length - n - 1) : "",
        o.slice(o.length - l)
      ].join("");
      return [
        e.charAt(0) === "-" ? "-" : "",
        c,
        "0".repeat(Math.max(0, n - c.length)),
        u.length ? "." : "",
        "0".repeat(Math.max(0, l - u.length)),
        u
      ].join("");
    }
  }
  return `${r}`;
}, A1 = (r) => {
  var l;
  r = Lu(r);
  const e = (c) => c < Vs.tiers.length ? Vs.tiers[c] : [
    Vs.bigPrefixes[c % 10 - 1],
    Vs.bigSuffixes[Math.floor(c / 10)]
  ].join(""), t = (c) => {
    if (qt(c) === 0)
      return "";
    const u = `${c}`.split("").map((p) => qt(p));
    let g = "";
    if (u.length === 3) {
      const p = u.shift();
      if (Hs(p))
        throw new Error(`[U.verbalizeNum] Undefined digit in trio '${u.join("")}'.`);
      g += p > 0 ? `${Vs.ones[p]} hundred` : "", p && (u[0] || u[1]) && (g += " and ");
    }
    if (qt(u.join("")) <= Vs.ones.length)
      g += Vs.ones[qt(u.join(""))];
    else {
      const p = Vs.tens[qt(u.shift())], h = qt(u[0]) > 0 ? `-${Vs.ones[qt(u[0])]}` : "";
      g += `${p}${h}`;
    }
    return g;
  }, s = [];
  r.charAt(0) === "-" && s.push("negative");
  const [i, a] = r.replace(/[,\s-]/g, "").split("."), o = ((l = [...i.split("")].reverse().join("").match(/.{1,3}/g)) == null ? void 0 : l.map((c) => [...c.split("")].reverse().join(""))) ?? [], n = [];
  for (; o.length; ) {
    const c = o.pop();
    if (c) {
      const u = t(c);
      u && n.push(`${u} ${e(o.length)}`);
    }
  }
  if (s.push(n.join(", ").trim()), getType(a) === "int") {
    i === "0" && s.push("zero"), s.push("point");
    for (const c of a.split(""))
      s.push(Vs.ones[qt(c)]);
  }
  return s.join(" ");
}, z2 = (r, e = !1) => {
  if (e) {
    const [t, s] = si(A1(r)).match(/.*?[-\s]?(\w*)$/i) ?? ["", ""];
    return t.replace(
      new RegExp(`${s}$`),
      s in i0 ? i0[s] : `${s}th`
    );
  }
  return /(\.)|(1[1-3]$)/.test(`${r}`) ? `${r}th` : `${r}${["th", "st", "nd", "rd", "th", "th", "th", "th", "th", "th"][qt(`${r}`.charAt(`${r}`.length - 1))]}`;
}, q2 = (r, e = !0) => {
  if (k1(r))
    throw new Error(`Error: Can't Romanize Floats (${r})`);
  if (r >= 4e5)
    throw new Error(`Error: Can't Romanize >= 400,000 (${r})`);
  if (r < 0)
    throw new Error(`Error: Can't Romanize Negative Numbers (${r})`);
  if (r === 0)
    return "0";
  const t = S2[e ? "grouped" : "ungrouped"], s = [...Lu(r).split("")].reverse().map((i, a) => t[a][qt(i)]).reverse().join("");
  return e ? s.replace(/ⅩⅠ/gu, "Ⅺ").replace(/ⅩⅡ/gu, "Ⅻ") : s;
}, Y2 = (r = 200) => {
  const e = T2.split(/\n?\s+/g), t = [...e[yl(0, e.length - 1)]];
  for (; t.length < r; )
    t.push(...e);
  return t.length = r, `${Fu(t.join(" ")).trim().replace(/[^a-z\s]*$/ui, "")}.`;
}, U2 = (r = 5) => Array.from({ length: r }).map(() => String.fromCharCode(Ru(...["a", "z"].map((e) => e.charCodeAt(0))))).join(""), X2 = (r = 1, e = C2) => Array.from({ length: r }).map(() => Nu([...e])).join(" "), Z2 = (r) => {
  const e = Math.max(
    0,
    ...Zl.filter(([s]) => s.startsWith(r)).map(([, , s]) => s)
  ) + 1, t = e === 1 ? r : `${r}_${e}`;
  return Zl.push([r, t, e]), eLog.log(`UUIDify(${r}) --> [${t}, ${e}]`), Object.assign(globalThis, { UUIDLOG: Zl }), t;
}, J2 = (r, e) => {
  const [t, s] = [r, e].map((i) => si(String(i).replace(/[^a-zA-Z0-9.+-]/g, "").trim()));
  return t.length > 0 && t === s;
}, x1 = (r, e = [], t = 0) => {
  const s = [
    (n, l) => new RegExp(`^${n}$`, "gu").test(`${l}`),
    (n, l) => new RegExp(`^${n}$`, "gui").test(`${l}`)
  ];
  if (t >= 1) {
    const n = [
      (l, c) => new RegExp(`^${l}`, "gui").test(`${c}`),
      (l, c) => new RegExp(`${l}$`, "gui").test(`${c}`),
      (l, c) => new RegExp(`${l}`, "gui").test(`${c}`),
      (l, c) => new RegExp(`${c}`, "gui").test(`${l}`)
    ];
    s.push(...n), t >= 2 && (s.push(...n.map((l) => (c, u) => l(`${c}`.replace(/\W/g, ""), `${u}`.replace(/\W/gu, "")))), t >= 3 && s.push(() => !1));
  }
  const i = `${r}`, a = (() => {
    if (lt(e))
      return [...e];
    if (ti(e))
      return Object.keys(e);
    try {
      return Array.from(e);
    } catch {
      throw new Error(`Haystack type must be [list, array], not ${typeof e}: ${JSON.stringify(e)}`);
    }
  })();
  if (!lt(a))
    return !1;
  let o = -1;
  for (; !Hc(o); ) {
    const n = s.shift();
    if (!n)
      return !1;
    o = a.findIndex((l) => n(i, `${l}`));
  }
  return Hc(o) ? ti(e) ? Object.values(e)[o] : e[o] : !1;
}, Q2 = (r, e) => x1(r, e, 0), yl = (r, e, t = 0) => ht.utils.random(r, e, t), Ru = (r, e) => yl(r, e, 1), em = () => yl(0, 1, 1) === 1, I1 = (r, [e = 0, t = 1 / 0] = []) => ht.utils.wrap(e, t, r), tm = (r, [e = 0, t = 1 / 0] = []) => ht.utils.clamp(e, t, r), $u = (r, e = [0, 360]) => I1(r, e), mo = (r, e = 0) => e === 0 ? qt(r) : cs(r, e), P1 = (...r) => Object.values(r.flat()).reduce((e, t) => t + e, 0), sm = (...r) => P1(...r) / r.flat().length, im = ({ x: r, y: e }, { x: t, y: s }) => ((r - t) ** 2 + (e - s) ** 2) ** 0.5, rm = ({ x: r, y: e }, { x: t, y: s }, { x: i, y: a } = { x: 0, y: 0 }, o = [0, 360]) => (r -= i, e -= a, t -= i, s -= a, $u(C1(Math.atan2(s - e, t - r)), o)), M1 = (r, e, t = [0, 360]) => $u(e - r, t), am = (r) => {
  let e = 1 / 0, t = 1 / 0, s = -1 / 0, i = -1 / 0;
  for (const c of r) {
    let u, g, p, h;
    if (c.radius !== void 0)
      u = c.x - c.radius, g = c.y - c.radius, p = c.x + c.radius, h = c.y + c.radius;
    else if (c.size !== void 0)
      u = (c.x - c.size) / 2, g = (c.y - c.size) / 2, p = (c.x + c.size) / 2, h = (c.y + c.size) / 2;
    else if (c.width !== void 0 || c.height !== void 0)
      c.width ?? (c.width = c.height), c.height ?? (c.height = c.width), u = (c.x - c.width) / 2, g = (c.y - c.height) / 2, p = (c.x + c.width) / 2, h = (c.y + c.height) / 2;
    else
      throw new Error(`[getBoundingRectangle] Error: shape must be a circle, square, or rectangle, not ${JSON.stringify(c)}`);
    e = Math.min(e, u), t = Math.min(t, g), s = Math.max(s, p), i = Math.max(i, h);
  }
  const a = s - e, o = i - t, n = (e + a) / 2, l = (t + o) / 2;
  return { x: n, y: l, width: a, height: o };
}, Nu = (r) => ht.utils.random(r), om = (r) => Ru(0, r.length - 1), nm = (r, e) => {
  const t = [];
  for (let s = r; s <= e; s++)
    t.push(s);
  return t;
}, lm = (r, e = 0) => {
  const t = ht.utils.wrap(r);
  return e--, function* () {
    for (; ; )
      e++, yield t(e);
  }();
};
function cm(r) {
  if (r = Object.values(r), r.length === 0)
    throw new Error("Cannot get last element of an empty array.");
  return r[r.length - 1];
}
const um = (r) => {
  const e = [];
  return r.forEach((t) => {
    e.includes(t) || e.push(t);
  }), e;
}, hm = (r, e) => {
  const t = {};
  return r.forEach((s) => {
    const i = s[e];
    let a = t[i];
    a || (a = [], t[i] = a), a.push(s);
  }), t;
}, dm = (r, e = 1, t = !0, s = (i, a) => !a.includes(i)) => {
  const i = [];
  let a = 0;
  for (; i.length < e && a < 1e6; ) {
    const o = Nu(r);
    t && s(o, i) && i.push(o), a++;
  }
  return i;
}, gm = (r, e) => r.splice(r.findIndex((t) => t === e));
function O1(r, e) {
  let t;
  typeof e != "function" ? t = (i) => i === e : t = e;
  const s = r.findIndex((i, a, o) => t(i, a, o));
  if (s !== -1)
    return r.splice(s, 1).pop();
}
const fm = (r, e) => O1(r, (t, s) => s === e), pm = (r, e) => {
  const t = [];
  for (; r.length > e; ) {
    const s = [];
    for (; s.length < e; )
      s.push(r.shift());
    t.push(s);
  }
  return t.push(r), t;
}, mm = (r) => {
  let e = r.length, t;
  for (; e !== 0; )
    t = Math.floor(Math.random() * e), e--, [r[e], r[t]] = [
      r[t],
      r[e]
    ];
  return r;
}, ym = (r) => ht.utils.toArray(r), Pn = ({ k: r, v: e }, t) => v1(t) ? Yr(e) ? t(e, r) : t(r) : new RegExp(`${t}`).test(`${e}`), bm = (r, e) => {
  if (lt(r)) {
    const t = r.findIndex((s) => Pn({ v: s }, e));
    if (t >= 0)
      return wm(r, t);
  } else if (ti(r)) {
    const [t] = Object.entries(r).find(([s, i]) => Pn({ k: s, v: i }, e)) ?? [];
    if (t)
      return vm(r, t);
  }
  return !1;
}, wm = (r, e) => {
  let t;
  for (let s = 0; s <= r.length; s++)
    s === e ? t = r.shift() : r.push(r.shift());
  return t;
}, vm = (r, e) => {
  const t = r[e];
  return delete r[e], t;
}, km = (r, e, t) => {
  let s;
  if (ti(r)) {
    if ([s] = Object.entries(r).find((i) => Pn({ v: i }, e)) || [!1], s === !1)
      return !1;
  } else if (lt(r) && (s = r.findIndex((i) => Pn({ v: i }, e)), s === -1))
    return !1;
  return typeof s != "number" && (s = `${s}`), typeof t == "function" ? r[s] = t(r[s], s) : r[s] = t, !0;
}, Wc = (r, e = [void 0, null, "", {}, []]) => {
  if (e.map((s) => JSON.stringify(s)).includes(JSON.stringify(r)) || e.includes(r))
    return "KILL";
  if (Array.isArray(r)) {
    const s = r.map((i) => Wc(i, e)).filter((i) => i !== "KILL");
    return Array.isArray(s) && s.length ? s : "KILL";
  }
  if (r && typeof r == "object" && JSON.stringify(r).startsWith("{")) {
    const s = Object.entries(r).map(([i, a]) => [i, Wc(a, e)]).filter(([, i]) => i !== "KILL");
    return s.length ? Object.fromEntries(s) : "KILL";
  }
  return r;
}, _m = (r, e = () => !0) => [
  Mn(r, e),
  Mn(r, (t, s) => !e(t, s))
], Dm = (r, e) => {
  if (r.length !== e.length)
    throw new Error("The arrays must be of equal length.");
  if (new Set(r).size !== r.length)
    throw new Error("The keys must be unique.");
  const t = {};
  return r.forEach((s, i) => {
    t[s] = e[i];
  }), t;
};
function F1(r, e, t) {
  let s = t, i = e;
  return s || (s = e, i = !1), i || (i = (a) => a), Array.isArray(r) ? r.map(s) : Object.fromEntries(Object.entries(r).map(([a, o]) => (D1(s, "function"), [i(a, o), s(o, a)])));
}
const L1 = (r) => w1(r) ? Object.keys(r).length : lt(r) ? r.length : r === !1 || r === null || r === void 0 ? 0 : 1;
function Tm(r, e, t) {
  if (t || (t = e, e = !1), lt(r))
    return r.findIndex(t);
  const s = e || (() => !0), i = t || (() => !0), a = Object.entries(r).find(([o, n]) => s(o, n) && i(n, o));
  return a ? a[0] : !1;
}
const Mn = (r, e, t, s = !1) => {
  if (t || (t = e, e = !1), lt(r)) {
    const o = r.filter(t);
    return s ? (r.splice(0, r.length, ...o), r) : o;
  }
  const i = e || (() => !0), a = t || (() => !0);
  if (s) {
    const o = Object.entries(r).filter(([n, l]) => !(i(n, l) && a(l, n)));
    for (const [n] of o)
      delete r[n];
    return r;
  }
  return Object.fromEntries(
    Object.entries(r).filter(([o, n]) => i(o, n) && a(n, o))
  );
}, Cm = (r, e) => {
  lt(r) ? r.forEach(e) : Object.entries(r).forEach(([t, s]) => e(s, t));
}, Sm = (r, e = [void 0, null], t = !1) => Mn(r, (s) => !e.includes(s), void 0, t), R1 = (r, e = !1) => {
  const t = (i) => [...i], s = (i) => ({ ...i });
  try {
    return JSON.parse(JSON.stringify(r));
  } catch (i) {
    if (e)
      throw i;
    if (Array.isArray(r))
      return t(r);
    if (typeof r == "object")
      return s(r);
  }
  return r;
};
function $1(r, e, {
  isMutatingOk: t = !1,
  isStrictlySafe: s = !1,
  isConcatenatingArrays: i = !0,
  isReplacingArrays: a = !1
} = {}) {
  if (r = t ? r : R1(r, s), e && typeof e == "object" && "id" in e && wl(e.id) || Hs(r))
    return e;
  if (Hs(e) || !_1(e))
    return r;
  for (const [o, n] of Object.entries(e)) {
    const l = r[o];
    a && lt(l) && lt(n) ? r[o] = n : i && lt(l) && lt(n) ? r[o].push(...n) : n !== null && typeof n == "object" ? (Hs(l) && !(n instanceof Application) && (r[o] = new (Object.getPrototypeOf(n)).constructor()), r[o] = $1(
      r[o],
      n,
      { isMutatingOk: !0, isStrictlySafe: s }
    )) : r[o] = n;
  }
  return r;
}
function N1(r, e) {
  const t = {}, s = Object.keys(e).filter((a) => Object.hasOwn(e, a) && Object.hasOwn(r, a)), i = Object.keys(e).filter((a) => Object.hasOwn(e, a) && !Object.hasOwn(r, a));
  for (const a of s)
    if (typeof r[a] == "object" && typeof e[a] == "object" && !Array.isArray(r[a]) && !Array.isArray(e[a])) {
      const o = N1(r[a], e[a]);
      Object.keys(o).length > 0 && (t[a] = o);
    } else if (Array.isArray(r[a]) && Array.isArray(e[a])) {
      const o = r[a], n = e[a];
      o.toString() !== n.toString() && (t[a] = e[a]);
    } else
      r[a] !== e[a] && (t[a] = e[a]);
  for (const a of i)
    t[`-=${a}`] = e[a];
  return t;
}
const B1 = (r) => {
  const e = {};
  for (const [s, i] of Object.entries(r))
    if (ti(i)) {
      const a = B1(i);
      setProperty(e, s, a);
    } else
      setProperty(e, s, i);
  function t(s) {
    return ti(s) ? /^\d+$/.test(Object.keys(s).join("")) ? Object.values(s).map(t) : F1(s, (i) => t(i)) : lt(s) ? s.map(t) : s;
  }
  return t(e);
}, H1 = (r) => {
  const e = {};
  for (const [t, s] of Object.entries(r))
    if ((lt(s) || ti(s)) && Ou(s))
      for (const [i, a] of Object.entries(H1(s)))
        e[`${t}.${i}`] = a;
    else
      e[t] = s;
  return e;
};
function Em(r) {
  return _1(r) ? Array.isArray(r) ? (r.forEach((e, t) => {
    r[t] = null;
  }), r) : (Object.keys(r).forEach((e) => {
    r[e] = null;
  }), r) : r;
}
function Am(r, ...e) {
  const t = e[0];
  if (t instanceof Object && !Array.isArray(t)) {
    const s = t;
    for (const i in s)
      if (r[i] === void 0)
        throw new Error(`Missing value for ${i}`);
  } else
    for (const s of e)
      if (r[s] === void 0)
        throw new Error(`Missing value for ${String(s)}`);
  return r;
}
const xm = (r, e, t) => {
  if (typeof e == "function") {
    const s = { [r](...i) {
      return e(...i);
    } }[r];
    return t ? s.bind(t) : s;
  }
  return !1;
}, Im = (r) => (...e) => (console.log(`calling ${r.name}`), r(...e)), Pm = (r, e, t = !1) => {
  r = $(r)[0], e = $(e)[0];
  const s = $(r).parent()[0], i = {
    x: ht.getProperty(r, "x"),
    y: ht.getProperty(r, "y")
  }, a = la.convertCoordinates(
    s,
    e,
    i
  );
  return eLog.checkLog3("changeContainer", "Target Element", { elem: r, container: e, curContainer: s, curPosition: i, relPos: a }), t && (r = $(r).clone()[0]), $(r).appendTo($(e)), ht.set(r, a), r;
}, W1 = (r, e, t, s, i = 8) => {
  r = $(r)[0], s ? r.style.setProperty("width", `${s}px`, "important") : r.style.setProperty("width", "max-content", "important");
  function a() {
    r = $(r)[0];
    const p = parseFloat(o.fontSize) * 0.8, h = parseFloat(o.lineHeight) * 0.8;
    return p < i ? !1 : (r.style.fontSize = `${p}px`, r.style.lineHeight = `${h}px`, W1(r, e, l ?? t, s, i));
  }
  const o = window.getComputedStyle(r), n = parseFloat(o.lineHeight);
  let l;
  Ja(t) && t < n && (l = t);
  const c = parseFloat(o.width);
  let u = c, g = !1;
  for (let p = 1; ; p++) {
    const h = n * p, m = c / p;
    if (m / h < e)
      break;
    if (Ja(l)) {
      if (p > l) {
        if (a())
          return;
        break;
      }
    } else if (t && h > t) {
      if (a())
        return;
      break;
    }
    if (u = m, Ja(l) && p === l) {
      g = !0;
      break;
    }
  }
  !g && s && u > s && a() || r.style.setProperty("width", `${u}px`, "important");
}, Mm = (r, e) => {
  const t = getProperty(Wg, r);
  if (!t)
    return "";
  const { viewBox: s, paths: i, classes: a } = t;
  return e ?? (e = Object.keys(i).join("|")), typeof e == "string" && (e = e.split("|")), [
    `<svg viewBox="${s}">`,
    ...e.map((o) => `<path class="${o} ${(a == null ? void 0 : a[o]) ?? ""}" d="${i[o] ?? ""}" />`),
    "</svg>"
  ].join(`
`);
}, j1 = (r, { x: e, y: t } = { x: 0, y: 0 }) => {
  [r, e, t] = [r, e, t].map((n) => mo(n, 2));
  const [s, i] = [0.4475 * r, (1 - 0.4475) * r], [a, o] = [e, t - r];
  return [[
    a,
    o,
    i,
    0,
    r,
    s,
    r,
    r,
    0,
    i,
    -s,
    r,
    -r,
    r,
    -i,
    0,
    -r,
    -s,
    -r,
    -r,
    0,
    -i,
    s,
    -r,
    r,
    -r
  ]];
}, Om = (r, e) => {
  const [[t, s, ...i]] = j1(r, e), a = [`m ${t} ${s}`];
  return i.forEach((o, n) => {
    n % 6 === 0 && a.push("c"), a.push(o);
  }), a.push("z"), a.join(" ");
}, bl = (r, e, t, s) => {
  var i;
  return ml(r) && ([r, e, t, s] = r.replace(/[^\d.,]/g, "").split(/,/).map((a) => Hs(a) ? void 0 : parseFloat(a))), pl(r) && ([4, 5].includes(r.length) && (r = r.replace(/([^#])/g, "$1$1")), [r, e, t, s] = ((i = r.match(/[^#]{2}/g)) == null ? void 0 : i.map((a) => parseInt(a, 16))) ?? []), [r, e, t].every((a) => /^\d+$/.test(`${a}`)) ? [r, e, t, s].filter((a) => /^[\d.]+$/.test(`${a}`)) : null;
}, K1 = (r, e, t, s) => {
  if ((ml(r) || pl(r)) && ([r, e, t, s] = bl(r) ?? []), [r, e, t].every((i) => /^[.\d]+$/.test(`${i}`))) {
    let i = "rgb";
    const a = [r, e, t];
    return /^[.\d]+$/.test(`${s}`) && (a.push(s >= 1 ? qt(s) : cs(s, 2)), i += "a"), `${i}(${a.join(", ")})`;
  }
  return null;
}, Fm = (r, e, t) => {
  function s(i) {
    const a = i.toString(16);
    return a.length === 1 ? `0${a}` : a;
  }
  return pl(r) ? r : (ml(r) && ([r, e, t] = bl(r) ?? []), Yr(r) && Yr(e) && Yr(t) && [r, e, t].every((i) => /^[.\d]+$/.test(`${i}`)) ? `#${s(r ?? 0)}${s(e ?? 0)}${s(t ?? 0)}` : null);
}, Lm = (...r) => {
  const [e, t, s] = bl(...r) ?? [];
  return [e, t, s].every(fl) ? (e * 299 + t * 587 + s * 114) / 1e3 >= 128 ? "rgba(0, 0, 0, 1)" : "rgba(255, 255, 255, 0.8)" : null;
}, Rm = () => K1(
  ht.utils.random(0, 255, 1),
  ht.utils.random(0, 255, 1),
  ht.utils.random(0, 255, 1)
), $m = (r) => {
  const e = [];
  return r.parentNode && Array.from(r.parentNode.children).forEach((t) => {
    t !== r && e.push(t);
  }), e;
}, Nm = (r) => typeof r == "string" ? r.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/[`']/g, "&#039;") : r, Bm = (r, ...e) => {
  const t = performance.now();
  let s = 0;
  const i = () => {
    if (performance.now() - t < 1e4)
      a(), s++;
    else {
      const o = performance.now() - t, n = mo(o / s / 4e3, 4);
      eLog.checkLog3("performance", `[TestPerformance] Function Ran ${s} Times in ${mo(o / 1e3, 4)}s, Averaging ${n}s per Call`);
    }
  }, a = () => {
    const o = r(...e);
    o instanceof Promise ? o.then(i) : i();
  };
  a();
}, Hm = (r, e) => ht.set(r, e);
function Wm(r, e, t) {
  if (t) {
    const s = Nr(ht.getProperty(r, e, t), /[\d.]+/);
    if (typeof s == "string")
      return cs(s);
    throw new Error(`Unable to extract property '${e}' in '${t}' units from ${r}`);
  }
  return ht.getProperty(r, e);
}
const jm = (r, e) => E1(mo(M1(r, e), 2)).replace(/^(.)/, "$1="), Km = (r, e) => {
  if (!r || !L1(r.labels))
    return;
  typeof e == "string" && (e = new RegExp(e));
  const t = Object.entries(r.labels).filter(([a]) => e instanceof RegExp ? e.test(a) : !0).sort((a, o) => a[1] - o[1]), s = ht.utils.snap(t.map(([a, o]) => o), r.time()), [i] = t.find(([a, o]) => o === s);
  return i;
}, Gm = (r) => {
  if (r.repeat() === -1)
    r.totalTime(r.time());
  else {
    const [e] = r.getChildren(!1, !0, !0, r.time());
    e && e.repeat() === -1 && e.totalTime(e.time()), r.reverse();
  }
  return r;
}, Vm = (r) => new Promise(
  (e) => {
    setTimeout(e, r >= 100 ? r : r * 1e3);
  }
);
function G1(r) {
  return new Promise(
    (e, t) => {
      r instanceof Promise || r instanceof ht.core.Animation ? r.then(() => e()).catch(t) : Array.isArray(r) ? Promise.all(r.map((s) => G1(s))).then(() => e()).catch(t) : e();
    }
  );
}
const zm = {
  onSelectChange: async (r, e) => {
    const t = e.currentTarget, { action: s, dtype: i, target: a, flagTarget: o } = t.dataset;
    if (!s)
      throw new Error("Select elements require a data-action attribute.");
    if (!a && !o)
      throw new Error("Select elements require a 'data-target' or 'data-flag-target' attribute.");
    const n = si(i);
    let l;
    switch (n) {
      case "number":
        l = cs(t.value);
        break;
      case "boolean":
        l = si(`${t.value}`) === "true";
        break;
      case "string":
        l = `${t.value}`;
        break;
      default: {
        if (y1(l))
          throw new Error(`You must set 'data-dtype="Number"' for <select> elements with number values.`);
        if (b1(l))
          throw new Error(`You must set 'data-dtype="Boolean"' for <select> elements with boolean values.`);
        l = `${t.value}`;
        break;
      }
    }
    a ? await r.document.update({ [a]: l }) : o && (t.value === "" ? await r.document.unsetFlag(X.SYSTEM_ID, o) : await r.document.setFlag(X.SYSTEM_ID, o, l));
  }
}, wl = (r) => typeof r == "string" && /^[A-Za-z0-9]{16}$/.test(r), V1 = (r) => {
  if (typeof r != "string")
    return !1;
  const [e, t] = r.split(/\./);
  return wl(t) ? game.collections.has(e) : !1;
}, Bu = (r) => typeof r == "string", z1 = (r) => Bu(r) ? !!(["name", "img", "id", "_id"].includes(r) || r.startsWith("system") || r.startsWith("flag")) : !1, qm = (r) => !(!Bu(r) || z1(r)), Ym = (r) => {
  var e;
  if (V1(r))
    return r;
  if (wl(r)) {
    const t = (e = game.collections.find((s) => s.has(r))) == null ? void 0 : e.get(r);
    if (t && "uuid" in t)
      return t.uuid;
    throw new Error(`[U.parseDocRefToUUID] Unable to find document with id '${r}'`);
  } else if (r && typeof r == "object" && "uuid" in r && typeof r.uuid == "string")
    return r.uuid;
  throw new Error(`[U.parseDocRefToUUID] Unrecognized reference: '${r}'`);
}, q1 = (r, e = {}) => {
  if (/[a-z]/.test(r) && (r = r.replace(new RegExp(`^(${X.SYSTEM_ID}.)*`), `${X.SYSTEM_ID}.`)), typeof game.i18n.localize(r) == "string") {
    for (const [t, s] of Object.entries(e))
      e[t] = q1(s);
    return game.i18n.format(r, e) || game.i18n.localize(r) || r;
  }
  return r;
}, Um = (r, e) => {
  const t = [e, r].filter(Yr).join(".");
  if (game.settings.settings.has(`${X.SYSTEM_ID}.${t}`))
    return game.settings.get(X.SYSTEM_ID, t);
};
function Y1(r, e) {
  return typeof e == "string" ? `${X.TEMPLATE_ROOT}/${r}/${e.replace(/\..*$/, "")}.hbs` : e.map((t) => Y1(r, t));
}
function Xm(r, e = `systems/${X.SYSTEM_ID}/assets`, t = { top: 200, left: 200 }) {
  return new FilePicker({
    type: "image",
    activeSource: "public",
    displayMode: "tiles",
    callback: r,
    top: t.top ?? 240,
    left: t.left ?? 210
  }).browse(e);
}
const w = {
  // ████████ GETTERS: Basic Data Lookup & Retrieval ████████
  GMID: E2,
  getUID: Z2,
  // ████████ TYPES: Type Checking, Validation, Conversion, Casting ████████
  isNumber: fl,
  isNumString: y1,
  isBooleanString: b1,
  isSimpleObj: w1,
  isList: ti,
  isArray: lt,
  isFunc: v1,
  isInt: Ja,
  isFloat: k1,
  isPosInt: Hc,
  isIterable: A2,
  isHTMLCode: x2,
  isRGBColor: ml,
  isHexColor: pl,
  isUndefined: Hs,
  isDefined: Yr,
  isEmpty: Mu,
  hasItems: Ou,
  isInstance: I2,
  isNullish: P2,
  areEqual: M2,
  areFuzzyEqual: T1,
  pFloat: cs,
  pInt: qt,
  pBool: O2,
  radToDeg: C1,
  degToRad: F2,
  getKey: L2,
  assertNonNullType: D1,
  FILTERS: R2,
  // ████████ REGEXP: Regular Expressions, Replacing, Matching ████████
  testRegExp: In,
  regExtract: Nr,
  // ████████ STRINGS: String Parsing, Manipulation, Conversion ████████
  // ░░░░░░░ Case Conversion ░░░░░░░
  uCase: S1,
  lCase: si,
  sCase: Fu,
  tCase: $2,
  // ░░░░░░░ Formatting ░░░░░░░
  /* hyphenate, */
  unhyphenate: N2,
  pluralize: H2,
  oxfordize: W2,
  ellipsize: j2,
  pad: K2,
  toKey: G2,
  parseArticles: B2,
  signNum: E1,
  padNum: V2,
  stringifyNum: Lu,
  verbalizeNum: A1,
  ordinalizeNum: z2,
  romanizeNum: q2,
  // ░░░░░░░ Content ░░░░░░░
  loremIpsum: Y2,
  randString: U2,
  randWord: X2,
  // ████████ SEARCHING: Searching Various Data Types w/ Fuzzy Matching ████████
  fuzzyMatch: J2,
  isIn: x1,
  isInExact: Q2,
  // ████████ NUMBERS: Number Casting, Mathematics, Conversion ████████
  randNum: yl,
  randInt: Ru,
  coinFlip: em,
  cycleNum: I1,
  cycleAngle: $u,
  roundNum: mo,
  clampNum: tm,
  sum: P1,
  average: sm,
  // ░░░░░░░ Positioning ░░░░░░░
  getDistance: im,
  getAngle: rm,
  getAngleDelta: M1,
  getBoundingRectangle: am,
  // ████████ ARRAYS: Array Manipulation ████████
  randElem: Nu,
  randIndex: om,
  makeIntRange: nm,
  makeCycler: lm,
  unique: um,
  group: hm,
  sample: dm,
  getLast: cm,
  removeFirst: gm,
  pullElement: O1,
  pullIndex: fm,
  subGroup: pm,
  shuffle: mm,
  toArray: ym,
  // ████████ OBJECTS: Manipulation of Simple Key/Val Objects ████████
  remove: bm,
  replace: km,
  partition: _m,
  zip: Dm,
  objClean: Wc,
  objSize: L1,
  objMap: F1,
  objFindKey: Tm,
  objFilter: Mn,
  objForEach: Cm,
  objCompact: Sm,
  objClone: R1,
  objMerge: $1,
  objDiff: N1,
  objExpand: B1,
  objFlatten: H1,
  objNullify: Em,
  objFreezeProps: Am,
  // ████████ FUNCTIONS: Function Wrapping, Queuing, Manipulation ████████
  getDynamicFunc: xm,
  withLog: Im,
  // ████████ HTML: Parsing HTML Code, Manipulating DOM Objects ████████
  getSvgCode: Mm,
  changeContainer: Pm,
  adjustTextContainerAspectRatio: W1,
  getRawCirclePath: j1,
  drawCirclePath: Om,
  getColorVals: bl,
  getRGBString: K1,
  getHEXString: Fm,
  getContrastingColor: Lm,
  getRandomColor: Rm,
  getSiblings: $m,
  escapeHTML: Nm,
  // ████████ PERFORMANCE: Performance Testing & Metrics ████████
  testFuncPerformance: Bm,
  // ░░░░░░░ GreenSock ░░░░░░░
  gsap: ht,
  get: Wm,
  set: Hm,
  getGSAngleDelta: jm,
  getNearestLabel: Km,
  reverseRepeatingTimeline: Gm,
  /* to, from, fromTo, */
  /* TextPlugin, Flip, */
  MotionPathPlugin: la,
  // ████████ ASYNC: Async Functions, Asynchronous Flow Control ████████
  sleep: Vm,
  waitFor: G1,
  // EVENT HANDLERS
  EventHandlers: zm,
  // ░░░░░░░ SYSTEM: System-Specific Functions (Requires Configuration of System ID in constants.js) ░░░░░░░
  isDocID: wl,
  isDocUUID: V1,
  isDotKey: Bu,
  isTargetKey: z1,
  isTargetFlagKey: qm,
  parseDocRefToUUID: Ym,
  loc: q1,
  getSetting: Um,
  getTemplatePath: Y1,
  displayImageSelector: Xm
};
class Zm extends FormApplication {
  constructor(e = {}, t = {}) {
    super(e, t);
  }
  /**
  * Default Options for this FormApplication
  */
  static get defaultOptions() {
    return mergeObject(super.defaultOptions, {
      id: "debug-settings-menu",
      title: "Debug Settings",
      popOut: !0,
      template: "systems/eunos-blades/templates/settings/debug-settings.hbs",
      classes: ["eunos-blades", "settings"],
      width: 500,
      closeOnSubmit: !0,
      submitOnChange: !1,
      submitOnClose: !0
    });
  }
  /**
  * Provide data to the template
  */
  getData() {
    return game.settings.get("eunos-blades", "debugSettings");
  }
  /**
   * Executes on form submission.
   * @param _event - the form submission event
   * @param formData - the form data
   */
  async _updateObject(e, t) {
    if (!t)
      return;
    const s = expandObject(t);
    game.settings.set("eunos-blades", "debugSettings", s);
  }
}
class Jm extends FormApplication {
  constructor(e = {}, t = {}) {
    super(e, t);
  }
  /**
  * Default Options for this FormApplication
  */
  static get defaultOptions() {
    return mergeObject(super.defaultOptions, {
      id: "openai-settings-menu",
      title: "Open AI Settings",
      popOut: !0,
      template: "systems/eunos-blades/templates/settings/openai-settings.hbs",
      classes: ["eunos-blades", "settings"],
      width: 500,
      closeOnSubmit: !0,
      submitOnChange: !1,
      submitOnClose: !0
    });
  }
  /**
  * Provide data to the template
  */
  getData() {
    return game.settings.get("eunos-blades", "openAISettings");
  }
  /**
   * Executes on form submission.
   * @param _event - the form submission event
   * @param formData - the form data
   */
  async _updateObject(e, t) {
    if (!t)
      return;
    const s = expandObject(t);
    game.settings.set("eunos-blades", "openAISettings", s);
  }
}
const Qm = function() {
  game.settings.registerMenu("eunos-blades", "debugSettingsMenu", {
    name: "Debug Settings",
    label: "Open Debug Settings",
    hint: "Configure settings related to debugging.",
    icon: "fa-duotone fa-ban-bug",
    type: Zm,
    restricted: !0
  }), game.settings.register("eunos-blades", "debugSettings", {
    scope: "world",
    config: !1,
    type: Object,
    default: {
      debugLevel: 3,
      debugHooks: !1,
      whitelist: "",
      blacklist: ""
    }
  }), game.settings.registerMenu("eunos-blades", "openAISettingsMenu", {
    name: "OpenAI Settings",
    label: "Open AI Integration",
    hint: "Configure settings related to integration with AI for content generation during play.",
    icon: "fa-duotone fa-brain-circuit",
    type: Jm,
    restricted: !0
  }), game.settings.register("eunos-blades", "openAISettings", {
    scope: "world",
    config: !1,
    type: Object,
    default: {
      apiKey: "",
      models: {
        text: "gpt-3.5-turbo",
        speech: "tts-1-hd",
        image: "gpt-4-vision-preview"
      },
      fileID: ""
    }
  }), game.settings.register("eunos-blades", "systemMigrationVersion", {
    name: "System Migration Version",
    scope: "world",
    config: !1,
    type: Number,
    default: 0
  });
};
function e3() {
  CONFIG.TinyMCE = {
    ...CONFIG.TinyMCE,
    skin: "skin",
    skin_url: "systems/eunos-blades/tinymce/skin",
    content_css: `systems/eunos-blades/tinymce/content.css?${(/* @__PURE__ */ new Date()).getTime()}`,
    font_css: "systems/eunos-blades/fonts.css",
    max_height: 500,
    min_height: 40,
    autoresize_overflow_padding: 0,
    autoresize_bottom_margin: 0,
    // 25,
    menubar: !1,
    statusbar: !1,
    // True,
    elementPath: !0,
    branding: !1,
    resize: !1,
    plugins: "lists image table code save autoresize searchreplace quickbars template",
    save_enablewhendirty: !1,
    // Table_default_styles: {},
    style_formats: [
      {
        title: "Headings",
        items: [
          { title: "Heading 1", block: "h1", wrapper: !1 },
          { title: "Heading 2", block: "h2", wrapper: !1 },
          { title: "Heading 3", block: "h3", wrapper: !1 },
          { title: "Heading 4", block: "h4", wrapper: !1 }
        ]
      },
      {
        title: "Blocks",
        items: [
          { title: "Paragraph", block: "p", wrapper: !1 },
          { title: "Block Quote", block: "blockquote", wrapper: !0 }
          // {title: "Secret", block: "span", classes: "text-secret", attributes: {"data-is-secret": "true"}, wrapper: false}
        ]
      },
      {
        title: "Inline",
        items: [
          { title: "Bold", inline: "b", wrapper: !1 },
          { title: "Italics", inline: "i", wrapper: !1 },
          { title: "Underline", inline: "u", wrapper: !1 },
          { title: "Secret", inline: "span", classes: "text-secret", attributes: { "data-is-secret": "true" }, wrapper: !1 }
        ]
      }
    ],
    style_formats_merge: !1,
    toolbar: "styles | searchreplace | formatting alignment lists elements | removeformat | code | save",
    toolbar_groups: {
      formatting: {
        icon: "color-picker",
        tooltip: "Formatting",
        items: "bold italic underline"
      },
      alignment: {
        icon: "align-left",
        tooltip: "Alignment",
        items: "alignleft aligncenter alignright alignjustify | outdent indent"
      },
      lists: {
        icon: "unordered-list",
        tooltip: "Lists",
        items: "bullist numlist"
      },
      elements: {
        icon: "duplicate",
        tooltip: "Insert Element",
        items: "tableinsertdialog image hr | template"
      }
    },
    toolbar_mode: "floating",
    quickbars_link_toolbar: !1,
    quickbars_selection_toolbar: "styles | bold italic underline",
    quickbars_insert_toolbar: "hr image table",
    quickbars_table_toolbar: "tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"
  };
}
function t3() {
  CONFIG.canvasTextStyle = new PIXI.TextStyle({
    align: "center",
    dropShadow: !0,
    dropShadowAngle: w.degToRad(45),
    dropShadowBlur: 8,
    dropShadowColor: X.Colors.BLACK,
    dropShadowDistance: 4,
    fill: [
      X.Colors.bWHITE,
      X.Colors.bGREY
    ],
    fillGradientType: 1,
    fillGradientStops: [
      0,
      0.3
    ],
    fontFamily: "Kirsty",
    fontSize: 32,
    letterSpacing: 2,
    lineHeight: 32,
    lineJoin: "round",
    padding: 4,
    stroke: X.Colors.dBLACK,
    strokeThickness: 3,
    trim: !0,
    whiteSpace: "normal",
    wordWrap: !0,
    wordWrapWidth: 0.1
  });
}
function s3() {
  $("body.vtt.game.system-eunos-blades").append(`<div id="backsplash" style="height: 100%; width: 100%; position: absolute; z-index: -1; background: linear-gradient(35deg, ${X.Colors.GREY}, ${X.Colors.BLACK});"></div>`), $("#interface").append(`<div class="lightning-border-container">
    </div>`);
}
async function i3() {
  const r = [
    // General Components
    "systems/eunos-blades/templates/components/toggle-icon.hbs",
    "systems/eunos-blades/templates/components/button-icon.hbs",
    "systems/eunos-blades/templates/components/dotline.hbs",
    "systems/eunos-blades/templates/components/armor.hbs",
    "systems/eunos-blades/templates/components/comp.hbs",
    "systems/eunos-blades/templates/components/select.hbs",
    "systems/eunos-blades/templates/components/portrait.hbs",
    "systems/eunos-blades/templates/components/clock.hbs",
    "systems/eunos-blades/templates/components/roll-collab-mod.hbs",
    "systems/eunos-blades/templates/components/slide-out-controls.hbs",
    "systems/eunos-blades/templates/components/consequence.hbs",
    "systems/eunos-blades/templates/components/consequence-accepted.hbs",
    // Partials
    "systems/eunos-blades/templates/parts/tier-block.hbs",
    "systems/eunos-blades/templates/parts/turf-list.hbs",
    "systems/eunos-blades/templates/parts/cohort-block.hbs",
    "systems/eunos-blades/templates/parts/roll-opposition-creator.hbs",
    "systems/eunos-blades/templates/parts/active-effects.hbs",
    "systems/eunos-blades/templates/parts/gm-pc-summary.hbs",
    "systems/eunos-blades/templates/components/clock-key.hbs"
  ];
  return loadTemplates(r);
}
const Cs = {
  randString(r = 10) {
    return w.randString(r);
  },
  test(r, e, t) {
    const s = {
      true: !0,
      false: !1,
      null: null,
      undefined: void 0
    };
    switch (["!", "not", "=??"].includes(String(r)) && ([e, r] = [String(r), e]), typeof r == "string" && r in s && (r = s[r]), typeof t == "string" && t in s && (t = s[t]), e) {
      case "!":
      case "not":
        return !r;
      case "=??":
        return [void 0, null].includes(r);
      case "&&":
        return r && t;
      case "||":
        return r || t;
      case "==":
        return w.areFuzzyEqual(r, t);
      case "===":
        return r === t;
      case "!=":
      case "!==":
        return r !== t;
      case ">":
        return typeof r == "number" && typeof t == "number" && r > t;
      case "<":
        return typeof r == "number" && typeof t == "number" && r < t;
      case ">=":
        return typeof r == "number" && typeof t == "number" && r >= t;
      case "<=":
        return typeof r == "number" && typeof t == "number" && r <= t;
      case "??":
        return r ?? t;
      case "includes":
        return Array.isArray(r) && r.includes(t);
      case "in":
        return Array.isArray(t) ? t.includes(r) : w.isList(t) && (typeof r == "number" || typeof r == "string") ? r in t : typeof t == "string" ? new RegExp(String(r), "gu").test(String(t)) : !1;
      default:
        return !1;
    }
  },
  calc(...r) {
    const e = {
      "+": (a, o) => w.pInt(a) + w.pInt(o),
      "-": (a, o) => w.pInt(a) - w.pInt(o),
      "*": (a, o) => w.pInt(a) * w.pInt(o),
      "/": (a, o) => w.pInt(a) / w.pInt(o),
      "%": (a, o) => w.pInt(a) % w.pInt(o),
      max: (a, o) => Math.max(w.pInt(a), w.pInt(o)),
      min: (a, o) => Math.min(w.pInt(a), w.pInt(o)),
      ceil: (a) => Math.ceil(w.pFloat(a)),
      floor: (a) => Math.floor(w.pFloat(a))
    }, [t, s, i] = typeof r[0] == "string" && r[0] in e ? [r[1], r[0]] : r;
    return e[s](t, i);
  },
  isIn(...r) {
    const [e, ...t] = r;
    return t.includes(e);
  },
  case(r, e) {
    switch (r) {
      case "upper":
        return w.uCase(e);
      case "lower":
        return w.lCase(e);
      case "sentence":
        return w.sCase(e);
      case "title":
        return w.tCase(e);
      default:
        return e;
    }
  },
  romanize(r) {
    return w.romanizeNum(w.pInt(r));
  },
  count(r) {
    return Array.isArray(r) || w.isList(r) ? Object.values(r).filter((e) => e != null).length : typeof r == "string" ? r.length : r ? 1 : 0;
  },
  // Concat helper
  // Usage: (concat 'first 'second')
  concat(...r) {
    let e = "";
    for (const t of r)
      (typeof t == "string" || typeof t == "number") && (e += t);
    return e;
  },
  // Merge helper - To merge additional properties into a template's context
  merge(r, ...e) {
    return e.pop(), e.reduce((t, s) => Object.assign(t, s), r);
  },
  // For loop: {{#for [from = 0, to, stepSize = 1]}}<html content, this = index>{{/for}}
  for: (...r) => {
    const e = r.pop();
    let [t, s, i] = r;
    if (t = w.pInt(t), s = w.pInt(s), i = w.pInt(i) || 1, t > s)
      return "";
    let a = "";
    for (let o = parseInt(t || 0, 10); o <= parseInt(s || 0, 10); o += i)
      a += e.fn(o);
    return a;
  },
  signNum(r) {
    return w.signNum(r);
  },
  compileSvg(...r) {
    const [e, t] = r;
    return w.getSvgCode(e, t);
  },
  eLog(...r) {
    r.pop();
    let e = 3;
    [0, 1, 2, 3, 4, 5].includes(r[0]) && (e = r.shift()), eLog.hbsLog(...r, e);
  },
  // Does the name of this turf block represent a standard 'Turf' claim?
  isTurfBlock: (r) => w.fuzzyMatch(r, "Turf"),
  // Which other connection does this connector overlap with?
  getConnectorPartner: (r, e) => {
    r = parseInt(`${r}`, 10);
    const t = {
      1: { right: 2, bottom: 6 },
      2: { left: 1, right: 3, bottom: 7 },
      3: { left: 2, right: 4, bottom: 8 },
      4: { left: 3, right: 5, bottom: 9 },
      5: { left: 4, bottom: 10 },
      6: { top: 1, right: 7, bottom: 11 },
      7: { top: 2, left: 6, right: 8, bottom: 12 },
      8: { top: 3, left: 7, right: 9, bottom: 13 },
      9: { top: 4, left: 8, right: 10, bottom: 14 },
      10: { top: 5, left: 9, bottom: 15 },
      11: { top: 6, right: 12 },
      12: { top: 7, left: 11, right: 13 },
      13: { top: 8, left: 12, right: 14 },
      14: { top: 9, left: 13, right: 15 },
      15: { top: 10, left: 14 }
    }, s = { left: "right", right: "left", top: "bottom", bottom: "top" }[e], i = t[r][e] ?? 0;
    return i ? `${i}-${s}` : null;
  },
  // Is the value Turf side.
  isTurfOnEdge: (r, e) => {
    r = parseInt(`${r}`, 10);
    const t = {
      1: ["top", "left"],
      2: ["top"],
      3: ["top"],
      4: ["top"],
      5: ["top", "right"],
      6: ["left"],
      7: [],
      8: [],
      9: [],
      10: ["right"],
      11: ["left", "bottom"],
      12: ["bottom"],
      13: ["bottom"],
      14: ["bottom"],
      15: ["right", "bottom"]
    };
    return r in t ? t[r].includes(e) : !0;
  },
  // Multiboxes
  multiboxes(r, e) {
    let t = e.fn(this);
    return r = [r].flat(1), r.forEach((s) => {
      if (s !== !1) {
        const i = RegExp.escape(Handlebars.escapeExpression(String(s))), a = new RegExp(` value="${i}"`);
        t = t.replace(a, '$& checked="checked"');
      }
    }), t;
  },
  repturf: (r, e) => {
    let t = e.fn(void 0), s = parseInt(r, 10);
    s > 6 && (s = 6);
    for (let i = 13 - s; i <= 12; i++) {
      const a = new RegExp(` value="${i}"`);
      t = t.replace(a, '$& disabled="disabled"');
    }
    return t;
  }
};
Cs.eLog1 = function(...r) {
  Cs.eLog(1, ...r.slice(0, 7));
};
Cs.eLog2 = function(...r) {
  Cs.eLog(2, ...r.slice(0, 7));
};
Cs.eLog3 = function(...r) {
  Cs.eLog(3, ...r.slice(0, 7));
};
Cs.eLog4 = function(...r) {
  Cs.eLog(4, ...r.slice(0, 7));
};
Cs.eLog5 = function(...r) {
  Cs.eLog(5, ...r.slice(0, 7));
};
Object.assign(Cs);
function r3() {
  Object.entries(Cs).forEach(([r, e]) => Handlebars.registerHelper(r, e));
}
const r0 = [
  ca,
  Do,
  la,
  Yi,
  // SplitText,
  Ks,
  _o
  //   CustomWiggle,
  //   CustomBounce,
  //   EasePack
], a3 = {
  // #region CLOCK KEYS
  keyDrop: {
    effect: (r, e) => {
      const [t] = $(r).closest(".clock-key-container");
      return w.gsap.timeline({
        onComplete() {
          e.callback && e.callback();
        }
      }).fromTo(t, {
        y: e.yShift
      }, {
        y: 0,
        autoAlpha: 1,
        ease: "bounce",
        duration: e.duration
      });
    },
    defaults: {
      duration: 1,
      yShift: -800
    },
    extendTimeline: !0
  },
  keyPull: {
    effect: (r, e) => {
      const [t] = $(r).closest(".clock-key-container");
      return w.gsap.timeline({
        onComplete() {
          e.callback && e.callback();
        }
      }).to(t, {
        y: e.yDelta,
        ease: e.ease,
        duration: 0.75 * e.duration
      }).to(t, {
        opacity: 0,
        ease: "power2.out",
        duration: 0.25 * e.duration
      }, 0.75 * e.duration);
    },
    defaults: {
      yDelta: -800,
      duration: 1,
      ease: "back.in(1)"
    },
    extendTimeline: !0
  },
  keyControlPanelFlip: {
    effect: (r, e) => w.gsap.timeline({
      delay: e.delay,
      onStart() {
        if (r) {
          const s = $(r).next(".clock-control-flipper");
          s.length && w.gsap.effects.keyControlPanelFlip(s[0], {
            ...e,
            delay: 0.15
          });
        }
      }
    }).to(r, {
      rotateX: e.angle,
      duration: 0.5,
      ease: "back.inOut(2)"
    }),
    defaults: {
      angle: 180,
      delay: 0
    },
    extendTimeline: !0
  },
  // #endregion
  // #region CHAT CONSEQUENCE EFFECTS
  csqEnter: {
    effect: (r, e) => {
      const t = w.gsap.utils.selector(r), s = t(".consequence-icon-circle.base-consequence"), i = t(".consequence-type.base-consequence"), a = t(".consequence-type.accept-consequence"), o = t(".consequence-name.base-consequence"), n = t(".consequence-name.accept-consequence"), l = w.gsap.timeline({ paused: !0, defaults: {} });
      return a.length > 0 && l.set(a, { opacity: 0 }, 0), n.length > 0 && l.set(n, { opacity: 0 }, 0), i.length > 0 && l.fromTo(i, {
        opacity: 1
      }, {
        opacity: 0,
        duration: 0.25,
        ease: "sine"
      }, 0), a.length > 0 && l.fromTo(a, {
        opacity: 0
      }, {
        opacity: 1,
        duration: 0.25,
        ease: "sine"
      }, 0), o.length > 0 && l.fromTo(o, {
        opacity: 1
      }, {
        opacity: 0,
        duration: 0.25,
        ease: "sine"
      }, 0), n.length > 0 && l.fromTo(n, {
        opacity: 0
      }, {
        opacity: 1,
        duration: 0.25,
        ease: "sine"
      }, 0), r && l.fromTo(r, {
        filter: "brightness(1)"
      }, {
        filter: `brightness(${e.brightness})`,
        duration: e.duration / 3,
        ease: "none"
      }, 0), s.length > 0 && l.fromTo(s, {
        scale: 0.75,
        outlineColor: X.Colors.dBLACK,
        outlineWidth: 0
      }, {
        scale: 0.85,
        outlineColor: X.Colors.GREY,
        outlineWidth: 1,
        duration: 0.55,
        ease: "sine.out"
      }, 0), l;
    },
    defaults: {
      brightness: 1.5,
      duration: 0.5,
      scale: 1.5,
      stagger: 0.05,
      ease: "sine",
      easeStrength: 1.5
    }
  },
  csqClickIcon: {
    effect: (r, e) => {
      const t = $(r).closest(".comp.consequence-display-container"), s = w.gsap.utils.selector(t[0]), i = w.gsap.utils.selector(r), a = s(".consequence-bg-image"), o = s(".consequence-interaction-pad"), n = i(".consequence-icon-circle.base-consequence"), l = i(".consequence-icon-circle.accept-consequence"), c = i(".consequence-button-container"), u = w.gsap.timeline({
        paused: !0,
        onComplete: function() {
          $(o).css("pointerEvents", "auto");
        },
        onReverseComplete: function() {
          $(o).css("pointerEvents", "none");
        }
      });
      return a.length && u.fromTo(a, {
        xPercent: 110,
        yPercent: -50
      }, {
        xPercent: -60,
        yPercent: -50,
        duration: 0.5,
        ease: "back"
      }, 0), n.length > 0 && u.fromTo(n, {
        opacity: 1
      }, {
        opacity: 0,
        duration: 0.25,
        ease: "sine.out"
      }, 0), l.length > 0 && u.fromTo(l, {
        opacity: 0
      }, {
        opacity: 1,
        duration: 0.15,
        ease: "sine"
      }, 0).fromTo(l, {
        outlineWidth: 1,
        scale: 0.85
      }, {
        outlineWidth: 2,
        scale: 1,
        duration: 0.25,
        ease: "sine"
      }, 0.175), c.length > 0 && u.fromTo(c, {
        scale: e.scale,
        opacity: 0,
        filter: "blur(25px)"
      }, {
        scale: 1,
        opacity: 1,
        filter: "blur(0px)",
        stagger: e.stagger,
        duration: e.duration,
        ease: `${e.ease}.inOut(${e.easeStrength})`
      }, 0), u;
    },
    defaults: {
      duration: 0.5,
      scale: 1.5,
      stagger: 0.05,
      ease: "sine",
      easeStrength: 1.5
    }
  },
  csqEnterRight: {
    effect: (r) => {
      const e = w.gsap.utils.selector(r), t = e(".consequence-type-container .consequence-type.accept-consequence"), s = e(".consequence-type-container .consequence-type-bg.accept-consequence"), i = w.gsap.utils.selector(e(".consequence-button-container.consequence-accept-button-container")), a = i(".consequence-button-bg"), o = i(".button-icon i"), n = i(".consequence-button-label"), l = w.gsap.timeline({ paused: !0, defaults: {} });
      return t.length > 0 && l.fromTo(
        t,
        {
          color: X.Colors.RED
        },
        {
          color: X.Colors.WHITE,
          duration: 0.5,
          ease: "sine.inOut"
        },
        0
      ), s.length > 0 && l.fromTo(s, {
        x: 5,
        scaleX: 0,
        color: X.Colors.RED,
        skewX: 0
      }, {
        scaleX: 1,
        skewX: -45,
        color: X.Colors.RED,
        duration: 0.5,
        ease: "back.out"
      }, 0), a.length > 0 && l.fromTo(a, {
        scaleX: 0,
        color: X.Colors.RED,
        skewX: 0
      }, {
        x: 0,
        scaleX: 1,
        skewX: -45,
        color: X.Colors.RED,
        duration: 0.25,
        ease: "back.out"
      }, 0), o.length > 0 && l.fromTo(
        o,
        {
          color: X.Colors.GREY,
          opacity: 0.75,
          scale: 1
        },
        {
          color: X.Colors.dBLACK,
          scale: 1.25,
          opacity: 1,
          duration: 0.5,
          ease: "sine"
        },
        0
      ), n.length > 0 && l.fromTo(
        n,
        {
          color: X.Colors.GREY,
          fontWeight: 400,
          scale: 1
        },
        {
          color: X.Colors.dBLACK,
          fontWeight: 800,
          duration: 0.75,
          ease: "sine"
        },
        0
      ), l;
    },
    defaults: {}
  },
  csqEnterLeft: {
    effect: (r) => {
      const e = w.gsap.utils.selector(r), t = e(".consequence-type-container .consequence-type.accept-consequence"), s = e(".consequence-name-container .consequence-name.accept-consequence"), i = e(".consequence-icon-circle.accept-consequence"), a = e(".consequence-button-container.consequence-accept-button-container"), o = w.gsap.timeline({ paused: !0, defaults: {} });
      return t.length > 0 && o.to(
        t,
        {
          opacity: 0,
          duration: 0.15,
          ease: "sine.inOut"
        },
        0
      ), s.length > 0 && o.to(s, {
        opacity: 0,
        duration: 0.15,
        ease: "sine.inOut"
      }, 0), i.length > 0 && o.to(
        i,
        {
          opacity: 0,
          duration: 0.15,
          ease: "sine.inOut"
        },
        0
      ), a.length > 0 && o.fromTo(
        a,
        {
          opacity: 1
        },
        {
          opacity: 0,
          duration: 0.25,
          ease: "sine.inOut"
        },
        0
      ), o;
    },
    defaults: {}
  },
  csqEnterSubLeft: {
    effect: (r, e) => {
      const t = w.gsap.utils.selector(r), s = t(`.consequence-icon-circle.${e.type}-consequence`), i = t(`.consequence-type-container .consequence-type.${e.type}-consequence`), a = t(`.consequence-name.${e.type}-consequence`), o = t(`.consequence-footer-container .consequence-footer-bg.${e.type}-consequence`), n = t(`.consequence-footer-container .consequence-footer-message.${e.type}-consequence`), l = w.gsap.timeline({ paused: !0, defaults: {} });
      if (s.length > 0 && l.fromTo(s, {
        opacity: 0
      }, {
        opacity: 1,
        duration: 0.5,
        ease: "back.out"
      }, 0), i.length > 0 && l.fromTo(i, {
        opacity: 0
      }, {
        opacity: 1,
        duration: 0.5,
        ease: "back.out"
      }, 0), a.length > 0 && l.fromTo(a, {
        scaleX: 0
      }, {
        scaleX: 1,
        duration: 0.5,
        ease: "back.inOut"
      }, 0), o.length > 0 && l.fromTo(o, {
        scaleX: 0,
        skewX: 0,
        opacity: 1
      }, {
        scaleX: 1,
        skewX: -45,
        opacity: 1,
        duration: 0.5,
        ease: "back.inOut"
      }, 0), n.length > 0 && l.fromTo(n, {
        scaleX: 0,
        opacity: 1
      }, {
        scaleX: 1,
        opacity: 1,
        duration: 0.5,
        ease: "back.inOut"
      }, 0), t(`.consequence-button-container.consequence-${e.type}-button-container`).length > 0) {
        const c = w.gsap.utils.selector(t(`.consequence-button-container.consequence-${e.type}-button-container`)), u = c(".consequence-button-bg"), g = c(".button-icon i"), p = c(".consequence-button-label");
        u.length > 0 && l.fromTo(u, {
          scaleX: 0,
          skewX: 0,
          opacity: 1
        }, {
          scaleX: 1,
          skewX: -45,
          opacity: 1,
          duration: 0.5,
          ease: "back.inOut"
        }, 0), g.length > 0 && l.fromTo(
          g,
          {
            color: X.Colors.GREY,
            opacity: 0.75,
            scale: 1
          },
          {
            color: X.Colors.dBLACK,
            scale: 1.25,
            opacity: 1,
            duration: 0.5,
            ease: "sine"
          },
          0
        ), p.length > 0 && l.fromTo(
          p,
          {
            color: X.Colors.GREY,
            fontWeight: 400,
            scale: 1
          },
          {
            color: X.Colors.dBLACK,
            fontWeight: 800,
            duration: 0.75,
            ease: "sine"
          },
          0
        );
      }
      return l;
    },
    defaults: {}
  },
  // #endregion
  // #region CHARACTER SHEET EFFECTS
  fillCoins: {
    effect: (r, e) => w.gsap.to(
      r,
      {
        duration: e.duration / 2,
        scale: e.scale,
        filter: e.filter,
        ease: e.ease,
        stagger: {
          amount: 0.25,
          from: "start",
          repeat: 1,
          yoyo: !0
        }
      }
    ),
    defaults: {
      duration: 1,
      scale: 1,
      filter: "saturate(1) brightness(2)",
      ease: "power2.in"
    },
    extendTimeline: !0
  },
  // #endregion
  // #region GENERAL: 'blurRemove', 'hoverTooltip', 'textJitter'
  blurRemove: {
    effect: (r, e) => w.gsap.timeline({ stagger: e.stagger }).to(
      r,
      {
        skewX: e.skewX,
        duration: e.duration / 2,
        ease: "power4.out"
      }
    ).to(
      r,
      {
        x: e.x,
        marginBottom: e.ignoreMargin ? void 0 : function(t, s) {
          return w.get(s, "height") * -1;
        },
        marginRight: e.ignoreMargin ? void 0 : function(t, s) {
          return w.get(s, "width") * -1;
        },
        scale: e.scale,
        filter: `blur(${e.blur}px)`,
        duration: 3 / 4 * e.duration
      },
      e.duration / 4
    ).to(
      r,
      {
        autoAlpha: 0,
        duration: e.duration / 2,
        ease: "power3.in"
      },
      e.duration / 2
    ),
    defaults: {
      ignoreMargin: !1,
      skewX: -20,
      duration: 0.5,
      x: "+=300",
      scale: 1.5,
      blur: 10,
      stagger: 0
    },
    extendTimeline: !0
  },
  blurReveal: {
    effect: (r, e) => w.gsap.timeline().fromTo(
      r,
      {
        x: e.x,
        marginBottom: e.ignoreMargin ? void 0 : function(t, s) {
          return w.get(s, "height") * -1;
        },
        marginRight: e.ignoreMargin ? void 0 : function(t, s) {
          return w.get(s, "width") * -1;
        },
        scale: e.scale,
        filter: `blur(${e.blur}px)`
      },
      {
        x: 0,
        marginBottom: 0,
        marginRight: 0,
        scale: 1,
        filter: "blur(0px)",
        duration: 3 / 4 * e.duration
      },
      0
    ).fromTo(
      r,
      {
        autoAlpha: 0
      },
      {
        autoAlpha: 1,
        duration: e.duration / 2,
        ease: "power3.in"
      },
      0
    ).fromTo(
      r,
      {
        skewX: e.skewX
      },
      {
        skewX: 0,
        duration: e.duration / 2,
        ease: "power4.out"
      },
      e.duration / 2
    ),
    defaults: {
      ignoreMargin: !1,
      skewX: -20,
      duration: 0.5,
      x: "+=300",
      scale: 1.5,
      blur: 10
    },
    extendTimeline: !0
  },
  scaleUpReveal: {
    effect: (r, e) => w.gsap.timeline().fromTo(r, {
      autoAlpha: 0,
      scale: 0.5 * e.scale
    }, {
      autoAlpha: 1,
      scale: e.scale,
      duration: e.duration,
      ease: e.ease
    }),
    defaults: {
      scale: 1,
      duration: 0.5,
      ease: "power2"
    },
    extendTimeline: !0
  },
  scaleDownRemove: {
    effect: (r, e) => w.gsap.timeline().to(r, {
      autoAlpha: 0,
      scale: 0.5 * e.scale,
      duration: e.duration,
      ease: e.ease
    }),
    defaults: {
      scale: 1,
      duration: 0.5,
      ease: "power2"
    },
    extendTimeline: !0
  },
  blurRevealTooltip: {
    effect: (r, e) => {
      if (!r)
        throw new Error(`blurRevealTooltip effect: tooltip element is ${r === null ? "null" : typeof r}`);
      const t = $(r);
      return w.gsap.timeline({
        paused: !0,
        onReverseComplete: e.onReverseComplete
      }).fromTo(
        t,
        {
          filter: `blur(${e.blurStrength}px)`,
          autoAlpha: 0,
          xPercent: 50,
          yPercent: -200,
          scale: e.scale
        },
        {
          filter: "blur(0px)",
          autoAlpha: 1,
          xPercent: -50,
          yPercent: -100,
          scale: 1,
          ease: e.ease,
          duration: e.duration
        }
      );
    },
    defaults: {
      scale: 1.5,
      blurStrength: 15,
      ease: "back.out",
      duration: 0.25,
      onReverseComplete: void 0
    },
    extendTimeline: !0
  },
  textJitter: {
    effect: (r, e) => {
      const [t] = $(r);
      if (!t)
        throw new Error("textJitter effect: target not found");
      const s = new SplitText(t, { type: "chars" });
      return w.gsap.timeline().to(t, {
        autoAlpha: 1,
        duration: e.duration,
        ease: "none"
      }).fromTo(s.chars, {
        y: -e.yAmp
      }, {
        y: e.yAmp,
        duration: e.duration,
        ease: "sine.inOut",
        stagger: {
          repeat: -1,
          yoyo: !0,
          from: "random",
          each: e.stagger
        }
      }, 0).fromTo(s.chars, {
        rotateZ: -e.rotateAmp
      }, {
        rotateZ: e.rotateAmp,
        duration: e.duration,
        ease: CustomWiggle.create("myWiggle", { wiggles: 10, type: "random" }),
        stagger: {
          repeat: -1,
          from: "random",
          yoyo: !0,
          each: e.stagger
        }
      }, 0);
    },
    defaults: {
      yAmp: 2,
      rotateAmp: 2,
      duration: 1,
      stagger: 0.05
    },
    extendTimeline: !0
  }
  // #endregion
};
function o3() {
  r0.length && (w.gsap.config({
    nullTargetWarn: !0
  }), w.gsap.registerPlugin(...r0), Object.assign(
    globalThis,
    {
      TextPlugin: ca,
      Flip: Do,
      MotionPathPlugin: la,
      Dragger: Yi,
      // SplitText,
      Observer: Ks,
      CustomEase: _o
      // CustomWiggle,
      // CustomBounce,
      // EasePack
    }
  )), Object.entries(a3).forEach(([r, e]) => {
    w.gsap.registerEffect(Object.assign(e, { name: r }));
  });
}
function oa(r) {
  r.find(".tooltip-trigger").each((e, t) => {
    const s = $(t).find(".tooltip")[0] ?? $(t).next(".tooltip")[0];
    if (!s)
      return;
    const i = $(s), a = i.parent();
    a.css("position") !== "relative" && a.css("position") !== "absolute" && a.css("position", "relative"), i.css("position", "absolute");
    const o = `tooltip-${randomID()}`;
    i.attr("id", o), i.hasClass("tooltip-wide") && w.adjustTextContainerAspectRatio(s, 6), $(t).on({
      mouseenter: function() {
        game.eunoblades.Director.displayTooltip(s);
      },
      mouseleave: function() {
        game.eunoblades.Director.clearTooltip(o);
      }
    });
  });
}
const Qa = w.gsap;
var rl, U1, vo, jc, al, X1, ol, Z1;
const io = class io {
  constructor(e, t) {
    ya(this, al);
    ya(this, ol);
    J(this, "_id");
    J(this, "_targetID");
    J(this, "_targetKey");
    J(this, "_targetFlagKey");
    J(this, "_isScopingById", !0);
    J(this, "_initialSchema");
    J(this, "_target");
    J(this, "initPromise");
    J(this, "isInitPromiseResolved", !1);
    var n;
    let s, i;
    const a = this.constructor;
    if (a.IsValidData(e)) {
      ({ linkData: s } = a.PartitionSchemaData(e));
      const l = fromUuidSync(s.targetID);
      if (!l)
        throw new Error(`[new BladesTargetLink()] Unable to resolve target from uuid '${s.targetID}'`);
      "targetKey" in s ? i = getProperty(l, `${s.targetKey}.${s.id}`) : i = l.getFlag(X.SYSTEM_ID, `${s.targetFlagKey}.${s.id}`), this.isInitPromiseResolved = !0;
    } else {
      const l = Dr(n = io, vo, jc).call(n, e, t);
      let c;
      ({ linkData: s, partialSchema: c } = a.PartitionSchemaData(l)), i = a._ApplySchemaDefaults(c);
    }
    this._id = s.id, this._targetID = s.targetID, "targetKey" in s ? this._targetKey = s.targetKey : this._targetFlagKey = s.targetFlagKey;
    const o = fromUuidSync(this.targetID);
    if (!o)
      throw new Error(`[new BladesTargetLink()] Unable to resolve target from uuid '${this._targetID}'`);
    this._target = o, this._initialSchema = i;
  }
  // #region STATIC METHODS ~
  static get ValidTargetClasses() {
    return [
      oe,
      Z,
      wr,
      User
    ];
  }
  static IsValidConfig(e) {
    return w.isSimpleObj(e) && (w.isDocID(e.target) || w.isDocUUID(e.target) || w.isDocID(e.targetID) || w.isDocUUID(e.targetID) || this.ValidTargetClasses.some((t) => e.target instanceof t)) && (w.isTargetKey(e.targetKey) || w.isTargetFlagKey(e.targetFlagKey)) && !(w.isTargetKey(e.targetKey) && w.isTargetFlagKey(e.targetFlagKey));
  }
  static IsValidData(e) {
    return w.isSimpleObj(e) && w.isDocID(e.id) && w.isDocUUID(e.targetID) && (w.isTargetKey(e.targetKey) || w.isTargetFlagKey(e.targetFlagKey)) && !(w.isTargetKey(e.targetKey) && w.isTargetFlagKey(e.targetFlagKey));
  }
  static BuildLinkConfig(e) {
    if ("target" in e) {
      if ("targetKey" in e)
        return {
          target: e.target,
          targetKey: e.targetKey,
          isScopingById: e.isScopingById
        };
      if ("targetFlagKey" in e)
        return {
          target: e.target,
          targetFlagKey: e.targetFlagKey,
          isScopingById: e.isScopingById
        };
      throw new Error("[BladesTargetLink.BuildConfig] Must provide a targetKey or targetFlagKey.");
    } else if ("targetID" in e) {
      if ("targetKey" in e)
        return {
          targetID: e.targetID,
          targetKey: e.targetKey,
          isScopingById: e.isScopingById
        };
      if ("targetFlagKey" in e)
        return {
          targetID: e.targetID,
          targetFlagKey: e.targetFlagKey,
          isScopingById: e.isScopingById
        };
      throw new Error("[BladesTargetLink.BuildConfig] Must provide a targetKey or targetFlagKey.");
    }
    throw new Error("[BladesTargetLink.BuildConfig] Must provide a target or targetID.");
  }
  /**
   * This static method parses the provided data into a format suitable for BladesTargetLink.
   * Subclasses can override this method to include their own parse logic.
   * If the provided data is already valid, it is returned as is.
   * Otherwise, the data is passed to the private #ParseConfig method for further processing.
   * Note: The 'id' property is defined at the return step, within #ParseConfig: Subclass
   * functionality that depends on the id property should be placed after the super call to this method.
   *
   * @template Schema - The data schema required by the subclass.
   * @param {(BladesTargetLink.Config | BladesTargetLink.Data) & Partial<Schema>} data - The data to be parsed.
   * @returns {BladesTargetLink.Data & Partial<Schema>} - The parsed data, suitable for BladesTargetLink.
   */
  static ParseConfigToData(e, t) {
    return this.IsValidData(e) ? Dr(this, rl, U1).call(this, e, t) : Dr(this, vo, jc).call(this, e, t);
  }
  static PartitionSchemaData(e) {
    const {
      id: t,
      target: s,
      targetID: i,
      targetKey: a,
      targetFlagKey: o,
      isScopingById: n,
      ...l
    } = e, c = l;
    if (w.isDocID(t)) {
      if (!this.IsValidData({ id: t, targetID: i, targetKey: a, targetFlagKey: o, isScopingById: n }))
        throw eLog.error("BladesTargetLink", "Bad Constructor DATA", { dataOrConfig: e }), new Error("[new BladesTargetLink()] Bad Constructor DATA (see log)");
      let u;
      if (a)
        u = { id: t, targetID: i, targetKey: a, isScopingById: n ?? !0 };
      else if (o)
        u = { id: t, targetID: i, targetFlagKey: o, isScopingById: n ?? !0 };
      else
        throw eLog.error("BladesTargetLink", "Bad Constructor DATA", { dataOrConfig: e }), new Error("[BladesTargetLink.PartitionSchemaData] Bad Constructor DATA (see log)");
      return {
        linkData: u,
        partialSchema: c
      };
    }
    return {
      linkConfig: this.BuildLinkConfig({
        isScopingById: n ?? !0,
        ..."targetID" in e ? { targetID: e.targetID } : { target: e.target },
        ..."targetKey" in e ? { targetKey: e.targetKey } : { targetFlagKey: e.targetFlagKey }
      }),
      partialSchema: c
    };
  }
  static _ApplySchemaDefaults(e) {
    return this.ApplySchemaDefaults(e);
  }
  /**
  * This static method applies defaults to any values missing from the class' data Schema.
  * 'Schema' is defined by subclasses to BladesTargetLink.
  * Subclasses must override this method to apply their own defaults.
  *
  * @template Schema - The data schema required by the subclass.
  * @param {Partial<Schema>} schemaData - Schema data overriding the defaults.
  * @returns {Schema} - The schema data with defaults applied.
  * @throws {Error} - Throws an error if this method is not overridden in a subclass.
  */
  static ApplySchemaDefaults(e) {
    throw new Error("[BladesTargetLink.ApplySchemaDefaults] Static Method ApplySchemaDefaults must be overridden in subclass");
  }
  /**
   * Creates a new instance of BladesTargetLink and initializes it with the provided configuration.
   * The configuration is parsed into a data object which is then used to initialize the target link.
   * The function logs the parsed data for debugging purposes.
   *
   * @template Schema - The schema type parameter that extends the data structure.
   * @param {BladesTargetLink.Config & Partial<Schema>} config - The configuration object containing both the target link configuration and the schema configuration.
   *
   * @returns {Promise<BladesTargetLink<Schema> & BladesTargetLink.Subclass<Schema>>} - A promise that resolves to a new instance of BladesTargetLink, initialized with the provided data.
   *
   * @throws {Error} - Throws an error if the initialization of the target link fails.
   */
  static async Create(e, t) {
    const s = new this(e, t);
    return await s.initTargetLink(), s;
  }
  // #endregion
  // #region GETTERS ~
  get isGM() {
    return game.user.isGM;
  }
  get id() {
    return this._id;
  }
  get targetID() {
    return this._targetID;
  }
  get targetKey() {
    return this._targetKey;
  }
  get targetFlagKey() {
    return this._targetFlagKey;
  }
  get isScopingById() {
    return this._isScopingById;
  }
  get initialSchema() {
    return this._initialSchema;
  }
  get targetKeyPrefix() {
    if (this.targetKey)
      return this.isScopingById ? this.targetKey ? `${this.targetKey}.${this.id}` : void 0 : this.targetKey;
  }
  get targetKeyNullPrefix() {
    if (this.targetKey) {
      if (this.isScopingById)
        return `${this.targetKey}.-=${this.id}`;
      if (/^.+\..+$/g.test(this.targetKey))
        return this.targetKey.replace(/\.([^.]+)$/, ".-=$1");
      throw new Error(`[BladesTargetLink.targetKeyNullPrefix] Can't Nullify TargetKey '${this.targetKey}'`);
    }
  }
  get targetFlagKeyPrefix() {
    if (this.targetFlagKey)
      return this.isScopingById ? this.targetFlagKey ? `${this.targetFlagKey}.${this.id}` : void 0 : this.targetFlagKey;
  }
  get isLinkInitialized() {
    return this.isInitPromiseResolved;
  }
  get linkData() {
    if (this.targetKey)
      return {
        id: this.id,
        targetID: this.targetID,
        targetKey: this.targetKey,
        isScopingById: this.isScopingById
      };
    if (this.targetFlagKey)
      return {
        id: this.id,
        targetID: this.targetID,
        targetFlagKey: this.targetFlagKey,
        isScopingById: this.isScopingById
      };
    throw new Error(`[BladesTargetLink.linkData] Missing targetKey and targetFlagKey for '${this.id}'`);
  }
  get target() {
    return this._target;
  }
  get localData() {
    return {
      ...this.initialSchema,
      ...this.linkData
    };
  }
  get data() {
    if (this.isLinkInitialized) {
      let e;
      if (this.targetFlagKeyPrefix ? e = this.target.getFlag(X.SYSTEM_ID, this.targetFlagKeyPrefix) : this.targetKeyPrefix && (e = getProperty(this.target, this.targetKeyPrefix)), !e)
        throw new Error("[BladesTargetLink.data] Error retrieving data.");
      return e;
    } else
      return eLog.warn("BladesTargetLink", "Attempt to access data of uninitiated BladesTargetLink: Returning local data only.", { bladesTargetLink: this, localData: this.localData }), this.localData;
  }
  // #endregion
  // #region ASYNC UPDATE & DELETE METHODS ~
  getDotKeyToProp(e, t = !1) {
    if (this.targetKeyPrefix)
      return e === void 0 ? t ? this.targetKeyNullPrefix : this.targetKeyPrefix : `${this.targetKeyPrefix}.${t ? "-=" : ""}${e}`;
    if (this.targetFlagKeyPrefix)
      return e === void 0 ? this.targetFlagKeyPrefix : `${this.targetFlagKeyPrefix}.${e}`;
    throw new Error("[BladesTargetLink.getDotKeyToProp()] Missing 'targetKeyPrefix' and 'targetFlagKeyPrefix'");
  }
  getFlagParamsToProp(e) {
    return [X.SYSTEM_ID, this.getDotKeyToProp(e)];
  }
  async updateTargetFlag(e, t) {
    this.targetFlagKeyPrefix && (t === null ? await this.target.unsetFlag(...this.getFlagParamsToProp(e)) : this.target instanceof oe ? await this.target.setFlag(...this.getFlagParamsToProp(e), t) : this.target instanceof Z ? await this.target.setFlag(...this.getFlagParamsToProp(e), t) : this.target instanceof User ? await this.target.setFlag(...this.getFlagParamsToProp(e), t) : this.target instanceof wr && await this.target.setFlag(...this.getFlagParamsToProp(e), t));
  }
  async updateTargetKey(e, t) {
    this.targetKeyPrefix && await this.target.update({ [this.getDotKeyToProp(e, t === null)]: t }, { render: !1 });
  }
  /**
   * Initializes a target link by updating the target's data with the provided data object.
   * If a targetKey is provided, the data is updated directly on the target.
   * If a targetFlagKey is provided, the data is set as a flag on the target.
   *
   * This method need only be run once, when the document is first created and its data must be written to server storage.
   * External functions can synchronously check the status of initialization via the isInitPromiseResolved property, while
   * asynchronous functions can await the initPromise property.
   *
   * TargetLink documents whose data already exists in server storage can be constructed directly (i.e. new BladesTargetLink(data))
   * without needing to call this method.
   *
   * @param {BladesTargetLink.Data & Schema} data - The combined data object containing both the target link data and the schema data.
   * @returns {Promise<void>} - A promise that resolves when the server update is complete.
   */
  async initTargetLink() {
    this.isInitPromiseResolved = !1;
    const e = {
      ...this.linkData,
      ...this.initialSchema
    };
    return this.initPromise = new Promise((t, s) => {
      if (this.targetKeyPrefix) {
        const i = mergeObject(
          getProperty(this.target, this.targetKeyPrefix) ?? {},
          e
        );
        this.target.update({ [this.targetKeyPrefix]: i }, { render: !1 }).then(() => {
          this.isInitPromiseResolved = !0, t();
        }).catch(s);
      } else if (this.targetFlagKeyPrefix) {
        const i = mergeObject(
          this.target.getFlag(X.SYSTEM_ID, this.targetFlagKeyPrefix) ?? {},
          e
        );
        this.target.setFlag(X.SYSTEM_ID, this.targetFlagKeyPrefix, i).then(() => {
          this.isInitPromiseResolved = !0, t();
        }).catch(s);
      } else
        s();
    }), this.initPromise;
  }
  async updateTarget(e, t, s) {
    if (typeof e == "string")
      return getProperty(this.data, e) === t ? void 0 : Dr(this, ol, Z1).call(this, e, t, s);
    if (typeof e == "object")
      return Dr(this, al, X1).call(this, e, t);
    throw new Error(`[BladesTargetLink.updateTarget()] Bad updateData for id '${this.id}': ${e}`);
  }
  async updateTargetData(e, t) {
    e && (e = {
      ...e,
      ...this.linkData
    }), await w.waitFor([this.initPromise, t]), this.targetFlagKeyPrefix ? await this.updateTargetFlag(void 0, e) : await this.updateTargetKey(void 0, e);
  }
  async delete(e, t) {
    e && e.delete(this.id), await w.waitFor([this.initPromise, t]), await this.updateTargetData(null);
  }
  // #endregion
};
rl = new WeakSet(), U1 = function(e, t) {
  if (!t)
    return e;
  const s = "targetKey" in t ? [t.targetKey] : [t.targetFlagKey];
  t.isScopingById && s.push(t.id);
  const i = s.join(".");
  if ("targetKey" in e && "targetKey" in t)
    e.targetKey.startsWith(`${i}.`) && (e.targetKey = e.targetKey.slice(i.length + 1)), e.targetKey = [
      t.targetKey,
      t.isScopingById ? t.id : void 0,
      e.targetKey
    ].filter(Boolean).join(".");
  else if ("targetFlagKey" in e && "targetFlagKey" in t)
    e.targetFlagKey.startsWith(`${i}.`) && (e.targetFlagKey = e.targetFlagKey.slice(i.length + 1)), e.targetFlagKey = [
      t.targetFlagKey,
      t.isScopingById ? t.id : void 0,
      e.targetFlagKey
    ].filter(Boolean).join(".");
  else
    throw new Error("[BladesTargetLink.ParseChildLinkData] targetKey/targetFlagKey mismatch between provided partialConfig and parentLinkData.");
  return e;
}, vo = new WeakSet(), jc = function(e, t) {
  if (this.IsValidData(e))
    return this.ParseConfigToData(e, t);
  const { linkConfig: s, partialSchema: i } = this.PartitionSchemaData(e), a = this.BuildLinkConfig(s);
  return "targetKey" in a ? this.ParseConfigToData({
    id: randomID(),
    ...i,
    targetID: w.parseDocRefToUUID("target" in a ? a.target : a.targetID),
    targetKey: a.targetKey
  }, t) : this.ParseConfigToData({
    id: randomID(),
    ...i,
    targetID: w.parseDocRefToUUID("target" in a ? a.target : a.targetID),
    targetFlagKey: a.targetFlagKey
  }, t);
}, al = new WeakSet(), X1 = async function(e, t) {
  if (await w.waitFor(t), this.targetKeyPrefix)
    return e = w.objMap(e, !1, (s) => `${this.targetKeyPrefix || this.targetFlagKeyPrefix}.${String(s)}`), this.target.update(e, { render: !1 });
  if (this.targetFlagKeyPrefix) {
    const s = this.target.getFlag(X.SYSTEM_ID, this.targetFlagKeyPrefix) ?? {}, i = flattenObject(s), a = mergeObject(i, e);
    return this.target.setFlag(X.SYSTEM_ID, this.targetFlagKeyPrefix, a);
  } else
    throw new Error(`[BladesTargetLink.#updateTargetViaMerge] Unable to update target data for BladesTargetLink id '${this.id}': Missing both 'targetKeyPrefix' and 'targetFlagKeyPrefix'`);
}, ol = new WeakSet(), Z1 = async function(e, t, s) {
  if (await w.waitFor(s), this.targetKeyPrefix)
    return this.target.update({ [`${this.targetKeyPrefix}.${e}`]: t });
  if (this.targetFlagKeyPrefix)
    return this.updateTargetFlag(e, t);
}, ya(io, rl), /**
 * This private static method is used to transform a configuration object into a data object for BladesTargetLink.
 * It checks if the provided configuration object is already valid data, and if so, returns it directly.
 * Otherwise, it partitions the configuration object into link-specific configuration and additional schema data,
 * constructs a full link configuration, and then creates a data object with a new random ID and the target UUID.
 * The method ensures that either 'targetKey' or 'targetFlagKey' is present and throws an error if the configuration is invalid.
 *
 * @template Schema - The additional schema data required by the subclass.
 * @param {BladesTargetLink.Config | BladesTargetLink.Data & Partial<Schema>} config - The configuration object that may contain BladesTargetLink properties and any subclass-specific schema data.
 * @returns {BladesTargetLink.Data & Partial<Schema>} - The fully constructed data object with necessary properties for BladesTargetLink.
 * @throws {Error} - Throws an error if the configuration object is invalid, lacks a target reference, or if both 'targetKey' and 'targetFlagKey' are provided.
 */
ya(io, vo);
let ws = io;
function n3(r) {
  return w.isList(r) && typeof r.x == "number" && typeof r.y == "number" && typeof r.width == "number" && typeof r.height == "number";
}
class Ft extends ws {
  constructor(t) {
    super(t);
    J(this, "positionDragger");
    game.eunoblades.ClockKeys.set(this.id, this), Object.values(t.clocksData ?? {}).forEach((s) => new je(s));
  }
  // #region STATIC METHODS ~
  static Initialize() {
    function t(s) {
      "clocksData" in s.system && Object.values(s.system.clocksData ?? {}).forEach((i) => {
        try {
          new Ft(i);
        } catch (a) {
          eLog.error("BladesClockKey", "[BladesClockKey.Initialize] Error initializing clock key.", a, i);
        }
      });
    }
    return game.items.contents.filter(
      (s) => Z.IsType(
        s,
        A.clock_keeper,
        A.project,
        A.cohort_gang,
        A.cohort_expert,
        A.ritual,
        A.design,
        A.location,
        A.score
      )
    ).forEach(t), game.actors.contents.filter(
      (s) => oe.IsType(
        s,
        z.pc,
        z.faction
      )
    ).forEach(t), loadTemplates([
      "systems/eunos-blades/templates/components/clock-key.hbs",
      "systems/eunos-blades/templates/components/clock.hbs"
    ]);
  }
  static ApplySchemaDefaults(t) {
    return {
      name: "",
      isVisible: !1,
      isNameVisible: !1,
      isSpotlit: !1,
      clocksData: {},
      sceneIDs: [],
      displayMode: Pt.full,
      oneKeyIndex: w.gsap.utils.random(0, 4, 1),
      ...t
    };
  }
  static async Create(t, s, i = []) {
    i.length > 6 ? (eLog.error("BladesClockKey", "[BladesClockKey.Create] Too many clock configs! (Max 6.) Eliminating extras.", i), i = i.slice(0, 6)) : i.length === 0 && i.push({});
    const a = new ws(t);
    if (a.targetKeyPrefix)
      t.clocksData = Object.fromEntries(
        i.map((l, c) => {
          const u = je.ParseConfigToData({
            ...je.ApplySchemaDefaults(l),
            index: c,
            targetID: a.targetID,
            targetKey: `${a.targetKeyPrefix}.clocksData`,
            isScopingById: !0
          });
          return [
            u.id,
            u
          ];
        })
      );
    else if (a.targetFlagKeyPrefix)
      t.clocksData = Object.fromEntries(
        i.map((l, c) => {
          const u = je.ParseConfigToData({
            ...je.ApplySchemaDefaults(l),
            targetID: a.targetID,
            targetFlagKey: `${a.targetFlagKeyPrefix}.clocksData`,
            isScopingById: !0
          });
          return [
            u.id,
            u
          ];
        })
      );
    else
      throw new Error("BladesClockKey.Create: No targetKey or targetFlagKey provided.");
    const o = await super.Create(a.data), n = new Ft(o.data);
    return n.renderTargetAndKeeper(), n;
  }
  static GetFromElement(t) {
    const s = $(t).closest(".clock-key-container").find(".clock-key");
    if (s.length === 0)
      return;
    const i = s.attr("id");
    if (i)
      return game.eunoblades.ClockKeys.get(i);
  }
  // #endregion
  // #region GETTERS & SETTERS ~
  // #region -- Shortcut Schema Getters ~
  get data() {
    return this.linkData;
  }
  get name() {
    return this.data.name;
  }
  set name(t) {
    this.updateTarget("name", t).then(() => {
      this.renderTargetAndKeeper();
    });
  }
  get isVisible() {
    return this.data.isVisible;
  }
  set isVisible(t) {
    this.updateTarget("isVisible", w.pBool(t)).then(() => {
      this.renderTargetAndKeeper();
    });
  }
  get isNameVisible() {
    return this.data.isNameVisible;
  }
  set isNameVisible(t) {
    this.updateTarget("isNameVisible", w.pBool(t)).then(() => {
      this.renderTargetAndKeeper();
    });
  }
  get isSpotlit() {
    return this.data.isSpotlit;
  }
  set isSpotlit(t) {
    this.updateTarget("isSpotlit", t).then(() => {
      this.renderTargetAndKeeper();
    });
  }
  get clocksData() {
    return this.data.clocksData;
  }
  get displayMode() {
    return this.data.displayMode;
  }
  get oneKeyIndex() {
    let { oneKeyIndex: t } = this.data;
    return t || (t = w.gsap.utils.random(0, 4, 1), this.updateTarget("oneKeyIndex", t).then(() => {
      this.renderTargetAndKeeper();
    })), t;
  }
  get sceneIDs() {
    return this.data.sceneIDs ?? [];
  }
  get overlayPosition() {
    var t;
    return (t = this.data.overlayPosition) == null ? void 0 : t[game.scenes.current.id];
  }
  set overlayPosition(t) {
    t ? this.updateTarget(`overlayPosition.${game.scenes.current.id}`, t).then(() => {
      this.renderTargetAndKeeper();
    }) : this.updateTarget(`overlayPosition.-=${game.scenes.current.id}`, null).then(() => {
      this.renderTargetAndKeeper();
    });
  }
  // #endregion
  get clocks() {
    return new Collection(
      Object.entries(this.clocksData).sort((t, s) => t[1].index - s[1].index).map(([t, s]) => [t, new je(s)])
    );
  }
  getClockByID(t) {
    return this.clocks.get(t);
  }
  getClockByIndex(t) {
    return this.clocks.find((s) => s.index === t);
  }
  get size() {
    return this.clocks.size;
  }
  get isComplete() {
    return Array.from(this.clocks).every((t) => t.isComplete);
  }
  get isClockKeeperKey() {
    return this.target instanceof vl;
  }
  get isFactionKey() {
    return this.target instanceof da;
  }
  get isProjectKey() {
    return this.target instanceof Co;
  }
  get isScoreKey() {
    return this.target instanceof So;
  }
  get visibleClocks() {
    return this.clocks.filter((t) => t.isVisible);
  }
  get activeClocks() {
    return this.visibleClocks.filter((t) => t.isActive);
  }
  get inProgressClocks() {
    return this.visibleClocks.filter((t) => !t.isComplete && t.value > 0);
  }
  get unstartedClocks() {
    return this.visibleClocks.filter((t) => t.value === 0);
  }
  get completedClocks() {
    return this.visibleClocks.filter((t) => t.isComplete);
  }
  get currentClock() {
    return this.activeClocks.length > 0 ? this.getEarliestClock(this.activeClocks) : this.completedClocks.length > 0 ? this.getLatestClock(this.completedClocks) : this.visibleClocks.length > 0 ? this.getEarliestClock(this.visibleClocks) : this.getEarliestClock(Array.from(this.clocks));
  }
  get fullDisplayPosData() {
    const t = this.svgData.width / 2, s = this.svgData.height / 2;
    return {
      x: t,
      y: s,
      width: this.svgData.width,
      height: this.svgData.height
    };
  }
  get clocksDisplayPosData() {
    return this.getClocksBoundingBox(Array.from(this.clocks));
  }
  get visibleClocksDisplayPosData() {
    return this.getClocksBoundingBox(this.visibleClocks);
  }
  get activeClocksDisplayPosData() {
    return this.getClocksBoundingBox(this.activeClocks);
  }
  getClocksBoundingBox(t) {
    const { size: s, ...i } = this.svgData.clocks, a = Object.fromEntries(
      Object.entries(i).filter(([p]) => t.map((h) => h.index).includes(w.pInt(p))).map(([p, h]) => [w.pInt(p), h])
    ), o = Object.values(a).sort((p, h) => p.x - h.x), n = Object.values(a).sort((p, h) => p.y - h.y), l = o[0].x, c = o[o.length - 1].x, u = n[0].y, g = n[n.length - 1].y;
    return {
      // Determine the center point in both x and y axes
      x: (l + c) / 2,
      y: (u + g) / 2,
      // Determine height and width of bounding box, accounting for clock size
      width: c - l + s,
      height: g - u + s
    };
  }
  /** This function accepts any number of arrays of BladesClock, then returns an array
   * containing those BladesClock instances that appear in ALL provided arrays.
   */
  getClocksIn(...t) {
    return t.length === 0 ? [] : t.reduce((s, i) => s.filter((a) => i.includes(a)));
  }
  /** This function accepts an array of BladesClock, and returns the BladesClock
   * instance with the lowest index property.
   */
  getEarliestClock(t) {
    if (t.length)
      return t.sort((s, i) => s.index - i.index)[0];
  }
  /** This function accepts an array of BladesClock, and returns the BladesClock
   * instance with the highest index property.
   */
  getLatestClock(t) {
    if (t.length)
      return t.sort((s, i) => i.index - s.index)[0];
  }
  isInScene(t = game.scenes.current.id) {
    return this.sceneIDs.includes(t);
  }
  get isInCurrentScene() {
    return this.isInScene(game.scenes.current.id);
  }
  get displaySelectOptions() {
    const t = [
      { value: Pt.full, display: "Full Key" },
      { value: Pt.clocks, display: "Clocks" },
      { value: Pt.activeClocks, display: "Active Clocks" }
    ];
    for (let s = 0; s < this.size; s++)
      t.push({ value: s, display: `Clock #${s}` }, { value: `present${s}`, display: `Present Clock #${s}` });
    return t;
  }
  // parseClockConfig(config: BladesClock.Config, indexOverride?: ClockIndex): BladesClock.Data {
  //   if (this.size === 6) {throw new Error("Cannot add a clock to a clock key with 6 clocks.");}
  //   if (indexOverride !== undefined && indexOverride < 0) {throw new Error("Cannot add a clock with a negative index.");}
  //   // Remove target so it doesn't conflict with key's targetID
  //   // delete config.target;
  //   const {target, targetID, targetKey, targetFlagKey, ...partialSchema} = config;
  //   const linkData: BladesTargetLink.LinkData = this.targetKey
  //     ? {
  //       targetID: this.targetID,
  //       targetKey: `${this.targetKeyPrefix}.clocksData` as TargetKey
  //     }
  //     : {
  //       targetID: this.targetID,
  //       targetFlagKey: `${this.targetFlagKeyPrefix}.clocksData` as TargetFlagKey
  //     };
  //   // Derive clock's targetID and targetKey/targetFlagKey from key's values
  //   data.targetID = this.targetID;
  //   if (this.targetKey) {
  //     data.targetKey = `${this.targetKeyPrefix}.clocksData` as TargetKey;
  //   } else if (this.targetFlagKey) {
  //     data.targetFlagKey = `${this.targetFlagKeyPrefix}.clocksData` as TargetFlagKey;
  //   }
  //   // Assign 'parentKeyID' and 'index'
  //   config.parentKeyID = this.id;
  //   config.index = indexOverride ?? this.size;
  //   // Parse config to full data object
  //   return BladesClock.ApplySchemaDefaults(
  //     BladesClock.ParseConfigToData(config as BladesClock.Config)
  //   );
  // }
  // #endregion
  // #region HTML INTERACTION ~
  // #region Get Elements$ ~
  getElemFromDisplayContext(t) {
    let s;
    const i = $(".vtt.game.system-eunos-blades");
    switch (t) {
      case Ke.overlay: {
        s = i.find(`#blades-overlay #${this.id}`);
        break;
      }
      case Ke.pcSheet: {
        s = i.find(`.actor.sheet .pc #${this.id}`);
        break;
      }
      case Ke.factionSheet: {
        s = i.find(`.actor.sheet .faction #${this.id}`);
        break;
      }
      case Ke.projectSheet: {
        s = i.find(`.item.sheet .project #${this.id}`);
        break;
      }
      case Ke.scoreSheet: {
        s = i.find(`.item.sheet .score #${this.id}`);
        break;
      }
      case Ke.rollCollab: {
        s = i.find(`.roll-collab-sheet #${this.id}`);
        break;
      }
      case Ke.chatMessage: {
        s = i.find(`#chat #${this.id}`);
        break;
      }
    }
    if (!s.length)
      throw new Error(`[BladesClockKey.getElemFromDisplayContext] Error elem$ not found for key '${this.id}' for display context '${t}'.`);
    return s;
  }
  getElements$(t) {
    let s;
    if (typeof t == "string" && (t = this.getElemFromDisplayContext(t)), s = $(t).find(`#${this.id}`), s.length || (s = $(t).closest(`#${this.id}`)), !(s != null && s.length))
      throw new Error(`[BladesClockKey.getElements$] Cannot find elements for display context '${t}' of clockKey '${this.id}'.`);
    const i = {
      elem$: s
    };
    if (!s.length)
      throw new Error(`[BladesClockKey.renderClockKey] Error '.clock-key-container' not found for key '${this.id}'.`);
    i.container$ = s.closest(".clock-key-container");
    const a = s.find(".key-image-container");
    if (!a.length)
      throw new Error(`[BladesClockKey.renderClockKey] Error '.key-image-container' not found for key '${this.id}'.`);
    i.imgContainer$ = a;
    const o = s.find(".key-label");
    if (!o.length)
      throw new Error(`[BladesClockKey.renderClockKey] Error label$ not found for key '${this.id}'.`);
    i.label$ = o;
    const n = s.find(".faction-label");
    n.length && (i.factionLabel$ = n);
    const l = s.find(".project-label");
    l.length && (i.projectLabel$ = l);
    const c = s.find(".score-label");
    return c.length && (i.scoreLabel$ = c), this.clocks.forEach((u) => {
      i.clocks ?? (i.clocks = {}), i.clocks[u.id] = u.getElements$(t);
    }), eLog.checkLog3("BladesClockKey", "Clock Key Elements", i), i;
  }
  // #endregion
  // #region Initial Rendering ~
  async renderTo(t) {
    const s = $(t);
    if (!s.length)
      throw new Error(`[BladesClockKey.renderClockKeyTo] Error parent element not provided for key '${this.id}'.`);
    const i = await renderTemplate(
      "systems/eunos-blades/templates/components/clock-key.hbs",
      this
    );
    $(i).appendTo(s);
  }
  /**
   * This function generates a partial GSAP.TweenVars object that will display the key in a given mode within the bounds of a provided container.
   *
   * @param {ClockKeyDisplayMode | number} [displayMode="full"] - The display mode. Options include:
   * - "full" - displays the entire clock key
   * - "clocks" - zooms in to display only the clocks
   * - "activeClocks" - zooms in to the active clocks
   * - "presentN" (where N is a clock index number) - zooms in to the clock at index N, and presents whichever side has the next available segment towards the camera.
   * - A clock index number - zooms in to the clock at index N
   *
   * @param {HTMLElement | JQuery<HTMLElement> | {x: number, y: number, width: number, height: number}} [container$] - The container within which the key will be displayed.
   * This can be:
   * - An HTMLElement
   * - A JQuery<HTMLElement>
   * - A {x, y, width, height} position definition
   * If not provided, it defaults to the clock key's container element (only if the key is already rendered in the DOM).
   *
   * @returns {gsap.TweenVars} - A partial GSAP.TweenVars object that describes how to display the key in the given mode within the bounds of the provided container. The returned object may include the following properties:
   * - 'scale' (number): A multiple to be applied to scale at "full" display mode.
   * - 'top' (number): A delta vertical shift from "full" display mode position.
   * - 'left' (number): A delta horizontal shift from "full" display mode position.
   * - 'transformOrigin': An absolute value.
   * - 'rotationZ': An absolute value for the keySwing axis.
   * - 'rotationY': An absolute value for rotation in/out of the screen.
   * Any variables left undefined default to "full" display mode.
   */
  getVarsForDisplayMode(t, s = Pt.full, i) {
    const a = {}, o = {};
    i ?? (i = t.container$);
    let n;
    if (i instanceof HTMLElement || i instanceof jQuery) {
      const u = w.gsap.getProperty($(i)[0]);
      n = {
        x: u("x"),
        y: u("y"),
        width: u("width"),
        height: u("height")
      };
    } else if (n3(i))
      n = i;
    else
      throw new Error(`[BladesClockKey.getVarsForDisplayMode] Error container$ '${i}' is not a valid type.`);
    let l, c;
    switch (s) {
      case Pt.full: {
        c = {
          x: this.svgData.width / 2,
          y: this.svgData.height / 2,
          width: this.svgData.width,
          height: this.svgData.height
        };
        break;
      }
      case Pt.clocks: {
        c = this.getClocksBoundingBox(Array.from(this.clocks));
        break;
      }
      case Pt.activeClocks: {
        c = this.getClocksBoundingBox(this.getClocksIn(this.activeClocks, this.visibleClocks));
        break;
      }
      case Pt.presentCurrentClock:
        l = this.currentClock, s = l.index;
      default: {
        if (typeof s == "string" && s.startsWith("present") && (s = w.pInt(s.toString().slice(7)), l = this.getClockByIndex(s)), !w.isInt(s) || s < 0 || s >= this.size)
          throw new Error(`[BladesClockKey.getVarsForDisplayMode] Error display mode '${s}' is not a valid clock index for key '${this.id}'.`);
        const u = this.svgData.clocks[s];
        c = {
          x: u.x,
          y: u.y,
          width: this.svgData.clocks.size,
          height: this.svgData.clocks.size
        };
        break;
      }
    }
    return a.scale = Math.min(
      n.height / c.height,
      n.width / c.width
    ), o.top = 0.5 * X.ClockKeySquareSize - c.y, o.left = 0.5 * X.ClockKeySquareSize - c.x, o.transformOrigin = `${c.x}px ${c.y}px`, o.rotateY = 0, l && (a.scale *= 2, l.getActiveSide() === "left" ? (o.rotateY = 30, o.left += this.size === 1 ? 45 : 25) : l.getActiveSide() === "right" && (o.rotateY = -30, o.left -= this.size === 1 ? 45 : 25)), { keyTweenVars: a, keyImgContTweenVars: o };
  }
  // public fitKeyToContainer(
  //   keyElems$: ClockKeyElems$,
  //   posOverrides?: Partial<ElemPosData & {
  //     xShift: number,
  //     yShift: number,
  //     scaleMult: number
  //   }>
  // ) {
  //   const {container$, elem$, imgContainer$} = keyElems$;
  //   // Get position data for the container$ element (x, y, width, height)
  //   const keyPosition: ElemPosData = {
  //     x: U.gsap.getProperty(container$[0], "x") as number,
  //     y: U.gsap.getProperty(container$[0], "y") as number,
  //     width: U.gsap.getProperty(container$[0], "width") as number,
  //     height: U.gsap.getProperty(container$[0], "height") as number
  //   };
  //   const {xShift, yShift, scaleMult, ...focusPosOverrides} = posOverrides ?? {};
  //   const focusPosition: ElemPosData = {
  //     ...this.fullDisplayPosData,
  //     ...focusPosOverrides
  //   };
  //   eLog.checkLog3("BladesClockKey", "[BladesClockKey] Key Positions", {
  //     keyPosition,
  //     focusPosition,
  //     widthScale: keyPosition.width / focusPosition.width,
  //     heightScale: keyPosition.height / focusPosition.height
  //   });
  //   // Apply scale factor to elem$ to fit default key position inside container$
  //   U.gsap.set(elem$, {
  //     scale: Math.min(
  //       keyPosition.width / focusPosition.width,
  //       keyPosition.height / focusPosition.height
  //     ) * (scaleMult ?? 1)
  //   });
  //   // Apply top, left and transformOrigin value to keyImgContainer, accounting for x/yPercent -50
  //   U.gsap.set(imgContainer$, {
  //     top: (0.5 * C.ClockKeySquareSize) - focusPosition.y + (yShift ?? 0),
  //     left: (0.5 * C.ClockKeySquareSize) - focusPosition.x + (xShift ?? 0),
  //     transformOrigin: `${focusPosition.x + (xShift ?? 0)}px ${focusPosition.y + (yShift ?? 0)}px`
  //   });
  // }
  formatLabels(t) {
    const { label$: s, clocks: i, factionLabel$: a, projectLabel$: o, scoreLabel$: n } = t;
    [
      [s, 2, 4],
      a ? [a, 2, 2] : void 0,
      o ? [o, 2, 2] : void 0,
      n ? [n, 2, 2] : void 0,
      ...this.clocks.map((l) => [i[l.id].clockLabel$, 2.5, 3])
    ].filter(Boolean).forEach(([l, c, u]) => {
      w.adjustTextContainerAspectRatio(l, c, u);
    });
  }
  setToDisplayMode(t, s, i = !0) {
    const { keyTweenVars: a, keyImgContTweenVars: o } = this.getVarsForDisplayMode(t, s);
    w.gsap.set(t.elem$, a), w.gsap.set(t.imgContainer$, o), i && s !== this.displayMode && this.updateTarget("displayMode", s);
  }
  initElementsInContext(t, s, i = !0) {
    const a = this.getElements$(t);
    return s ?? (s = this.displayMode), this.setToDisplayMode(a, s, i), this.formatLabels(a), (s.toString().startsWith("present") || Number.isInteger(s)) && w.gsap.to(a.container$.find(".clock-label, .clock-key-label"), { autoAlpha: 0, duration: 0 }), a;
  }
  // #endregion
  async addToScene(t = game.scenes.current.id) {
    if (this.isInScene(t))
      return;
    const { sceneIDs: s } = this;
    s.push(t), await this.updateTarget({
      isVisible: !1,
      sceneIDs: s
    }), this.renderTargetAndKeeper();
  }
  async removeFromScene(t = game.scenes.current.id) {
    if (!this.isInScene(t))
      return;
    const { sceneIDs: s } = this;
    w.remove(s, t), await this.updateTarget("sceneIDs", s), this.renderTargetAndKeeper();
  }
  closeClockKey({ container$: t }) {
    t.remove();
  }
  get svgData() {
    if (this.size === 0)
      throw new Error("[BladesClockKey.svgData] Error size is 0.");
    const t = O0[this.size];
    let s;
    if (this.size === 1 && t.paths)
      s = t.paths[this.oneKeyIndex];
    else if (t.path)
      s = t.path;
    else
      throw new Error("[BladesClockKey.svgData] Error path is not defined.");
    return {
      width: t.width,
      height: t.height,
      path: s,
      clocks: t.clocks
    };
  }
  isInOverlay(t) {
    return $(t).hasClass(".overlay-section") || $(t).closest(".overlay-section").length > 0;
  }
  get keyHeight() {
    return this.svgData.height;
  }
  get keyWidth() {
    return this.svgData.width;
  }
  get keyViewbox() {
    return `0 0 ${this.svgData.width} ${this.svgData.height}`;
  }
  get keyPath() {
    return this.svgData.path;
  }
  get clockSize() {
    return this.svgData.clocks.size;
  }
  getClockPosition(t = 0) {
    if (t > this.size)
      throw new Error(`[BladesClockKey.getClockPosition] Error clockIndex '${t}' is greater than key size '${this.size}'.`);
    if (t < 0)
      throw new Error(`[BladesClockKey.getClockPosition] Error clockIndex '${t}' is less than 0.`);
    return this.svgData.clocks[t];
  }
  removePositionDragger() {
    var t, s;
    (t = this.positionDragger) == null || t.target.remove(), (s = this.positionDragger) == null || s.kill(), delete this.positionDragger;
  }
  spawnPositionDragger(t = game.eunoblades.Director.clockKeySection$) {
    const s = this;
    this.positionDragger && this.removePositionDragger();
    const i = $(`<div id="Dragger-${this.id}" class="clock-key-container clock-key-dragger" data-size="${this.size}"></div>`).appendTo(t);
    this.overlayPosition && i.css({
      left: this.overlayPosition.x,
      top: this.overlayPosition.y
    }), this.positionDragger = new Yi(i, {
      type: "top,left",
      onDragStart() {
        $(this.target).css("background", "rgba(255, 255, 0, 0.25)"), $(this.target).css("outlineColor", "rgba(255, 255, 0, 1)");
      },
      onDragEnd() {
        $(this.target).css("background", "rgba(255, 0, 255, 0.25)"), $(this.target).css("outlineColor", "rgba(255, 0, 255, 1)"), s.overlayPosition = { x: this.endX, y: this.endY };
      }
    });
  }
  switchToMode(t, s, i = {}, a = {}, o = !0, n) {
    const { elem$: l, imgContainer$: c } = t, { keyTweenVars: u, keyImgContTweenVars: g } = this.getVarsForDisplayMode(t, s), p = this.displayMode, h = w.gsap.utils.random(1, 1e3, 1);
    return w.gsap.timeline({
      callbackScope: this,
      paused: !0,
      onStart() {
        eLog.checkLog2("BladesClockKey", `switchToMode #${h} - START`, { key: this, keyElems$: t, displayMode: s });
      },
      onComplete() {
        eLog.checkLog3("BladesClockKey", `switchToMode #${h} - COMPLETE`, { key: this, keyElems$: t, displayMode: s }), o && s !== this.currentDisplayMode ? this.updateTarget("displayMode", s).then(() => n == null ? void 0 : n()) : n == null || n();
      },
      onReverseComplete() {
        eLog.checkLog3("BladesClockKey", `switchToMode #${h} - REVERSE COMPLETE`, { key: this, keyElems$: t, displayMode: s }), o && this.updateTarget("displayMode", p);
      }
    }).to(l, { ...u, ...i }, 0).to(c, { ...g, ...a }, 0);
  }
  // #endregion
  // #region ANIMATED UPDATES (Both GM-Only AND Socket Calls)
  //    #region   > SOCKET CALLS: _SocketCall / static _SocketResponse / _Animation
  fadeInName_Animation(t) {
    if (this.name)
      return w.gsap.effects.blurReveal(t.label$, {
        ignoreMargin: !0,
        duration: 0.75
      });
  }
  async fadeInName_SocketCall(t) {
    game.user.isGM && socketlib.system.executeForEveryone("fadeInName_SocketCall", t, this.id);
  }
  static fadeInName_SocketResponse(t, s) {
    const i = game.eunoblades.ClockKeys.get(s);
    i && i.fadeInName_Animation(i.getElements$(t));
  }
  fadeOutName_Animation(t) {
    if (this.name)
      return w.gsap.effects.blurRemove(t.label$, {
        ignoreMargin: !0,
        duration: 0.75
      });
  }
  async fadeOutName_SocketCall(t) {
    game.user.isGM && (this.fadeOutName_Animation(this.getElements$(t)), socketlib.system.executeForOthers("fadeOutName_SocketCall", t, this.id));
  }
  static fadeOutName_SocketResponse(t, s) {
    const i = game.eunoblades.ClockKeys.get(s);
    i && i.fadeOutName_Animation(i.getElements$(t));
  }
  //    #endregion
  // #endregion
  // #region Adding & Removing Clocks ~
  async updateClockIndices() {
    return await this.updateTarget("clocksData", Object.fromEntries(
      Object.entries(this.clocksData).map(([t, s], i) => [t, { ...s, index: i }])
    )), this.clocks;
  }
  async addClock(t = {}) {
    const s = je.ParseConfigToData({
      ...je.ApplySchemaDefaults(t),
      index: this.size,
      targetID: this.targetID,
      targetKey: `${this.targetKeyPrefix}.clocksData`,
      isScopingById: !0
    });
    await this.updateTarget(`clocksData.${s.id}`, s), this.clocks, this.renderTargetAndKeeper();
  }
  async deleteClock(t) {
    var s, i;
    if (this.size <= 1)
      throw new Error("[BladesClockKey.deleteClock()] Cannot reduce number of clocks below 1!");
    t ?? (t = (s = Array.from(this.clocks).pop()) == null ? void 0 : s.id), t && (await ((i = this.getClockByID(t)) == null ? void 0 : i.delete()), await this.updateClockIndices(), this.clocks);
  }
  // #endregion
  // #region OVERRIDES: Async Update Methods
  renderTargetAndKeeper() {
    var t;
    this.renderTarget(), (t = game.eunoblades.ClockKeeper.sheet) == null || t.render();
  }
  renderTarget() {
    var t;
    (t = this.target.sheet) == null || t.render();
  }
  // #endregion
}
class je extends ws {
  // #region STATIC METHODS ~
  static ApplySchemaDefaults(e) {
    const t = {
      name: e.name ?? "",
      value: e.value ?? 0,
      max: e.max ?? 8
    };
    return {
      index: 0,
      color: Yt.white,
      isVisible: !w.isInt(e.index) || e.index === 0,
      isNameVisible: !1,
      isHighlighted: !1,
      isActive: !w.isInt(e.index) || e.index === 0,
      ...e,
      ...t
    };
  }
  // #endregion
  // #region GETTERS & SETTERS ~
  get canEdit() {
    return console.log("NOTE: All Clocks currently Editable; see line 71 of BladesClock.ts"), this.isVisible && this.isActive;
  }
  get data() {
    return this.linkData;
  }
  get name() {
    return this.data.name;
  }
  set name(e) {
    this.updateTarget("name", e).then(() => {
      this.parentKey.renderTargetAndKeeper();
    });
  }
  get value() {
    return w.pInt(this.data.value);
  }
  set value(e) {
    this.updateTarget("value", w.pInt(e)).then(() => {
      this.parentKey.renderTargetAndKeeper();
    });
  }
  get max() {
    return w.pInt(this.data.max);
  }
  set max(e) {
    this.updateTarget("max", w.pInt(e)).then(() => {
      this.parentKey.renderTargetAndKeeper();
    });
  }
  get color() {
    return this.data.color ?? Yt.white;
  }
  set color(e) {
    this.updateTarget("color", e).then(() => {
      this.parentKey.renderTargetAndKeeper();
    });
  }
  get isActive() {
    return w.pBool(this.data.isActive);
  }
  set isActive(e) {
    this.updateTarget("isActive", w.pBool(e)).then(() => {
      this.parentKey.renderTargetAndKeeper();
    });
  }
  get parentKey() {
    const e = game.eunoblades.ClockKeys.get(this.data.parentKeyID);
    if (!e)
      throw new Error(`[BladesClockKey.parentKey] No parent key found for clock ${this.id}`);
    return e;
  }
  get isNameVisible() {
    return w.pBool(this.data.isNameVisible);
  }
  set isNameVisible(e) {
    this.updateTarget("isNameVisible", w.pBool(e)).then(() => {
      this.parentKey.renderTargetAndKeeper();
    });
  }
  get isVisible() {
    return w.pBool(this.data.isVisible);
  }
  set isVisible(e) {
    this.updateTarget("isVisible", w.pBool(e)).then(() => {
      this.parentKey.renderTargetAndKeeper();
    });
  }
  get isHighlighted() {
    return w.pBool(this.data.isHighlighted);
  }
  set isHighlighted(e) {
    this.updateTarget("isHighlighted", w.pBool(e)).then(() => {
      this.parentKey.renderTargetAndKeeper();
    });
  }
  get index() {
    return w.pInt(this.data.index);
  }
  set index(e) {
    this.updateTarget("index", w.pInt(e)).then(() => {
      this.parentKey.renderTargetAndKeeper();
    });
  }
  get isEmpty() {
    return this.value === 0;
  }
  get isComplete() {
    return this.value >= this.max;
  }
  get rollOppClock() {
    return this;
  }
  get rollOppName() {
    return this.name;
  }
  get rollOppType() {
    return "clock";
  }
  get colorSelectOptions() {
    return [
      { value: Yt.white, display: "🔘" },
      { value: Yt.yellow, display: "📀" },
      { value: Yt.cyan, display: "🔵" },
      { value: Yt.red, display: "🔴" }
    ];
  }
  get maxSelectOptions() {
    return [
      { value: 2, display: 2 },
      { value: 3, display: 3 },
      { value: 4, display: 4 },
      { value: 5, display: 5 },
      { value: 6, display: 6 },
      { value: 8, display: 8 },
      { value: 10, display: 10 },
      { value: 12, display: 12 }
    ];
  }
  get valueSelectOptions() {
    const e = [];
    for (let t = 0; t <= this.max; t++)
      e.push({ value: t, display: t });
    return e;
  }
  // Returns which hemisphere of the clock will show the final change if segmentDelta segments are added/removed.
  getActiveSide(e = 0) {
    const t = Math.min(this.max, Math.max(0, this.value + e)), s = this.max / 2;
    return e === 0 ? t >= s ? "left" : "right" : t > s ? "left" : "right";
  }
  // #endregion
  // #region HTML INTERACTION ~
  getElemFromDisplayContext(e) {
    let t;
    const s = $(".vtt.game.system-eunos-blades");
    switch (e) {
      case Ke.overlay: {
        t = s.find(`#blades-overlay #${this.id}`);
        break;
      }
      case Ke.pcSheet: {
        t = s.find(`.actor.sheet .pc #${this.id}`);
        break;
      }
      case Ke.factionSheet: {
        t = s.find(`.actor.sheet .faction #${this.id}`);
        break;
      }
      case Ke.projectSheet: {
        t = s.find(`.item.sheet .project #${this.id}`);
        break;
      }
      case Ke.scoreSheet: {
        t = s.find(`.item.sheet .score #${this.id}`);
        break;
      }
      case Ke.rollCollab: {
        t = s.find(`.roll-collab-sheet #${this.id}`);
        break;
      }
      case Ke.chatMessage: {
        t = s.find(`#chat #${this.id}`);
        break;
      }
    }
    if (!t.length)
      throw new Error(`[BladesClockKey.getElemFromDisplayContext] Error elem$ not found for key '${this.id}' for display context '${e}'.`);
    return t;
  }
  getElements$(e) {
    let t;
    if (typeof e == "string" && (e = this.getElemFromDisplayContext(e)), t = $(e).find(`#${this.id}`), t.length || (t = $(e).closest(`#${this.id}`)), !(t != null && t.length))
      throw new Error(`[BladesClock.getElements$] Cannot find elements for display context '${e}' of clock '${this.id}' of key '${this.parentKey.id}'.`);
    const s = {
      clockElem$: t
    }, i = t.closest(".clock-container");
    if (!i.length)
      throw new Error(`[BladesClock.getElements$] Error '.clock-container' not found for clock '${this.id}' of key '${this.parentKey.id}'.`);
    s.clockContainer$ = i;
    const a = t.find(".clock-label");
    if (!a.length)
      throw new Error(`[BladesClock.getElements$] Error '.clock-label' not found for clock '${this.id}' of key '${this.parentKey.id}'.`);
    s.clockLabel$ = a;
    const o = t.find(".clock-bg");
    if (!o.length)
      throw new Error(`[BladesClock.getElements$] Error '.clock-bg' not found for clock '${this.id}' of key '${this.parentKey.id}'.`);
    s.bg$ = o;
    const n = t.find(".clock-frame");
    if (!n.length)
      throw new Error(`[BladesClock.getElements$] Error '.clock-frame' not found for clock '${this.id}' of key '${this.parentKey.id}'.`);
    s.frame$ = n;
    const l = t.find(".clock-fill");
    if (!l.length)
      throw new Error(`[BladesClock.getElements$] Error '.clock-fill' not found for clock '${this.id}' of key '${this.parentKey.id}'.`);
    s.fill$ = l;
    const c = t.find(".clock-glow");
    if (!c.length)
      throw new Error(`[BladesClock.getElements$] Error '.clock-glow' not found for clock '${this.id}' of key '${this.parentKey.id}'.`);
    s.glow$ = c;
    const u = t.find(".clock-cover");
    if (!u.length)
      throw new Error(`[BladesClock.getElements$] Error '.clock-cover' not found for clock '${this.id}' of key '${this.parentKey.id}'.`);
    s.cover$ = u;
    const g = t.find(".clock-one-segment");
    if (g.length !== 3)
      throw new Error(`[BladesClock.getElements$] Error '.clock-one-segment' elements not found for clock '${this.id}' of key '${this.parentKey.id}'.`);
    return s.oneSegments$ = g, s;
  }
  // #endregion
  // #region ANIMATED UPDATES (Both GM-Only AND Socket Calls)
  reveal_Animation(e, t) {
    const s = [
      e.frame$,
      e.fill$
    ].filter((a) => a !== void 0), i = w.gsap.timeline({
      callbackScope: this,
      onComplete() {
        t == null || t();
      }
    });
    return i.to(e.cover$, { scale: 2, autoAlpha: 0, duration: 0.5, ease: "power2" }), i.fromTo(s, {
      autoAlpha: 0,
      scale: 2
    }, {
      autoAlpha: 1,
      scale: 1,
      duration: 0.5,
      stagger: 0.2,
      ease: "power2"
    }), this.name && this.isNameVisible && i.blurReveal(e.clockLabel$, {
      ignoreMargin: !0,
      duration: 0.75
    }, "<+0.05"), this.isHighlighted && i.scaleUpReveal(e.glow$, {
      scale: 3,
      duration: 0.5
    }, "<+0.05"), this.isActive ? i.add(() => this.activate_Animation(e), "<+0.05") : i.add(() => this.deactivate_Animation(e), "<+0.05"), i;
  }
  async reveal_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("reveal_SocketCall", e, this.parentKey.id, this.index);
  }
  static reveal_SocketResponse(e, t, s) {
    const i = game.eunoblades.ClockKeys.get(t);
    if (!(i != null && i.isVisible))
      return;
    const a = i.getClockByIndex(s);
    if (!a)
      return;
    const o = a.getElements$(e);
    a.reveal_Animation(o);
  }
  hide_Animation(e, t) {
    const s = [
      e.frame$,
      e.fill$
    ].filter((a) => a !== void 0), i = w.gsap.timeline({
      callbackScope: this,
      onComplete() {
        t == null || t();
      }
    });
    return i.to(s, {
      autoAlpha: 0,
      scale: 2,
      duration: 0.5,
      stagger: 0.2,
      ease: "power2"
    }), this.name && this.isNameVisible && i.blurRemove(e.clockLabel$, {
      ignoreMargin: !0,
      duration: 0.75
    }, "<+0.05"), this.isHighlighted && i.scaleDownRemove(e.glow$, {
      scale: 3,
      duration: 0.5
    }, "<+0.05"), i.to(e.cover$, { scale: 1, autoAlpha: 1, duration: 0.5, ease: "power2" }), i;
  }
  async hide_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("hide_SocketCall", e, this.parentKey.id, this.index);
  }
  static hide_SocketResponse(e, t, s) {
    const i = game.eunoblades.ClockKeys.get(t);
    if (!(i != null && i.isVisible))
      return;
    const a = i.getClockByIndex(s);
    if (!a)
      return;
    const o = a.getElements$(e);
    a.hide_Animation(o);
  }
  activate_Animation(e, t) {
    w.gsap.to(e.bg$, { autoAlpha: 1, duration: 0.5, ease: "power2" }), w.gsap.to(e.frame$, {
      filter: "brightness(0.5)",
      duration: 0.5,
      ease: "power2",
      onComplete: t
    });
  }
  async activate_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("activate_SocketCall", e, this.parentKey.id, this.index);
  }
  static activate_SocketResponse(e, t, s) {
    const i = game.eunoblades.ClockKeys.get(t);
    if (!(i != null && i.isVisible))
      return;
    const a = i.getClockByIndex(s);
    a && a.activate_Animation(a.getElements$(e));
  }
  deactivate_Animation(e, t) {
    w.gsap.to(e.bg$, { autoAlpha: 0, duration: 0.5, ease: "power2" }), w.gsap.to(e.frame$, {
      filter: "brightness(1) blur(5px)",
      duration: 0.5,
      ease: "power2",
      onComplete: t
    });
  }
  async deactivate_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("deactivate_SocketCall", e, this.parentKey.id, this.index);
  }
  static deactivate_SocketResponse(e, t, s) {
    const i = game.eunoblades.ClockKeys.get(t);
    if (!(i != null && i.isVisible))
      return;
    const a = i.getClockByIndex(s);
    a && a.deactivate_Animation(a.getElements$(e));
  }
  fadeInClockName_Animation(e) {
    w.gsap.effects.blurReveal(e.clockLabel$, {
      ignoreMargin: !0,
      duration: 0.75
    });
  }
  async fadeInClockName_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("fadeInClockName_SocketCall", e, this.parentKey.id, this.index);
  }
  static fadeInClockName_SocketResponse(e, t, s) {
    const i = game.eunoblades.ClockKeys.get(t);
    if (!(i != null && i.isVisible))
      return;
    const a = i.getClockByIndex(s);
    a && a.fadeInClockName_Animation(a.getElements$(e));
  }
  fadeOutClockName_Animation(e) {
    w.gsap.effects.blurRemove(e.clockLabel$, {
      ignoreMargin: !0,
      duration: 0.75
    });
  }
  async fadeOutClockName_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("fadeOutClockName_SocketCall", e, this.parentKey.id, this.index);
  }
  static fadeOutClockName_SocketResponse(e, t, s) {
    const i = game.eunoblades.ClockKeys.get(t);
    if (!(i != null && i.isVisible))
      return;
    const a = i.getClockByIndex(s);
    a && a.fadeOutClockName_Animation(a.getElements$(e));
  }
  highlight_Animation(e) {
    w.gsap.effects.scaleUpReveal(e.glow$, {
      duration: 0.5,
      scale: 3
    });
  }
  async highlight_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("highlight_SocketCall", e, this.parentKey.id, this.index);
  }
  static highlight_SocketResponse(e, t, s) {
    const i = game.eunoblades.ClockKeys.get(t);
    if (!(i != null && i.isVisible))
      return;
    const a = i.getClockByIndex(s);
    a && a.highlight_Animation(a.getElements$(e));
  }
  unhighlight_Animation(e) {
    w.gsap.effects.scaleDownRemove(e.glow$, {
      duration: 0.5,
      scale: 3
    });
  }
  async unhighlight_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("unhighlight_SocketCall", e, this.parentKey.id, this.index);
  }
  static unhighlight_SocketResponse(e, t, s) {
    const i = game.eunoblades.ClockKeys.get(t);
    if (!(i != null && i.isVisible))
      return;
    const a = i.getClockByIndex(s);
    a && a.unhighlight_Animation(a.getElements$(e));
  }
  getRotationOfSegment(e) {
    return 360 / this.max * (e - 1);
  }
  initOneSegments(e, t, s) {
    if (t.length > 3)
      throw new Error(`Too many segments: [${t.join(", ")}]`);
    const i = [...e.oneSegments$], a = Array.from(e.oneSegments$).slice(0, t.length);
    for (const o of t) {
      const n = i.shift();
      w.gsap.set(n, {
        rotation: this.getRotationOfSegment(o),
        autoAlpha: s ? 1 : 0
      });
    }
    return s && e.clockElem$.attr("data-value", w.getLast(t) - 1), a;
  }
  changeSegments_Animation(e, t, s, i) {
    t = w.gsap.utils.clamp(0, this.max, t), s = w.gsap.utils.clamp(0, this.max, s);
    let a = s - t;
    if (a === 0)
      return;
    const o = [];
    if (a < 0) {
      for (; Math.abs(a) > t; )
        a++;
      for (let c = t; c > s; c--)
        o.push(c);
    } else {
      for (; s > this.max; )
        a--;
      for (let c = t + 1; c <= s; c++)
        o.push(c);
    }
    const n = this.initOneSegments(e, o, t > s);
    eLog.checkLog3("BladesClock", "changeSegments_Animation", { clockElems$: e, delta: a, segmentNums: o, startVal: t, endVal: s, segmentsToAnimate: n });
    const l = w.gsap.timeline();
    return a > 0 ? l.fromTo(n, {
      autoAlpha: 0,
      scale: 2
    }, {
      autoAlpha: 1,
      scale: 1,
      duration: 0.5,
      stagger: 0.2,
      ease: "power2",
      callbackScope: this,
      onComplete() {
        e.clockElem$.attr("data-value", s), w.gsap.to(n, {
          autoAlpha: 0,
          duration: 0.5,
          stagger: 0.2
          // onComplete() {
          //   // Return clock key to original size and focus
          //   clockFocusTimeline.reverse();
          // }
        });
      }
    }) : l.fromTo(n, {
      autoAlpha: 1,
      scale: 1
    }, {
      autoAlpha: 0,
      scale: 2,
      duration: 0.5,
      stagger: 0.2,
      ease: "power2"
      // onComplete() {
      //   // Return clock key to original size and focus
      //   clockFocusTimeline.reverse();
      // }
    }), l;
  }
  async changeSegments_SocketCall(e, t, s) {
    game.user.isGM && (t = w.gsap.utils.clamp(0, this.max, t), s = w.gsap.utils.clamp(0, this.max, s), socketlib.system.executeForEveryone("changeSegments_SocketCall", e, this.parentKey.id, this.index, t, s));
  }
  static changeSegments_SocketResponse(e, t, s, i, a) {
    const o = game.eunoblades.ClockKeys.get(t);
    if (!(o != null && o.isVisible))
      return;
    const n = o.getClockByIndex(s);
    n && n.changeSegments_Animation(n.getElements$(e), i, a);
  }
  // #endregion
  // #region Adding/Removing Clock Segments ~
  // Returns number of segments beyond max (or 0, if max not met)
  async fillSegments(e, t = !1) {
    const s = Math.max(0, this.value + e - this.max);
    return e = Math.min(this.value + e, this.max) - this.value, e === 0 || (await this.updateTarget("value", this.value + e), t || this.parentKey.renderTargetAndKeeper()), s;
  }
  // Returns (positive) number of segments removed
  // in excess of the number of segments in the clock
  async clearSegments(e, t = !1) {
    const s = Math.max(0, e - this.value);
    return e = Math.min(this.value, e), e === 0 || (await this.updateTarget("value", this.value - e), t || this.parentKey.renderTargetAndKeeper()), s;
  }
  async delete() {
    const { parentKey: e } = this;
    await super.delete(!1), e.updateClockIndices();
  }
  // #endregion
}
const zt = class zt {
  constructor() {
    J(this, "_id");
    // #endregion
    // #endregion
    // #region OVERLAY ~
    // #region  >> Overlay Elements$ ~
    J(this, "_overlayContainer");
    J(this, "_overlayContainer$");
    // - As with notifications: placeholder animation until something more final can be coded.
    // #endregion
    // #region TOOLTIPS ~
    J(this, "_tooltipObserver");
    J(this, "_tooltipElems", /* @__PURE__ */ new Map());
    J(this, "_displayedTooltipID");
    this._id = randomID();
  }
  static getInstance() {
    return zt.instance ?? (zt.instance = new zt());
  }
  // #endregion
  static async Initialize() {
    return game.user.isGM && $("body").addClass("user-gm"), Hooks.on("renderApplication", async () => {
      game.eunoblades.Director.initClockKeySection(!0), game.user.isGM && (await game.eunoblades.ClockKeeper.update({ "system.targetScene": game.scenes.current.id }), game.eunoblades.ClockKeeper.render());
    }), loadTemplates([
      "systems/eunos-blades/templates/overlay/blades-overlay.hbs",
      "systems/eunos-blades/templates/overlay/location.hbs",
      "systems/eunos-blades/templates/overlay/score-panel.hbs",
      "systems/eunos-blades/templates/overlay/npc-portrait.hbs",
      "systems/eunos-blades/templates/overlay/pc-portrait.hbs",
      "systems/eunos-blades/templates/overlay/cohort-portrait.hbs",
      "systems/eunos-blades/templates/overlay/crew-status-bar.hbs",
      "systems/eunos-blades/templates/overlay/game-phase-bar.hbs",
      "systems/eunos-blades/templates/overlay/notices/push.hbs"
    ]);
  }
  // #region   >>  Sockets ~
  static InitSockets() {
    const e = zt.getInstance();
    socketlib.system.register("renderOverlay_SocketCall", e.renderOverlay_SocketResponse.bind(e)), e.initClockSockets(), e.initScorePanelSockets(), e.initLocationSockets(), e.initNPCSockets(), e.initPCSockets(), e.initCohortSockets(), e.initCrewSockets(), e.initNotificationSockets(), e.initTransitionSockets();
  }
  get overlayContainer() {
    return this._overlayContainer || ([this._overlayContainer] = $("#blades-overlay")), this._overlayContainer || ($("body.vtt").append('<section id="blades-overlay"></section>'), [this._overlayContainer] = $("#blades-overlay")), this._overlayContainer;
  }
  get overlayContainer$() {
    return this._overlayContainer$ || (this._overlayContainer$ = $(this.overlayContainer)), this._overlayContainer$;
  }
  get clockKeySection$() {
    return this.overlayContainer$.find(".overlay-section-clock-keys");
  }
  get locationSection$() {
    return this.overlayContainer$.find(".overlay-section-location");
  }
  get scorePanelSection$() {
    return this.overlayContainer$.find(".overlay-section-score-panel");
  }
  get npcSection$() {
    return this.overlayContainer$.find(".overlay-section-npcs");
  }
  get playerSection$() {
    return this.overlayContainer$.find(".overlay-section-players");
  }
  get crewSection$() {
    return this.overlayContainer$.find(".overlay-section-crew");
  }
  get notificationSection$() {
    return this.overlayContainer$.find(".overlay-section-notifications");
  }
  get transitionSection$() {
    return this.overlayContainer$.find(".overlay-section-transitions");
  }
  get tooltipSection$() {
    return this.overlayContainer$.find(".overlay-section-tooltips");
  }
  get svgData() {
    return O0;
  }
  // #endregion
  // #region  >> Rendering ~
  renderOverlay_SocketCall() {
    game.user.isGM && this.overlayContainer && socketlib.system.executeForEveryone("renderOverlay_SocketCall");
  }
  async renderOverlay_SocketResponse() {
    const e = await renderTemplate(
      "systems/eunos-blades/templates/overlay/blades-overlay.hbs",
      this
    );
    this.overlayContainer$.empty().append(e), this.initClockKeySection(), this.initTooltipSection();
  }
  // #endregion
  // #endregion
  // #region CLOCKS & CLOCK KEYS ~
  // #region   >> INITIALIZATION ~
  initClockKeySection(e = !1) {
    e && this.clockKeySection$.empty();
    const t = w.shuffle(this.sceneKeys.filter((i) => i.isVisible));
    let s = 0;
    for (; t.length; ) {
      const i = t.shift();
      i && (setTimeout(() => this.renderClockKey(i), s * 1e3), s += 0.5);
    }
    setTimeout(() => {
    }, s * 1e3);
  }
  initClockSockets() {
    socketlib.system.register("renderClockKey_SocketCall", zt.renderClockKey_SocketResponse.bind(zt)), socketlib.system.register("pullKey_SocketCall", zt.pullKey_SocketResponse.bind(zt)), socketlib.system.register("fadeInName_SocketCall", Ft.fadeInName_SocketResponse.bind(Ft)), socketlib.system.register("fadeOutName_SocketCall", Ft.fadeOutName_SocketResponse.bind(Ft)), socketlib.system.register("reveal_SocketCall", je.reveal_SocketResponse.bind(je)), socketlib.system.register("hide_SocketCall", je.hide_SocketResponse.bind(je)), socketlib.system.register("activate_SocketCall", je.activate_SocketResponse.bind(je)), socketlib.system.register("deactivate_SocketCall", je.deactivate_SocketResponse.bind(je)), socketlib.system.register("fadeInClockName_SocketCall", je.fadeInClockName_SocketResponse.bind(je)), socketlib.system.register("fadeOutClockName_SocketCall", je.fadeOutClockName_SocketResponse.bind(je)), socketlib.system.register("highlight_SocketCall", je.highlight_SocketResponse.bind(je)), socketlib.system.register("unhighlight_SocketCall", je.unhighlight_SocketResponse.bind(je)), socketlib.system.register("changeSegments_SocketCall", je.changeSegments_SocketResponse.bind(je));
  }
  // #endregion
  get sceneKeys() {
    return game.eunoblades.ClockKeeper.getSceneKeys(game.scenes.current.id);
  }
  // #region   >> Rendering (Dropping) Clock Keys ~
  dropKey_Animation(e, t) {
    const {
      container$: s,
      label$: i,
      imgContainer$: a,
      clocks: o
    } = t ?? e.getElements$(game.eunoblades.Director.clockKeySection$), n = a.data("keySwingTimeline"), l = w.gsap.timeline().call(() => {
      n.seek("NEUTRAL").play();
    }).from(s, {
      y: -800,
      ease: "bounce",
      duration: 1
    }, 0).to(s, { autoAlpha: 1, duration: 0.5, ease: "power2" }, 0);
    e.visibleClocks.forEach((c, u) => {
      l.add(
        () => {
          c.reveal_Animation(o[c.id]);
        },
        u === 0 ? ">" : "<+0.15"
      );
    }), e.name && e.isNameVisible && l.blurReveal(i, {
      ignoreMargin: !0,
      duration: 0.75
    }, "<+0.05");
  }
  prepareClockKeyTimelines(e, t) {
    const { container$: s, imgContainer$: i, elem$: a, label$: o, clocks: n } = t;
    w.gsap.set(s, { pointerEvents: "auto" }), w.gsap.set(a, { filter: "brightness(1)" }), w.gsap.set(i, { transformOrigin: "50% 10%" });
    const l = w.gsap.getProperty(s[0], "scale");
    i.data(
      "keySwingTimeline",
      w.gsap.timeline({ paused: !0, repeat: -1, yoyo: !0 }).fromTo(i, { rotateZ: -1 }, { rotateZ: 1, duration: 3, ease: "sine.inOut" }).addLabel("NEUTRAL", 1.5).seek("NEUTRAL")
    ), s.data(
      "hoverOverTimeline",
      w.gsap.timeline({
        paused: !0,
        data: { key: e, imgContainer$: i, label$: o, isNameRevealed: !1 },
        onStart() {
          this.data.imgContainer$.data("keySwingTimeline").tweenTo("NEUTRAL", {
            duration: 0.25,
            ease: "back.out(1.5)"
          }), this.data.key.name && !this.data.key.isNameVisible && (this.data.isNameRevealed = !0, w.gsap.effects.blurReveal(this.data.label$, {
            ignoreMargin: !0,
            duration: 0.5
          }));
        },
        onReverseComplete() {
          this.data.imgContainer$.data("keySwingTimeline").seek("NEUTRAL").play(), this.data.isNameRevealed && (this.data.isNameRevealed = !1, w.gsap.effects.blurRemove(this.data.label$, {
            ignoreMargin: !0,
            duration: 0.5
          }));
        }
      }).to(a, { filter: "brightness(1.5)", scale: l * 1.25, duration: 0.5, ease: "sine" })
    ), e.clocks.forEach((c) => {
      const { clockContainer$: u, clockLabel$: g, clockElem$: p } = n[c.id];
      if (!(u != null && u.length))
        throw new Error(`[BladesDirector.prepareClockKeyTimelines] Error clockContainer$ not found for clock '${c.id}' of key '${e.id}'.`);
      w.gsap.set(u, { pointerEvents: "auto" }), u.data(
        "hoverOverTimeline",
        w.gsap.timeline({
          paused: !0,
          data: { clock: c, clockLabel$: g, isNameRevealed: !1 },
          onStart() {
            this.data.clock.name && !this.data.clock.isNameVisible && (this.data.isNameRevealed = !0, w.gsap.effects.blurReveal(this.data.clockLabel$, {
              ignoreMargin: !0,
              duration: 0.5
            }));
          },
          onReverseComplete() {
            this.data.isNameRevealed && (this.data.isNameRevealed = !1, w.gsap.effects.blurRemove(this.data.clockLabel$, {
              ignoreMargin: !0,
              duration: 0.5
            }));
          }
        }).to(p, { filter: "brightness(1.5)", scale: 1.25, duration: 0.25, ease: "sine" })
      );
    });
  }
  async activateClockKeyListeners(e, t) {
    const { container$: s, clocks: i } = t;
    game.user.isGM ? (s.on("dblclick", async () => {
      var a;
      (a = game.eunoblades.ClockKeeper.sheet) == null || a.render(!0);
    }), s.on("contextmenu", async () => {
      this.pullKey_SocketCall(e.id), e.updateTarget("isVisible", !1);
    })) : (s.on("mouseenter", () => {
      s.data("hoverOverTimeline").play();
    }).on("mouseleave", () => {
      s.data("hoverOverTimeline").reverse();
    }), e.clocks.forEach((a) => {
      const { clockContainer$: o } = i[a.id];
      o.on("mouseenter", () => {
        a.isVisible && o.data("hoverOverTimeline").play();
      }).on("mouseleave", () => {
        a.isVisible && o.data("hoverOverTimeline").reverse();
      });
    }));
  }
  async renderClockKey(e) {
    await e.renderTo(this.clockKeySection$), e.positionDragger && e.removePositionDragger();
    const t = e.initElementsInContext(this.clockKeySection$, Pt.full);
    e.overlayPosition && w.gsap.set(t.container$, {
      left: e.overlayPosition.x,
      top: e.overlayPosition.y
    }), this.prepareClockKeyTimelines(e, t), this.activateClockKeyListeners(e, t), this.dropKey_Animation(e, t);
  }
  async renderClockKey_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("renderClockKey_SocketCall", e);
  }
  static async renderClockKey_SocketResponse(e) {
    const t = game.eunoblades.ClockKeys.get(e);
    t && game.eunoblades.Director.renderClockKey(t);
  }
  // #endregion
  // #region   >> Un-Rendering (Pulling) Clock Keys ~
  pullKey_Animation(e) {
    const { container$: t } = e.getElements$(game.eunoblades.Director.clockKeySection$);
    w.gsap.timeline().to(t, {
      y: -800,
      ease: "back.in(1)",
      duration: 0.75
    }).to(t, {
      opacity: 0,
      ease: "power2.out",
      duration: 0.25
    }, 0.75).call(() => {
      t.remove();
    });
  }
  async pullKey_SocketCall(e) {
    game.user.isGM && socketlib.system.executeForEveryone("pullKey_SocketCall", e);
  }
  static pullKey_SocketResponse(e) {
    const t = game.eunoblades.ClockKeys.get(e);
    t && game.eunoblades.Director.pullKey_Animation(t);
  }
  // #endregion
  // #endregion
  // #region SCORE PANEL ~
  // #region   >> INITIALIZATION ~
  initScorePanelSockets() {
  }
  // #endregion
  // ## Score Details
  // - Small panel overlapping corner of Location
  // - Engagement roll result
  // - Plan & Detail
  // - Target tier
  activateScorePanelListeners() {
  }
  // #endregion
  // #region LOCATIONS ~
  // #region   >> INITIALIZATION ~
  initLocationSockets() {
  }
  // #endregion
  // ## Locations
  // - District wrapper/header
  // - Faction wrapper/footer
  // - Location main
  // - Slide-scroll of sublocations
  activateLocationListeners() {
  }
  // #endregion
  // #region NPCs ~
  // #region   >> INITIALIZATION ~
  initNPCSockets() {
  }
  // #endregion// ## NPCs
  // - Linked to a location: When location is displayed, so are they.  *(Can be linked to District wrapper, main Location, or sublocations)*
  // - Portrait images close to the central location display, hover-over popups provide more detailed information from sheet or `BladesScore` instance
  activateNPCListeners() {
  }
  // #endregion
  // #region PCs, COHORTs, CREW ~
  // #region   >> INITIALIZATION ~
  initPCSockets() {
  }
  initCohortSockets() {
  }
  initCrewSockets() {
  }
  // #endregion
  // ## PCs
  // - Display panels along bottom
  // - Signal lights
  activatePCListeners() {
  }
  // ## Cohorts
  // - Smaller panels alongside the PCs
  activateCohortListeners() {
  }
  // ## Crew
  // - Limited information displayed, maybe bar beneath PCs showing Heat, Wanted Level…
  activateCrewListeners() {
  }
  // #endregion
  // #region NOTIFICATIONS ~
  // #region   >> INITIALIZATION ~
  initNotificationSockets() {
    socketlib.system.register("pushNotice_SocketCall", zt.pushNotice_SocketResponse.bind(zt));
  }
  // #endregion
  pushNotice_SocketCall(e, t) {
    const s = randomID();
    if (typeof e == "string") {
      if (e === "ALL")
        return socketlib.system.executeForEveryone("pushNotice_SocketCall", s, t);
      if (e === "GM")
        return socketlib.system.executeForAllGMs("pushNotice_SocketCall", s, t);
      e = game.users.filter(
        (i) => {
          var a, o;
          return i.id === e || i.name === e || ((a = i.character) == null ? void 0 : a.id) === e || ((o = i.character) == null ? void 0 : o.name) === e || game.user.isGM;
        }
      ).map((i) => i.id);
    }
    if (e.length > 0)
      return socketlib.system.executeForUsers("pushNotice_SocketCall", e, s, t);
  }
  static async pushNotice_SocketResponse(e, t) {
    const s = game.eunoblades.Director, i = $(await renderTemplate("systems/eunos-blades/templates/overlay/notices/push.hbs", {
      id: e,
      ...t
    })).appendTo(s.notificationSection$).on("click", (a) => {
      s.$removePush(a.currentTarget);
    }).on("contextmenu", (a) => {
      s.$removeAndClear(a.currentTarget);
    });
    w.gsap.fromTo(
      i,
      {
        x: 200,
        skewX: 20,
        autoAlpha: 0,
        filter: "blur(10px)"
      },
      {
        x: 0,
        skewX: 0,
        autoAlpha: 1,
        filter: "blur(0px)",
        duration: 0.5,
        ease: "back"
      }
    );
  }
  async $removePush(e) {
    w.gsap.to(
      e,
      {
        x: "+=200",
        autoAlpha: 0,
        ease: "power2",
        duration: 0.5,
        onComplete: function() {
          $(e).remove();
        }
      }
    );
  }
  async $removeAndClear(e) {
    const t = $(e).prevAll().get().reverse();
    t.unshift(e), w.gsap.to(
      t,
      {
        x: "+=200",
        autoAlpha: 0,
        ease: "power2",
        duration: 0.5,
        stagger: {
          each: 0.5,
          from: "start",
          ease: "power1.inOut"
        },
        onComplete: function() {
          t.forEach((s) => $(s).remove());
        }
      }
    );
  }
  // #endregion
  // #region TRANSITIONS ~
  // #region   >> INITIALIZATION ~
  initTransitionSockets() {
  }
  // #endregion
  // ## Transitions
  async advanceGamePhase(e) {
    var t;
    w.gsap.utils.wrap(
      Object.values($e),
      Object.values($e).indexOf(e ?? ((t = game.eunoblades.Tracker) == null ? void 0 : t.phase) ?? $e.Freeplay) + 1
    );
  }
  /**
   * Adjusts the tooltip's position to ensure it remains within its parent container using jQuery methods.
   * @param tooltip - The tooltip element, which can be either an HTMLElement or a JQuery<HTMLElement>.
   */
  adjustTooltipPosition(e) {
    if (e.css("position") !== "absolute")
      throw new Error("Tooltip position must be 'absolute'.");
    const t = e[0].getBoundingClientRect(), s = this.tooltipSection$[0].getBoundingClientRect(), i = e.position().top, a = e.position().left;
    if (t.right > s.right) {
      const o = s.right - t.right;
      e.css("left", `${a + o}px`);
    } else if (t.left < s.left) {
      const o = s.left - t.left;
      e.css("left", `${a + o}px`);
    }
    if (t.bottom > s.bottom) {
      const o = s.bottom - t.bottom;
      e.css("top", `${i + o}px`);
    } else if (t.top < s.top) {
      const o = s.top - t.top;
      e.css("top", `${i + o}px`);
    }
  }
  displayTooltip(e) {
    var s, i;
    if (!e.id)
      throw new Error("Tooltip must have an ID to be cloned to the overlay.");
    this._displayedTooltipID = e.id;
    const t = this;
    if (game.eunoblades.Director.clearTooltips(), !this._tooltipElems.has(e.id)) {
      const a = $(w.changeContainer(
        e,
        game.eunoblades.Director.tooltipSection$[0],
        !0
      ));
      this.adjustTooltipPosition(a);
      const o = w.gsap.effects.blurRevealTooltip(
        a[0],
        {
          onReverseComplete() {
            a.attr("id") === t._displayedTooltipID && delete t._displayedTooltipID, game.eunoblades.Director._tooltipElems.delete(a.attr("id")), game.eunoblades.Director.tooltipSection$.find(`#${a.attr("id")}`).remove(), game.eunoblades.Director.tooltipSection$.children("[style*='opacity: 0'], [style*='opacity:0']").each(function() {
              const n = this.id;
              n !== t._displayedTooltipID && (n && game.eunoblades.Director._tooltipElems.delete(n), $(this).remove());
            });
          }
        }
      );
      a.data("revealTimeline", o), this._tooltipElems.set(e.id, a);
    }
    (i = (s = this._tooltipElems.get(e.id)) == null ? void 0 : s.data("revealTimeline")) == null || i.play();
  }
  clearTooltip(e, t = !0) {
    e === this._displayedTooltipID && delete this._displayedTooltipID;
    const s = game.eunoblades.Director._tooltipElems.get(e);
    if (!s)
      return;
    const i = s.data("revealTimeline");
    i.isActive() && !t || i.reverse();
  }
  clearTooltips() {
    eLog.checkLog3("Observer", "Observer Triggered!"), game.eunoblades.Director._tooltipElems.forEach((e) => {
      e.attr("id") !== this._displayedTooltipID && game.eunoblades.Director.clearTooltip(e.attr("id"), !0);
    });
  }
  initTooltipSection() {
    var t;
    const e = this;
    this.clearTooltips(), (t = this._tooltipObserver) == null || t.kill(), this._tooltipObserver = Observer.create({
      type: "touch,pointer",
      // onMove: throttledOnMove,
      onClick() {
        e.clearTooltips();
      }
    });
  }
  // #endregion
};
// #region INITIALIZATION ~
// #region   >>  Single-Instance Factory Construction ~
J(zt, "instance");
let St = zt;
class $s extends ws {
  // #region Static Methods ~
  static async Initialize() {
    if (!game.messages)
      throw new Error("[BladesConsequence] Messages Not Ready!");
    return (await Promise.all(game.messages.contents.map(async (e) => e.rollConsequences))).flat();
  }
  /**
  * Checks if the given value is valid consequence data for a Resistance Roll.
  * @param val The value to check.
  * @param isCheckingResistedTo If the check is being recursively applied to the 'resistTo' value.
  * @returns True if the val is valid BladesConsequence.Data, false otherwise.
  */
  static IsValidConsequenceData(e, t = !1) {
    return !w.isList(e) || typeof e.type != "string" || !(e.type in Vt) || typeof e.name != "string" ? !1 : t ? !0 : !(e.attribute && (typeof e.attribute != "string" || !(e.attribute in Tt)) || !this.IsValidConsequenceData(e.resistTo, !0));
  }
  static ApplySchemaDefaults(e) {
    if (!e.primaryID)
      throw new Error("A primaryID is required for BladesConsequence.Schema");
    if (typeof e.name == "string" && !e.name && e.type !== Vt.None)
      throw new Error(`A name must be provided for non-None-type consequences (${e.name}).`);
    return {
      name: "",
      type: Vt.None,
      ...e
    };
  }
  static GetCsqTypeValue(e, t) {
    if (e === Vt.WorsePosition) {
      if (!t)
        throw new Error(`Cannot resolve consequence type value for '${e}' without roll data.`);
      let s;
      if ("rollPositionFinal" in t ? s = t.rollPositionFinal : "position" in t && (s = t.position), !s)
        throw new Error(`Cannot resolve consequence type value for '${e}' without roll data that includes final position data.`);
      return {
        [Ct.controlled]: 1,
        [Ct.risky]: 2,
        [Ct.desperate]: 0
      }[s];
    }
    if (e === Vt.ReducedEffect) {
      if (!t)
        throw new Error(`Cannot resolve consequence type value for '${e}' without roll data.`);
      let s;
      if ("rollEffectFinal" in t ? s = t.rollEffectFinal : "effect" in t && (s = t.effect), !s)
        throw new Error(`Cannot resolve consequence type value for '${e}' without roll data that includes final effect data.`);
      return {
        [mt.extreme]: 1,
        [mt.great]: 1,
        [mt.standard]: 1,
        [mt.limited]: 2,
        [mt.zero]: 0
      }[s];
    }
    return X.ConsequenceValues[e];
  }
  // #endregion
  // #region *** GETTERS *** ~
  // #region Getters (Target Data) ~
  get primaryID() {
    var e;
    return this.data.primaryID ?? ((e = this.parentConsequence) == null ? void 0 : e.primaryID);
  }
  get parentCsqID() {
    return this.data.parentCsqID;
  }
  get name() {
    return this.data.name;
  }
  get type() {
    return this.data.type;
  }
  get attribute() {
    var e;
    return this.data.attribute ?? ((e = this.parentConsequence) == null ? void 0 : e.attribute);
  }
  get attributeVal() {
    var e;
    return this.data.attributeVal ?? ((e = this.parentConsequence) == null ? void 0 : e.attributeVal);
  }
  get specialFooterMsg() {
    var e;
    return this.data.specialFooterMsg ?? ((e = this.parentConsequence) == null ? void 0 : e.specialFooterMsg);
  }
  // #endregion
  // #region Getters (Derived Data) ~
  get primary() {
    const e = fromUuidSync(this.primaryID);
    if (!Me.IsDoc(e))
      throw new Error(`Could not find primary with UUID '${this.primaryID}'`);
    return this.roll ? new Me(this.roll, e) : new Me(e);
  }
  get parentConsequence() {
    if (!this.parentCsqID)
      return;
    const e = game.eunoblades.Consequences.get(this.parentCsqID);
    if (!e)
      throw new Error(`Error locating parent consequence with id '${this.parentCsqID}'`);
    return e;
  }
  get typeDisplay() {
    return X.ConsequenceDisplay[this.type];
  }
  get icon() {
    return X.ConsequenceIcons[this.type];
  }
  get value() {
    return $s.GetCsqTypeValue(this.type, this);
  }
  // #endregion
  // #region Getters (Resolved Roll Data that Applied This Consequence) ~
  get rollData() {
    var e;
    return this.data.actionRollData ?? ((e = this.parentConsequence) == null ? void 0 : e.rollData);
  }
  get roll() {
    if (this.rollData)
      return game.eunoblades.Rolls.get(this.rollData.id) ?? new Ws({
        ...this.rollData,
        isScopingById: !1
      });
  }
  get position() {
    var e;
    return (e = this.roll) == null ? void 0 : e.rollPositionFinal;
  }
  get effect() {
    var e;
    return (e = this.roll) == null ? void 0 : e.rollEffectFinal;
  }
  get result() {
    var e;
    return (e = this.roll) == null ? void 0 : e.rollResultFinal;
  }
  // #endregion
  // #region Getters (Resistibility & Acceptance Status) ~
  isResistible() {
    return !!(this.type !== Vt.None && !this.isAccepted && this.data.resistSchema);
  }
  get resistanceModes() {
    return this.data.resistanceModes ?? [];
  }
  get wasResisted() {
    return !!this.resistanceModes.length;
  }
  get wasResistedByRoll() {
    return this.resistanceModes.includes("resist");
  }
  get wasResistedByArmor() {
    return this.resistanceModes.includes("armor");
  }
  get wasResistedBySpecialArmor() {
    var e;
    return (e = this.resistanceModes) == null ? void 0 : e.includes("special");
  }
  get canResistWithRoll() {
    return !(!this.isResistible() || !Te.IsType(this.primary.rollPrimaryDoc) || this.wasResistedByRoll);
  }
  get canResistWithArmor() {
    return !this.isResistible() || !this.data.canResistWithArmor ? !1 : this.primary.availableArmorCount > 0;
  }
  get canResistWithSpecial() {
    return !this.isResistible() || !this.data.canResistWithSpecial || !Te.IsType(this.primary.rollPrimaryDoc) || this.wasResistedBySpecialArmor ? !1 : this.primary.hasSpecialArmor;
  }
  get resistWithRollNegates() {
    return this.canResistWithRoll ? this.wasResisted ? !0 : !!this.data.resistWithRollNegates : !1;
  }
  get resistWithArmorNegates() {
    return this.canResistWithArmor ? this.wasResisted ? !0 : !!this.data.resistWithArmorNegates : !1;
  }
  get resistWithSpecialNegates() {
    return this.canResistWithSpecial ? this.wasResisted ? !0 : !!this.data.resistWithSpecialNegates : !1;
  }
  get isAccepted() {
    return "acceptanceMode" in this.data;
  }
  get acceptanceMode() {
    return this.data.acceptanceMode;
  }
  // #endregion
  // #endregion
  // #region *** RESISTING CONSEQUENCES ***
  // #region Constructing Resistable Consequence Schema
  get noneSchema() {
    return {
      name: "",
      type: Vt.None,
      primaryID: this.primaryID
    };
  }
  get resistSchema() {
    if (!this.isResistible())
      return;
    const e = {
      name: this.data.resistSchema.name,
      type: this.data.resistSchema.type,
      primaryID: this.primaryID,
      resistSchema: {
        name: "",
        type: Vt.None
      },
      resistanceModes: this.resistanceModes,
      resistWithRollNegates: !0,
      attribute: this.attribute,
      attributeVal: this.attributeVal,
      canResistWithArmor: this.canResistWithArmor,
      resistWithArmorNegates: !0,
      canResistWithSpecial: this.canResistWithSpecial,
      resistWithSpecialNegates: !0,
      specialFooterMsg: this.specialFooterMsg
    };
    return this.wasResisted && (e.name = "", e.type = Vt.None, delete e.resistSchema, e.canResistWithArmor = !1, e.canResistWithSpecial = !1), e;
  }
  // #endregion
  async resistConsequence(e, t) {
    if (!this.isResistible())
      throw new Error("Cannot resist a consequence that is not resistible.");
    const s = {
      resistanceModes: this.resistanceModes,
      ...this.resistSchema
    };
    if (s.resistanceModes.push(e), s.parentCsqID = void 0, e === "resist") {
      if (!(t != null && t.isResolved))
        throw new Error("Cannot transform to resisted consequence without a resolved resistance roll instance.");
      s.resistanceRollData = t.data;
    }
    this.wasResisted || s.type === Vt.None ? s.acceptanceMode = "base" : e === "resist" && !this.canResistWithArmor && !this.canResistWithSpecial && (s.acceptanceMode = e), await this.updateTargetData(s), s.acceptanceMode ? socketlib.system.executeForEveryone("acceptConsequence_SocketCall", this.id) : socketlib.system.executeForEveryone("resistConsequence_SocketCall", this.id);
  }
  // #endregion
  // #region *** ACCEPTING CONSEQUENCES ***
  async acceptConsequence() {
    this.isAccepted || (await this.updateTarget("acceptanceMode", w.getLast(this.resistanceModes) ?? "accept"), socketlib.system.executeForEveryone("acceptConsequence_SocketCall", this.id));
  }
  async applyConsequenceEffects() {
    if (/Harm/.test(this.type))
      this.primary.applyHarm(
        w.pInt(this.type.substring(this.type.length - 1)),
        this.name
      );
    else if (this.type === Vt.WorsePosition)
      this.primary.applyWorsePosition();
    else if (this.type === Vt.ReducedEffect) {
      const e = Object.values(mt).findIndex((t) => t === this.effect);
      if (e >= 1) {
        const t = Object.values(mt)[e - 1];
        await this.updateTarget("rollData.rollEffectFinal", t);
      }
    }
  }
  // #endregion
  // #region === CONSTRUCTOR === ~
  // constructor(
  //   config: BladesConsequence.Config,
  //   parentCsq?: BladesConsequence.Data
  // )
  // constructor(
  //   data: BladesConsequence.Data
  // )
  // constructor(
  //   schema: Partial<BladesConsequence.Schema>,
  //   parentCsq: BladesConsequence.Data
  // )
  // constructor(
  //   dataConfigOrSchema: BladesConsequence.Config | BladesConsequence.Data | Partial<BladesConsequence.Schema>,
  //   parentCsq?: BladesConsequence.Data
  // ) {
  //   // If a parentCsq is provided...
  //   if (parentCsq) {
  //     super({
  //       ...BladesTargetLink.BuildLinkConfig(parentCsq),
  //       ...dataConfigOrSchema
  //     });
  //   } else {
  //     super(dataConfigOrSchema as BladesConsequence.Config | BladesConsequence.Data);
  //   }
  // }
  // #endregion
  // #region *** HTML INTERACTION ***
  // #region *** BladesDialog *** ~
  // #endregion
  // #region *** BladesChat *** ~
  static ApplyChatListeners(e) {
    e.elem$.find(".comp.consequence-display-container").each((s, i) => {
      if (!$(i).hasClass("consequence-accepted")) {
        const a = $(i).find(".consequence-icon-container"), o = $(i).find(".interaction-pad-right"), n = $(i).find(".interaction-pad-left"), l = $(i).find(".interaction-pad-left-resist"), c = $(i).find(".interaction-pad-left-armor"), u = $(i).find(".interaction-pad-left-special");
        $(i).data("hoverTimeline", w.gsap.effects.csqEnter(i)), $(i).on({
          mouseenter: function() {
            $(i).css("z-index", 10), $(i).data("hoverTimeline").play();
          },
          mouseleave: function() {
            (!(a.data("isToggled") || a.data("isTogglingOn")) || a.data("isTogglingOff")) && $(i).data("hoverTimeline").reverse().then(() => {
              $(i).css("z-index", "");
            });
          }
        }), a.data("clickTimeline", w.gsap.effects.csqClickIcon(a[0])), a.on({
          click: function() {
            a.data("isToggled") || a.data("isTogglingOn") ? (a.data("isTogglingOn", !1), a.data("isTogglingOff", !0), a.data("clickTimeline").reverse().then(() => {
              a.data("isTogglingOff", !1), a.data("isToggled", !1);
            })) : (a.data("isTogglingOn", !0), a.data("isTogglingOff", !1), Array.from($(i).siblings(".consequence-display-container")).forEach((g) => {
              const p = $(g).find(".consequence-icon-container");
              (p != null && p.data("isToggled") || p != null && p.data("isTogglingOn")) && (p.data("isTogglingOn", !1), p.data("isTogglingOff", !0), p.data("clickTimeline").reverse().then(() => {
                p.data("isTogglingOff", !1), p.data("isToggled", !1), $(g).data("hoverTimeline").reverse().then(() => {
                  $(g).css("z-index", "");
                });
              }));
            }), a.data("clickTimeline").play().then(() => {
              a.data("isTogglingOn", !1), a.data("isToggled", !0);
            }));
          }
        }), o.data("hoverTimeline", w.gsap.effects.csqEnterRight(i)), o.on({
          mouseenter: function() {
            a.data("isToggled") && o.data("hoverTimeline").play();
          },
          mouseleave: function() {
            o.data("hoverTimeline").reverse();
          }
        }), n.data("hoverTimeline", w.gsap.effects.csqEnterLeft(i)), n.on({
          mouseenter: function() {
            a.data("isToggled") && n.data("hoverTimeline").play();
          },
          mouseleave: function() {
            n.data("hoverTimeline").reverse();
          }
        }), l.data("hoverTimeline", w.gsap.effects.csqEnterSubLeft(i, { type: "resist" })), l.on({
          mouseenter: function() {
            a.data("isToggled") && l.data("hoverTimeline").play();
          },
          mouseleave: function() {
            a.data("isToggled") && l.data("hoverTimeline").reverse();
          }
        }), c.data("hoverTimeline", w.gsap.effects.csqEnterSubLeft(i, { type: "armor" })), c.on({
          mouseenter: function() {
            a.data("isToggled") && c.data("hoverTimeline").play();
          },
          mouseleave: function() {
            a.data("isToggled") && c.data("hoverTimeline").reverse();
          }
        }), u.data("hoverTimeline", w.gsap.effects.csqEnterSubLeft(i, { type: "special" })), u.on({
          mouseenter: function() {
            a.data("isToggled") && u.data("hoverTimeline").play();
          },
          mouseleave: function() {
            a.data("isToggled") && u.data("hoverTimeline").reverse();
          }
        });
      }
    });
  }
  // #endregion
  // #endregion
}
var bt = /* @__PURE__ */ ((r) => (r.Heritage = "Heritage", r.Background = "Background", r.Vice = "Vice", r.Playbook = "Playbook", r.Reputation = "Reputation", r.Preferred_Op = "Preferred_Op", r.Gear = "Gear", r.Ability = "Ability", r.Faction = "Faction", r.Upgrade = "Upgrade", r.Cohort_Gang = "Cohort_Gang", r.Cohort_Expert = "Cohort_Expert", r.Feature = "Feature", r.Stricture = "Stricture", r.VicePurveyor = "VicePurveyor", r.Acquaintance = "Acquaintance", r.Friend = "Friend", r.Rival = "Rival", r.Crew = "Crew", r.Member = "Member", r.Contact = "Contact", r))(bt || {});
class na extends Dialog {
  constructor(t, s) {
    super(t, s);
    J(this, "parent");
    J(this, "tabs");
    J(this, "dialogType");
    J(this, "tags", []);
    J(this, "width");
    J(this, "docType");
    // csqData?: Record<
    // Position,
    // Record<
    //   RollResult.partial|RollResult.fail,
    //   Record<
    //     string,
    //     BladesRoll.ConsequenceData
    //     >
    //   >
    // >;
    J(this, "prompt");
    J(this, "target");
    J(this, "flagTarget");
    switch (this.dialogType = t.dialogType ?? "Selection", this.parent = t.parent, this.width = (s == null ? void 0 : s.width) ?? 500, this.prompt = t.prompt, this.target = t.target, this.flagTarget = t.flagTarget, this.dialogType) {
      case "Input":
        return;
      case "Selection":
        this.constructSelectionData(
          t
          /* , options */
        );
        return;
      default:
        throw new Error(`Unrecognized type for BladesDialog constructor: '${this.dialogType}'`);
    }
  }
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "dialog"],
      width: "auto",
      height: "auto",
      tabs: [{ navSelector: ".nav-tabs", contentSelector: ".tab-content", initial: "front" }]
    });
  }
  static Initialize() {
    return loadTemplates([
      "systems/eunos-blades/templates/dialog-selection.hbs",
      "systems/eunos-blades/templates/dialog-consequence.hbs",
      "systems/eunos-blades/templates/dialog-input.hbs",
      "systems/eunos-blades/templates/parts/dialog-consequence-block.hbs"
    ]);
  }
  static async DisplaySimpleInputDialog(t, s, i, a) {
    const o = new na({
      parent: t,
      title: t instanceof Ws ? "Roll Input" : `${t.name}: Input`,
      dialogType: "Input",
      content: "",
      prompt: s,
      target: i,
      flagTarget: a,
      buttons: {
        apply: {
          icon: '<i class="fa-solid fa-arrow-down-to-arc"></i>',
          label: "Apply",
          callback: (n) => o
          //   .writeToRollInstance(html as JQuery<HTMLElement>)
        },
        cancel: {
          icon: '<i class="fas fa-times"></i>',
          label: game.i18n.localize("Cancel"),
          callback: (n) => (eLog.checkLog3("dialog", "Callback Scope", { this: o, html: n }), !1)
        }
      },
      default: "apply"
    }, { classes: ["eunos-blades", "sheet", "dialog", "simple-input-dialog"] });
    return o._render(!0, { width: o.width }).then(() => eLog.checkLog3("dialog", "Input Dialog Instance", { this: o }));
  }
  static async DisplaySelectionDialog(t, s, i, a, o) {
    const n = new na({
      parent: t,
      title: s,
      docType: i,
      tabs: a,
      tags: o == null ? void 0 : o.filter((l) => l !== ""),
      content: "",
      buttons: {
        cancel: {
          icon: '<i class="fas fa-times"></i>',
          label: game.i18n.localize("Cancel"),
          callback: (l) => (eLog.checkLog3("dialog", "Callback Scope", { this: this, html: l }), !1)
        }
      },
      default: "cancel"
    });
    return n.hasItems ? n.render(!0, { width: n.width }) : void 0;
  }
  // static async DisplayRollConsequenceDialog(rollInst: BladesRoll) {
  // const app: BladesDialog = new BladesDialog({
  //   parent: rollInst,
  //   title: "Consequences",
  //   dialogType: BladesDialogType.Consequence,
  //   content: "",
  //   buttons: {
  //     apply: {
  //       icon: '<i class="fa-solid fa-arrow-down-to-arc"></i>',
  //       label: "Apply",
  //       callback: (html: HTMLElement|JQuery<HTMLElement>) => (app as BladesDialog)
  //         .writeToRollInstance(html as JQuery<HTMLElement>)
  //     },
  //     cancel: {
  //       icon: '<i class="fas fa-times"></i>',
  //       label: game.i18n.localize("Cancel"),
  //       callback: (html: JQuery|HTMLElement) => {
  //         eLog.checkLog3("dialog", "Callback Scope", {this: app, html});
  //         return false;
  //       }
  //     }
  //   },
  //   default: "apply"
  // }, {classes: ["eunos-blades", "sheet", "dialog", "consequence-dialog"]});
  // return app._render(true, {width: app.width}).then(() => eLog.checkLog3("dialog", "Dialog Instance", {this: app}));
  // }
  get template() {
    return `systems/eunos-blades/templates/dialog-${w.lCase(this.dialogType)}.hbs`;
  }
  get hasItems() {
    return Object.values(this.tabs ?? []).some((t) => t.length > 0);
  }
  constructSelectionData(t) {
    const s = [];
    if (t.tabs) {
      for (const [i, a] of Object.entries(t.tabs))
        a.length === 0 ? delete t.tabs[i] : s.push(i);
      s.length === 1 && !("Main" in t.tabs) && (t.tabs.Main = [...t.tabs[s[0]]], delete t.tabs[s[0]]), this.docType = t.docType, this.tabs = t.tabs, this.tags = t.tags ?? [], this.width = 150 * Math.ceil(Math.sqrt(Object.values(t.tabs)[0].length));
    }
  }
  // constructConsequenceData(data: BladesDialog.Data/* , options?: Partial<BladesDialog.Options> */) {
  //   eLog.checkLog3("dialog", "constructConsequenceData", {incoming: {...data}});
  //   if (!(this.parent instanceof BladesRoll)) { throw new Error("Cannot call 'constructConsequenceData' without a rollInst parent!"); }
  //   // Get existing consequence data, if any, on roll instance
  //   const rollCsqData = this.parent.data.consequenceData ?? {};
  //   // Extend consequence data by applying new blank consequence instances,
  //   //   so at least three csq entries are available for each position/result combination
  //   (Object.values(Position) as Position[]).forEach((rollPos: Position) => {
  //     rollCsqData[rollPos] ??= {
  //       [RollResult.partial]: {},
  //       [RollResult.fail]: {}
  //     };
  //     ([RollResult.partial, RollResult.fail] as const).forEach((rollResult: RollResult.partial|RollResult.fail) => {
  //       rollCsqData[rollPos] ??= {};
  //       rollCsqData[rollPos][rollResult] ??= {};
  //       while (Object.values(rollCsqData[rollPos][rollResult as RollResult.partial|RollResult.fail]).length < 3) {
  //         const blankCsqData: BladesConsequence.Data = {
  //           id: randomID() as IDString,
  //           name: "",
  //           type: "",
  //           attribute: ""
  //         };
  //         rollCsqData[rollPos][rollResult as RollResult.partial|RollResult.fail][blankCsqData.id] = blankCsqData;
  //       }
  //     });
  //   });
  //   this._consequenceAI = new BladesAI(AGENTS.ConsequenceAdjuster);
  //   return rollCsqData;
  // }
  getData() {
    const t = super.getData();
    switch (this.dialogType) {
      case "Input":
        return this.prepareInputData(t);
      case "Selection":
        return this.prepareSelectionData(t);
      default:
        return null;
    }
  }
  prepareInputData(t) {
    return t.prompt = this.prompt, t.target = this.target, t.flagTarget = this.flagTarget, t;
  }
  prepareSelectionData(t) {
    return t.title = this.title, t.tabs = this.tabs, t.docType = this.docType, t.tags = this.tags, t;
  }
  // prepareConsequenceData(data: BladesDialog.Data) {
  //   eLog.checkLog3("dialog", "prepareConsequenceData this.csqData", {...this.csqData});
  //   eLog.checkLog3("dialog", "prepareConsequenceData", {incoming: {...data}});
  //   data.consequenceData = this.csqData;
  //   data.consequenceTypeOptions = this.consequenceTypeOptions;
  //   data.consequenceTypeOptionsAll = Object.keys(C.ConsequenceDisplay)
  //     .map((cType) => ({value: cType, display: cType}));
  //   data.consequenceAttributeOptions = [
  //     {value: AttributeTrait.insight, display: "Insight"},
  //     {value: AttributeTrait.prowess, display: "Prowess"},
  //     {value: AttributeTrait.resolve, display: "Resolve"}
  //   ];
  //   eLog.checkLog3("dialog", "prepareConsequenceData", {outgoing: {...data}});
  //   return data;
  // }
  // get consequenceTypeOptions(): Record<
  //   Position,
  //   Record<
  //     RollResult.partial|RollResult.fail,
  //     Array<BladesSelectOption<string, ConsequenceType>>
  //   >
  //   > {
  //   if (this.parent instanceof BladesRoll) {
  //     const returnData: Partial<Record<
  //     Position,
  //     Record<
  //       RollResult.partial|RollResult.fail,
  //       Array<BladesSelectOption<string, ConsequenceType>>
  //     >
  //   >> = {};
  //     [Position.controlled, Position.risky, Position.desperate].forEach((pos) => {
  //       returnData[pos] = {
  //         [RollResult.partial]: C.Consequences[pos][RollResult.partial]
  //           .map((cType) => ({value: cType, display: cType})),
  //         [RollResult.fail]: C.Consequences[pos][RollResult.fail]
  //           .map((cType) => ({value: cType, display: cType}))
  //       };
  //     });
  //     return returnData as Record<
  //     Position,
  //     Record<
  //       RollResult.partial|RollResult.fail,
  //       Array<BladesSelectOption<string, ConsequenceType>>
  //     >
  //   >;
  //   }
  //   return {} as never;
  // }
  updateInputText(t) {
    const s = t.val();
    if (this.parent instanceof Ws) {
      const i = t.data("flagTarget");
      eLog.checkLog3("dialog", "updateInputText", { value: s, flagTarget: i }), this.parent.updateTarget(i, s).then(() => this.parent.renderRollCollab_SocketCall());
    } else
      (this.parent instanceof Z || this.parent instanceof oe) && this.parent.update({ [t.data("target")]: t.val() });
  }
  // updateConsequenceType(csqElem$: JQuery<HTMLElement>, cData: BladesConsequence.Data) {
  //   const type$ = csqElem$.find(".roll-consequence-type-select") as JQuery<HTMLSelectElement>;
  //   const typeVal = type$.val() as string|undefined;
  //   if (typeVal && typeVal in ConsequenceType) {
  //     cData.type = typeVal as ConsequenceType;
  //     cData.icon = C.ConsequenceIcons[cData.type];
  //     cData.typeDisplay = C.ConsequenceDisplay[cData.type];
  //   }
  // }
  // updateConsequenceAttribute(csqElem$: JQuery<HTMLElement>, cData: BladesConsequence.Data) {
  //   if (/Insight/.exec(cData.type)) { cData.attribute = AttributeTrait.insight; }
  //   else if (/Prowess/.exec(cData.type)) { cData.attribute = AttributeTrait.prowess; }
  //   else if (/Resolve/.exec(cData.type)) { cData.attribute = AttributeTrait.resolve; }
  //   else {
  //     const attribute$ = csqElem$.find(".roll-consequence-attribute-select") as JQuery<HTMLSelectElement>;
  //     const attrVal = attribute$.val() as AttributeTrait|undefined;
  //     if (attrVal) {
  //       cData.attribute = attrVal;
  //     }
  //   }
  // }
  // updateConsequenceAttributeVal(cData: BladesConsequence.Data) {
  //   if (this.parent.rollPrimaryDoc instanceof BladesPC) {
  //     cData.attributeVal = this.parent.rollPrimaryDoc.attributes[cData.attribute as AttributeTrait];
  //   } else if (this.parent.rollPrimaryDoc?.parent instanceof BladesPC) {
  //     cData.attributeVal = this.parent.rollPrimaryDoc.parent.attributes[cData.attribute as AttributeTrait];
  //   } else {
  //     eLog.error(`Unable to get attribute from rollPrimaryDoc '${this.parent.rollPrimaryDoc?.name}' of type '${this.parent.rollPrimaryDoc?.rollPrimaryType}' (may need to log via flags if either of the previous show 'undefined'.`);
  //   }
  // }
  // getSelectedResistOption(cData: BladesConsequence.Data): BladesConsequence|false {
  //   return cData.resistTo
  //     ? new BladesConsequence(cData.resistTo)
  //     : false;
  // }
  // updateConsequenceResist(csqElem$: JQuery<HTMLElement>, cData: BladesConsequence.Data) {
  //   const resistOptions: Record<string, BladesRoll.ConsequenceResistOption> = cData.resistOptions ?? {};
  //   // If consequence is already minimal, toggle resistNegates to true and set 'resistTo' to None-type
  //   const minimalCsqTypes = Object.entries(C.ResistedConsequenceTypes)
  //     .filter(([_, rCsqType]) => rCsqType === ConsequenceType.None)
  //     .map(([csqType]) => csqType as ConsequenceType);
  //   if (minimalCsqTypes.includes(cData.type as ConsequenceType)) {
  //     cData.resistNegates = true;
  //     const noneCsq = BladesConsequence.None;
  //     cData.resistOptions = {[noneCsq.id]: noneCsq};
  //     cData.resistTo = noneCsq;
  //     return;
  //   } else {
  //     // Clear 'resistTo' (will be redetermined below)
  //     delete cData.resistTo;
  //     delete cData.resistNegates;
  //     csqElem$.find(".consequence-resist-option").each((_, elem) => {
  //       const resCsqID = $(elem).data("csq-id");
  //       resistOptions[resCsqID] ??= {id: resCsqID, name: "", type: undefined, isSelected: false};
  //       // Update Resistance Option Type
  //       const resType$ = $(elem).find(".roll-consequence-type-select") as JQuery<HTMLSelectElement>;
  //       const resTypeVal = resType$.val() as string|undefined;
  //       if (resTypeVal && resTypeVal in ConsequenceType) {
  //         resistOptions[resCsqID].type = resTypeVal as ConsequenceType;
  //         resistOptions[resCsqID].icon = C.ConsequenceIcons[resistOptions[resCsqID].type as ConsequenceType];
  //         resistOptions[resCsqID].typeDisplay = C.ConsequenceDisplay[resistOptions[resCsqID].type as ConsequenceType];
  //       }
  //       // Update Resistance Option Name
  //       const resName$ = $(elem).find(".consequence-name") as JQuery<HTMLInputElement>;
  //       const resNameVal = resName$.val();
  //       resistOptions[resCsqID].name = resNameVal ?? "";
  //       // If this is selected, update 'resistTo' data as well
  //       if (resistOptions[resCsqID].isSelected) {
  //         cData.resistTo = resistOptions[resCsqID];
  //       }
  //     });
  //   }
  //   cData.resistOptions = resistOptions;
  // }
  // updateConsequenceArmorResist(_csqElem$: JQuery<HTMLElement>, cData: BladesConsequence.Data) {
  //   // If consequence is already minimal, toggle armorNegates to true and set 'armorTo' to None-type
  //   const minimalCsqTypes = Object.entries(C.ResistedConsequenceTypes)
  //     .filter(([_, rCsqType]) => rCsqType === ConsequenceType.None)
  //     .map(([csqType]) => csqType as ConsequenceType);
  //   if (minimalCsqTypes.includes(cData.type as ConsequenceType)) {
  //     cData.armorNegates = true;
  //     cData.armorTo = BladesConsequence.None;
  //   } else {
  //     delete cData.armorNegates;
  //     cData.armorTo = this.getSelectedResistOption(cData);
  //   }
  // }
  // updateConsequenceSpecialArmorResist(_csqElem$: JQuery<HTMLElement>, cData: BladesConsequence.Data) {
  //   // If consequence is already minimal, toggle specialArmorNegates to true and set 'specialTo' to None-type
  //   const minimalCsqTypes = Object.entries(C.ResistedConsequenceTypes)
  //     .filter(([_, rCsqType]) => rCsqType === ConsequenceType.None)
  //     .map(([csqType]) => csqType as ConsequenceType);
  //   if (minimalCsqTypes.includes(cData.type as ConsequenceType)) {
  //     cData.specialArmorNegates = true;
  //     cData.specialTo = BladesConsequence.None;
  //   } else {
  //     delete cData.specialArmorNegates;
  //     cData.specialArmorNegates ??= false;
  //     cData.specialTo = this.getSelectedResistOption(cData);
  //   }
  // }
  // updateConsequenceData(
  //   html: JQuery<HTMLElement|HTMLInputElement>,
  //   cData: BladesConsequence.Data
  // ) {
  //   const csqElem$ = html.find(`.roll-consequence-row[data-csq-id='${cData.id}']`);
  //   // Update Type
  //   this.updateConsequenceType(csqElem$, cData);
  //   // Update Name
  //   if (cData.type === ConsequenceType.None) {
  //     cData.name = "";
  //   } else {
  //     const name$ = csqElem$.find(".consequence-name") as JQuery<HTMLInputElement>;
  //     const nameVal = name$.val();
  //     cData.name = nameVal ?? "";
  //   }
  //   // Update Resistance Attribute
  //   this.updateConsequenceAttribute(csqElem$, cData);
  //   this.updateConsequenceAttributeVal(cData);
  //   // Update Resistance Options
  //   this.updateConsequenceResist(csqElem$, cData);
  //   // Update Armor Options
  //   if ((<BladesRoll> this.parent).canResistWithArmor(cData)) {
  //     cData.isDisplayingArmorToggle = true;
  //     this.updateConsequenceArmorResist(csqElem$, cData);
  //   } else {
  //     cData.isDisplayingArmorToggle = false;
  //   }
  //   // Update Special Armor Options
  //   if ((<BladesRoll> this.parent).canResistWithSpecialArmor(cData)) {
  //     cData.isDisplayingSpecialArmorToggle = true;
  //     this.updateConsequenceSpecialArmorResist(csqElem$, cData);
  //   } else {
  //     cData.isDisplayingSpecialArmorToggle = false;
  //   }
  //   return cData;
  // }
  // updateConsequenceDialog(html: JQuery<HTMLElement|HTMLInputElement>, isRendering = true) {
  //   if (!(this.parent instanceof BladesRoll)) { return; }
  //   if (!this.csqData) { return; }
  //   eLog.checkLog3("dialog", "updateConsequenceDialog() this.csqData INCOMING", {...this.csqData});
  //   const {csqData} = this;
  //   const {rollPrimaryDoc} = this.parent;
  //   if (!(rollPrimaryDoc instanceof BladesPC)) { return; }
  //   (Object.keys(csqData) as Position[]).forEach((rollPos) => {
  //     const positionCsqData = csqData[rollPos];
  //     (Object.keys(csqData[rollPos]) as [RollResult.partial, RollResult.fail]).forEach((rollResult) => {
  //       positionCsqData[rollResult] = U.objMap(
  //         positionCsqData[rollResult],
  //         (cData: BladesConsequence.Data) => this.updateConsequenceData(html, cData)
  //       );
  //     });
  //     csqData[rollPos] = positionCsqData;
  //   });
  //   this.csqData = csqData;
  //   eLog.checkLog3("dialog", "updateConsequenceDialog() this.csqData OUTGOING", {...this.csqData});
  //   if (isRendering) {
  //     this.render();
  //   }
  // }
  // async writeToRollInstance(html: JQuery<HTMLElement>) {
  // if (this.parent instanceof BladesRoll) {
  // this.updateConsequenceDialog(html, false);
  // await this.parent.updateTarget("consequenceData", this.csqData);
  // }
  // }
  // _consequenceAI?: BladesAI;
  // getCsqDataFromElem(elem: HTMLElement, paramCount = 3): string[] {
  //   const dataAction = elem.dataset.action;
  //   if (dataAction) {
  //     const params = dataAction.split(/-/).reverse().slice(0, paramCount);
  //     return params.reverse();
  //   }
  //   return [];
  // }
  // async queryAI(event: ClickEvent) {
  //   if (!this.csqData) { return; }
  //   // If the AI generator has not been initialized, do so.
  //   if (!this._consequenceAI) {
  //     this._consequenceAI = new BladesAI(AGENTS.ConsequenceAdjuster);
  //   }
  //   const [rollPosition, rollResult, csqID] = this.getCsqDataFromElem(event.currentTarget);
  //   const csqName: string|undefined =
  //     this.csqData[rollPosition as Position][rollResult as RollResult.partial|RollResult.fail][csqID]?.name;
  //   if (csqName) {
  //     const response = await this._consequenceAI?.query(csqName, csqName);
  //     if (response) {
  //       this.refreshResistanceOptions(rollPosition as Position, rollResult as RollResult.partial|RollResult.fail, csqID, response.split("|"));
  //     }
  //   }
  // }
  // async spawnBlankResistOption(event: ClickEvent) {
  //   if (!this.csqData) { return; }
  //   const [rollPosition, rollResult, csqID] = this.getCsqDataFromElem(event.currentTarget);
  //   const rCsqID = randomID() as IDString;
  //   this.csqData[rollPosition as Position][rollResult as RollResult.partial|RollResult.fail][csqID]
  //     .resistOptions = {
  //       [rCsqID]: {
  //         id: rCsqID,
  //         name: "",
  //         type: undefined,
  //         isSelected: true
  //       }
  //     };
  //   this.render();
  // }
  // async setFlagVal(target: string, value: unknown) {
  //   if (this.parent instanceof BladesRoll) {
  //     await this.parent.updateTarget(target, value);
  //   }
  // }
  // async refreshResistanceOptions(rollPosition: Position, rollResult: RollResult, cID: string, rOptions: string[]) {
  //   if (!this.csqData) { return; }
  //   const cData = this.csqData[rollPosition][rollResult as RollResult.partial|RollResult.fail][cID];
  //   if (!cData) { return; }
  //   const cType = cData.type as keyof typeof C["ResistedConsequenceTypes"];
  //   const rType = C.ResistedConsequenceTypes[cType] ?? undefined;
  //   const resistOptions: Record<string, BladesRoll.ConsequenceResistOption> = {};
  //   for (let i = 0; i < rOptions.length; i++) {
  //     const rID = randomID() as IDString;
  //     resistOptions[rID] = {
  //       id: rID,
  //       name: rOptions[i],
  //       isSelected: false
  //     };
  //     if (rType) {
  //       resistOptions[rID].type = rType;
  //       resistOptions[rID].typeDisplay = C.ConsequenceDisplay[rType];
  //       resistOptions[rID].icon = C.ConsequenceIcons[rType];
  //     }
  //   }
  //   this.csqData[rollPosition][rollResult as RollResult.partial|RollResult.fail][cID].resistOptions = resistOptions;
  //   eLog.checkLog3("dialog", "addResistanceOptions() this.csqData", {...this.csqData});
  //   this.render();
  // }
  // async selectResistOption(event: ClickEvent) {
  //   if (!this.csqData) { return; }
  //   const [rollPosition, rollResult, csqID, resID] = this.getCsqDataFromElem(event.currentTarget, 4);
  //   eLog.checkLog3("dialog", "... Action Passed", {rollResult, csqIndex: csqID, resIndex: resID});
  //   // Get consequence data
  //   const cData = this.csqData[rollPosition as Position][rollResult as RollResult.partial|RollResult.fail][csqID];
  //   cData.resistOptions ??= {};
  //   // Toggle clicked resistance option
  //   cData.resistOptions[resID].isSelected = !cData.resistOptions[resID].isSelected;
  //   // If resistance option is now selected...
  //   if (cData.resistOptions[resID].isSelected) {
  //     // ... deselect & hide other options
  //     Object.keys(cData.resistOptions)
  //       .filter((key) => key !== resID)
  //       .forEach((key) => {
  //         Object.assign(cData.resistOptions?.[key] ?? {}, {isSelected: false, isVisible: false});
  //       });
  //     // ... and set 'resistTo' to this consequence.
  //     cData.resistTo = cData.resistOptions[resID];
  //   } else {
  //     // Otherwise, set 'resistTo' to false...
  //     cData.resistTo = false;
  //     // ... and unhide other options.
  //     Object.keys(cData.resistOptions)
  //       .filter((key) => key !== resID)
  //       .forEach((key) => {
  //         Object.assign(cData.resistOptions?.[key] ?? {}, {isVisible: true});
  //       });
  //   }
  //   // Assign new cData instance.
  //   this.csqData[rollPosition as Position][rollResult as RollResult.partial|RollResult.fail][csqID] = cData;
  //   this.render();
  // }
  // async clearResistOptions(event: ContextMenuEvent) {
  //   if (!this.csqData) { return; }
  //   const [rollPosition, rollResult, csqID] = this.getCsqDataFromElem(event.currentTarget);
  //   this.csqData[rollPosition as Position][rollResult as RollResult.partial|RollResult.fail][csqID].resistOptions = {};
  //   this.render();
  // }
  // async toggleArmor(event: ClickEvent) {
  //   if (!this.csqData) { return; }
  //   const [rollPosition, rollResult, csqID] = this.getCsqDataFromElem(event.currentTarget);
  //   const cData = this.csqData[rollPosition as Position][rollResult as RollResult.partial|RollResult.fail][csqID];
  //   cData.canArmor = !cData.canArmor;
  //   this.render();
  // }
  // async toggleSpecialArmor(event: ClickEvent) {
  //   if (!this.csqData) { return; }
  //   const [rollPosition, rollResult, csqID] = this.getCsqDataFromElem(event.currentTarget);
  //   const cData = this.csqData[rollPosition as Position][rollResult as RollResult.partial|RollResult.fail][csqID];
  //   cData.canSpecialArmor = !cData.canSpecialArmor;
  //   this.render();
  // }
  activateListeners(t) {
    switch (super.activateListeners(t), oa(t), this.dialogType) {
      case "Input":
        this.activateInputListeners(t);
        break;
      case "Selection":
        this.activateSelectionListeners(t);
        break;
    }
  }
  activateInputListeners(t) {
    t.find("textarea").on({ change: (s) => this.updateInputText($(s.currentTarget)) });
  }
  activateSelectionListeners(t) {
    const s = this;
    t.find(".nav-tabs .tab-selector").on("click", (i) => {
      const a = w.pInt($(i.currentTarget).data("tab")), o = Object.values(s.tabs ?? [])[a].length, n = w.pInt(150 * Math.ceil(Math.sqrt(o)));
      eLog.checkLog3("nav", "Nav Tab Size Recalculation", { tabIndex: a, numItems: o, width: n }), this.render(!1, { width: n });
    }), t.find("[data-item-id]").on("click", function() {
      if ($(this).parent().hasClass("locked"))
        return;
      const i = $(this).data("itemId"), a = $(this).data("docType");
      eLog.checkLog("dialog", "[BladesDialog] on Click", { elem: this, docId: i, docType: a, parent: s.parent }), s.parent instanceof oe && (a === "Actor" ? s.parent.addSubActor(i, s.tags) : a === "Item" && s.parent.addSubItem(i)), s.close();
    });
  }
  async close() {
    $("#eunos-blades-tooltips > *").remove(), super.close();
  }
  // activateConsequenceListeners(html: JQuery<HTMLElement>) {
  // html.find("input").on({change: () => this.updateConsequenceDialog(html)});
  // html.find("select").on({change: () => this.updateConsequenceDialog(html)});
  // html.find('[data-action^="ai-query"]').on({
  //   click: (event) => this.queryAI(event),
  //   contextmenu: (event) => this.clearResistOptions(event)
  // });
  // html.find('[data-action^="blank-option"]').on({
  //   click: (event) => this.spawnBlankResistOption(event),
  //   contextmenu: (event) => this.clearResistOptions(event)
  // });
  // html.find('[data-action^="gm-select-toggle"]').on({click: (event) => this.selectResistOption(event) });
  // html.find('[data-action^="toggle-armor"]').on({click: (event) => this.toggleArmor(event) });
  // html.find('[data-action^="toggle-special"]').on({click: (event) => this.toggleSpecialArmor(event) });
  // }
}
function a0(r) {
  return !!(r && typeof r == "string" && w.lCase(r) in js);
}
function o0(r) {
  return !!(r && typeof r == "string" && w.lCase(r) in Tt);
}
function n0(r) {
  return !!(r && typeof r == "string" && w.lCase(r) in H);
}
function l3(r) {
  return typeof r == "string" && r in se;
}
function c3(r) {
  return [
    ae.roll,
    ae.position,
    ae.effect
  ].includes(r);
}
function u3(r) {
  return !!(r.startsWith("Group_") || ["Assist", "Setup"].includes(r));
}
class ki extends ws {
  constructor(t, s) {
    super(t);
    J(this, "isRerendering", !1);
    J(this, "_rollInstance");
    this._rollInstance = s;
  }
  static ApplySchemaDefaults(t) {
    if (!t.name)
      throw new Error("name is required for BladesRollMod.Schema");
    return {
      key: `${t.name}-positive-roll`,
      modType: Re.general,
      section: ae.roll,
      posNeg: "positive",
      base_status: se.Hidden,
      value: 1,
      tooltip: "",
      ...t
    };
  }
  static get GMOnlyModStatuses() {
    return [se.ForcedOn, se.ForcedOff, se.Hidden];
  }
  static getSchemaFromStrings(t) {
    const s = w.pullElement(t, (u) => typeof u == "string" && /^na/i.test(u)), i = typeof s == "string" && s.replace(/^.*:/, "");
    if (!i)
      throw new Error(`RollMod Missing Name: '${t.join("@")}'`);
    const a = w.pullElement(t, (u) => typeof u == "string" && /^cat/i.test(u)), o = typeof a == "string" && a.replace(/^.*:/, "");
    if (!o || !(o in ae))
      throw new Error(`RollMod Missing Category: '${t.join("@")}'`);
    const l = (w.pullElement(t, (u) => typeof u == "string" && /^p/i.test(u)) || "posNeg:positive").replace(/^.*:/, "");
    return {
      key: `${i}-${l}-${o}`,
      name: i,
      section: o,
      posNeg: l,
      base_status: se.ToggledOff,
      modType: Re.general,
      tooltip: "",
      value: 1,
      ...Object.fromEntries(
        t.map(c)
      )
    };
    function c(u) {
      const [g, p] = u.split(/:/);
      let h = /\|/.test(p) ? p.split(/\|/) : p, m;
      if (/^stat/i.test(g))
        m = "base_status";
      else if (/^val/i.test(g))
        m = "value";
      else if (/^eff|^ekey/i.test(g))
        m = "effectKeys";
      else if (/^side|^ss/i.test(g))
        m = "sideString";
      else if (/^s.*ame/i.test(g))
        m = "source_name";
      else if (/^tool|^tip/i.test(g))
        m = "tooltip";
      else if (/^ty/i.test(g))
        m = "modType";
      else if (/^c.{0,10}r?.{0,3}ty/i.test(g))
        m = "conditionalRollTypes";
      else if (/^a.{0,3}r?.{0,3}y/i.test(g))
        m = "autoRollTypes";
      else if (/^p.{0,10}r?.{0,3}y/i.test(g))
        m = "participantRollTypes";
      else if (/^c.{0,10}r?.{0,3}tr/i.test(g))
        m = "conditionalRollTraits";
      else if (/^a.{0,3}r?.{0,3}tr/i.test(g))
        m = "autoRollTraits";
      else if (/^p.{0,10}r?.{0,3}tr/i.test(g))
        m = "participantRollTypes";
      else
        throw new Error(`Bad Roll Mod Key: ${g}`);
      m === "base_status" && h === "Conditional" && (h = se.Hidden);
      let y;
      return ["value"].includes(m) ? y = w.pInt(h) : ["effectKeys", "conditionalRollTypes", "autoRollTypes", "conditionalRollTraits", "autoRollTraits"].includes(m) ? y = [h].flat() : y = h.replace(/%COLON%/g, ":"), [m, y];
    }
  }
  static ParseDocModsToSchemaSet(t) {
    if (t instanceof wr)
      throw new Error("BladesRollMod.ParseDocRollMods cannot be called on a BladesChat document.");
    const { roll_mods: s } = t.system;
    return !s || s.length === 0 ? [] : s.filter((i) => !!(i && typeof i == "string")).map((i) => this.getSchemaFromStrings(i.split(/@/)));
  }
  get status() {
    return this.userStatus && ki.GMOnlyModStatuses.includes(this.userStatus) ? this.userStatus : this.heldStatus && [se.ToggledOff, se.ToggledOn].includes(this.heldStatus) ? this.userStatus ?? this.heldStatus : this.heldStatus ?? this.userStatus ?? this.baseStatus;
  }
  get isActive() {
    return [se.ToggledOn, se.ForcedOn].includes(this.status);
  }
  get isVisible() {
    return this.status !== se.Hidden;
  }
  // get flagParams() {
  //   return [C.SYSTEM_ID, `rollCollab.rollModsData.${this.id}`] as const;}
  // async setUserStatusFlag(val: RollModStatus | undefined) {
  // }
  get isConditional() {
    return [
      ...this.conditionalRollTraits,
      ...this.autoRollTraits,
      ...this.participantRollTraits,
      ...this.conditionalRollTypes,
      ...this.autoRollTypes,
      ...this.participantRollTypes
    ].length > 0;
  }
  get isInInactiveBlock() {
    return game.user.isGM ? [se.Hidden, se.ForcedOff, se.ToggledOff].includes(this.status) && (this.isConditional || this.modType === Re.ability) : [se.ForcedOff, se.ToggledOff].includes(this.status) && (this.isConditional || this.modType === Re.ability);
  }
  get isPush() {
    return !!(w.lCase(this.name) === "push" || this.effectKeys.find((t) => t === "Is-Push"));
  }
  get isBasicPush() {
    return w.lCase(this.name) === "push";
  }
  get stressCost() {
    const t = this.effectKeys.filter((i) => i.startsWith("Cost-Stress"));
    if (t.length === 0)
      return 0;
    let s = 0;
    return t.forEach((i) => {
      const [a] = (i.split(/-/) ?? []).slice(1), [o, n] = (/([A-Za-z]+)(\d*)/.exec(a) ?? []).slice(1);
      s += w.pInt(n);
    }), s;
  }
  isValidForRollType() {
    switch (this.rollInstance.rollType) {
      case Oe.Action:
        return !0;
      case Oe.Resistance:
      case Oe.Fortune:
      case Oe.IndulgeVice:
        return !(this.isPush || ["bargain", "setup", "assist", "potency"].includes(w.lCase(this.name)));
      default:
        return !1;
    }
  }
  /**
   * Checks if any types or traits apply to the roll instance.
   * @param {AnyRollType[]} types The types to check.
   * @param {RollTrait[]} traits The traits to check.
   * @returns {boolean} - Returns true if any types or traits apply, false otherwise.
   */
  checkTypesOrTraits(t, s) {
    const i = [this.rollInstance.rollType, this.rollInstance.rollSubType, this.rollInstance.rollDowntimeAction].filter((n) => !!n), a = !this.rollInstance.isParticipantRoll && t.length === 0 || i.some((n) => t.includes(n)), o = !this.rollInstance.isParticipantRoll && s.length === 0 || this.rollInstance.rollTrait && s.includes(this.rollInstance.rollTrait);
    return !!(a && o);
  }
  /**
   * Sets the conditional status of the roll mod instance.
   * @returns {boolean} - Returns false if the status is ForcedOn or ToggledOff, true if the status is Hidden.
   */
  setConditionalStatus() {
    return this.isConditional ? this.autoRollTypes.includes(this.rollInstance.rollType) || this.rollInstance.rollSubType && this.autoRollTypes.includes(this.rollInstance.rollSubType) || this.rollInstance.rollDowntimeAction && this.autoRollTypes.includes(this.rollInstance.rollDowntimeAction) ? (this.heldStatus = se.ForcedOn, !1) : this.rollInstance.rollTrait && this.autoRollTraits.includes(this.rollInstance.rollTrait) ? (this.heldStatus = se.ForcedOn, !1) : this.checkTypesOrTraits(this.conditionalRollTypes, this.conditionalRollTraits) ? (this.heldStatus = se.ToggledOff, !1) : this.rollInstance.isParticipantRoll && this.checkTypesOrTraits(this.participantRollTypes, this.participantRollTraits) ? (this.heldStatus = se.ToggledOff, !1) : (this.heldStatus = se.Hidden, !0) : !1;
  }
  /**
   * Sets the auto-reveal/enable status of the roll mod instance.
   * @returns {boolean} - Returns false if the status is ForcedOn or ToggledOff, true if the status is Hidden.
   */
  setAutoStatus() {
    const t = this.effectKeys.filter((s) => s.startsWith("Auto"));
    if (t.length === 0)
      return !1;
    for (const s of t) {
      const [i, a] = s.split(/-/) ?? [];
      if (w.lCase(a) in Ct && this.rollInstance.rollPositionFinal === w.lCase(a)) {
        if (i === "AutoRevealOn")
          return this.heldStatus = se.ToggledOff, !1;
        if (i === "AutoEnableOn")
          return this.heldStatus = se.ForcedOn, !1;
      }
    }
    return this.heldStatus = se.Hidden, !0;
  }
  /**
   * Sets the relevancy status of the roll mod instance (i.e. hides irrelevant rollMods).
   * @returns {boolean} - Returns true if mod is irrelevant and status is Hidden, false otherwise.
   */
  setRelevancyStatus() {
    const t = this.effectKeys.filter((i) => /^Negate|^Increase/.test(i));
    return t.length === 0 ? !1 : t.filter((i) => {
      const [a, o] = i.split(/-/) ?? [];
      if (a === "Negate") {
        const n = {
          PushCost: () => this.rollInstance.isPushed(),
          QualityPenalty: () => {
            var l, c;
            return this.rollInstance.isTraitRelevant(H.quality) && (((l = this.rollInstance.rollFactors.source[H.quality]) == null ? void 0 : l.value) ?? 0) < (((c = this.rollInstance.rollFactors.opposition[H.quality]) == null ? void 0 : c.value) ?? 0);
          },
          ScalePenalty: () => {
            var l, c;
            return this.rollInstance.isTraitRelevant(H.scale) && (((l = this.rollInstance.rollFactors.source[H.scale]) == null ? void 0 : l.value) ?? 0) < (((c = this.rollInstance.rollFactors.opposition[H.scale]) == null ? void 0 : c.value) ?? 0);
          },
          TierPenalty: () => {
            var l, c;
            return this.rollInstance.isTraitRelevant(H.tier) && (((l = this.rollInstance.rollFactors.source[H.tier]) == null ? void 0 : l.value) ?? 0) < (((c = this.rollInstance.rollFactors.opposition[H.tier]) == null ? void 0 : c.value) ?? 0);
          }
        };
        if (Object.hasOwn(n, o))
          return n[o]();
        throw new Error(`Unrecognized Negate parameter: ${o}`);
      } else if (a === "Increase") {
        const [n, l] = /(\w+)\d+/.exec(o) ?? [];
        return this.rollInstance.isTraitRelevant(l);
      } else
        throw new Error(`Unrecognized Function Key: ${a}`);
    }).length === 0 ? (this.heldStatus = se.Hidden, !0) : !1;
  }
  /**
   * Sets the payable status of the roll mod instance (i.e. forces off rollMods the primary can't pay for).
   * @returns {boolean} - Returns true if mod is unpayable and status is ForcedOff, false otherwise.
   */
  setPayableStatus() {
    const t = this.effectKeys.filter((i) => i.startsWith("Cost"));
    return t.length === 0 ? !1 : t.filter((i) => {
      const [a] = (i.split(/-/) ?? []).slice(1), [o, n] = (/([A-Za-z]+)(\d*)/.exec(a) ?? []).slice(1), { rollPrimaryDoc: l } = this.rollInstance.rollPrimary ?? {};
      if (!Me.IsDoc(l))
        return !1;
      switch (o) {
        case "SpecialArmor":
          return oe.IsType(l, z.pc) && l.system.armor.active.special && !l.system.armor.checked.special;
        case "Stress": {
          const c = w.pInt(n);
          return oe.IsType(l, z.pc) && l.system.stress.max - l.system.stress.value >= c;
        }
        case "Heat":
          return Te.IsType(l) && Kt.IsType(l.crew) || Kt.IsType(
            l
          );
        default:
          throw new Error(`Unrecognize Payable Key: ${o}`);
      }
    }).length === 0 ? (this.heldStatus = se.ForcedOff, !0) : !1;
  }
  applyRollModEffectKeys() {
    if (!this.isActive)
      return;
    const t = this.effectKeys.filter((s) => /^Negate|^Increase/.test(s)).map((s) => s.split(/-/));
    t.length !== 0 && t.forEach(([s, i]) => {
      if (s === "Negate") {
        const a = {
          PushCost: () => {
            this.rollInstance.negatePushCost();
          },
          QualityPenalty: () => {
            this.rollInstance.negateFactorPenalty(H.quality);
          },
          ScalePenalty: () => {
            this.rollInstance.negateFactorPenalty(H.scale);
          },
          TierPenalty: () => {
            this.rollInstance.negateFactorPenalty(H.tier);
          }
        };
        if (Object.hasOwn(a, i))
          return a[i]();
        throw new Error(`Unrecognized Negate parameter: ${i}`);
      } else if (s === "Increase") {
        const [a, o] = /(\w+)\d+/.exec(i) ?? [];
        return this.rollInstance.isTraitRelevant(o);
      } else
        throw new Error(`Unrecognized Function Key: ${s} (key: ${s})`);
    });
  }
  get selectOptions() {
    return this.modType !== Re.teamwork ? null : this.name === "Assist" || this.name === "Setup" ? this.rollInstance.rollParticipantSelectOptions[this.name] : this.name.startsWith("Group_") ? this.rollInstance.rollParticipantSelectOptions.Group : null;
  }
  get selectedParticipant() {
    return this.modType !== Re.teamwork ? null : this.rollInstance.getRollParticipant(this.section, this.name);
  }
  get allFlagData() {
    return this.rollInstance.data;
  }
  get costs() {
    if (!this.isActive)
      return;
    const t = this.effectKeys.filter((s) => s.startsWith("Cost"));
    if (t.length !== 0)
      return t.map((s) => {
        const [i] = (s.split(/-/) ?? []).slice(1), [a, o] = (/([A-Za-z]+)(\d*)/.exec(i) ?? []).slice(1);
        let n = this.name;
        if (this.isBasicPush)
          if (this.posNeg === "negative")
            n = `${this.name} (<span class='red-bright'>To Act</span>)`;
          else {
            const l = this.section === ae.roll ? "+1d" : "+1 effect";
            n = `${this.name} (<span class='gold-bright'>${l}</span>)`;
          }
        return {
          id: this.id,
          label: n,
          costType: a,
          costAmount: o ? w.pInt(o) : 1
        };
      });
  }
  get rollInstance() {
    return this._rollInstance;
  }
  get name() {
    return this.data.name;
  }
  get modType() {
    return this.data.modType;
  }
  get sourceName() {
    return this.data.source_name ?? this.data.name;
  }
  get section() {
    return this.data.section;
  }
  get posNeg() {
    return this.data.posNeg;
  }
  get userStatus() {
    return this.data.user_status;
  }
  set userStatus(t) {
    if (t === this.userStatus)
      return;
    const { isRerendering: s } = this;
    if (!t || t === this.baseStatus)
      this.updateTarget("user_status", null).then(() => {
        s && this.rollInstance.renderRollCollab_SocketCall();
      });
    else {
      if (!game.user.isGM && (ki.GMOnlyModStatuses.includes(t) || this.userStatus && ki.GMOnlyModStatuses.includes(this.userStatus)))
        return;
      this.updateTarget("user_status", t).then(() => {
        s && this.rollInstance.renderRollCollab_SocketCall();
      });
    }
  }
  get elem$() {
    return this.rollInstance.elem$.find(`#${this.id}`);
  }
  get statusChangeTimeline() {
    let t = this.elem$.data("statusChangeTimeline");
    return t instanceof gsap.core.Timeline || (t = w.gsap.effects.rollModStatusChange(this.elem$, { startAt: this.status }), this.elem$.data("statusChangeTimeline", t)), t;
  }
  async rollModStatusChange_Animation() {
    return await this.statusChangeTimeline.tweenTo(this.status).then(() => {
      this.rollInstance.renderRollCollab();
    });
  }
  async rollModStatusChange_SocketCall() {
    this.rollInstance.isRendered && socketlib.system.executeForEveryone("rollModStatusChange_SocketCall", this.id);
  }
  static rollModStatusChange_SocketResponse(t, s) {
    var a;
    const i = game.eunoblades.Rolls.get(t);
    i != null && i.isRendered && ((a = i.getRollModByID(s)) == null || a.rollModStatusChange_Animation());
  }
  get baseStatus() {
    return this.data.base_status;
  }
  get heldStatus() {
    return this.data.held_status;
  }
  set heldStatus(t) {
    t !== this.heldStatus && this.updateTarget("held_status", t || null).then(this.rollModStatusChange_SocketCall.bind(this));
  }
  get value() {
    return this.data.value;
  }
  get effectKeys() {
    return this.data.effectKeys ?? [];
  }
  get sideString() {
    if (this.data.sideString)
      return this.data.sideString;
    if (this.selectedParticipant)
      return this.selectedParticipant.rollParticipantName;
  }
  get tooltip() {
    let t = this.data.tooltip.replace(/%COLON%/g, ":");
    return t.includes("%DOC_NAME%") && (t = t.replace(
      /%DOC_NAME%/g,
      this.selectedParticipant ? this.selectedParticipant.rollParticipantName : "an Ally"
    )), t.includes("@OPPOSITION_NAME@") && (t = t.replace(
      /@OPPOSITION_NAME@/g,
      this.rollInstance.rollOpposition ? this.rollInstance.rollOpposition.rollOppName : "Your Opposition"
    )), t;
  }
  get conditionalRollTypes() {
    return this.data.conditionalRollTypes ?? [];
  }
  get autoRollTypes() {
    return this.data.autoRollTypes ?? [];
  }
  get participantRollTypes() {
    return this.data.participantRollTypes ?? [];
  }
  get conditionalRollTraits() {
    return this.data.conditionalRollTraits ?? [];
  }
  get autoRollTraits() {
    return this.data.autoRollTraits ?? [];
  }
  get participantRollTraits() {
    return this.data.participantRollTraits ?? [];
  }
}
class Me {
  constructor(...e) {
    // #endregion
    J(this, "rollInstance");
    J(this, "rollPrimaryID");
    J(this, "_rollPrimaryDoc");
    J(this, "rollPrimaryName");
    J(this, "rollPrimaryType");
    J(this, "rollPrimaryImg");
    J(this, "rollPrimaryModsSchemaSet");
    J(this, "rollFactors");
    let t = !1, s = !1;
    if (e[0] instanceof zi && (this.rollInstance = e[0], e.shift()), Me.IsDoc(e[0]) ? s = e[0] : Me.IsValidData(e[0]) ? t = e[0] : w.isList(e[0]) && ("rollPrimaryID" in e[0] ? s = Me.GetDoc(e[0].rollPrimaryID) : "rollPrimaryName" in e[0] && (s = Me.GetDoc(e[0].rollPrimaryName))), s && !Me.IsValidData(t) && (t = {
      rollPrimaryID: s.rollPrimaryID,
      rollPrimaryName: s.rollPrimaryName,
      rollPrimaryType: s.rollPrimaryType,
      rollPrimaryImg: s.rollPrimaryImg,
      rollPrimaryModsSchemaSet: s.rollPrimaryModsSchemaSet,
      rollFactors: s.rollFactors
    }), !Me.IsValidData(t) && !Me.IsDoc(s) && this.rollInstance && (t = this.rollInstance.rollPrimary.data), !Me.IsValidData(t))
      throw new Error(`[BladesRoll.constructor] Failed to resolve primary data from provided arguments: ${JSON.stringify(e)}`);
    const {
      rollPrimaryID: i,
      rollPrimaryName: a,
      rollPrimaryType: o,
      rollPrimaryImg: n,
      rollPrimaryModsSchemaSet: l,
      rollFactors: c
    } = t;
    if (this.rollPrimaryID = i, !a)
      throw new Error("Must include a rollPrimaryName when constructing a BladesRollPrimary object.");
    if (!n)
      throw new Error("Must include a rollPrimaryImg when constructing a BladesRollPrimary object.");
    if (!o)
      throw new Error("Must include a rollPrimaryType when constructing a BladesRollPrimary object.");
    if (!c)
      throw new Error("Must include a rollFactors when constructing a BladesRollPrimary object.");
    this.rollPrimaryName = a, this.rollPrimaryType = o, this.rollPrimaryImg = n, this.rollFactors = c, this.rollPrimaryModsSchemaSet = l ?? [];
  }
  // #region Static Methods ~
  static IsValidData(e) {
    return Me.IsDoc(e) ? !1 : w.isList(e) && typeof e.rollPrimaryName == "string" && typeof e.rollPrimaryType == "string" && typeof e.rollPrimaryImg == "string" && Array.isArray(e.rollPrimaryModsSchemaSet) && w.isList(e.rollFactors) && (!e.rollPrimaryID || typeof e.rollPrimaryID == "string") && (!e.rollPrimaryDoc || Me.IsDoc(e.rollPrimaryDoc));
  }
  static GetDoc(e) {
    let t = e;
    return typeof e == "string" && (t = game.actors.get(e) ?? game.items.get(e) ?? game.actors.getName(e) ?? game.items.getName(e)), Me.IsDoc(t) && t;
  }
  static IsDoc(e) {
    return oe.IsType(e, z.pc, z.crew) || Z.IsType(e, A.cohort_expert, A.cohort_gang, A.gm_tracker);
  }
  static GetDataFromDoc(e) {
    return {
      rollPrimaryID: e.id,
      rollPrimaryName: e.name,
      rollPrimaryType: e.type,
      rollPrimaryImg: e.img,
      rollPrimaryModsSchemaSet: e.rollPrimaryModsSchemaSet,
      rollFactors: e.rollFactors
    };
  }
  static BuildData(e) {
    if (Me.IsDoc(e.rollPrimaryData))
      return Me.GetDataFromDoc(e.rollPrimaryData);
    if (Me.IsValidData(e.rollPrimaryData))
      return e.rollPrimaryData;
    let t;
    const s = game.users.get(e.rollUserID ?? game.user.id);
    if ("target" in e && Me.IsDoc(e.target))
      t = e.target;
    else if (s && Me.IsDoc(s.character))
      t = s.character;
    else
      throw new Error("[BladesRollPrimary.BuildData()] A valid source of PrimaryData must be provided to construct a roll.");
    return {
      rollPrimaryID: t.rollPrimaryID,
      rollPrimaryName: t.rollPrimaryName,
      rollPrimaryType: t.rollPrimaryType,
      rollPrimaryImg: t.rollPrimaryImg,
      rollPrimaryModsSchemaSet: t.rollPrimaryModsSchemaSet,
      rollFactors: t.rollFactors
    };
  }
  static Build(e) {
    return new Me(this.BuildData(e));
  }
  get rollPrimaryDoc() {
    if (!this._rollPrimaryDoc) {
      let e;
      this.rollPrimaryID && (e = game.items.get(this.rollPrimaryID) ?? game.actors.get(this.rollPrimaryID)), !e && this.rollPrimaryName && (e = game.items.getName(this.rollPrimaryName) ?? game.actors.getName(this.rollPrimaryName)), Me.IsDoc(e) && (this._rollPrimaryDoc = e);
    }
    return this._rollPrimaryDoc;
  }
  get data() {
    return {
      rollPrimaryID: this.rollPrimaryID,
      rollPrimaryName: this.rollPrimaryName,
      rollPrimaryType: this.rollPrimaryType,
      rollPrimaryImg: this.rollPrimaryImg,
      rollPrimaryModsSchemaSet: this.rollPrimaryModsSchemaSet,
      rollFactors: this.rollFactors
    };
  }
  get isWorsePosition() {
    return this.rollPrimaryDoc ? this.rollPrimaryDoc.getFlag("eunos-blades", "isWorsePosition") === !0 : !1;
  }
  async applyHarm(e, t) {
    if (this.rollPrimaryDoc)
      return this.rollPrimaryDoc.applyHarm(e, t);
  }
  async applyWorsePosition() {
    if (this.rollPrimaryDoc)
      return this.rollPrimaryDoc.applyWorsePosition();
  }
  get hasSpecialArmor() {
    return Te.IsType(this.rollPrimaryDoc) && this.rollPrimaryDoc.isSpecialArmorAvailable;
  }
  get availableArmorCount() {
    return Te.IsType(this.rollPrimaryDoc) ? this.rollPrimaryDoc.availableArmor.length : Z.IsType(this.rollPrimaryDoc, A.cohort_gang, A.cohort_expert) ? this.rollPrimaryDoc.system.armor.max - this.rollPrimaryDoc.system.armor.value : 0;
  }
  async spendArmor(e) {
    var t;
    if (!this.rollPrimaryDoc)
      throw new Error("[BladesRollPrimary.spendArmor()] Cannot spend armor when rollPrimaryDoc is not defined.");
    if (e > this.availableArmorCount)
      throw new Error(`[BladesRollPrimary.spendArmor()] Cannot spend more armor (${e}) than ${(t = this.rollPrimaryDoc) == null ? void 0 : t.name} has (${this.availableArmorCount}).`);
    if (Te.IsType(this.rollPrimaryDoc)) {
      const s = this.rollPrimaryDoc.availableArmor.slice(0, e), i = {};
      s.includes("Light Armor") && (i["system.armor.active.light"] = !0, i["system.armor.checked.light"] = !0), s.includes("Heavy Armor") && (i["system.armor.active.heavy"] = !0, i["system.armor.checked.heavy"] = !0), await this.rollPrimaryDoc.update(i);
    } else
      Z.IsType(this.rollPrimaryDoc, A.cohort_gang, A.cohort_expert) && await this.rollPrimaryDoc.update({ "system.armor.value": this.rollPrimaryDoc.system.armor.value + e });
  }
  // #endregion
}
class jt {
  // #region Constructor ~
  constructor(e, {
    rollOppID: t,
    rollOppName: s,
    rollOppSubName: i,
    rollOppType: a,
    rollOppImg: o,
    rollOppModsSchemaSet: n,
    rollFactors: l
  } = {}) {
    // #endregion
    J(this, "rollInstance");
    J(this, "rollOppID");
    J(this, "rollOppDoc");
    J(this, "rollOppName");
    J(this, "rollOppSubName");
    J(this, "rollOppType");
    J(this, "rollOppImg");
    J(this, "rollOppModsSchemaSet");
    J(this, "rollFactors");
    this.rollInstance = e;
    const c = jt.GetDoc(t ?? s);
    if (c && (this.rollOppDoc = c, t = c.rollOppID, s ?? (s = c.rollOppName), i ?? (i = c.rollOppSubName), a ?? (a = c.rollOppType), o ?? (o = c.rollOppImg), n = [
      ...n ?? [],
      ...c.rollOppModsSchemaSet ?? []
    ], l = {
      ...c.rollFactors,
      ...l ?? {}
    }), !s)
      throw new Error("Must include a rollOppName when constructing a BladesRollOpposition object.");
    if (!a)
      throw new Error("Must include a rollOppType when constructing a BladesRollOpposition object.");
    if (!l)
      throw new Error("Must include a rollFactors when constructing a BladesRollOpposition object.");
    this.rollOppID = t, this.rollOppName = s, this.rollOppSubName = i, this.rollOppType = a, this.rollOppImg = o ?? "", this.rollOppModsSchemaSet = n ?? [], this.rollFactors = l;
  }
  // #region Static Methods ~
  static IsValidData(e) {
    return jt.IsDoc(e) ? !0 : w.isList(e) && typeof e.rollOppName == "string" && typeof e.rollOppType == "string" && typeof e.rollOppImg == "string" && (!e.rollOppSubName || typeof e.rollOppSubName == "string") && (!e.rollOppModsSchemaSet || Array.isArray(e.rollOppModsSchemaSet)) && w.isList(e.rollFactors) && (!e.rollOppID || typeof e.rollOppID == "string");
  }
  static GetDoc(e) {
    let t = e;
    return typeof e == "string" && (t = game.actors.get(e) ?? game.items.get(e) ?? game.actors.getName(e) ?? game.items.getName(e)), jt.IsDoc(t) ? t : !1;
  }
  static IsDoc(e) {
    return oe.IsType(
      e,
      z.npc,
      z.faction
    ) || Z.IsType(
      e,
      A.cohort_expert,
      A.cohort_gang
    );
  }
  static GetDataFromDoc(e) {
    return {
      rollOppID: e.id,
      rollOppName: e.name,
      rollOppType: e.type,
      rollOppImg: e.img,
      rollOppModsSchemaSet: e.rollOppModsSchemaSet,
      rollFactors: e.rollFactors
    };
  }
  // #endregion
  get data() {
    return {
      rollOppID: this.rollOppID,
      rollOppName: this.rollOppName,
      rollOppSubName: this.rollOppSubName,
      rollOppType: this.rollOppType,
      rollOppImg: this.rollOppImg,
      rollOppModsSchemaSet: this.rollOppModsSchemaSet,
      rollFactors: this.rollFactors
    };
  }
  async updateRollFlags() {
    this.rollInstance && (await this.rollInstance.updateTarget("rollOppData", this.data), this.rollInstance.isRendered && socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.rollInstance.id));
  }
  refresh() {
    if (!this.rollInstance)
      return;
    const e = this.rollInstance.data.rollOppData;
    return e && (this.rollOppID = e.rollOppID, this.rollOppName = e.rollOppName, this.rollOppSubName = e.rollOppSubName, this.rollOppType = e.rollOppType, this.rollOppImg = e.rollOppImg, this.rollOppModsSchemaSet = e.rollOppModsSchemaSet ?? [], this.rollFactors = e.rollFactors), this;
  }
}
class Dt {
  constructor(e, t, s, i) {
    // #endregion
    J(this, "rollInstance");
    J(this, "rollParticipantID");
    J(this, "rollParticipantDoc");
    J(this, "rollParticipantName");
    J(this, "rollParticipantType");
    J(this, "rollParticipantIcon");
    J(this, "rollParticipantSection");
    J(this, "rollParticipantSubSection");
    J(this, "rollParticipantModsSchemaSet");
    // As applied to MAIN roll when this participant involved
    J(this, "rollFactors");
    if (this.rollInstance = e, !t)
      throw new Error("Must include a rollParticipantSection when constructing a BladesRollParticipant object.");
    if (!s)
      throw new Error("Must include a rollParticipantSubSection when constructing a BladesRollParticipant object.");
    this.rollParticipantSection = t, this.rollParticipantSubSection = s;
    const a = Dt.IsDoc(i) ? i : Dt.GetDoc(
      i.rollParticipantID ?? i.rollParticipantName
    );
    if (a && (i = a), !i.rollParticipantName)
      throw new Error("Must include a rollParticipantName when constructing a BladesRollParticipant object.");
    if (!i.rollParticipantType)
      throw new Error("Must include a rollParticipantType when constructing a BladesRollParticipant object.");
    if (!i.rollFactors)
      throw new Error("Must include a rollFactors when constructing a BladesRollParticipant object.");
    this.rollParticipantID = i.rollParticipantID, this.rollParticipantName = i.rollParticipantName, this.rollParticipantType = i.rollParticipantType, this.rollParticipantIcon = i.rollParticipantIcon ?? "", this.rollParticipantModsSchemaSet = i.rollParticipantModsSchemaSet ?? [], this.rollFactors = i.rollFactors;
  }
  // #region Static Methods ~
  static IsValidData(e) {
    return Dt.IsDoc(e) ? !0 : w.isList(e) && typeof e.rollParticipantName == "string" && typeof e.rollParticipantType == "string" && typeof e.rollParticipantIcon == "string" && (!e.rollParticipantModsSchemaSet || Array.isArray(e.rollParticipantModsSchemaSet)) && w.isList(e.rollFactors) && (!e.rollParticipantID || typeof e.rollParticipantID == "string") && (!e.rollParticipantDoc || Dt.IsDoc(e.rollParticipantDoc));
  }
  static GetDoc(e) {
    let t = e;
    return typeof e == "string" && (t = game.actors.get(e) ?? game.items.get(e) ?? game.actors.getName(e) ?? game.items.getName(e)), Dt.IsDoc(t) ? t : !1;
  }
  static IsDoc(e) {
    return oe.IsType(e, z.pc, z.crew, z.npc) || Z.IsType(e, A.cohort_expert, A.cohort_gang, A.gm_tracker);
  }
  // #endregion
  get data() {
    return {
      rollParticipantID: this.rollParticipantID,
      rollParticipantName: this.rollParticipantName,
      rollParticipantType: this.rollParticipantType,
      rollParticipantIcon: this.rollParticipantIcon,
      rollParticipantModsSchemaSet: this.rollParticipantModsSchemaSet,
      rollFactors: this.rollFactors
    };
  }
  async updateRollFlags() {
    await this.rollInstance.updateTarget(`rollParticipantData.${this.rollParticipantSection}.${this.rollParticipantSubSection}`, this.data), this.rollInstance.isRendered && socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.rollInstance.id);
  }
  refresh() {
    var t;
    const e = (t = this.rollInstance.data.rollParticipantData) == null ? void 0 : t[this.rollParticipantSection];
    if (e && this.rollParticipantSubSection in e) {
      const s = e[this.rollParticipantSubSection];
      s && (this.rollParticipantID = s.rollParticipantID, this.rollParticipantName = s.rollParticipantName, this.rollParticipantType = s.rollParticipantType, this.rollParticipantIcon = s.rollParticipantIcon, this.rollParticipantModsSchemaSet = s.rollParticipantModsSchemaSet ?? [], this.rollFactors = s.rollFactors);
    }
    return this;
  }
}
const _t = class _t extends ws {
  constructor(t) {
    super(t);
    // #endregion
    // #region *** CONSTRUCTOR *** ~
    J(this, "rollPermission");
    J(this, "_rollPrimary");
    J(this, "_rollOpposition");
    J(this, "_rollParticipants");
    J(this, "projectSelectOptions");
    J(this, "_rollTraitValOverride");
    J(this, "_roll");
    J(this, "rollFactorPenaltiesNegated", {});
    J(this, "tempGMBoosts", {});
    J(this, "getModsDelta", (t) => w.sum([
      ...this.getActiveRollMods(t, "positive").map((s) => s.value),
      ...this.getActiveRollMods(t, "negative").map((s) => -s.value)
    ]));
    J(this, "_rollMods");
    // #endregion
    // #region *** EVALUATING ROLL *** ~
    // #region DICE ~
    J(this, "_dieVals");
    // #endregion
    // #region *** ROLL COLLAB HTML ELEMENT ***
    J(this, "_elem$");
    J(this, "_overlayPosition", { x: 200, y: 200 });
    // Async _gmControlSelect(event: SelectChangeEvent) {
    //   event.preventDefault();
    //   const elem$ = $(event.currentTarget);
    //   const section = elem$.data("rollSection");
    //   const subSection = elem$.data("rollSubSection");
    //   const selectedOption = elem$.val();
    //   if (typeof selectedOption !== "string") { return; }
    //   if (selectedOption === "false") {
    //     await this.document.unsetFlag(C.SYSTEM_ID, `rollCollab.rollParticipantData.${section}.${subSection}`);
    //   }
    //   await this.addRollParticipant(selectedOption, section, subSection);
    // }
    // #endregion
    // #region ACTIVATE LISTENERS ~
    J(this, "_positionDragger");
    if (this.rollPermission = this.data.userPermissions[game.user.id], this._rollPrimary = new Me(this, this.data.rollPrimaryData), this.data.rollOppData ? this._rollOpposition = new jt(this, this.data.rollOppData) : this.data.rollDowntimeAction === ke.LongTermProject && (this.projectSelectOptions = Array.from(game.items).filter((s) => Z.IsType(s, A.project)).map((s) => ({ value: s.id ?? "", display: s.name }))), this.data.rollParticipantData) {
      this._rollParticipants = {};
      for (const [s, i] of Object.entries(this.data.rollParticipantData))
        if ([ae.roll, ae.position, ae.effect].includes(s) && !w.isEmpty(i)) {
          const a = {};
          for (const [o, n] of Object.entries(i))
            a[o] = new Dt(
              this,
              s,
              o,
              n
            );
          this._rollParticipants[s] = a;
        }
    }
    game.eunoblades.Rolls.set(this.id, this);
  }
  // #region STATIC METHODS: INITIALIZATION & DEFAULTS ~
  static Initialize() {
    return loadTemplates([
      "systems/eunos-blades/templates/roll/partials/roll-collab-gm-number-line.hbs",
      "systems/eunos-blades/templates/roll/partials/roll-collab-gm-select-doc.hbs",
      "systems/eunos-blades/templates/roll/partials/roll-collab-gm-factor-control.hbs",
      "systems/eunos-blades/templates/roll/roll-collab-action.hbs",
      "systems/eunos-blades/templates/roll/roll-collab-action-gm.hbs",
      "systems/eunos-blades/templates/roll/roll-collab-resistance.hbs",
      "systems/eunos-blades/templates/roll/roll-collab-resistance-gm.hbs",
      "systems/eunos-blades/templates/roll/roll-collab-fortune.hbs",
      "systems/eunos-blades/templates/roll/roll-collab-fortune-gm.hbs",
      "systems/eunos-blades/templates/roll/roll-collab-indulgevice.hbs",
      "systems/eunos-blades/templates/roll/roll-collab-indulgevice-gm.hbs"
    ]);
  }
  static InitSockets() {
    socketlib.system.register("constructRollCollab_SocketCall", _t.constructRollCollab_SocketResponse.bind(_t)), socketlib.system.register("renderRollCollab_SocketCall", _t.renderRollCollab_SocketResponse.bind(_t)), socketlib.system.register("closeRollCollab_SocketCall", _t.closeRollCollab_SocketResponse.bind(_t));
  }
  static ParseConfigToData(t, s) {
    if (!game.eunoblades.Rolls.get(s.id))
      throw new Error(`[BladesRoll.ParseConfigToData] No BladesRoll instance found with id ${s.id}.`);
    return t.rollPrimaryData instanceof Me && (t.rollPrimaryData = t.rollPrimaryData.data), t.rollOppData instanceof jt && (t.rollOppData = t.rollOppData.data), t.rollParticipantData && (t.rollParticipantData[ae.roll] && Object.keys(t.rollParticipantData[ae.roll]).forEach((a) => {
      var n, l;
      const o = (l = (n = t.rollParticipantData) == null ? void 0 : n[ae.roll]) == null ? void 0 : l[a];
      o instanceof Dt && (t.rollParticipantData[ae.roll][a] = o.data);
    }), t.rollParticipantData[ae.position] && Object.keys(t.rollParticipantData[ae.position]).forEach((a) => {
      var n, l;
      const o = (l = (n = t.rollParticipantData) == null ? void 0 : n[ae.position]) == null ? void 0 : l[a];
      o instanceof Dt && (t.rollParticipantData[ae.position][a] = o.data);
    }), t.rollParticipantData[ae.effect] && Object.keys(t.rollParticipantData[ae.effect]).forEach((a) => {
      var n, l;
      const o = (l = (n = t.rollParticipantData) == null ? void 0 : n[ae.effect]) == null ? void 0 : l[a];
      o instanceof Dt && (t.rollParticipantData[ae.effect][a] = o.data);
    })), super.ParseConfigToData(t);
  }
  static ApplySchemaDefaults(t) {
    if (!t.rollType)
      throw new Error("Must include a rollType when constructing a BladesRoll object.");
    return t.rollPhase ?? (t.rollPhase = Ys.Collaboration), t.GMBoosts = {
      [H.tier]: 0,
      [H.quality]: 0,
      [H.scale]: 0,
      [H.magnitude]: 0,
      ...t.GMBoosts ?? {}
    }, t.GMOppBoosts = {
      [H.tier]: 0,
      [H.quality]: 0,
      [H.scale]: 0,
      [H.magnitude]: 0,
      ...t.GMOppBoosts ?? {}
    }, t.GMOverrides ?? (t.GMOverrides = {}), t.userPermissions ?? (t.userPermissions = {}), t.rollPrimaryData instanceof Me && (t.rollPrimaryData = t.rollPrimaryData.data), t.rollOppData instanceof jt && (t.rollOppData = t.rollOppData.data), t;
  }
  // static override get defaultOptions() {
  //   return foundry.utils.mergeObject(super.defaultOptions, {
  //     classes: ["eunos-blades", "sheet", "roll-collab", game.user.isGM ? "gm-roll-collab" : ""],
  //     template: `systems/eunos-blades/templates/roll/roll-collab${game.user.isGM ? "-gm" : ""}.hbs`,
  //     submitOnChange: true,
  //     width: 500,
  //     dragDrop: [
  //       {dragSelector: null, dropSelector: "[data-action='gm-drop-opposition'"}
  //     ]
  //     // Height: 500
  //   });
  // }
  static get DefaultRollModSchemaSet() {
    return [];
  }
  static GetDieClass(t, s, i, a) {
    switch (t) {
      case Oe.Resistance:
        return i === 6 && a <= 1 && s === -1 ? "blades-die-critical" : a === 0 ? "blades-die-resistance" : "blades-die-fail";
      case Oe.IndulgeVice:
        return a === 0 ? "blades-die-indulge-vice" : "blades-die-fail";
    }
    return i === 6 && a <= 1 && s === Ue.critical && i++, [
      "",
      "blades-die-fail",
      "blades-die-fail",
      "blades-die-fail",
      "blades-die-partial",
      "blades-die-partial",
      "blades-die-success",
      "blades-die-critical"
    ][i];
  }
  static GetDieImage(t, s, i, a, o = !1, n = !1) {
    let l = "systems/eunos-blades/assets/dice/image/";
    return o ? l += "ghost-" : [Oe.Resistance, Oe.IndulgeVice].includes(t) && (l += "grad-"), l += i, !o && i === 6 && a <= 1 && n && (l += "-crit"), l += ".webp", l;
  }
  static get Active() {
    return w.getLast(game.eunoblades.Rolls.filter((t) => t.isActive));
  }
  // #endregion
  // #region STATIC METHODS: New Roll Creation ~
  // static Current: Record<string, BladesRoll> = {};
  // static _Active?: BladesRoll;
  // static get Active(): BladesRoll | undefined {
  //   if (BladesRoll._Active) {return BladesRoll._Active;}
  //   if (U.objSize(BladesRoll.Current) > 0) {return U.getLast(Object.values(BladesRoll.Current));}
  //   return undefined;
  // }
  // static set Active(val: BladesRoll | undefined) {
  //   BladesRoll._Active = val;
  // }
  static GetUserPermissions(t) {
    var u, g, p, h;
    if (!t.rollPrimaryData)
      throw new Error("[BladesRoll.GetUserPermissions()] Missing rollPrimaryData.");
    const s = (u = game.users.find((m) => m.isGM)) == null ? void 0 : u.id;
    if (!s)
      throw new Error("[BladesRoll.GetUserPermissions()] No GM found!");
    const i = game.users.filter((m) => Te.IsType(m.character) && !m.isGM && typeof m.id == "string").map((m) => m.id), a = {
      [pt.GM]: [s],
      [pt.Primary]: [],
      [pt.Participant]: [],
      [pt.Observer]: []
    }, { rollPrimaryDoc: o } = new Me(t.rollPrimaryData);
    Te.IsType(o) && w.pullElement(i, (g = o.primaryUser) == null ? void 0 : g.id) ? a[pt.Primary].push((p = o.primaryUser) == null ? void 0 : p.id) : Kt.IsType(o) ? a[pt.Primary].push(...i) : Z.IsType(o, A.cohort_gang, A.cohort_expert) ? t.rollUserID === s ? a[pt.Primary].push(...i) : Te.IsType(o.parent) && ((h = o.parent.primaryUser) != null && h.id) && a[pt.Primary].push(o.parent.primaryUser.id) : kl.IsType(o) && a[pt.Primary].push(s), t.rollParticipantData && a[pt.Participant].push(...c(t.rollParticipantData, i)), a[pt.Observer] = i.filter((m) => !a[pt.Participant].includes(m));
    const n = {};
    return Object.entries(a).forEach(([m, y]) => {
      for (const k of y)
        n[k] = m;
    }), n;
    function l(m) {
      return Object.values(flattenObject(m)).map((y) => {
        if (Dt.IsDoc(y))
          return y;
        if (Dt.IsValidData(y) && typeof y.rollParticipantID == "string") {
          const k = game.actors.get(y.rollParticipantID) ?? game.items.get(y.rollParticipantID);
          if (Dt.IsDoc(k))
            return k;
        }
        throw new Error(`[getParticipantDocs] Invalid participant data encountered. Data: ${JSON.stringify(y)}, Expected: "BladesRollParticipant or valid participant data", Function Context: "getParticipantDocs", Participant Data: ${JSON.stringify(m)}`);
      });
    }
    function c(m, y) {
      return l(m).map((k) => {
        var _;
        return Te.IsType(k) && typeof ((_ = k.primaryUser) == null ? void 0 : _.id) == "string" ? k.primaryUser.id : Kt.IsType(k) || Z.IsType(k, A.cohort_gang, A.cohort_expert) ? y : null;
      }).flat().filter((k) => k !== null && !a[pt.Primary].includes(k));
    }
  }
  static BuildLinkConfig(t) {
    const s = {};
    if ("targetKey" in t && t.targetKey ? s.targetKey = t.targetKey : "targetFlagKey" in t && t.targetFlagKey && (s.targetFlagKey = t.targetFlagKey), "target" in t)
      if (w.isDocUUID(t.target))
        s.targetID = t.target;
      else if (w.isDocID(t.target)) {
        const i = game.actors.get(t.target) ?? game.items.get(t.target) ?? game.messages.get(t.target) ?? game.users.get(t.target);
        if (i)
          s.targetID = i.uuid;
        else
          throw new Error(`[BladesRoll.BuildLinkConfig] No target found with id ${t.target}.`);
      } else
        s.targetID = t.target.uuid;
    else if ("targetID" in t)
      s.targetID = t.targetID;
    else
      throw new Error("[BladesRoll.BuildLinkConfig] You must provide a valid target or targetID in the config object.");
    if (!s.targetKey && !s.targetFlagKey && (s.targetFlagKey = "rollCollab"), ws.IsValidConfig(s))
      return ws.BuildLinkConfig(s);
    throw new Error("[BladesRoll.BuildLinkConfig] Invalid link config.");
  }
  /**
   * Asynchronously creates a new instance of `BladesRoll` or its subclasses.
   *
   * This generic static method is designed to facilitate the creation of roll instances with
   * configurations specific to the type of roll being created. It ensures that the correct type
   * of roll instance is returned based on the class it's called on, allowing for a flexible and
   * type-safe creation process that can be extended to subclasses of `BladesRoll`.
   *
   * @template C The class on which `New` is called. This class must extend `BladesRoll` and
   * must be constructible with a configuration object that is either a `BladesRoll.Config` or
   * a combination of `BladesTargetLink.Data` and a partial `BladesRoll.Schema`. This ensures
   * that any subclass of `BladesRoll` can use this method to create instances of itself while
   * applying any class-specific configurations or behaviors.
   *
   * @param {BladesRoll.Config} config The configuration object for creating a new roll instance.
   * This configuration includes all necessary data to initialize the roll, such as user permissions,
   * roll type, and any modifications or additional data required for the roll's operation.
   *
   * @returns {Promise<InstanceType<C>>} A promise that resolves to an instance of the class
   * from which `New` was called. This allows for the dynamic creation of roll instances based
   * on the subclass calling the method, ensuring that the returned instance is of the correct type.
   *
   * @example
   * // Assuming `MyCustomRoll` is a subclass of `BladesRoll`
   * MyCustomRoll.New(myConfig).then(instance => {
   *   // `instance` is of type `MyCustomRoll`
   * });
   *
   * @remarks
   * - The method performs several key operations as part of the roll instance creation process:
   *   1. Builds link configuration based on the provided config.
   *   2. Prepares roll user flag data to determine permissions for different users.
   *   3. Validates that a roll type is defined in the config, throwing an error if not.
   *   4. Logs the roll data for debugging or auditing purposes.
   *   5. Constructs and initializes the roll instance, including setting up roll modifications
   *      and sending out socket calls to inform all users about the roll.
   * - This method is central to the dynamic and flexible creation of roll instances within the
   *   system, allowing for easy extension and customization in subclasses of `BladesRoll`.
   */
  static async New(t) {
    const s = this.BuildLinkConfig(t);
    if (t.userPermissions = this.GetUserPermissions(t), !t.rollType)
      throw new Error("rollType must be defined in config");
    eLog.checkLog3("bladesRoll", "BladesRoll.NewRoll()", { config: t });
    const i = await this.Create({ ...t, ...s });
    return i.isInitPromiseResolved ? eLog.checkLog3("bladesRoll", "BladesRoll Init Promise Resolved After Awaiting Create") : (eLog.checkLog3("bladesRoll", "BladesRoll Init Promise NOT Resolved After Awaiting Create"), await w.waitFor(i.initPromise)), i.constructRollCollab_SocketCall(i.linkData), i;
  }
  async initTargetLink() {
    this.initialSchema.rollModsData = this.rollModsDataSet, super.initTargetLink();
  }
  get rollModsSchemaSets() {
    var s;
    const t = [];
    return this.rollPrimary && t.push(
      ...this.rollPrimary.rollPrimaryModsSchemaSet.filter((i) => t.every((a) => a.key !== i.key))
    ), (s = this.rollOpposition) != null && s.rollOppModsSchemaSet && t.push(
      ...this.rollOpposition.rollOppModsSchemaSet.filter((i) => t.every((a) => a.key !== i.key))
    ), t.push(...this.constructor.DefaultRollModSchemaSet.filter((i) => t.every((a) => a.key !== i.key))), this.rollDowntimeAction && (t.push({
      key: "HelpFromFriend-positive-roll",
      name: "Help From a Friend",
      section: ae.position,
      base_status: se.ToggledOff,
      posNeg: "positive",
      modType: Re.general,
      value: 1,
      effectKeys: [],
      tooltip: "<h1>Help From a Friend</h1><p>Add <strong>+1d</strong> if you enlist the help of a friend or contact.</p>"
    }), this.rollDowntimeAction !== ke.IndulgeVice && t.push({
      key: "CanBuyResultLevel-positive-after",
      name: "Buying Result Level",
      section: ae.after,
      base_status: se.ForcedOn,
      posNeg: "positive",
      modType: Re.general,
      value: 0,
      effectKeys: [],
      tooltip: '<h1>Buying Result Level</h1><p>After your roll, you can <strong>increase the result level</strong> by one for each <strong class="gold-bright">Coin</strong> you spend.</p>'
    }), this.rollDowntimeAction === ke.AcquireAsset && t.push(
      {
        key: "RepeatPurchase-positive-roll",
        name: "Repeat Purchase",
        section: ae.roll,
        base_status: se.ToggledOff,
        posNeg: "positive",
        modType: Re.general,
        value: 1,
        effectKeys: [],
        tooltip: "<h1>Repeat Purchase Bonus</h1><p>Add <strong>+1d</strong> if you have previously acquired this asset or service with a <strong>Acquire Asset</strong> Downtime activity.</p>"
      },
      {
        key: "RestrictedItem-negative-after",
        name: "Restricted",
        section: ae.after,
        base_status: se.Hidden,
        posNeg: "negative",
        modType: Re.general,
        value: 0,
        effectKeys: ["Cost-Heat2"],
        tooltip: '<h1>Restricted</h1><p>Whether contraband goods or dangerous materials, this <strong>Acquire Asset</strong> Downtime activity will add <strong class="red-bright">+2 Heat</strong> to your crew.</p>'
      }
    )), t;
  }
  get rollModsDataSet() {
    const { linkData: t } = this, s = {
      targetID: t.targetID,
      isScopingById: !0,
      ..."targetKey" in t ? { targetKey: `${this.targetKeyPrefix}.rollModsData` } : {},
      ..."targetFlagKey" in t ? { targetFlagKey: `${this.targetFlagKeyPrefix}.rollModsData` } : {}
    };
    return Object.fromEntries(
      this.rollModsSchemaSets.map((i) => {
        const a = ws.ParseConfigToData(
          {
            ...ki.ApplySchemaDefaults(i),
            ...s
          }
        );
        return [a.id, a];
      })
    );
  }
  // #endregion
  // #region SOCKET CALLS & RESPONSES ~
  static GetRollSubClass(t) {
    const s = new ws(t);
    switch (s.data.rollType) {
      case Oe.Action:
        return Ur;
      case Oe.Fortune:
        return s.data.rollSubType === Na.Engagement ? Q1 : s.data.rollSubType === Na.Incarceration ? eg : To;
      case Oe.Resistance:
        return s.data.isInlineResistanceRoll ? J1 : Hu;
      case Oe.IndulgeVice:
        return Wu;
    }
  }
  constructRollCollab_SocketCall(t) {
    socketlib.system.executeForEveryone("constructRollCollab_SocketCall", t);
  }
  static constructRollCollab_SocketResponse(t) {
    const s = new (this.GetRollSubClass(t))(t);
    eLog.checkLog3("rollCollab", "constructRollCollab_SocketResponse()", { params: { linkData: t }, rollInst: s }), this.renderRollCollab_SocketResponse(s.id);
  }
  renderRollCollab_SocketCall() {
    socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
  }
  static renderRollCollab_SocketResponse(t) {
    const s = game.eunoblades.Rolls.get(t);
    if (!s)
      throw new Error(`[BladesRoll.renderRollCollab_SocketResponse] No roll found with id ${t}.`);
    s.renderRollCollab();
  }
  closeRollCollab_Animation() {
    return w.gsap.effects.blurRemove(this.elem$, { ignoreMargins: !0 });
  }
  async closeRollCollab_SocketCall() {
    game.user.isGM && (socketlib.system.executeForOthers("closeRollCollab_SocketCall", this.id), await w.waitFor(this.closeRollCollab_Animation()));
  }
  static closeRollCollab_SocketResponse(t) {
    var s;
    (s = game.eunoblades.Rolls.get(t)) == null || s.closeRollCollab_Animation();
  }
  // #endregion
  // #region Roll Participation & User Permissions
  async addRollParticipant(t, s, i) {
    i || (i = "Assist");
    const a = typeof t == "string" ? game.actors.get(t) ?? game.actors.getName(t) ?? game.items.get(t) ?? game.items.getName(t) : t;
    if (!Dt.IsValidData(a))
      throw new Error("Bad data.");
    await new Dt(this, s, i, a).updateRollFlags(), this.isRendered && socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
  }
  async removeRollParticipant(t, s) {
    await this.updateTarget(`rollParticipantData.${t}.${s}`, null);
  }
  async updateUserPermission(t, s) {
  }
  // #endregion
  // #region Basic User Flag Getters/Setters ~
  // get data(): BladesRoll.FlagData {
  //   if (!this.document.getFlag(C.SYSTEM_ID, "rollCollab")) {
  //     throw new Error("[get flags()] No RollCollab Flags Found on User Document");
  //   }
  //   return this.document.getFlag(C.SYSTEM_ID, "rollCollab") as BladesRoll.FlagData;
  // }
  get rollPrimary() {
    return this._rollPrimary;
  }
  get rollPrimaryDoc() {
    return this.rollPrimary.rollPrimaryDoc;
  }
  get rollOpposition() {
    var t;
    return !this._rollOpposition && jt.IsValidData(this.data.rollOppData) && (this._rollOpposition = new jt(this, this.data.rollOppData)), (t = this._rollOpposition) == null ? void 0 : t.refresh();
  }
  set rollOpposition(t) {
    t === void 0 ? this._rollOpposition = void 0 : (this._rollOpposition = t, t.updateRollFlags());
  }
  get rollClockKey() {
    return this.data.rollClockKey ? game.eunoblades.ClockKeys.get(this.data.rollClockKey) : void 0;
  }
  set rollClockKey(t) {
    this.updateTarget("rollClockKeyID", t ?? null);
  }
  /**
   * This method prepares the roll participant data.
   * It iterates over the roll sections (roll, position, effect) and for each section,
   * it creates a new BladesRollParticipant instance for each participant in that section.
   * The created instances are stored in the rollParticipants object.
   */
  prepareRollParticipantData() {
    const t = this.data.rollParticipantData;
    if (!t)
      return;
    const s = {};
    [
      ae.roll,
      ae.position,
      ae.effect
    ].forEach((i) => {
      const a = t[i];
      if (a) {
        const o = {};
        Object.entries(a).forEach(([n, l]) => {
          l && (o[n] = new Dt(this, i, n, l));
        }), s[i] = o;
      }
    }), this._rollParticipants = s;
  }
  get rollParticipants() {
    return this._rollParticipants;
  }
  getRollParticipant(t, s) {
    var i;
    if (c3(t) && u3(s)) {
      const a = (i = this.rollParticipants) == null ? void 0 : i[t];
      if (a)
        return a[s] ?? null;
    }
    return null;
  }
  get rollParticipantSelectOptions() {
    const t = Te.All.filter((s) => s.hasTag(he.PC.ActivePC) && s.id !== this.rollPrimary.rollPrimaryID).map((s) => ({ value: s.id, display: s.name }));
    return {
      Assist: t,
      Setup: t,
      Group: t
    };
  }
  get rollType() {
    return this.data.rollType;
  }
  get rollSubType() {
    return this.data.rollSubType;
  }
  set rollSubType(t) {
    this.updateTarget("rollSubType", t ?? null);
  }
  get rollPhase() {
    return this.data.rollPhase ?? Ys.Collaboration;
  }
  get rollDowntimeAction() {
    return this.data.rollDowntimeAction;
  }
  get rollTrait() {
    return this.data.rollTrait;
  }
  get rollTraitVerb() {
    if (this.rollTrait && this.rollTrait in X.ActionVerbs)
      return X.ActionVerbs[this.rollTrait];
  }
  get rollTraitPastVerb() {
    if (this.rollTrait && this.rollTrait in X.ActionPastVerbs)
      return X.ActionPastVerbs[this.rollTrait];
  }
  get rollTraitValOverride() {
    return this._rollTraitValOverride;
  }
  set rollTraitValOverride(t) {
    this._rollTraitValOverride = t;
  }
  get rollTraitData() {
    var t, s;
    if (oe.IsType(this.rollPrimaryDoc, z.pc)) {
      if (a0(this.rollTrait))
        return {
          name: this.rollTrait,
          value: this.rollTraitValOverride ?? this.rollPrimaryDoc.actions[this.rollTrait],
          max: this.rollTraitValOverride ?? this.rollPrimaryDoc.actions[this.rollTrait],
          pcTooltip: this.rollPrimaryDoc.rollTraitPCTooltipActions,
          gmTooltip: X.ActionTooltipsGM[this.rollTrait]
        };
      if (o0(this.rollTrait))
        return {
          name: this.rollTrait,
          value: this.rollTraitValOverride ?? this.rollPrimaryDoc.attributes[this.rollTrait],
          max: this.rollTraitValOverride ?? this.rollPrimaryDoc.attributes[this.rollTrait],
          pcTooltip: this.rollPrimaryDoc.rollTraitPCTooltipAttributes,
          gmTooltip: X.AttributeTooltips[this.rollTrait]
        };
    }
    if (w.isInt(this.rollTrait))
      return {
        name: `+${this.rollTraitValOverride ?? this.rollTrait}`,
        value: this.rollTraitValOverride ?? this.rollTrait,
        max: this.rollTraitValOverride ?? this.rollTrait
      };
    if (n0(this.rollTrait))
      return {
        name: w.tCase(this.rollTrait),
        value: this.rollTraitValOverride ?? ((t = this.rollPrimary.rollFactors[this.rollTrait]) == null ? void 0 : t.value) ?? 0,
        max: this.rollTraitValOverride ?? ((s = this.rollPrimary.rollFactors[this.rollTrait]) == null ? void 0 : s.max) ?? 10
      };
    throw new Error(`[get rollTraitData] Invalid rollTrait: '${this.rollTrait}'`);
  }
  get rollTraitOptions() {
    if (oe.IsType(this.rollPrimaryDoc, z.pc)) {
      if (a0(this.rollTrait))
        return Object.values(js).map((t) => ({
          name: w.uCase(t),
          value: t
        }));
      if (o0(this.rollTrait))
        return Object.values(Tt).map((t) => ({
          name: w.uCase(t),
          value: t
        }));
    }
    if (w.isInt(this.rollTrait))
      return [1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((t) => ({
        name: `+${t}`,
        value: t
      }));
    if (n0(this.rollTrait))
      return [];
    throw new Error(`[get rollTraitOptions] Invalid rollTrait: '${this.rollTrait}'`);
  }
  get posEffectTrade() {
    var t;
    return ((t = this.data) == null ? void 0 : t.rollPosEffectTrade) ?? !1;
  }
  // getFlagVal<T>(flagKey?: string): T | undefined {
  //   if (flagKey) {
  //     return this.document.getFlag(C.SYSTEM_ID, `rollCollab.${flagKey}`.replace(/(rollCollab\.)+/g, "rollCollab.")) as T | undefined;
  //   }
  //   return this.document.getFlag(C.SYSTEM_ID, "rollCollab") as T | undefined;
  // }
  // async setFlagVal(flagKey: string, flagVal: unknown, isRerendering = true) {
  //   await this.document.setFlag(C.SYSTEM_ID, `rollCollab.${flagKey}`.replace(/(rollCollab\.)+/g, "rollCollab."), flagVal);
  //   if (isRerendering) {
  //     socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
  //   }
  // }
  // async clearFlagVal(flagKey: string, isRerendering = true) {
  //   await this.document.unsetFlag(C.SYSTEM_ID, `rollCollab.${flagKey}`.replace(/(rollCollab\.)+/g, "rollCollab."));
  //   if (isRerendering) {
  //     socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
  //   }
  // }
  get initialPosition() {
    return this.data.rollPositionInitial ?? Ct.risky;
  }
  set initialPosition(t) {
    this.updateTarget("rollPositionInitial", t ?? Ct.risky);
  }
  get initialEffect() {
    return this.data.rollEffectInitial ?? mt.standard;
  }
  set initialEffect(t) {
    this.updateTarget("rollEffectInitial", t ?? mt.standard);
  }
  get isApplyingConsequences() {
    return !(this.rollType !== Oe.Action || !this.rollResult || ![Ue.partial, Ue.fail].includes(this.rollResult));
  }
  // Get rollConsequence() --> For resistance rolls.
  get rollConsequence() {
    const { consequence: t } = this.data.resistanceData ?? {};
    if (t != null && t.id)
      return game.eunoblades.Consequences.get(t.id) ?? new $s(t);
  }
  // #endregion
  // #region GETTERS: DERIVED DATA ~
  get rollPositionFinal() {
    return Object.values(Ct)[w.clampNum(
      Object.values(Ct).indexOf(this.initialPosition) + this.getModsDelta(ae.position) + (this.posEffectTrade === "position" ? 1 : 0) + (this.posEffectTrade === "effect" ? -1 : 0),
      [0, 2]
    )];
  }
  get rollEffectFinal() {
    return Object.values(mt)[w.clampNum(
      Object.values(mt).indexOf(this.initialEffect) + this.getModsDelta(ae.effect) + (this.posEffectTrade === "effect" ? 1 : 0) + (this.posEffectTrade === "position" ? -1 : 0),
      [0, 4]
    )];
  }
  get rollResultDelta() {
    var t;
    return this.getModsDelta(ae.result) + (((t = this.data) == null ? void 0 : t.GMBoosts.Result) ?? 0) + (this.tempGMBoosts.Result ?? 0);
  }
  get rollResultFinal() {
    if (this.rollResult === !1)
      return !1;
    if (this.rollResultDelta === 0)
      return this.rollResult;
    switch (this.rollType) {
      case Oe.Action:
      case Oe.Fortune:
        return Object.values(Ue).toReversed()[w.clampNum(
          Object.values(Ue).toReversed().indexOf(this.rollResult) + this.rollResultDelta,
          [0, 3]
        )];
      case Oe.Resistance:
        return this.isCritical ? -1 : w.clampNum(6 - this.highestDieVal - this.rollResultDelta, [-1, 1 / 0]);
      case Oe.IndulgeVice:
        return w.clampNum(this.highestDieVal + this.rollResultDelta, [0, 1 / 0]);
    }
    return !1;
  }
  get finalDicePool() {
    return Math.max(0, this.rollTraitData.value + this.getModsDelta(ae.roll) + (this.data.GMBoosts.Dice ?? 0) + (this.tempGMBoosts.Dice ?? 0));
  }
  get isRollingZero() {
    return Math.max(0, this.rollTraitData.value + this.getModsDelta(ae.roll) + (this.data.GMBoosts.Dice ?? 0) + (this.tempGMBoosts.Dice ?? 0)) <= 0;
  }
  get roll() {
    return this._roll ?? (this._roll = new Roll(`${this.isRollingZero ? 2 : this.finalDicePool}d6`, {})), this._roll;
  }
  get rollFactors() {
    const t = {
      [H.tier]: {
        name: "Tier",
        value: 0,
        max: 0,
        baseVal: 0,
        display: "?",
        isActive: !1,
        isPrimary: !0,
        isDominant: !1,
        highFavorsPC: !0,
        cssClasses: "factor-gold"
      },
      [H.quality]: {
        name: "Quality",
        value: 0,
        max: 0,
        baseVal: 0,
        display: "?",
        isActive: !1,
        isPrimary: !1,
        isDominant: !1,
        highFavorsPC: !0,
        cssClasses: "factor-gold"
      },
      [H.scale]: {
        name: "Scale",
        value: 0,
        max: 0,
        baseVal: 0,
        display: "?",
        isActive: !1,
        isPrimary: !1,
        isDominant: !1,
        highFavorsPC: !0,
        cssClasses: "factor-gold"
      },
      [H.magnitude]: {
        name: "Magnitude",
        value: 0,
        max: 0,
        baseVal: 0,
        display: "?",
        isActive: !1,
        isPrimary: !1,
        isDominant: !1,
        highFavorsPC: !0,
        cssClasses: "factor-gold"
      }
    }, s = w.objMerge(
      w.objMerge(
        t,
        this.rollPrimary.rollFactors,
        { isMutatingOk: !1 }
      ),
      this.data.rollFactorToggles.source,
      { isMutatingOk: !1 }
    ), i = this.rollOpposition ? w.objMerge(
      w.objMerge(
        t,
        this.rollOpposition.rollFactors,
        { isMutatingOk: !1 }
      ),
      this.data.rollFactorToggles.opposition,
      { isMutatingOk: !1 }
    ) : {};
    return {
      source: Object.fromEntries(
        Object.entries(s).map(([a, o]) => (o.value += (this.data.GMBoosts[a] ?? 0) + (this.tempGMBoosts[a] ?? 0), a === H.tier ? o.display = w.romanizeNum(o.value) : o.display = `${o.value}`, [a, o]))
      ),
      opposition: Object.fromEntries(
        Object.entries(i).map(([a, o]) => (o.value += this.data.GMOppBoosts[a] ?? 0, a === H.tier ? o.display = w.romanizeNum(o.value) : o.display = `${o.value}`, [a, o]))
      )
    };
  }
  // #endregion
  // #region ROLL MODS: Getters & Update Method ~
  initRollMods() {
    this.rollTraitValOverride = void 0, this.rollFactorPenaltiesNegated = {}, this.tempGMBoosts = {};
    const t = {};
    let s = 0;
    const i = (c) => {
      if (_t.Debug.modWatch === !1)
        return;
      const u = `(${s}) == ${c}`, g = this.rollMods.find((p) => _t.Debug.modWatch && _t.Debug.modWatch.exec(p.name));
      g ? t[`${u} : ${g.status}`] = {
        inst: g,
        data: { ...g.data },
        sourceName: g.sourceName,
        status: {
          ALL: g.status,
          base: g.baseStatus,
          held: g.heldStatus,
          user: g.userStatus
        },
        is: {
          active: g.isActive,
          visible: g.isVisible,
          conditional: g.isConditional,
          inInactiveBlock: g.isInInactiveBlock,
          isPush: g.isPush,
          isBasicPush: g.isBasicPush
        }
      } : t[u] = "MOD NOT FOUND", s++;
    };
    i("INITIAL"), this._rollMods = this.rollMods.filter((c) => c.isValidForRollType()), i("ROLLTYPE VALIDATION");
    const a = this.rollMods.filter((c) => !c.setConditionalStatus());
    i("DISABLE - CONDITIONAL");
    const o = a.filter((c) => !c.setAutoStatus());
    i("DISABLE - AUTO-REVEAL/ENABLE"), o.forEach((c) => {
      c.setPayableStatus();
    }), i("DISABLE - PAYABLE");
    const n = (c) => {
      var g, p;
      const u = c.effectKeys.filter((h) => h.startsWith("ForceOn"));
      if (u.length !== 0)
        for (; u.length; ) {
          const h = (p = (g = u.pop()) == null ? void 0 : g.split(/-/)) == null ? void 0 : p.pop();
          if (h === "BestAction")
            Te.IsType(this.rollPrimaryDoc) && (this.rollTraitValOverride = Math.max(...Object.values(this.rollPrimaryDoc.actions)));
          else {
            const [m, y, k] = (h == null ? void 0 : h.split(/,/)) ?? [];
            if (!m)
              throw new Error(`No targetName found in thisTarget: ${h}.`);
            let _ = this.getRollModByName(m) ?? this.getRollModByName(m, y ?? c.section);
            if (!_ && m === "Push" && ([_] = [
              ...this.getActiveBasicPushMods(y ?? c.section, "negative").filter((C) => C.status === se.ToggledOn),
              ...this.getActiveBasicPushMods(y ?? c.section, "positive").filter((C) => C.status === se.ToggledOn),
              ...this.getInactiveBasicPushMods(y ?? c.section, "positive").filter((C) => C.status === se.ToggledOff)
            ]), _ ?? (_ = this.getRollModByName(m, y ?? c.section, k ?? c.posNeg)), !_)
              throw new Error(`No mod found matching ${m}/${y}/${k}`);
            _.isActive ? _.heldStatus = se.ForcedOn : (_.heldStatus = se.ForcedOn, n(_));
          }
        }
    };
    this.getActiveRollMods().forEach((c) => n(c)), i("FORCE-ON PASS"), this.isForcePushed() && (this.getInactivePushMods().filter((c) => !c.isBasicPush).forEach((c) => {
      c.heldStatus = se.ForcedOff;
    }), i("PUSH-CHECK: FORCE-OFF IS-PUSH")), [ae.roll, ae.effect].forEach((c) => {
      if (this.isPushed(c)) {
        if (c === ae.roll && this.isPushed(c, "positive")) {
          const u = this.getRollModByKey("Bargain-positive-roll");
          u != null && u.isVisible && (u.heldStatus = se.ForcedOff);
        }
        i("PUSH-CHECK: FORCE OFF BARGAIN");
      } else
        this.getInactivePushMods(c).filter((u) => !u.isBasicPush).forEach((u) => {
          u.heldStatus = se.Hidden;
        }), i("PUSH-CHECK: HIDE IS-PUSH");
    }), this.getVisibleRollMods().forEach((c) => {
      c.setRelevancyStatus();
    }), i("RELEVANCY PASS"), this.getActiveRollMods().find((c) => c.effectKeys.includes("Cost-SpecialArmor")) && (this.getVisibleRollMods().filter((c) => !c.isActive && c.effectKeys.includes("Cost-SpecialArmor")).forEach((c) => {
      c.heldStatus = se.ForcedOff;
    }), i("OVERPAYMENT PASS")), eLog.checkLog2("rollMods", "*** initRollMods() PASS ***", t);
  }
  isTraitRelevant(t) {
    var s;
    if (t in H) {
      const { source: i, opposition: a } = this.rollFactors;
      return !!(t in i && t in a && ((s = i[t]) != null && s.isActive));
    }
    return !1;
  }
  get isParticipantRoll() {
    return this.rollType === Oe.Fortune && !game.user.isGM || this.rollSubType === Na.GroupParticipant;
  }
  negatePushCost() {
    const t = this.getActiveRollMods().find((s) => s.isPush && s.stressCost > 0);
    t && w.pullElement(t.effectKeys, (s) => s.startsWith("Cost-Stress"));
  }
  negateFactorPenalty(t) {
    this.rollFactorPenaltiesNegated[t] = !0;
  }
  isPushed(t, s) {
    return this.getActiveBasicPushMods(t, s).length > 0;
  }
  hasOpenPush(t, s) {
    return this.isPushed(t) && this.getOpenPushMods(t, s).length > 0;
  }
  isForcePushed(t, s) {
    return this.isPushed(t) && this.getForcedPushMods(t, s).length > 0;
  }
  get rollCosts() {
    if (!this.isPushed)
      return 0;
    const t = this.getRollModByKey("Push-negative-roll"), s = this.getRollModByKey("Push-positive-roll"), i = this.getRollModByKey("Push-positive-effect"), a = this.getActiveRollMods(ae.after, "positive").filter((o) => o.effectKeys.includes("Negate-PushCost"));
    return ((t == null ? void 0 : t.isActive) && (t == null ? void 0 : t.stressCost) || 0) + ((s == null ? void 0 : s.isActive) && (s == null ? void 0 : s.stressCost) || 0) + ((i == null ? void 0 : i.isActive) && (i == null ? void 0 : i.stressCost) || 0) - a.length * 2;
  }
  get rollCostData() {
    return this.getActiveRollMods().map((t) => t.costs ?? []).flat();
  }
  getRollModByID(t) {
    return this.rollMods.find((s) => s.id === t);
  }
  getRollModByName(t, s, i) {
    const a = this.rollMods.filter((o) => !(w.lCase(o.name) !== w.lCase(t) || s && o.section !== s || i && o.posNeg !== i));
    if (a.length !== 0 && !(a.length > 1))
      return a[0];
  }
  getRollModByKey(t) {
    return this.rollMods.find((s) => s.data.key === t);
  }
  getRollMods(t, s) {
    return this.rollMods.filter((i) => (!t || i.section === t) && (!s || i.posNeg === s));
  }
  getVisibleRollMods(t, s) {
    return this.getRollMods(t, s).filter((i) => i.isVisible);
  }
  getActiveRollMods(t, s) {
    return this.getRollMods(t, s).filter((i) => i.isActive);
  }
  getVisibleInactiveRollMods(t, s) {
    return this.getVisibleRollMods(t, s).filter((i) => !i.isActive);
  }
  getPushMods(t, s) {
    return this.getRollMods(t, s).filter((i) => i.isPush);
  }
  getVisiblePushMods(t, s) {
    return this.getPushMods(t, s).filter((i) => i.isVisible);
  }
  getActivePushMods(t, s) {
    return this.getVisiblePushMods(t, s).filter((i) => i.isActive);
  }
  getActiveBasicPushMods(t, s) {
    return this.getActivePushMods(t, s).filter((i) => i.isBasicPush);
  }
  getInactivePushMods(t, s) {
    return this.getVisiblePushMods(t, s).filter((i) => !i.isActive);
  }
  getInactiveBasicPushMods(t, s) {
    return this.getInactivePushMods(t, s).filter((i) => i.isBasicPush);
  }
  getForcedPushMods(t, s) {
    return this.getActivePushMods(t, s).filter((i) => i.isBasicPush && i.status === se.ForcedOn);
  }
  getOpenPushMods(t, s) {
    return this.getActivePushMods(t, s).filter((i) => i.isBasicPush && i.status === se.ToggledOn);
  }
  /**
   * Compare function for sorting roll mods.
   * @param {BladesRollMod} modA First mod to compare.
   * @param {BladesRollMod} modB Second mod to compare.
   * @returns {number} - Comparison result.
   */
  compareMods(t, s) {
    const i = ["Bargain", "Assist", "Setup"];
    if (t.isBasicPush)
      return -1;
    if (s.isBasicPush)
      return 1;
    if (t.name === "Bargain" && t.isActive)
      return -1;
    if (s.name === "Bargain" && s.isActive)
      return 1;
    if (t.isPush)
      return -1;
    if (s.isPush)
      return 1;
    const a = i.indexOf(t.name), o = i.indexOf(s.name);
    return a !== -1 && o !== -1 ? a - o : t.name.localeCompare(s.name);
  }
  get rollMods() {
    return this._rollMods || (this._rollMods = Object.values(this.data.rollModsData).map((t) => new ki(t, this))), [...this._rollMods].sort((t, s) => this.compareMods(t, s));
  }
  // #endregion
  // #region CONSEQUENCES: Getting, Accepting, Resisting
  get consequences() {
    var s, i;
    const t = (i = (s = this.data.consequenceData) == null ? void 0 : s[this.rollPositionFinal]) == null ? void 0 : i[this.rollResult];
    return t ? Object.values(t).map((a) => new $s(a)) : [];
  }
  getConsequenceByID(t) {
    return this.consequences.find((s) => s.id === t) ?? !1;
  }
  get acceptedConsequences() {
    return [Ys.AwaitingConsequences, Ys.Complete].includes(this.rollPhase) ? this.consequences.filter((t) => t.isAccepted === !0) : [];
  }
  get unacceptedConsequences() {
    return this.rollPhase === Ys.AwaitingConsequences ? this.consequences.filter((t) => t.isAccepted !== !0) : [];
  }
  // #endregion
  // #region *** ROLL COLLAB HTML INTERACTION *** ~
  /**
   * Retrieve the data for rendering the base RollCollab sheet.
   * @returns {Promise<object>} The data which can be used to render the HTML of the sheet.
   */
  get context() {
    return this.initRollMods(), this.rollMods.forEach((t) => t.applyRollModEffectKeys()), this.getTemplateContext();
  }
  /**
   * Determines if the user is a game master.
   * @returns {boolean} Whether the user is a GM.
   */
  getIsGM() {
    var t;
    return (t = game.eunoblades.Tracker) != null && t.system.is_spoofing_player ? !1 : game.user.isGM;
  }
  /**
   * Gets the roll costs.
   * @returns {BladesRoll.CostData[]} The roll costs.
   */
  getRollCosts() {
    return this.getActiveRollMods().map((t) => t.costs).flat().filter((t) => t !== void 0);
  }
  /**
   * Constructs the sheet data.
   * @param {boolean} isGM If the user is a GM.
   * @param {BladesRoll.CostData[]} rollCosts The roll costs.
   * @returns {BladesRoll.Context} The constructed sheet data.
   */
  getTemplateContext() {
    var O;
    const {
      data: t,
      rollPrimary: s,
      rollTraitData: i,
      rollTraitOptions: a,
      rollClockKey: o,
      finalDicePool: n,
      rollPositionFinal: l,
      rollEffectFinal: c,
      rollResultDelta: u,
      rollResultFinal: g,
      rollMods: p,
      rollFactors: h
    } = this;
    if (!s)
      throw new Error("A primary roll source is required for BladesRoll.");
    const m = {
      ...this.data,
      cssClass: "roll-collab",
      isGM: this.isGM,
      system: (O = this.rollPrimaryDoc) == null ? void 0 : O.system,
      rollMods: p,
      rollPrimary: s,
      rollTraitData: i,
      rollTraitOptions: a,
      diceTotal: n,
      rollOpposition: this.rollOpposition,
      rollParticipants: this.rollParticipants,
      rollParticipantOptions: this.rollParticipantSelectOptions,
      rollEffects: Object.values(mt),
      rollTraitValOverride: this.rollTraitValOverride,
      rollFactorPenaltiesNegated: this.rollFactorPenaltiesNegated,
      posRollMods: Object.fromEntries(Object.values(ae).map((M) => [M, this.getRollMods(M, "positive")])),
      negRollMods: Object.fromEntries(Object.values(ae).map((M) => [M, this.getRollMods(M, "negative")])),
      hasInactiveConditionals: this.calculateHasInactiveConditionalsData(),
      rollFactors: h,
      ...this.calculateOddsHTML(n, u)
    }, y = this.calculateGMBoostsData(t), k = this.calculatePositionEffectTradeData(), _ = this.getRollCosts().filter((M) => M.costType === "Stress").map((M) => [M.label, M.costAmount]), C = [];
    if (this.rollPrimaryDoc instanceof Te)
      C.push(...this.rollPrimaryDoc.availableArmor);
    else if (Z.IsType(
      this.rollPrimaryDoc,
      A.cohort_gang,
      A.cohort_expert
    ))
      for (let M = 0; M < this.rollPrimaryDoc.system.armor.value; M++)
        C.push("Armor");
    const T = this.getRollCosts().filter((M) => M.costType === "Armor").map((M, R) => [M.label, C[R]]).filter(([M, R]) => R !== void 0), x = this.getRollCosts().filter((M) => M.costType === "SpecialArmor").map((M) => M.label), S = m.userPermissions[game.user.id] ?? pt.Observer;
    return {
      ...m,
      rollPrimary: this.rollPrimary,
      rollPositionFinal: l,
      rollEffectFinal: c,
      rollResultFinal: g,
      rollPositions: Object.values(Ct),
      rollEffects: Object.values(mt),
      rollResultDelta: u,
      isAffectingResult: u !== 0 || this.getVisibleRollMods(ae.result).length > 0 || this.isGM && this.getRollMods(ae.result).length > 0,
      isAffectingAfter: this.getVisibleRollMods(ae.after).length > 0 || this.isGM && this.getRollMods(ae.after).length > 0,
      ...y,
      ...k,
      rollClockKey: o,
      totalStressCost: _.reduce((M, [R, L]) => M + L, 0),
      totalArmorCost: T.length,
      stressCosts: _.length > 0 ? Object.fromEntries(_) : void 0,
      armorCosts: T.length > 0 ? Object.fromEntries(T) : void 0,
      specArmorCost: x[0],
      userPermission: S,
      editable: S === pt.Primary || S === pt.GM,
      gamePhase: game.eunoblades.Tracker.phase
    };
  }
  // type BladesSelectOption<displayType, valueType = string> = {
  //   value: valueType,
  //   display: displayType
  // };
  // protected processDowntimeActions() {
  //   const downtimeData: Record<string,any>;
  //   if (BladesActor.IsType(this.rollPrimaryDoc, BladesActorType.pc)) {
  //     downtimeData.canDoDowntimeActions = true;
  //     downtimeData.downtimeActionsRemaining = this.rollPrimaryDoc.remainingDowntimeActions;
  //     const availableDowntimeActions: DowntimeAction[] = [];
  //     if (this.rollType === RollType.Action) {
  //       availableDowntimeActions.push(...[
  //         DowntimeAction.AcquireAsset,
  //         DowntimeAction.LongTermProject,
  //         DowntimeAction.Recover,
  //         DowntimeAction.ReduceHeat
  //       ]);
  //     } else if (this.rollType === RollType.Fortune) {
  //       availableDowntimeActions.push(...[
  //         DowntimeAction.
  //       ])
  //     }
  //     downtimeData.downtimeActionOptions =
  //   downtimeActionOptions?: Array<BladesSelectOption<string, DowntimeAction>
  // }
  calculateGMBoostsData(t) {
    return {
      GMBoosts: {
        Dice: t.GMBoosts.Dice ?? 0,
        [H.tier]: t.GMBoosts[H.tier] ?? 0,
        [H.quality]: t.GMBoosts[H.quality] ?? 0,
        [H.scale]: t.GMBoosts[H.scale] ?? 0,
        [H.magnitude]: t.GMBoosts[H.magnitude] ?? 0,
        Result: t.GMBoosts.Result ?? 0
      },
      GMOppBoosts: {
        [H.tier]: t.GMOppBoosts[H.tier] ?? 0,
        [H.quality]: t.GMOppBoosts[H.quality] ?? 0,
        [H.scale]: t.GMOppBoosts[H.scale] ?? 0,
        [H.magnitude]: t.GMOppBoosts[H.magnitude] ?? 0
      }
    };
  }
  calculateOddsHTML(t, s) {
    return this.rollType === Oe.Resistance ? this.calculateOddsHTML_Resistance(t) : this.calculateOddsHTML_Standard(t, s);
  }
  /**
   * Calculate odds starting & ending HTML based on given dice total.
   * @param {number} diceTotal Total number of dice.
   * @param {number} rollResultDelta
   * @returns {{oddsHTMLStart: string, oddsHTMLStop: string}} Opening & Closing HTML for odds bar display
   */
  calculateOddsHTML_Standard(t, s) {
    const i = {
      crit: "var(--blades-gold)",
      success: "var(--blades-white-bright)",
      partial: "var(--blades-grey)",
      fail: "var(--blades-black-dark)"
    }, a = { ...X.DiceOddsStandard[t] };
    if (s < 0)
      for (let n = s; n < 0; n++)
        i.crit = i.success, i.success = i.partial, i.partial = i.fail;
    else if (s > 0)
      for (let n = 0; n < s; n++)
        i.fail = i.partial, i.partial = i.success, i.success = i.crit;
    const o = [];
    return Object.entries(a).reverse().forEach(([n, l]) => {
      l !== 0 && o.push(`<div class="odds-section" style="height: 100%; width: ${l}%; background: ${i[n]};">&nbsp;</div>`);
    }), {
      oddsHTMLStart: [
        '<div class="roll-odds-section-container">',
        ...o
      ].join(`
`),
      oddsHTMLStop: "</div>"
    };
  }
  /**
   * Calculate odds starting & ending HTML based on given dice total.
   * @param {number} diceTotal Total number of dice.
   * @returns {{oddsHTMLStart: string, oddsHTMLStop: string}} Opening & Closing HTML for odds bar display
   */
  calculateOddsHTML_Resistance(t) {
    const s = [
      "var(--blades-gold)",
      // -1
      "var(--blades-white)",
      // 0
      "var(--blades-red)",
      // 1
      "var(--blades-red)",
      // 2
      "var(--blades-red)",
      // 3
      "var(--blades-red)",
      // 4
      "var(--blades-red)"
      // 5
    ].reverse(), i = [
      "none",
      "none",
      "brightness(0.2)",
      "brightness(0.4)",
      "brightness(0.6)",
      "brightness(0.8)",
      "none"
    ].reverse(), a = [...X.DiceOddsResistance[t]].reverse(), o = [];
    for (let n = 0; n < a.length; n++) {
      const l = a[n];
      if (l > 0) {
        const c = s[n], u = i[n];
        o.push(`<div class="odds-section odds-section-stress" style="height: 100%; width: ${l}%; background: ${c}; filter: ${u};">&nbsp;</div>`);
      }
    }
    return {
      oddsHTMLStart: [
        '<div class="roll-odds-section-container">',
        ...o
      ].join(`
`),
      oddsHTMLStop: "</div>"
    };
  }
  /**
   * Calculate data for position and effect trade.
   * @returns {{canTradePosition: boolean, canTradeEffect: boolean}}
   */
  calculatePositionEffectTradeData() {
    const t = this.posEffectTrade === "position" || this.posEffectTrade === !1 && this.rollPositionFinal !== Ct.desperate && this.rollEffectFinal !== mt.extreme, s = this.posEffectTrade === "effect" || this.posEffectTrade === !1 && this.rollPositionFinal !== Ct.controlled && this.rollEffectFinal !== mt.zero;
    return { canTradePosition: t, canTradeEffect: s };
  }
  /**
   * Calculate data on whether there are any inactive conditionals.
   * @returns {Record<RollModSection, boolean>} - Data on inactive conditionals.
   */
  calculateHasInactiveConditionalsData() {
    const t = {};
    for (const s of Object.values(ae))
      t[s] = this.getRollMods(s).filter((i) => i.isInInactiveBlock).length > 0;
    return t;
  }
  get dieVals() {
    return this.roll.terms[0].results.map((t) => t.result).sort().reverse();
  }
  // Accounts for rolling zero dice by removing highest.
  get finalDieVals() {
    return this.isRollingZero ? this.dieVals.slice(1) : this.dieVals;
  }
  get finalDiceData() {
    eLog.checkLog3("rollCollab", "[get finalDiceData()]", { roll: this, dieVals: this.dieVals });
    const t = [...this.dieVals], s = this.isRollingZero ? t.shift() : null, i = t.filter((o) => o === 6).length >= 2, a = t.map((o, n) => ({
      value: o,
      dieClass: _t.GetDieClass(this.rollType, this.rollResult, o, n),
      dieImage: _t.GetDieImage(this.rollType, this.rollResult, o, n, !1, i)
    }));
    return s && a.push({
      value: s,
      dieClass: "blades-die-ghost",
      dieImage: _t.GetDieImage(this.rollType, this.rollResult, s, a.length, !0, !1)
    }), a;
  }
  // get dieValsHTML(): string {
  //   eLog.checkLog3("rollCollab", "[get dieValsHTML()]", {roll: this, dieVals: this.dieVals});
  //   const dieVals = [...this.dieVals];
  //   const ghostNum = this.isRollingZero ? dieVals.shift() : null;
  //   const isCritical = dieVals.filter((val) => val === 6).length >= 2;
  //   const diceData = dieVals.map((val, i) => ({
  //     value: val,
  //     dieClass: BladesRoll.GetDieClass(this.rollType, this.rollResult, val, i),
  //     dieImage: BladesRoll.GetDieImage(this.rollType, this.rollResult, val, i, false, isCritical)
  //   }));
  //   if (ghostNum) {
  //     diceData.push({
  //       value: ghostNum,
  //       dieClass: "blades-die-ghost",
  //       dieImage: BladesRoll.GetDieImage(this.rollType, this.rollResult, ghostNum, diceData.length, true, false)
  //     });
  //   }
  //   return [
  //     ...dieVals.map((val, i) => `<span class='blades-die ${dieClass} blades-die-${value}'><img src='${dieImage}' /></span>`),
  //     ghostNum ? `<span class='blades-die blades-die-ghost blades-die-${ghostNum}'><img src='${this.getDieImage(ghostNum, 0, true)}' /></span>` : null
  //   ]
  //     .filter((val): val is string => typeof val === "string")
  //     .join("");
  // }
  // #endregion
  // #region RESULT GETTERS ~
  get isCritical() {
    return this.finalDieVals.filter((t) => t === 6).length >= 2;
  }
  get isSuccess() {
    return !!(!this.isCritical && this.finalDieVals.find((t) => t === 6));
  }
  get isPartial() {
    return !!(!this.isCritical && !this.isSuccess && this.finalDieVals.find((t) => t && t >= 4));
  }
  get isFail() {
    return !this.isCritical && !this.isSuccess && !this.isPartial;
  }
  get highestDieVal() {
    return this.finalDieVals[0];
  }
  get rollResult() {
    throw new Error("[BladesRoll.rollResult] Unimplemented by Subclass.");
  }
  // #endregion
  get isResolved() {
    return this.roll.total !== void 0;
  }
  async evaluateRoll() {
    return this.isResolved ? (this.closeRollCollab_Animation(), this.data) : (this.closeRollCollab_SocketCall(), eLog.checkLog3("rollCollab", "[resolveRoll()] Before Evaluation", { roll: this, rollData: { ...this.data } }), await this.roll.evaluate({ async: !0 }), await this.updateTargetData({
      ...this.data,
      rollPositionFinal: this.rollPositionFinal,
      rollEffectFinal: this.rollEffectFinal,
      rollResult: this.rollResult,
      rollTraitVerb: this.rollTraitVerb,
      rollTraitPastVerb: this.rollTraitPastVerb,
      finalDiceData: this.finalDiceData,
      rollPhase: this.isApplyingConsequences ? Ys.AwaitingConsequences : Ys.Complete
    }));
  }
  async resolveRollResult() {
    throw new Error("[BladesRoll.resolveRollResult] Unimplemented by Subclass.");
  }
  async outputRollToChat() {
    await wr.create({ bladesRoll: this });
  }
  async resolveRoll() {
    await this.evaluateRoll(), this.resolveRollResult(), await this.outputRollToChat();
  }
  // #endregion
  // #region *** INTERFACING WITH BLADESCHAT ***
  getSpeaker(t) {
    var n;
    const { rollPrimaryID: s, rollPrimaryName: i, rollPrimaryType: a, rollPrimaryDoc: o } = this.rollPrimary;
    return t.alias = i, [A.cohort_gang, A.cohort_expert].includes(a) ? (t.actor = ((n = o == null ? void 0 : o.parent) == null ? void 0 : n.id) ?? t.actor, (o == null ? void 0 : o.parent) instanceof Te && (t.alias = `${t.alias} (${o.parent.name})`)) : [A.gm_tracker, A.score].includes(a) ? (t.actor = null, t.alias = "The Gamemaster") : s && (t.actor = s), t;
  }
  get overlayPosition() {
    return this._overlayPosition;
  }
  set overlayPosition(t) {
    this._overlayPosition = t;
  }
  get elem$() {
    if (this._elem$)
      return this._elem$;
    const t = $(`#${this.id}`);
    return t.length ? this._elem$ = t : (this._elem$ = $(`<div id="${this.id}" class="app window-app ${X.SYSTEM_ID} sheet roll-collab${game.user.isGM ? " gm-roll-collab" : ""}"></div>`).appendTo("body"), this._elem$.css({
      left: `${this.overlayPosition.x}px`,
      top: `${this.overlayPosition.y}px`
    })), this._elem$;
  }
  async renderRollCollab() {
    this.prepareRollParticipantData();
    const t = await renderTemplate(this.collabTemplate, this.context);
    this.elem$.html(t), this.activateListeners();
  }
  get isRendered() {
    var t;
    return !!((t = this._elem$) != null && t.length);
  }
  get collabTemplate() {
    throw new Error("[BladesRoll.collabTemplate] Unimplemented by Subclass.");
  }
  get chatTemplate() {
    throw new Error("[BladesRoll.chatTemplate] Unimplemented by Subclass.");
  }
  // #region LISTENER FUNCTIONS ~
  // async _handleConsequenceClick(event: ClickEvent) {
  //   const clickTarget$ = $(event.currentTarget);
  //   const csqParent$ = clickTarget$.closest(".comp.consequence-display-container");
  //   const csqID = csqParent$.data("csq-id");
  //   const chatElem$ = csqParent$.closest(".blades-roll");
  //   const chatMessage$ = chatElem$.closest(".chat-message");
  //   const chatID = chatMessage$.data("messageId") as IDString;
  //   const chatMessage = game.messages.get(chatID);
  //   if (!chatMessage) {return;}
  //   const csqs = await BladesConsequence.GetFromChatMessage(chatMessage);
  //   const thisCsq = csqs.find((csq) => csq.id === csqID);
  //   if (!thisCsq) {return;}
  //   switch (clickTarget$.data("action")) {
  //     case "accept-consequence": return thisCsq.resolveAccept();
  //     case "resist-consequence": return thisCsq.resistConsequence();
  //     case "armor-consequence": return thisCsq.resistArmorConsequence();
  //     case "special-consequence": return thisCsq.resistSpecialArmorConsequence();
  //   }
  //   return undefined as never;
  // }
  _toggleRollModClick(t) {
    t.preventDefault();
    const i = $(t.currentTarget).data("id"), a = this.getRollModByID(i);
    if (!a)
      throw new Error(`Unable to find roll mod with id '${i}'`);
    switch (a.isRerendering = !0, a.status) {
      case se.Hidden:
        a.userStatus = se.ForcedOff;
        break;
      case se.ForcedOff:
        a.userStatus = se.ToggledOff;
        break;
      case se.ToggledOff:
        a.userStatus = se.ToggledOn;
        break;
      case se.ToggledOn:
        a.userStatus = game.user.isGM ? se.ForcedOn : se.ToggledOff;
        break;
      case se.ForcedOn:
        a.userStatus = se.Hidden;
        break;
      default:
        throw new Error(`Unrecognized RollModStatus: ${a.status}`);
    }
    a.isRerendering = !1;
  }
  /**
   * Handles setting of rollMod status via GM pop-out controls
   * @param {ClickEvent} event JQuery click event sent to listener.
   */
  _gmControlSet(t) {
    if (t.preventDefault(), !game.user.isGM)
      return;
    const s = $(t.currentTarget), i = s.data("id"), a = s.data("status");
    if (!l3(a) && a !== "Reset")
      return;
    const o = this.getRollModByID(i);
    o && (o.userStatus = a === "Reset" ? void 0 : a);
  }
  /**
   * Handles setting values via GM number line (e.g. roll factor boosts/modifications).
   * @param {ClickEvent} event JQuery click event sent to listener.
   */
  async _gmControlSetTargetToValue(t) {
    if (t.preventDefault(), !game.user.isGM)
      return;
    const s = $(t.currentTarget), i = s.data("target").replace(/flags\.eunos-blades\./, ""), a = s.data("value");
    await this.updateTarget(i, a), socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
  }
  async _gmControlCycleTarget(t) {
    var u;
    if (t.preventDefault(), !game.user.isGM)
      return;
    const s = $(t.currentTarget), i = s.data("flagTarget"), a = s.data("curVal"), o = (u = s.data("vals")) == null ? void 0 : u.split(/\|/);
    if (!o)
      throw new Error(`Unable to parse cycle values from data-vals = ${s.data("vals")}`);
    const n = o.indexOf(a);
    if (n === -1)
      throw new Error(`Unable to find current value '${a}' in cycle values '${s.data("vals")}'`);
    let l = n + 1;
    l >= o.length && (l = 0);
    const c = o[l];
    eLog.checkLog3("gmControlCycleTarget", "gmControlCycleTarget", { flagTarget: i, curVal: a, cycleVals: o, curValIndex: n, newValIndex: l, newVal: c }), await this.updateTarget(i, c);
  }
  /**
   * Handles resetting value associated with GM number line on a right-click.
   * @param {ClickEvent} event JQuery context menu event sent to listener.
   */
  async _gmControlResetTarget(t) {
    t.preventDefault(), game.user.isGM && (await this.updateTarget($(t.currentTarget).data("target"), void 0), socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id));
  }
  /**
   * Handles setting of baseline rollPosition via GM button line
   * @param {ClickEvent} event JQuery click event sent to listener.
   */
  _gmControlSetPosition(t) {
    if (t.preventDefault(), !game.user.isGM)
      return;
    const i = $(t.currentTarget).data("status");
    this.initialPosition = i;
  }
  /**
   * Handles setting of baseline rollPosition via GM button line
   * @param {ClickEvent} event JQuery click event sent to listener.
   */
  _gmControlSetEffect(t) {
    if (t.preventDefault(), !game.user.isGM)
      return;
    const i = $(t.currentTarget).data("status");
    this.initialEffect = i;
  }
  /**
   * Handles setting of Factor toggles: isActive, isPrimary, highFavorsPC, isDominant
   * @param {ClickEvent} event JQuery click event sent to listener.
   */
  async _gmControlToggleFactor(t) {
    if (t.preventDefault(), !game.user.isGM)
      return;
    const s = $(t.currentTarget), i = s.data("target"), a = !s.data("value");
    eLog.checkLog3("toggleFactor", "_gmControlToggleFactor", { event: t, target: i, value: a });
    const o = this.data.rollFactorToggles, [n, l, c] = i.split(/\./).slice(-3);
    switch (["isActive", "isPrimary", "isDominant", "highFavorsPC"].includes(c) || (await this.updateTarget(i, a), socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id)), o[n][l] = {
      ...o[n][l] ?? { display: "" },
      [c]: a
    }, c) {
      case "isDominant":
      case "isPrimary": {
        a === !0 && Object.values(H).filter((u) => u !== l).forEach((u) => {
          var g;
          ((g = o[n][u]) == null ? void 0 : g[c]) === !0 && (o[n][u] = {
            ...o[n][u],
            [c]: !1
          });
        });
        break;
      }
      case "isActive": {
        if (a === !0) {
          const u = n === "source" ? "opposition" : "source";
          o[u][l] = {
            ...o[u][l] ?? { display: "" },
            isActive: a
          };
        }
        break;
      }
    }
    await this.updateTarget("rollFactorToggles", o), socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
  }
  async _onTextInputBlur(t) {
    const s = t.target, { action: i, targetKey: a } = s.dataset;
    if (!i)
      throw new Error("Input text elements require a data-action attribute.");
    if (!a)
      throw new Error("Input text elements require a 'data-target-key' attribute.");
    await this.updateTarget(a, s.value), socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
  }
  async _onGMPopupClick(t) {
    const s = $(t.currentTarget), i = s.data("prompt"), a = s.data("flagTarget");
    i && a && na.DisplaySimpleInputDialog(this, i, void 0, a);
  }
  get positionDragger() {
    return this._positionDragger ? this._positionDragger : this.spawnPositionDragger();
  }
  spawnPositionDragger() {
    var s;
    const t = this;
    if (!this._elem$)
      throw new Error(`[BladesRoll.spawnPositionDragger] No elem$ found for roll ${this.id}.`);
    return (s = this._positionDragger) == null || s.kill(), this._positionDragger = new Yi(this._elem$, {
      type: "top,left",
      trigger: ".window-header.dragger",
      onDragStart() {
        w.gsap.to(this.target, { opacity: 0.25, duration: 0.25, ease: "power2" });
      },
      onDragEnd() {
        w.gsap.to(this.target, { opacity: 1, duration: 0.25, ease: "power2" }), t.overlayPosition = { x: this.endX, y: this.endY };
      }
    });
  }
  _onPlayerToggleRollMod(t) {
    t.preventDefault();
    const i = $(t.currentTarget).attr("id"), a = this.getRollModByID(i);
    if (!a)
      throw new Error(`Unable to find roll mod with id '${i}'`);
    switch (a.status) {
      case se.ToggledOff: {
        a.heldStatus = se.ToggledOn;
        break;
      }
      case se.ToggledOn: {
        a.heldStatus = se.ToggledOff;
        break;
      }
    }
  }
  _onClickToRoll(t) {
    t.preventDefault(), this.rollPhase === Ys.AwaitingRoll && this.resolveRoll();
  }
  async _onSelectChange(t) {
    t.preventDefault();
    const s = t.currentTarget, { dtype: i, docType: a, targetKey: o } = s.dataset;
    if (game.user.isGM && s.value !== "" && (a != null && a.startsWith("BladesRollParticipant"))) {
      const [l, c, u] = a.split(".");
      await this.addRollParticipant(
        s.value,
        c,
        u
      );
      return;
    }
    if (!o)
      throw new Error("Select elements require a 'data-target-key' attribute.");
    let n;
    switch (w.lCase(i)) {
      case "number":
        n = w.pFloat(s.value);
        break;
      case "boolean":
        n = w.lCase(`${s.value}`) === "true";
        break;
      case "string":
        n = `${s.value}`;
        break;
      default: {
        if (w.isNumString(n))
          throw new Error(`You must set 'data-dtype="Number"' for <select> elements with number values.`);
        if (w.isBooleanString(n))
          throw new Error(`You must set 'data-dtype="Boolean"' for <select> elements with boolean values.`);
        n = `${s.value}`;
        break;
      }
    }
    await this.updateTarget(o, n), socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
  }
  activateListeners() {
    oa(this.elem$), this.spawnPositionDragger(), this.elem$.find("[data-action='player-toggle-mod']").on({
      click: this._onPlayerToggleRollMod.bind(this)
    }), this.elem$.find("[data-action='player-select']").on({ change: this._onSelectChange.bind(this) }), this.elem$.find("[data-action='player-trade']").on({
      click: async (t) => {
        await this.updateTarget("rollPosEffectTrade", w.lCase(`${$(t.currentTarget).data("value")}`) === "false"), socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
      }
    }), this.elem$.find("[data-action='player-roll']").on({
      click: this._onClickToRoll.bind(this)
    }), game.user.isGM && (this.elem$.find(".roll-mod-controls-container").each((t, s) => {
      const i = $(s), a = i.find(".roll-mod-controls-panel");
      i.on({
        mouseenter: () => {
          a.toggleClass("active");
        },
        mouseleave: () => {
          a.toggleClass("active");
        }
      });
    }), this.elem$.find(".controls-toggle").on({
      click: (t) => {
        t.preventDefault(), $(t.currentTarget).parents(".controls-panel").toggleClass("active");
      }
    }), this.elem$.find('[data-action="gm-set"]').on({
      click: this._gmControlSet.bind(this)
    }), this.elem$.find('[data-action="gm-set-position"]').on({
      click: this._gmControlSetPosition.bind(this)
    }), this.elem$.find('[data-action="gm-set-effect"]').on({
      click: this._gmControlSetEffect.bind(this)
    }), this.elem$.find('[data-action="gm-set-target"]').on({
      click: this._gmControlSetTargetToValue.bind(this),
      contextmenu: this._gmControlResetTarget.bind(this)
    }), this.elem$.find('[data-action="gm-cycle-target"]').on({
      click: this._gmControlCycleTarget.bind(this)
    }), this.elem$.find('[data-action="gm-toggle-factor"]').on({
      click: this._gmControlToggleFactor.bind(this)
    }), this.elem$.find("select[data-action='gm-select']").on({ change: this._onSelectChange.bind(this) }), this.elem$.find('[data-action="gm-text-popup"]').on({ click: this._onGMPopupClick.bind(this) }), this.elem$.find("[data-action='gm-text-input']").on({ blur: this._onTextInputBlur.bind(this) }));
  }
  // #endregion
  // #endregion
  // #region OVERRIDES: _canDragDrop, _onDrop, _onSubmit, close, render ~
  // override _canDragDrop() {
  //   return game.user.isGM;
  // }
  // override _onDrop(event: DragEvent) {
  //   const {uuid} = TextEditor.getDragEventData(event) as {uuid: UUIDString};
  //   const dropDoc = fromUuidSync(uuid);
  //   if (BladesRollOpposition.IsDoc(dropDoc)) {
  //     this.rollOpposition = new BladesRollOpposition(this, {rollOppDoc: dropDoc});
  //   } else if (dropDoc instanceof BladesProject && dropDoc.clockKey) {
  //     // Project dropped on roll: Assign project's clock key to roll.
  //     this.rollClockKey = dropDoc.clockKey;
  //   }
  // }
  async submitChange(t, s) {
    await this.updateTarget(t, s), socketlib.system.executeForEveryone("renderRollCollab_SocketCall", this.id);
  }
  // #endregion
};
J(_t, "Debug", {
  modWatch: !1,
  watchRollMod(t) {
    typeof t == "string" ? _t.Debug.modWatch = new RegExp(t, "g") : _t.Debug.modWatch = !1;
  }
});
let zi = _t;
class Ur extends zi {
  /* Not much -- most action roll things will extend to other rolls, but split out things like Position, Effect, default Mods */
  static ApplySchemaDefaults(e) {
    var i, a;
    if (e.rollType = Oe.Action, !e.rollPrimaryData)
      throw new Error("Must include a rollPrimaryData when constructing a BladesActionRoll object.");
    if (!(e.rollTrait === "" || w.isInt(e.rollTrait) || w.lCase(e.rollTrait) in { ...js, ...H }))
      throw new Error(`[BladesActionRoll.ApplySchemaDefaults()] Bad RollTrait for Action Roll: ${e.rollTrait}`);
    const t = super.ApplySchemaDefaults(e), s = Me.Build(t);
    switch (t.rollDowntimeAction) {
      case ke.AcquireAsset: {
        t.rollTrait = H.tier;
        break;
      }
      case ke.LongTermProject: {
        if (!jt.IsValidData(t.rollOppData))
          throw new Error("No rollOppData provided for LongTermProject roll.");
        if (![
          A.project,
          A.design
        ].includes(t.rollOppData.rollOppType))
          throw new Error("rollOppType must be 'project' or 'design' for LongTermProject roll.");
        break;
      }
      case ke.Recover: {
        if (Te.IsType(s.rollPrimaryDoc)) {
          if (!s.rollPrimaryDoc.abilities.find((o) => o.name === "Physiker"))
            throw new Error("A PC rollPrimary on a Recovery roll must have the Physiker ability.");
          t.rollTrait = js.tinker;
        } else if (((i = s.rollPrimaryDoc) == null ? void 0 : i.rollPrimaryType) === z.npc)
          t.rollTrait = H.quality;
        else
          throw new Error("Only a PC with Physiker or an NPC can be rollPrimary on a Recover roll.");
        break;
      }
      case ke.ReduceHeat: {
        let o;
        if (s.rollPrimaryDoc) {
          const { parent: n } = s.rollPrimaryDoc;
          Kt.IsType(n) ? o = n : Te.IsType(n) && Kt.IsType(n.crew) && (o = n.crew);
        }
        if (!Kt.IsType(o))
          throw new Error(`Could not find crew for rollPrimary '${(a = s.rollPrimaryDoc) == null ? void 0 : a.rollPrimaryName}'`);
        if (o.system.heat.value === 0)
          throw new Error("Attempt to Reduce Heat for a Crew with no Heat.");
        break;
      }
      case void 0:
        break;
      default:
        throw new Error(`Unrecognized Roll Downtime Action: ${t.rollDowntimeAction}`);
    }
    return {
      rollPositionInitial: Ct.risky,
      rollEffectInitial: mt.standard,
      rollPosEffectTrade: !1,
      GMBoosts: {
        [H.tier]: 0,
        [H.quality]: 0,
        [H.scale]: 0,
        [H.magnitude]: 0
      },
      GMOppBoosts: {
        [H.tier]: 0,
        [H.quality]: 0,
        [H.scale]: 0,
        [H.magnitude]: 0
      },
      GMOverrides: {},
      rollFactorToggles: {
        source: {
          [H.tier]: {
            display: "",
            isActive: !1,
            isPrimary: !1,
            isDominant: !1,
            highFavorsPC: !0
          },
          [H.quality]: {
            display: "",
            isActive: !1,
            isPrimary: !1,
            isDominant: !1,
            highFavorsPC: !0
          },
          [H.scale]: {
            display: "",
            isActive: !1,
            isPrimary: !1,
            isDominant: !1,
            highFavorsPC: !0
          },
          [H.magnitude]: {
            display: "",
            isActive: !1,
            isPrimary: !1,
            isDominant: !1,
            highFavorsPC: !0
          }
        },
        opposition: {
          [H.tier]: {
            display: "",
            isActive: !1,
            isPrimary: !1,
            isDominant: !1,
            highFavorsPC: !0
          },
          [H.quality]: {
            display: "",
            isActive: !1,
            isPrimary: !1,
            isDominant: !1,
            highFavorsPC: !0
          },
          [H.scale]: {
            display: "",
            isActive: !1,
            isPrimary: !1,
            isDominant: !1,
            highFavorsPC: !0
          },
          [H.magnitude]: {
            display: "",
            isActive: !1,
            isPrimary: !1,
            isDominant: !1,
            highFavorsPC: !0
          }
        }
      },
      ...t,
      rollPrimaryData: s.data,
      rollOppData: t.rollOppData instanceof jt ? t.rollOppData.data : t.rollOppData
    };
  }
  static get DefaultRollModSchemaSet() {
    return [
      {
        key: "Push-positive-roll",
        name: "PUSH",
        section: ae.roll,
        base_status: se.ToggledOff,
        posNeg: "positive",
        modType: Re.general,
        value: 1,
        effectKeys: ["ForceOff-Bargain", "Cost-Stress2"],
        tooltip: "<h1>Push for +1d</h1><p>For <strong class='red-bright'>2 Stress</strong>, add <strong class='gold-bright'>1 die</strong> to your pool.</p><p><em>(You <strong>cannot</strong> also accept a <strong class='red-bright'>Devil's Bargain</strong> to increase your dice pool: It's one or the other.)</em></p>"
      },
      {
        key: "Bargain-positive-roll",
        name: "Bargain",
        section: ae.roll,
        base_status: se.Hidden,
        posNeg: "positive",
        modType: Re.general,
        value: 1,
        effectKeys: [],
        tooltip: "<h1 class='red-bright'>Devil's Bargain</h1><p>The GM has offered you a <strong class='red-bright'>Devil's Bargain</strong>.</p><p><strong class='red-bright'>Accept the terms</strong> to add <strong class='gold-bright'>1 die</strong> to your pool.</p><p><em>(You <strong>cannot</strong> also <strong>Push for +1d</strong> to increase your dice pool: It's one or the other.)</em></p>"
      },
      {
        key: "Assist-positive-roll",
        name: "Assist",
        section: ae.roll,
        base_status: se.Hidden,
        posNeg: "positive",
        modType: Re.teamwork,
        value: 1,
        tooltip: "<h1 class='gold-bright'>%DOC_NAME% Assists</h1><p><strong class='gold-bright'>%DOC_NAME%</strong> is <strong>Assisting</strong> your efforts, adding <strong class='gold-bright'>1 die</strong> to your pool.</p>"
      },
      {
        key: "Setup-positive-position",
        name: "Setup",
        section: ae.position,
        base_status: se.Hidden,
        posNeg: "positive",
        modType: Re.teamwork,
        value: 1,
        tooltip: "<h1 class='gold-bright'>%DOC_NAME% Sets You Up</h1><p><strong class='gold-bright'>%DOC_NAME%</strong> has set you up for success with a preceding <strong>Setup</strong> action, increasing your <strong class='gold-bright'>Position</strong> by one level.</p>"
      },
      {
        key: "Push-positive-effect",
        name: "PUSH",
        section: ae.effect,
        base_status: se.ToggledOff,
        posNeg: "positive",
        modType: Re.general,
        value: 1,
        effectKeys: ["Cost-Stress2"],
        tooltip: "<h1>Push for Effect</h1><p>For <strong class='red-bright'>2 Stress</strong>, increase your <strong class='gold-bright'>Effect</strong> by one level.</p>"
      },
      {
        key: "Setup-positive-effect",
        name: "Setup",
        section: ae.effect,
        base_status: se.Hidden,
        posNeg: "positive",
        modType: Re.teamwork,
        value: 1,
        tooltip: "<h1 class='gold-bright'>%DOC_NAME% Sets You Up</h1><p><strong class='gold-bright'>%DOC_NAME%</strong> has set you up for success with a preceding <strong>Setup</strong> action, increasing your <strong class='gold-bright'>Effect</strong> by one level.</p>"
      },
      {
        key: "Potency-positive-effect",
        name: "Potency",
        section: ae.effect,
        base_status: se.Hidden,
        posNeg: "positive",
        modType: Re.general,
        value: 1,
        tooltip: "<h1>Potency</h1><p>By circumstance or advantage, you have <strong>Potency</strong> in this action, increasing your <strong class='gold-bright'>Effect</strong> by one level.</p>"
      },
      {
        key: "Potency-negative-effect",
        name: "Potency",
        section: ae.effect,
        base_status: se.Hidden,
        posNeg: "negative",
        modType: Re.general,
        value: 1,
        tooltip: "<h1 class='red-bright'>Potency</h1><p>By circumstance or advantage, <strong class='red-bright'>@OPPOSITION_NAME@</strong> has <strong>Potency</strong> against you, reducing your <strong class='red-bright'>Effect</strong> by one level."
      }
    ];
  }
  /**
   * Asynchronously creates a new instance of this subclass of `BladesRoll`.
   *
   * Overrides the `New` static method from `BladesRoll`, applying subclass-specific configurations
   * to the instance creation process. It ensures that the returned instance is correctly typed
   * and configured for this subclass.
   *
   * @param {BladesRoll.Config} config The configuration object for creating a new roll instance,
   * extended with any subclass-specific configurations or requirements.
   *
   * @returns {Promise<InstanceType<this>>} A promise that resolves to an instance of this subclass.
   *
   * @see {@link BladesRoll.New} for the base method's functionality and the generic creation process
   * for roll instances.
   */
  static async New(e) {
    const t = this.BuildLinkConfig(e), s = {
      ...e,
      ...t
    };
    return await super.New(s);
  }
  get rollModsSchemaSets() {
    const e = super.rollModsSchemaSets;
    return this.rollPrimary.isWorsePosition && e.push({
      key: "WorsePosition-negative-position",
      name: "Worse Position",
      section: ae.position,
      base_status: se.ForcedOn,
      posNeg: "negative",
      modType: Re.general,
      value: 1,
      effectKeys: [],
      tooltip: "<h1>Worse Position</h1><p>A <strong class='red-bright'>Consequence</strong> on a previous roll has worsened your <strong>Position</strong>.</p>"
    }), this.acceptedConsequences.some((t) => t.type === Vt.ReducedEffect) && e.push({
      key: "ReducedEffect-negative-effect",
      name: "Reduced Effect",
      section: ae.effect,
      base_status: se.ForcedOn,
      posNeg: "negative",
      modType: Re.general,
      value: 1,
      effectKeys: [],
      tooltip: "<h1>Reduced Effect</h1><p>A <strong class='red-bright'>Consequence</strong> has worsened your <strong>Effect</strong>.</p>"
    }), e;
  }
  get collabTemplate() {
    return `systems/eunos-blades/templates/roll/roll-collab-action${game.user.isGM ? "-gm" : ""}.hbs`;
  }
  get chatTemplate() {
    const e = [
      "systems/eunos-blades/templates/chat/roll-result/action",
      this.rollClockKey ? "-clock" : ""
    ];
    return this.rollDowntimeAction && [
      ke.AcquireAsset,
      // action-acquireasset
      ke.ReduceHeat,
      //   action-reduceheat
      ke.Recover
      //       action-clock-recover
    ].includes(this.rollDowntimeAction) ? e.push(`-${w.lCase(this.rollDowntimeAction)}`) : this.rollSubType && [
      Na.GatherInfo
      //      action-gatherinfo
    ].includes(this.rollSubType) && e.push(`-${w.lCase(this.rollSubType)}`), e.push(".hbs"), e.join("");
  }
  get rollResult() {
    return this.isResolved ? this.isCritical ? Ue.critical : this.isSuccess ? Ue.success : this.isPartial ? Ue.partial : Ue.fail : !1;
  }
  async resolveRollResult() {
    var t, s;
    eLog.checkLog2("bladesRoll", "[BladesActionRoll] Costs", this.getRollCosts());
    const e = this.getRollCosts().filter((i) => i.costType === "Armor").length;
    if (this.rollPrimaryDoc instanceof Te) {
      const i = this.getRollCosts().filter((o) => o.costType === "Stress").reduce((o, n) => o + n.costAmount, 0);
      i !== 0 && this.rollPrimaryDoc.adjustStress(i), this.getRollCosts().filter((o) => o.costType === "SpecialArmor").length !== 0 && this.rollPrimaryDoc.spendSpecialArmor();
    }
    e !== 0 && this.rollPrimary.spendArmor(e), (t = this.getRollModByKey("WorsePosition-negative-position")) != null && t.isActive && ((s = this.rollPrimaryDoc) == null || s.unsetFlag("eunos-blades", "isWorsePosition"));
  }
}
class Hu extends zi {
  static ApplySchemaDefaults(e) {
    var t;
    if (!e.resistanceData || !$s.IsValidConsequenceData((t = e.resistanceData) == null ? void 0 : t.consequence))
      throw eLog.error("rollCollab", "[PrepareResistanceRoll] Bad Roll Consequence Data.", e), new Error("[PrepareResistanceRoll()] Bad Consequence Data for Resistance Roll");
    return e.rollTrait = e.resistanceData.consequence.attribute, eLog.checkLog3("bladesRoll", "BladesRoll.PrepareResistanceRoll() [1]", { config: e }), e;
  }
  /**
   * Asynchronously creates a new instance of this subclass of `BladesRoll`.
   *
   * Overrides the `New` static method from `BladesRoll`, applying subclass-specific configurations
   * to the instance creation process. It ensures that the returned instance is correctly typed
   * and configured for this subclass.
   *
   * @param {BladesRoll.Config} config The configuration object for creating a new roll instance,
   * extended with any subclass-specific configurations or requirements.
   *
   * @returns {Promise<InstanceType<this>>} A promise that resolves to an instance of this subclass.
   *
   * @see {@link BladesRoll.New} for the base method's functionality and the generic creation process
   * for roll instances.
   */
  static async New(e) {
    const t = this.BuildLinkConfig(e), s = {
      ...e,
      ...t
    };
    return await super.New(s);
  }
  get collabTemplate() {
    return `systems/eunos-blades/templates/roll/roll-collab-resistance${game.user.isGM ? "-gm" : ""}.hbs`;
  }
  get chatTemplate() {
    return "systems/eunos-blades/templates/chat/roll-result/resistance.hbs";
  }
  get stressCost() {
    if (!this.isResolved)
      return 0;
    const e = [...this.finalDieVals];
    return this.isCritical ? -1 : 6 - (e.shift() ?? 0);
  }
  get rollResult() {
    return this.isResolved ? this.stressCost : !1;
  }
  async resolveRollResult() {
    this.rollPrimaryDoc instanceof Te && this.stressCost !== 0 && this.rollPrimaryDoc.adjustStress(this.stressCost);
  }
}
class J1 extends Hu {
  get chatTemplate() {
    return "systems/eunos-blades/templates/chat/components/inline-resistance.hbs";
  }
}
class To extends zi {
  static ApplySchemaDefaults(e) {
    if (!(w.isInt(e.rollTrait) || w.lCase(e.rollTrait) in { ...js, ...Tt, ...H }))
      throw new Error(`[PrepareFortuneRoll()] Bad RollTrait for Fortune Roll: ${e.rollTrait}`);
    return e;
  }
  /**
   * Asynchronously creates a new instance of this subclass of `BladesRoll`.
   *
   * Overrides the `New` static method from `BladesRoll`, applying subclass-specific configurations
   * to the instance creation process. It ensures that the returned instance is correctly typed
   * and configured for this subclass.
   *
   * @param {BladesRoll.Config} config The configuration object for creating a new roll instance,
   * extended with any subclass-specific configurations or requirements.
   *
   * @returns {Promise<InstanceType<this>>} A promise that resolves to an instance of this subclass.
   *
   * @see {@link BladesRoll.New} for the base method's functionality and the generic creation process
   * for roll instances.
   */
  static async New(e) {
    const t = this.BuildLinkConfig(e), s = {
      ...e,
      ...t
    };
    return await super.New(s);
  }
}
class Wu extends zi {
  static ApplySchemaDefaults(e) {
    var a;
    const t = Me.GetDoc((a = e.rollPrimaryData) == null ? void 0 : a.rollPrimaryID);
    if (!t || !Te.IsType(t))
      throw new Error("[BladesRoll.PrepareIndulgeViceRollConfig] RollPrimary must be a PC for Indulge Vice rolls.");
    const { attributes: s } = t, i = Math.min(...Object.values(s));
    return e.rollTrait = w.sample(
      Object.values(Tt).filter((o) => s[o] === i)
    )[0], e.rollDowntimeAction = ke.IndulgeVice, e;
  }
  /**
   * Asynchronously creates a new instance of this subclass of `BladesRoll`.
   *
   * Overrides the `New` static method from `BladesRoll`, applying subclass-specific configurations
   * to the instance creation process. It ensures that the returned instance is correctly typed
   * and configured for this subclass.
   *
   * @param {BladesRoll.Config} config The configuration object for creating a new roll instance,
   * extended with any subclass-specific configurations or requirements.
   *
   * @returns {Promise<InstanceType<this>>} A promise that resolves to an instance of this subclass.
   *
   * @see {@link BladesRoll.New} for the base method's functionality and the generic creation process
   * for roll instances.
   */
  static async New(e) {
    const t = this.BuildLinkConfig(e), s = {
      ...e,
      ...t
    };
    return await super.New(s);
  }
  get collabTemplate() {
    return `systems/eunos-blades/templates/roll/roll-collab-indulgevice${game.user.isGM ? "-gm" : ""}.hbs`;
  }
  get chatTemplate() {
    return "systems/eunos-blades/templates/chat/roll-result/indulgevice.hbs";
  }
  get rollResult() {
    return this.isResolved ? this.highestDieVal : !1;
  }
  async resolveRollResult() {
    Te.IsType(this.rollPrimaryDoc) && this.rollPrimaryDoc.indulgeStress(this.highestDieVal);
  }
}
class Q1 extends To {
  static get DefaultRollModSchemaSet() {
    return [
      {
        key: "BoldPlan-positive-roll",
        name: "Bold Plan",
        section: ae.roll,
        base_status: se.ToggledOff,
        posNeg: "positive",
        modType: Re.general,
        value: 1,
        effectKeys: [],
        tooltip: "<h1></h1><p></p>"
      },
      {
        key: "ComplexPlan-negative-roll",
        name: "Complex Plan",
        section: ae.roll,
        base_status: se.ToggledOff,
        posNeg: "negative",
        modType: Re.general,
        value: 1,
        effectKeys: [],
        tooltip: "<h1></h1><p></p>"
      },
      {
        key: "ExploitWeakness-positive-roll",
        name: "Exploiting a Weakness",
        section: ae.roll,
        base_status: se.ToggledOff,
        posNeg: "positive",
        modType: Re.general,
        value: 1,
        effectKeys: [],
        tooltip: "<h1></h1><p></p>"
      },
      {
        key: "WellDefended-negative-roll",
        name: "Well-Defended",
        section: ae.roll,
        base_status: se.ToggledOff,
        posNeg: "negative",
        modType: Re.general,
        value: 1,
        effectKeys: [],
        tooltip: "<h1></h1><p></p>"
      },
      {
        key: "HelpFromFriend-positive-roll",
        name: "Help From a Friend",
        section: ae.position,
        base_status: se.ToggledOff,
        posNeg: "positive",
        modType: Re.general,
        value: 1,
        effectKeys: [],
        tooltip: "<h1>Help From a Friend</h1><p>Add <strong>+1d</strong> if you enlist the help of a friend or contact.</p>"
      },
      {
        key: "EnemyInterference-negative-roll",
        name: "Enemy Interference",
        section: ae.roll,
        base_status: se.ToggledOff,
        posNeg: "negative",
        modType: Re.general,
        value: 1,
        effectKeys: [],
        tooltip: "<h1></h1><p></p>"
      }
    ];
  }
  get chatTemplate() {
    return "systems/eunos-blades/templates/chat/roll-result/fortune-engagement.hbs";
  }
}
class eg extends To {
  get chatTemplate() {
    return "systems/eunos-blades/templates/chat/roll-result/fortune-incarceration.hbs";
  }
}
const Ws = zi;
class Le extends Item {
  constructor() {
    super(...arguments);
    J(this, "dialogCSSClasses", "");
  }
  // #region Static Overrides: Create ~
  static async create(t, s = {}) {
    return Array.isArray(t) && (t = t[0]), t.system = t.system ?? {}, eLog.checkLog2("item", "BladesItem.create(data,options)", { data: t, options: s }), t.system.world_name = t.system.world_name ?? t.name.replace(/[^A-Za-z_0-9 ]/g, "").trim().replace(/ /g, "_"), super.create(t, s);
  }
  // #endregion
  // #region BladesDocument Implementation
  static get All() {
    return game.items;
  }
  static Get(t) {
    return t instanceof Le ? t : w.isDocID(t) ? Le.All.get(t) : Le.All.find((s) => s.system.world_name === t) || Le.All.find((s) => s.name === t);
  }
  static GetTypeWithTags(t, ...s) {
    return Array.isArray(t) ? t.map((i) => Le.All.filter((a) => a.type === i)).flat() : Le.All.filter((i) => i.type === t).filter((i) => i.hasTag(...s));
  }
  static IsType(t, ...s) {
    const i = new Set(s);
    return t instanceof Le && i.has(t.type);
  }
  get tags() {
    return this.system.tags ?? [];
  }
  hasTag(...t) {
    return t.every((s) => this.tags.includes(s));
  }
  async addTag(...t) {
    const s = this.tags;
    t.forEach((i) => {
      s.includes(i) || s.push(i);
    }), await this.update({ "system.tags": s });
  }
  async remTag(...t) {
    const s = this.tags.filter((i) => !t.includes(i));
    await this.update({ "system.tags": s });
  }
  get tooltip() {
    const t = [
      this.system.concept,
      this.system.rules,
      this.system.notes
    ].filter(Boolean).join("");
    if (t)
      return new Handlebars.SafeString(t).toString();
  }
  getFactorTotal(t) {
    var s, i, a;
    switch (t) {
      case H.tier:
        return Le.IsType(this, A.cohort_gang) ? this.system.tier.value + (((s = this.parent) == null ? void 0 : s.getFactorTotal(H.tier)) ?? 0) : Le.IsType(this, A.cohort_expert) ? this.system.tier.value + (((i = this.parent) == null ? void 0 : i.getFactorTotal(H.tier)) ?? 0) : Le.IsType(this, A.gear) ? this.system.tier.value + (((a = this.parent) == null ? void 0 : a.getFactorTotal(H.tier)) ?? 0) : this.system.tier.value;
      case H.quality: {
        if (Le.IsType(this, A.cohort_gang))
          return this.getFactorTotal(H.tier) + (this.system.quality_bonus ?? 0);
        if (Le.IsType(this, A.cohort_expert))
          return this.getFactorTotal(H.tier) + (this.system.quality_bonus ?? 0) + 1;
        if (Le.IsType(this, A.gear)) {
          let o = this.getFactorTotal(H.tier) + (this.hasTag("Fine") ? 1 : 0);
          return Te.IsType(this.parent) && (o += this.parent.getTaggedItemBonuses(this.tags)), o;
        }
        return Le.IsType(this, A.design) ? this.system.min_quality : this.getFactorTotal(H.tier);
      }
      case H.scale:
        return Le.IsType(this, A.cohort_gang) ? this.getFactorTotal(H.tier) + (this.system.scale_bonus ?? 0) : Le.IsType(this, A.cohort_expert) ? 0 + (this.system.scale_bonus ?? 0) : 0;
      case H.magnitude:
        return Le.IsType(this, A.ritual) ? this.system.magnitude.value : 0;
      default:
        return 0;
    }
  }
  // #endregion
  // #region BladesItemDocument Implementation
  async archive() {
    return await this.addTag(he.System.Archived), this;
  }
  async unarchive() {
    return await this.remTag(he.System.Archived), this;
  }
  // #endregion
  // #region BladesRoll Implementation
  get rollFactors() {
    const t = {
      [A.cohort_gang]: [H.quality, H.scale],
      [A.cohort_expert]: [H.quality, H.scale],
      [A.gear]: [H.quality],
      [A.project]: [H.quality],
      [A.ritual]: [H.magnitude],
      [A.design]: [H.quality]
    };
    if (!t[this.type])
      return {};
    const s = t[this.type], i = {};
    return (s ?? []).forEach((a, o) => {
      const n = this.getFactorTotal(a);
      i[a] = {
        name: a,
        value: n,
        max: n,
        baseVal: n,
        display: [H.tier, H.quality].includes(a) ? w.romanizeNum(n) : `${n}`,
        isActive: o === 0,
        isPrimary: o === 0,
        isDominant: !1,
        highFavorsPC: !0,
        cssClasses: `factor-gold${o === 0 ? " factor-main" : ""}`
      };
    }), i;
  }
  // #region BladesRoll.PrimaryDoc Implementation
  get rollPrimaryID() {
    return this.id;
  }
  get rollPrimaryDoc() {
    return this;
  }
  get rollPrimaryName() {
    return this.name;
  }
  get rollPrimaryType() {
    if (![
      A.cohort_gang,
      A.cohort_expert,
      A.gm_tracker,
      A.score
    ].includes(this.type))
      throw new Error(`BladesItem of type '${this.type}' ("${this.name}") cannot be RollPrimary.`);
    return this.type;
  }
  get rollPrimaryImg() {
    return this.img;
  }
  get rollPrimaryModsSchemaSet() {
    return ki.ParseDocModsToSchemaSet(this);
  }
  async applyHarm(t, s) {
    if (Le.IsType(this, A.cohort_expert, A.cohort_gang)) {
      const i = this.system.harm.value;
      let a;
      t > i ? a = t : a = i + 1;
      const o = ["is Weakened", "is Impaired", "has been Broken", "has been Killed!"], n = [
        "They act with Reduced Effect.",
        "They act with Reduced Effect and suffer -1d to all rolls.",
        "They cannot do anything until they recover.",
        "You may replace them during Downtime."
      ];
      St.getInstance().pushNotice_SocketCall(
        "ALL",
        {
          title: `${this.name} ${o[a - 1]}`,
          body: n[a - 1],
          type: Ls.push,
          cssClasses: "harm-alert"
        }
      ), await this.update({ "system.harm": t });
    }
  }
  async applyWorsePosition() {
    Le.IsType(this, A.cohort_expert, A.cohort_gang) && this.setFlag("eunos-blades", "isWorsePosition", !0);
  }
  // #endregion
  // #region BladesRoll.OppositionDoc Implementation
  get rollOppID() {
    return this.id;
  }
  get rollOppDoc() {
    return this;
  }
  get rollOppImg() {
    return this.img;
  }
  get rollOppName() {
    return this.name;
  }
  get rollOppSubName() {
    return "";
  }
  get rollOppType() {
    if (![
      A.cohort_gang,
      A.cohort_expert,
      A.gm_tracker,
      A.score,
      A.location,
      A.project,
      A.design,
      A.ritual
    ].includes(this.type))
      throw new Error(`BladesItem of type '${this.type}' ("${this.name}") cannot be RollOpposition.`);
    return this.type;
  }
  get rollOppModsSchemaSet() {
    return [];
  }
  // #endregion
  // #region BladesRoll.ParticipantDoc Implementation
  get rollParticipantID() {
    return this.id;
  }
  get rollParticipantDoc() {
    return this;
  }
  get rollParticipantIcon() {
    return this.img;
  }
  get rollParticipantName() {
    return this.name;
  }
  get rollParticipantType() {
    if (![
      A.cohort_gang,
      A.cohort_expert,
      A.gm_tracker
    ].includes(this.type))
      throw new Error(`BladesItem of type '${this.type}' ("${this.name}") cannot be RollParticipant.`);
    return this.type;
  }
  get rollParticipantModsSchemaSet() {
    return [];
  }
  // #endregion
  // #endregion
  // #region PREPARING DERIVED DATA
  prepareDerivedData() {
    super.prepareDerivedData(), Le.IsType(this, A.cohort_gang, A.cohort_expert) && this._prepareCohortData(this.system), Le.IsType(this, A.crew_playbook) && this._preparePlaybookData(this.system), Le.IsType(this, A.gear) && this._prepareGearData(this.system), Le.IsType(this, A.playbook) && this._preparePlaybookData(this.system);
  }
  _prepareCohortData(t) {
    if (!Le.IsType(this, A.cohort_gang, A.cohort_expert))
      return;
    t.tier.name = "Quality";
    const s = w.unique(Object.values(t.subtypes).map((a) => a.trim()).filter((a) => /[A-Za-z]/.test(a))), i = [
      ...Object.values(t.elite_subtypes)
    ];
    if (Kt.IsType(this.parent) && i.push(
      ...this.parent.upgrades.filter((a) => (a.name ?? "").startsWith("Elite")).map((a) => (a.name ?? "").trim().replace(/^Elite /, ""))
    ), t.subtypes = Object.fromEntries(s.map((a, o) => [`${o + 1}`, a])), t.elite_subtypes = Object.fromEntries(
      w.unique(
        i.map((a) => a.trim()).filter((a) => /[A-Za-z]/.test(a) && s.includes(a))
      ).map((a, o) => [`${o + 1}`, a])
    ), t.edges = Object.fromEntries(Object.values(t.edges ?? []).filter((a) => /[A-Za-z]/.test(a)).map((a, o) => [`${o + 1}`, a.trim()])), t.flaws = Object.fromEntries(Object.values(t.flaws ?? []).filter((a) => /[A-Za-z]/.test(a)).map((a, o) => [`${o + 1}`, a.trim()])), t.quality = this.getFactorTotal(H.quality), Le.IsType(this, A.cohort_gang)) {
      if ([...s, ...i].includes(he.GangType.Vehicle))
        t.scale = this.getFactorTotal(H.scale), t.scaleExample = "(1 vehicle)";
      else {
        t.scale = this.getFactorTotal(H.scale);
        const a = Math.min(6, t.scale);
        t.scaleExample = X.ScaleExamples[a], t.subtitle = X.ScaleSizes[a];
      }
      s.length + i.length === 0 && (t.subtitle = t.subtitle.replace(/\s+of\b/g, "").trim());
    } else
      t.scale = 0, t.scaleExample = [...s, ...i].includes("Pet") ? "(1 animal)" : "(1 person)", t.subtitle = "An Expert";
    s.length + i.length > 0 && ([...s, ...i].includes(he.GangType.Vehicle) ? t.subtitle = X.VehicleDescriptors[Math.min(6, this.getFactorTotal(H.tier))] : t.subtitle += ` ${w.oxfordize([
      ...s.filter((a) => !i.includes(a)),
      ...i.map((a) => `Elite ${a}`)
    ], !1, "&")}`);
  }
  _prepareGearData(t) {
    Le.IsType(this, A.gear) && (t.tier.name = "Quality");
  }
  _preparePlaybookData(t) {
    if (!Le.IsType(this, A.playbook, A.crew_playbook))
      return;
    const s = {};
    if ([...Object.values(t.experience_clues).filter((i) => /[A-Za-z]/.test(i)), " "].forEach((i, a) => {
      s[(a + 1).toString()] = i;
    }), t.experience_clues = s, Le.IsType(this, A.playbook)) {
      const i = {};
      [...Object.values(t.gather_info_questions).filter((a) => /[A-Za-z]/.test(a)), " "].forEach((a, o) => {
        i[(o + 1).toString()] = a;
      }), t.gather_info_questions = i;
    }
  }
  // #endregion
  // Unlock lower-level update method for subclasses
  async callOnUpdate(...t) {
    await this._onUpdate(...t);
  }
}
const Z = Le, zs = {}, _a = {
  addItem: async (r, e, t, s = !1) => {
    if (eLog.checkLog("activeEffects", "addItem", { actor: r, funcData: e, isReversing: s }), r.hasActiveSubItemOf(e)) {
      if (s)
        return r.remSubItem(e);
    } else if (!s)
      return r.addSubItem(e);
  },
  addIfChargen: async (r, e, t, s = !1) => {
    var o;
    if (eLog.checkLog("activeEffects", "addIfChargen", { actor: r, funcData: e, isReversing: s }), !s && ((o = game.eunoblades.Tracker) == null ? void 0 : o.system.phase) !== $e.CharGen)
      return;
    const [i, a] = e.split(/:/);
    if (s) {
      await r.update({ [i]: w.pInt(getProperty(r, i)) - w.pInt(a) });
      return;
    }
    await r.update({ [i]: w.pInt(getProperty(r, i)) + w.pInt(a) });
  },
  upgradeIfChargen: async (r, e, t, s = !1) => {
    var o;
    if (eLog.checkLog("activeEffects", "upgradeIfChargen", { actor: r, funcData: e, isReversing: s }), !s && ((o = game.eunoblades.Tracker) == null ? void 0 : o.system.phase) !== $e.CharGen)
      return;
    const [i, a] = e.split(/:/);
    getProperty(r, i) < w.pInt(a) && await r.update({ [i]: w.pInt(a) });
  },
  APPLYTOMEMBERS: async () => {
  },
  APPLYTOCOHORTS: async () => {
  },
  remItem: async (r, e, t, s = !1) => {
    function i(a, o) {
      return o.startsWith("rX") ? new RegExp(o.replace(/^rX:\/(.*?)\//, "$1")).test(a) : a === o;
    }
    if (e.startsWith("{")) {
      if (s) {
        console.error("Cannot reverse a 'remItem' custom effect that was defined with a JSON object.");
        return;
      }
      const { type: a, tags: o, name: n } = JSON.parse(e);
      let l = r.activeSubItems;
      if (l.length === 0 || (n && (l = l.filter((c) => i(c.name, n))), l.length === 0) || (a && (l = l.filter((c) => i(c.type, a))), l.length === 0) || (o && (l = l.filter((c) => c.hasTag(...o))), l.length === 0))
        return;
      eLog.checkLog("activeEffects", "remItem - JSON OBJECT", { actor: r, funcData: JSON.parse(e), isReversing: s, activeSubItems: l }), l.forEach((c) => r.remSubItem(c));
    }
    if (eLog.checkLog("activeEffects", "remItem", { actor: r, funcData: e, isReversing: s }), r.hasActiveSubItemOf(e))
      return r.remSubItem(e);
    if (s)
      return r.addSubItem(e);
  }
};
class ms extends ActiveEffect {
  static Initialize() {
    CONFIG.ActiveEffect.documentClass = ms, Hooks.on("preCreateActiveEffect", async (e) => {
      var i;
      if (eLog.checkLog3("effect", "PRECREATE ActiveEffect", { effect: e, parent: (i = e.parent) == null ? void 0 : i.name }), !(e.parent instanceof oe))
        return;
      if (e.changes.some((a) => a.key === "APPLYTOMEMBERS")) {
        if (oe.IsType(e.parent, z.pc) && oe.IsType(e.parent.crew, z.crew)) {
          const a = e.parent.crew.members.filter((o) => {
            var n;
            return o.id !== ((n = e.parent) == null ? void 0 : n.id);
          });
          a.length > 0 && (e.changes = e.changes.filter((o) => o.key !== "APPLYTOMEMBERS"), await Promise.all(a.map(async (o) => o.createEmbeddedDocuments("ActiveEffect", [e.toJSON()]))), await e.parent.setFlag("eunos-blades", `memberEffects.${e.id}`, {
            appliedTo: a.map((o) => o.id),
            effect: e.toJSON()
          }));
        } else if (oe.IsType(e.parent, z.crew)) {
          const a = w.pullElement(e.changes, (o) => o.key === "APPLYTOMEMBERS");
          if (!a)
            return;
          e.parent.members.length > 0 && await Promise.all(e.parent.members.map(async (o) => o.createEmbeddedDocuments("ActiveEffect", [e.toJSON()]))), await e.parent.setFlag("eunos-blades", `memberEffects.${e.id}`, {
            appliedTo: e.parent.members.map((o) => o.id),
            effect: e
          }), await e.updateSource({ changes: [a] });
        }
      } else
        e.changes.some((a) => a.key === "APPLYTOCOHORTS") && (oe.IsType(e.parent, z.pc) || oe.IsType(e.parent, z.crew)) && (e.parent.cohorts.length > 0 && await Promise.all(e.parent.cohorts.map(async (a) => a.createEmbeddedDocuments("ActiveEffect", [e.toJSON()]))), await e.parent.setFlag("eunos-blades", `cohortEffects.${e.id}`, {
          appliedTo: e.parent.cohorts.map((a) => a.id),
          effect: e
        }), await e.updateSource({ changes: e.changes.filter((a) => a.key === "APPLYTOCOHORTS") }));
      const [t, s] = w.partition(e.changes, (a) => a.key.startsWith("perm"));
      await e.updateSource({ changes: s });
      for (const a of t) {
        const { key: o, value: n } = a, l = o.replace(/^perm/, "");
        if (l in _a) {
          const c = {
            funcName: l,
            funcData: n,
            isReversing: !1,
            effect: e
          };
          ms.ThrottleCustomFunc(e.parent, c);
        } else if (l === "Add") {
          const [c, u] = n.split(/:/);
          e.parent.update({ [c]: w.pInt(getProperty(e.parent, c)) + w.pInt(u) });
        }
      }
    }), Hooks.on("applyActiveEffect", (e, t) => {
      if (e instanceof oe && t.key in _a) {
        const s = {
          funcName: t.key,
          funcData: t.value,
          isReversing: !1,
          effect: t.effect
        };
        ms.ThrottleCustomFunc(e, s);
      }
    }), Hooks.on("updateActiveEffect", (e, { disabled: t }) => {
      if (!(e.parent instanceof oe))
        return;
      e.changes.filter((i) => i.mode === 0).forEach(({ key: i, value: a }) => {
        const o = {
          funcName: i,
          funcData: a,
          isReversing: t,
          effect: e
        };
        ms.ThrottleCustomFunc(e.parent, o);
      });
    }), Hooks.on("deleteActiveEffect", async (e) => {
      if (!(e.parent instanceof oe))
        return;
      if (e.changes.some((s) => s.key === "APPLYTOMEMBERS"))
        if (oe.IsType(e.parent, z.pc) && oe.IsType(e.parent.crew, z.crew)) {
          const s = e.parent.crew.members.filter((i) => {
            var a;
            return i.id !== ((a = e.parent) == null ? void 0 : a.id);
          });
          s.length > 0 && await Promise.all(s.map(async (i) => Promise.all(i.effects.filter((a) => a.name === e.name).map(async (a) => a.delete())))), await e.parent.unsetFlag("eunos-blades", `memberEffects.${e.id}`);
        } else
          oe.IsType(e.parent, z.crew) && (e.parent.members.length > 0 && await Promise.all(e.parent.members.map(async (s) => Promise.all(s.effects.filter((i) => i.name === e.name).map(async (i) => i.delete())))), await e.parent.unsetFlag("eunos-blades", `memberEffects.${e.id}`));
      else
        e.changes.some((s) => s.key === "APPLYTOCOHORTS") && oe.IsType(e.parent, z.pc, z.crew) && (e.parent.cohorts.length > 0 && await Promise.all(e.parent.cohorts.map(async (s) => Promise.all(s.effects.filter((i) => i.name === e.name).map(async (i) => i.delete())))), await e.parent.unsetFlag("eunos-blades", `cohortEffects.${e.id}`));
      e.changes.filter((s) => s.mode === 0).forEach(({ key: s, value: i }) => {
        const a = {
          funcName: s,
          funcData: i,
          isReversing: !0,
          effect: e
        };
        ms.ThrottleCustomFunc(e.parent, a);
      });
    });
  }
  static async AddActiveEffect(e, t, s, i = "systems/eunos-blades/assets/icons/effect-icons/default.png") {
    const a = [s].flat();
    await e.createEmbeddedDocuments("ActiveEffect", [{ name: t, icon: i, changes: a }]);
  }
  static ThrottleCustomFunc(e, t) {
    const { funcName: s, funcData: i, isReversing: a, effect: o } = t;
    if (e.id) {
      if (eLog.checkLog3("activeEffect", `Throttling Func: ${s}(${i}, ${a})`), e.id && e.id in zs) {
        const n = zs[e.id].queue.find((l) => JSON.stringify(l) === JSON.stringify(t));
        if (eLog.checkLog("activeEffects", "... Checking Queue", { data: t, FUNCQUEUE: zs[e.id], matchingQueue: n }), n) {
          eLog.error("... Function ALREADY QUEUED, SKIPPING");
          return;
        }
        zs[e.id].queue.push(t);
        return;
      }
      eLog.checkLog3("activeEffect", "... Creating New FUNCQUEUE, RUNNING:"), zs[e.id] = {
        curFunc: ms.RunCustomFunc(e, _a[s](e, i, o, a)),
        queue: []
      };
    }
  }
  static async RunCustomFunc(e, t) {
    if (e.id)
      if (eLog.checkLog("activeEffects", "... Running Func ..."), await t, eLog.checkLog("activeEffects", "... Function Complete!"), zs[e.id].queue.length) {
        const { funcName: s, funcData: i, isReversing: a, effect: o } = zs[e.id].queue.shift() ?? {};
        if (!s || !(s in _a) || !i)
          return;
        eLog.checkLog3("activeEffect", `Progressing Queue: ${s}(${i}, ${a}) -- ${zs[e.id].queue.length} remaining funcs.`), zs[e.id].curFunc = ms.RunCustomFunc(
          e,
          _a[s](e, i, o, a)
        );
      } else
        eLog.checkLog3("activeEffect", "Function Queue Complete! Deleting."), delete zs[e.id];
  }
  /**
   * Manage Active Effect instances through the Actor Sheet via effect control buttons.
   * @param {MouseEvent} event      The left-click event on the effect control
   * @param {Actor|Item} owner      The owning entity which manages this effect
   */
  static onManageActiveEffect(e, t) {
    var o;
    e.preventDefault();
    const s = e.currentTarget;
    if (s.dataset.action === "create")
      return t.createEmbeddedDocuments("ActiveEffect", [{
        name: t.name,
        icon: t.img,
        origin: t.uuid
      }]);
    const i = s.closest("tr");
    if (i === null)
      return null;
    const a = i.dataset.effectId ? t.effects.get(i.dataset.effectId) : null;
    if (!a)
      return null;
    switch (s.dataset.action) {
      case "edit":
        return (o = a.sheet) == null ? void 0 : o.render(!0);
      case "delete":
        return eLog.checkLog("activeEffects", "delete effect"), a.delete();
      case "toggle":
        return a.update({ disabled: !a.disabled });
      default:
        return null;
    }
  }
  async _preCreate(e, t, s) {
    eLog.checkLog3("effect", "ActiveEffect._preCreate()", { data: e, options: t, user: s }), await super._preCreate(e, t, s);
  }
  _onDelete(e, t) {
    eLog.checkLog3("effect", "ActiveEffect._onDelete()", { options: e, userID: t }), super._onDelete(e, t);
  }
  get isSuppressed() {
    if (!/Actor.*Item/.test(this.origin))
      return super.isSuppressed;
    const [e, t] = this.origin.replace(/Actor\.|Item\./g, "").split("."), i = game.actors.get(e).items.get(t);
    return super.isSuppressed || (i == null ? void 0 : i.hasTag(he.System.Archived));
  }
}
const h3 = (r, e, t) => {
  const s = r.target.value;
  if (s) {
    const i = JSON.parse(s).map(({ value: a }) => a);
    e.update({ [t]: i });
  } else
    e.update({ [t]: [] });
}, tg = {
  InitListeners: (r, e) => {
    function t(o, n) {
      const l = new Vg(o, {
        enforceWhitelist: !0,
        editTags: !1,
        whitelist: Object.entries(n).map(([p, h]) => h.map((m) => ({
          value: new Handlebars.SafeString(m).toString(),
          "data-group": p
        }))).flat(),
        dropdown: {
          enabled: 0,
          maxItems: 1e4,
          placeAbove: !1,
          appendTarget: r[0]
        }
      });
      l.dropdown.createListHTML = (p) => {
        const h = {};
        return structuredClone(p).map((m) => {
          const y = l.dropdown.getMappedValue.call(
            l,
            m
          );
          let k = "";
          return h[m["data-group"]] || (h[m["data-group"]] = !0, Object.keys(h).length && (k += "</div>"), k += `
                <div class="tagify__dropdown__itemsGroup">
                <h3>${m["data-group"]}</h3>
              `), m.value = y && typeof y == "string" ? w.escapeHTML(y) : y, k += l.settings.templates.dropdownItem.apply(
            l,
            [m]
          ), k;
        }).join("");
      };
      function c(p) {
        for (const [h, m] of Object.entries(n))
          if (m.includes(p))
            return h;
        return !1;
      }
      const u = $(o).data("tagTarget") ?? "system.tags", g = [getProperty(e, u) ?? []].flat().filter(Boolean);
      l.addTags(
        g.filter(c).map((p) => ({
          value: new Handlebars.SafeString(p).toString(),
          "data-group": c(p)
        })),
        !0,
        !0
      ), setTimeout(() => o.addEventListener("change", (p) => {
        h3(p, e, u);
      }), 1e3);
    }
    const s = {
      "System Tags": Object.values(he.System),
      "Gear Tags": [
        ...Object.values(he.Gear),
        ...Object.values(he.GearCategory)
      ],
      "Actor Tags": [
        ...Object.values(he.PC),
        ...Object.values(he.NPC)
      ],
      Vices: Object.values(M0),
      Playbooks: Object.values(Ba),
      Inventions: Object.values(he.Invention),
      "Gang Types": Object.values(he.GangType)
    }, i = {
      "City Districts": Object.values(I0),
      "Other Districts": Object.values(P0)
    }, a = { Factions: game.actors.filter((o) => o.type === z.faction && o.name !== null).map((o) => o.name) };
    $(r).find(".tags-gm").each((o, n) => t(n, s)), $(r).find(".tags-district").each((o, n) => t(n, i)), $(r).find(".tags-faction").each((o, n) => t(n, a));
  }
};
class ua extends ItemSheet {
  constructor() {
    super(...arguments);
    J(this, "_getTypedItemData", {
      [A.ability]: (t) => Z.IsType(this.item, A.ability) ? {
        ...t,
        ...{}
      } : void 0,
      [A.background]: (t) => Z.IsType(this.item, A.background) ? {
        ...t,
        ...{}
      } : void 0,
      [A.clock_keeper]: (t) => {
        if (!Z.IsType(this.item, A.clock_keeper))
          return;
        const s = {
          phases: Object.values($e)
        };
        return {
          ...t,
          ...s
        };
      },
      [A.cohort_gang]: (t) => {
        var i, a;
        if (!Z.IsType(this.item, A.cohort_gang, A.cohort_expert))
          return;
        t.tierTotal = this.item.system.quality > 0 ? w.romanizeNum(this.item.system.quality) : "0", (i = t.system).subtypes ?? (i.subtypes = {}), (a = t.system).elite_subtypes ?? (a.elite_subtypes = {});
        const s = {
          tierData: {
            class: "comp-tier comp-vertical comp-teeth",
            dotline: {
              data: this.item.system.tier,
              target: "system.tier.value",
              iconEmpty: "dot-empty.svg",
              iconEmptyHover: "dot-empty-hover.svg",
              iconFull: "dot-full.svg",
              iconFullHover: "dot-full-hover.svg"
            }
          }
        };
        return s.edgeData = Object.fromEntries(Object.values(t.system.edges ?? []).filter((o) => /[A-Za-z]/.test(o)).map((o) => [o.trim(), X.EdgeTooltips[o]])), s.flawData = Object.fromEntries(Object.values(t.system.flaws ?? []).filter((o) => /[A-Za-z]/.test(o)).map((o) => [o.trim(), X.FlawTooltips[o]])), {
          ...t,
          ...s
        };
      },
      [A.cohort_expert]: (t) => {
        const s = this._getTypedItemData[A.cohort_gang];
        if (!s)
          throw new Error(`No data for type ${this.item.type}`);
        return s(t);
      },
      [A.crew_ability]: (t) => Z.IsType(this.item, A.crew_ability) ? {
        ...t,
        ...{}
      } : void 0,
      [A.crew_reputation]: (t) => Z.IsType(this.item, A.crew_reputation) ? {
        ...t,
        ...{}
      } : void 0,
      [A.crew_playbook]: (t) => {
        if (!Z.IsType(this.item, A.crew_playbook))
          return;
        if (t.isGM) {
          const i = {};
          [...Object.values(t.system.experience_clues ?? []).filter((a) => /[A-Za-z]/.test(a)), " "].forEach((a, o) => {
            i[(o + 1).toString()] = a;
          }), t.system.experience_clues = i;
        }
        return {
          ...t,
          ...{}
        };
      },
      [A.crew_upgrade]: (t) => Z.IsType(this.item, A.crew_upgrade) ? {
        ...t,
        ...{}
      } : void 0,
      [A.feature]: (t) => Z.IsType(this.item, A.feature) ? {
        ...t,
        ...{}
      } : void 0,
      [A.gm_tracker]: (t) => {
        if (!Z.IsType(this.item, A.gm_tracker))
          return;
        const s = {
          phase: this.item.system.phase,
          phases: Object.values($e)
        };
        return {
          ...t,
          ...s
        };
      },
      [A.heritage]: (t) => Z.IsType(this.item, A.heritage) ? {
        ...t,
        ...{}
      } : void 0,
      [A.gear]: (t) => {
        if (!Z.IsType(this.item, A.gear))
          return;
        const s = {
          tierData: {
            class: "comp-tier comp-vertical comp-teeth",
            label: "Quality",
            labelClass: "filled-label full-width",
            dotline: {
              data: this.item.system.tier,
              target: "system.tier.value",
              iconEmpty: "dot-empty.svg",
              iconEmptyHover: "dot-empty-hover.svg",
              iconFull: "dot-full.svg",
              iconFullHover: "dot-full-hover.svg"
            }
          }
        };
        return {
          ...t,
          ...s
        };
      },
      [A.playbook]: (t) => {
        if (!Z.IsType(this.item, A.playbook))
          return;
        if (t.isGM) {
          const i = {};
          [...Object.values(t.system.experience_clues ?? []).filter((o) => /[A-Za-z]/.test(o)), " "].forEach((o, n) => {
            i[(n + 1).toString()] = o;
          }), t.system.experience_clues = i;
          const a = {};
          [...Object.values(t.system.gather_info_questions ?? []).filter((o) => /[A-Za-z]/.test(o)), " "].forEach((o, n) => {
            a[(n + 1).toString()] = o;
          }), t.system.gather_info_questions = a;
        }
        return {
          ...t,
          ...{}
        };
      },
      [A.preferred_op]: (t) => Z.IsType(this.item, A.preferred_op) ? {
        ...t,
        ...{}
      } : void 0,
      [A.stricture]: (t) => Z.IsType(this.item, A.stricture) ? {
        ...t,
        ...{}
      } : void 0,
      [A.vice]: (t) => Z.IsType(this.item, A.vice) ? {
        ...t,
        ...{}
      } : void 0,
      [A.ritual]: (t) => Z.IsType(this.item, A.ritual) ? {
        ...t,
        ...{}
      } : void 0,
      [A.design]: (t) => Z.IsType(this.item, A.design) ? {
        ...t,
        ...{}
      } : void 0,
      [A.location]: (t) => Z.IsType(this.item, A.location) ? {
        ...t,
        ...{}
      } : void 0,
      [A.score]: (t) => {
        if (Z.IsType(this.item, A.score))
          return t;
      }
    });
  }
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "item"],
      width: 560,
      height: 500,
      tabs: [{ navSelector: ".sheet-tabs", contentSelector: ".sheet-body", initial: "description" }]
    });
  }
  /* -------------------------------------------- */
  // constructor(item: BladesItem, options: Partial<ItemSheet.Options> = {}) {
  //   options.classes = [...options.classes ?? [], "eunos-blades", "sheet", "item", item.type];
  //   super(item, options);
  // }
  // override async getData() {
  getData() {
    var a;
    const t = super.getData(), s = {
      cssClass: this.item.type,
      editable: this.options.editable,
      isGM: (a = game.eunoblades.Tracker) != null && a.system.is_spoofing_player ? !1 : !!game.user.isGM,
      isEmbeddedItem: !!this.item.parent,
      item: this.item,
      system: this.item.system,
      tierTotal: this.item.getFactorTotal(H.tier) > 0 ? w.romanizeNum(this.item.getFactorTotal(H.tier)) : "0",
      activeEffects: Array.from(this.item.effects)
    }, i = this._getTypedItemData[this.item.type];
    return i ? i({ ...t, ...s }) : {
      ...t,
      ...s
    };
  }
  get template() {
    const t = [
      "systems/eunos-blades/templates/items"
    ];
    return X.SimpleItemTypes.includes(this.item.type) ? t.push("simple-sheet.hbs") : t.push(`${this.item.type}-sheet.hbs`), t.join("/");
  }
  /* -------------------------------------------- */
  addDotlineListeners(t) {
    t.find(".dotline").each((s, i) => {
      if ($(i).hasClass("locked"))
        return;
      const a = this.item, o = $(i).data("target"), n = $(i).closest("comp"), l = w.pInt($(i).data("value"));
      $(i).find(".dot").each((c, u) => {
        $(u).on("click", (g) => {
          g.preventDefault();
          const p = w.pInt($(u).data("value"));
          p !== l && (n.hasClass("comp-coins") || n.hasClass("comp-stash") ? Qa.effects.fillCoins($(u).prevAll(".dot")).then(() => a.update({ [o]: p })) : a.update({ [o]: p }));
        }), $(u).on("contextmenu", (g) => {
          g.preventDefault();
          const p = w.pInt($(u).data("value")) - 1;
          p !== l && a.update({ [o]: p });
        });
      });
    });
  }
  async activateListeners(t) {
    await super.activateListeners(t);
    const s = this;
    tg.InitListeners(t, this.item), oa(t), this.options.editable && (this.addDotlineListeners(t), Z.IsType(this.item, A.cohort_expert, A.cohort_gang) && t.find("[data-harm-click]").on({
      click: (i) => {
        var o;
        i.preventDefault();
        const a = w.pInt($(i.currentTarget).data("harmClick"));
        ((o = this.item.system.harm) == null ? void 0 : o.value) !== a && this.item.update({ "system.harm.value": a });
      },
      contextmenu: (i) => {
        var o;
        i.preventDefault();
        const a = Math.max(0, w.pInt($(i.currentTarget).data("harmClick")) - 1);
        ((o = this.item.system.harm) == null ? void 0 : o.value) !== a && this.item.update({ "system.harm.value": a });
      }
    }), this.options.submitOnChange && t.on("change", "textarea", this._onChangeInput.bind(this)), t.find(".effect-control").on("click", (i) => {
      var a;
      if (s.item.isOwned) {
        (a = ui.notifications) == null || a.warn(game.i18n.localize("BITD.EffectWarning"));
        return;
      }
      ms.onManageActiveEffect(i, s.item);
    }), t.find('[data-action="toggle-turf-connection"').on("click", this.toggleTurfConnection.bind(this)));
  }
  toggleTurfConnection(t) {
    const i = $(t.currentTarget).parent(), a = parseInt(i.data("index") ?? 0, 10), o = i.data("dir");
    if (!a || !o)
      return;
    const n = i.hasClass("no-connect"), l = {
      [`system.turfs.${a}.connects.${o}`]: n
    }, c = i.data("partner");
    if (typeof c == "string" && /-/.test(c)) {
      const [u, g] = c.split("-");
      l[`system.turfs.${u}.connects.${g}`] = n;
    }
    this.item.update(l);
  }
}
class l0 extends ua {
  constructor() {
    super(...arguments);
    J(this, "_htmlContext");
  }
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "item", "project-sheet"],
      template: "systems/eunos-blades/templates/items/project-sheet.hbs"
    });
  }
  getData() {
    const t = super.getData(), s = {};
    return s.presentingClock = this.presentedClock, {
      ...t,
      ...s
    };
  }
  get presentedClock() {
    const { clockKey: t } = this.document;
    if (!t)
      throw new Error(`ClockKey not initialized for Project ${this.document.name}`);
    let s;
    if (w.isInt(t.displayMode))
      s = t.displayMode;
    else if (t.displayMode === Pt.presentCurrentClock)
      s = this.document.currentClock.index;
    else if (t.displayMode.startsWith("present"))
      s = w.pInt(t.displayMode.slice(7));
    else
      return !1;
    return this.document.clockKey.getClockByIndex(s) ?? !1;
  }
  getClockKeyComponents(t) {
    const { clockKey: s } = this.document;
    if (!s)
      throw new Error(`ClockKey not initialized for Project ${this.document.name}`);
    return {
      clockKey: s,
      keyElems$: s.getElements$(t.find(".clock-key-panel"))
    };
  }
  switchToPresentAllClocks(t, s) {
    const { clocks: i } = s, a = t.switchToMode(s, Pt.clocks);
    t.size > 1 && t.visibleClocks.forEach((o, n) => {
      const { clockLabel$: l } = i[o.id];
      a.blurReveal(l, n === 0 ? ">" : "<+0.05");
    }), a.play().then(() => {
      this._htmlContext && this.document.currentClock && this._htmlContext.find(".sheet-subtitle").attr("data-action", "current-clock-name").val(this.document.currentClock.name);
    });
  }
  switchToPresentClock(t, s, i) {
    const a = s.switchToMode(
      i,
      t === Pt.presentCurrentClock ? t : `present${t}`,
      void 0,
      void 0,
      !0,
      () => {
        eLog.checkLog3("BladesProject", "Clock Switch", { clockRef: t, clockKey: s, keyElems$: i, htmlContext: this._htmlContext, presentedClock: this.presentedClock }), this._htmlContext && this.presentedClock && this._htmlContext.find(".sheet-subtitle").attr("data-action", "presented-clock-name").val(this.presentedClock.name);
      }
    );
    a.to(i.container$.find(".clock-label, .clock-key-label"), { autoAlpha: 0, duration: 0.5, ease: "sine" }, 0), a.play().then();
  }
  activateClockKeyListeners(t, s) {
    eLog.checkLog2("BladesProject", "Clock Key Data", { clockKey: t, keyElems$: s });
    const { container$: i } = s;
    i.css("pointer-events", "auto"), i.on("contextmenu", () => {
      this.switchToPresentAllClocks(t, s);
    }), Object.entries(s.clocks).forEach(([a, o]) => {
      o.clockContainer$.css("pointer-events", "auto"), o.clockContainer$.on("click", () => {
        var n;
        this.switchToPresentClock(
          ((n = t.clocks.get(a)) == null ? void 0 : n.index) ?? Pt.presentCurrentClock,
          t,
          s
        );
      });
    });
  }
  async activateListeners(t) {
    this._htmlContext = t, await super.activateListeners(t);
    const { clockKey: s, keyElems$: i } = this.getClockKeyComponents(t);
    t.find("input.sheet-subtitle").on({
      change: (a) => {
        a.preventDefault();
        const o = $(a.currentTarget).data("action");
        eLog.checkLog3("BladesProject", "Clock Name Change", { action: o, value: $(a.currentTarget).val() }), o === "presented-clock-name" && this.presentedClock ? (this.presentedClock.updateTarget("name", $(a.currentTarget).val()), i.clocks[this.presentedClock.id].clockLabel$.text($(a.currentTarget).val())) : o === "current-clock-name" && (this.document.clockKey.currentClock.updateTarget("name", $(a.currentTarget).val()), i.clocks[this.document.clockKey.currentClock.id].clockLabel$.text($(a.currentTarget).val())), s.formatLabels(i);
      }
    }), s.initElementsInContext(t), this.activateClockKeyListeners(s, i), await Promise.all([
      ...s.visibleClocks.map((a) => new Promise((o) => {
        const n = i.clocks[a.id];
        a.reveal_Animation(n, () => {
          o();
        });
      })),
      ...s.activeClocks.map((a) => new Promise((o) => {
        const n = i.clocks[a.id];
        a.activate_Animation(n, () => {
          o();
        });
      }))
    ]);
  }
}
class ju extends Z {
  constructor() {
    super(...arguments);
    J(this, "_clockKey");
  }
  // #region INITIALIZATION ~
  static async Initialize() {
    return Object.assign(globalThis, { BladesProject: ju, BladesProjectSheet: l0 }), Items.registerSheet("blades", l0, { types: ["project"], makeDefault: !0 }), loadTemplates(["systems/eunos-blades/templates/items/project-sheet.hbs"]);
  }
  // #endregion
  static IsType(t) {
    return super.IsType(t, A.project);
  }
  static async create(t, s = {}) {
    const i = await super.create(t, { ...s, renderSheet: !1 });
    return i._clockKey || (i._clockKey = await Ft.Create({
      name: i.name,
      target: i,
      targetKey: "system.clocksData",
      isNameVisible: !1,
      isSpotlit: !1,
      isVisible: !0,
      displayMode: Pt.clocks
      // oneKeyIndex: U.gsap.utils.random(0, 4, 1) as OneKeyImgIndex
    }, void 0, [{
      name: "",
      index: 0,
      color: Yt.yellow,
      value: 0,
      max: 8,
      isVisible: !0,
      isActive: !0,
      isNameVisible: !1,
      isHighlighted: !1
    }])), i;
  }
  get clockKey() {
    var i, a, o;
    if (this._clockKey)
      return this._clockKey;
    const t = Object.values(this.system.clocksData);
    if (t.length === 0)
      throw new Error(`ClockKey not initialized for Project ${this.name}`);
    let s;
    if (t.length === 1)
      s = t[0].id;
    else if (this.isEmbedded) {
      if (s = (i = t.find((n) => {
        var l;
        return n.targetID.includes((l = this.parent) == null ? void 0 : l.id);
      })) == null ? void 0 : i.id, !s)
        throw new Error(`ClockKey not initialized for Project ${this.name} embedded in document '${(a = this.parent) == null ? void 0 : a.name}'.`);
    } else if (s = (o = t.find((n) => /^Item\.[^.]{16}$/.exec(n.targetID))) == null ? void 0 : o.id, !s)
      throw new Error(`ClockKey not initialized for Project ${this.name}.`);
    if (this._clockKey = game.eunoblades.ClockKeys.get(s) ?? new Ft(this.system.clocksData[s]), !this._clockKey)
      throw new Error(`ClockKey not initialized for Project ${this.name}`);
    return this._clockKey;
  }
  get ownerName() {
    if (this.parent)
      return this.parent.name;
  }
  get currentClock() {
    return this.clockKey.currentClock;
  }
  get isComplete() {
    return this.clockKey.isComplete;
  }
  get rollOppClock() {
    var t;
    return (t = this.currentClock) == null ? void 0 : t.data;
  }
  async advanceClock(t = 1) {
    if (this.currentClock)
      return this.currentClock.fillSegments(t);
  }
  get rollFactors() {
    const t = {};
    return [
      H.tier,
      H.quality
    ].forEach((s, i) => {
      const a = this.getFactorTotal(s);
      t[s] = {
        name: s,
        value: a,
        max: a,
        baseVal: a,
        display: s === H.tier ? w.romanizeNum(a) : `${a}`,
        isActive: i === 0,
        isPrimary: i === 0,
        isDominant: !1,
        highFavorsPC: !0,
        cssClasses: `factor-gold${i === 0 ? " factor-main" : ""}`
      };
    }), t;
  }
  getFactorTotal(t) {
    switch (t) {
      case H.tier:
        return this.system.tier.value;
      case H.quality:
        return this.getFactorTotal(H.tier);
    }
    return 0;
  }
  get rollOppImg() {
    return "";
  }
  get keyElem() {
    if (this.clockKey)
      return $(`#${this.clockKey.id}`)[0];
  }
  get currentClockElem() {
    if (this.keyElem && this.currentClock)
      return $(this.keyElem).find(`.clock[data-id="${this.currentClock.id}"]`)[0];
  }
}
const Co = ju;
class sg extends Z {
  get rollFactors() {
    const e = {};
    return [
      H.tier,
      H.quality,
      H.scale
    ].forEach((t, s) => {
      const i = this.getFactorTotal(t);
      e[t] = {
        name: t,
        value: i,
        max: i,
        baseVal: i,
        display: t === H.tier ? w.romanizeNum(i) : `${i}`,
        isActive: s === 0,
        isPrimary: s === 0,
        isDominant: !1,
        highFavorsPC: !0,
        cssClasses: `factor-gold${s === 0 ? " factor-main" : ""}`
      };
    }), e;
  }
  getFactorTotal(e) {
    switch (e) {
      case H.tier:
        return this.system.tier.value;
      case H.quality:
        return this.getFactorTotal(H.tier);
      case H.scale:
        return this.system.scale;
    }
    return 0;
  }
  get rollOppImg() {
    return this.img ?? "";
  }
  // #region OVERRIDES: _onUpdate
  // override async _onUpdate(changed: any, options: any, userId: string) {
  //   await super._onUpdate(changed, options, userId);
  //   BladesActor.GetTypeWithTags(BladesActorType.pc).forEach((actor) => actor.render());
  // }
  // #endregion
}
class Ku extends Z {
  static async Initialize() {
    const e = game.items.find((t) => t.type === "clock_keeper");
    return e ? game.eunoblades.ClockKeeper = e : game.eunoblades.ClockKeeper = await Ku.create({
      name: "Clock Keeper",
      type: "clock_keeper",
      img: "systems/eunos-blades/assets/icons/misc-icons/clock-keeper.svg"
    }), loadTemplates([
      "systems/eunos-blades/templates/parts/clock-sheet-key-controls.hbs",
      "systems/eunos-blades/templates/parts/clock-sheet-clock-controls.hbs"
    ]);
  }
  showClockKeyControls(e) {
    var t;
    (t = this.sheet) != null && t.element;
  }
  hideClockKeyControls(e) {
    var t;
    (t = this.sheet) != null && t.element;
  }
  // #region CLOCKS OVERLAY
  get clockKeys() {
    return this.getSceneKeys();
  }
  get currentScene() {
    var e, t;
    return (t = (e = game.scenes) == null ? void 0 : e.current) == null ? void 0 : t.id;
  }
  get currentSceneID() {
    var e;
    if (!((e = game.scenes) != null && e.current))
      throw new Error("[BladesClockKeeper.currentScene] Error retrieving 'game.scenes.current'.");
    return game.scenes.current.id;
  }
  get targetSceneID() {
    return this.system.targetScene ?? this.currentSceneID;
  }
  get keys() {
    return new Collection(
      Object.entries(this.system.clocksData ?? {}).map(([e, t]) => [
        e,
        game.eunoblades.ClockKeys.get(e) ?? new Ft(t)
      ])
    );
  }
  getSceneKeys(e) {
    return e ?? (e = this.targetSceneID), new Collection(Array.from(game.eunoblades.ClockKeys).filter((t) => t.sceneIDs.includes(e)).map((t) => [t.id, t]));
  }
  async addClockKey(e = {}) {
    var s;
    return (s = e.sceneIDs) != null && s.length || (e.sceneIDs = [this.targetSceneID]), await Ft.Create({
      target: this,
      targetKey: "system.clocksData",
      ...e
    });
  }
  async deleteClockKey(e) {
    var t;
    await ((t = game.eunoblades.ClockKeys.get(e)) == null ? void 0 : t.delete(game.eunoblades.ClockKeys));
  }
  async addClockToKey(e, t) {
    const s = await game.eunoblades.ClockKeys.get(e);
    s && await s.addClock(t);
  }
  async deleteClockFromKey(e, t) {
    const s = await game.eunoblades.ClockKeys.get(e);
    s && await s.deleteClock(t);
  }
  // #endregion
  // #region OVERRIDES: prepareDerivedData, _onUpdate
  prepareDerivedData() {
    var e, t;
    super.prepareDerivedData(), (t = this.system).targetScene ?? (t.targetScene = ((e = game.scenes.current) == null ? void 0 : e.id) || null);
  }
  // #endregion
}
const vl = Ku;
class Gu extends Z {
  static async Initialize() {
    const e = game.items.find((t) => Z.IsType(t, A.gm_tracker));
    e ? game.eunoblades.Tracker = e : game.eunoblades.Tracker = await Gu.create({
      name: "GM Tracker",
      type: "gm_tracker",
      img: "systems/eunos-blades/assets/icons/misc-icons/gm-tracker.svg"
    });
  }
  get phase() {
    return this.system.phase ?? $e.Freeplay;
  }
  set phase(e) {
    this.update({ "system.phase": e });
  }
  prepareDerivedData() {
    this.system.phases = Object.values($e);
  }
  // #region OVERRIDES: prepareDerivedData, _onUpdate
  async _onUpdate(...e) {
    await super.callOnUpdate(...e), oe.GetTypeWithTags(z.pc).forEach((t) => t.render());
  }
  // #endregion
}
const kl = Gu;
class c0 extends ua {
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "item", "score-sheet"],
      template: "systems/eunos-blades/templates/items/score-sheet.hbs",
      width: 900,
      submitOnChange: !1,
      height: 970
    });
  }
  async generateRandomizerData(e) {
    const t = {
      Bargains: Object.fromEntries(Object.entries(w.sample(Be.GM.Bargains.filter((i) => !Object.values(this.document.system.randomizers.Bargains).some((a) => a.name === i.name || a.effect === i.effect)), 3, !0, (i, a) => a.filter((o) => i.category === o.category).length === 0)).map(([i, a]) => (i = `${i}`, Object.assign(a, { notes: "" }), [i, a]))),
      Obstacles: Object.fromEntries(Object.entries(w.sample(Be.GM.Obstacles.filter((i) => !Object.values(this.document.system.randomizers.Obstacles).some((a) => a.name === i.name || a.desc === i.desc)), 3, !0, (i, a) => a.filter((o) => i.category === o.category).length === 0)).map(([i, a]) => (i = `${i}`, Object.assign(a, { notes: "" }), [i, a]))),
      NPCs: Object.fromEntries(Object.entries(w.sample(
        Be.GM.NPCs.filter(
          (i) => !Object.values(this.document.system.randomizers.NPCs).some((a) => a.name === i.name || a.description === i.description)
        ),
        3,
        !0,
        (i, a) => a.filter((o) => i.arena === o.arena).length === 0
      )).map(([i, a]) => (i = `${i}`, Object.assign(a, { notes: "" }), [i, a]))),
      Scores: Object.fromEntries(Object.entries(w.sample(Be.GM.Scores.filter((i) => !Object.values(this.document.system.randomizers.Scores).some((a) => a.name === i.name || a.desc === i.desc)), 3, !0, (i, a) => a.filter((o) => i.category === o.category).length === 0)).map(([i, a]) => (i = `${i}`, Object.assign(a, { notes: "" }), [i, a])))
    };
    e && Object.keys(t).filter((i) => i !== e).forEach((i) => {
      const a = i;
      t[a] = this.document.system.randomizers[a];
    });
    const s = {
      Bargains: {},
      Obstacles: {},
      NPCs: {},
      Scores: {}
    };
    Object.keys(t).forEach((i) => {
      const a = i;
      Object.keys(t[a]).forEach((o) => {
        var n;
        (n = this.document.system.randomizers) != null && n[a][o].isLocked ? s[a][o] = this.document.system.randomizers[a][o] : s[a][o] = t[a][o];
      });
    }), await this.document.update({ "system.randomizers": s });
  }
  getData() {
    const e = super.getData(), t = {};
    t.playerCharacters = oe.GetTypeWithTags(z.pc, he.PC.ActivePC).map((i) => Object.assign(
      i,
      {
        actionData: Object.fromEntries(Object.entries(i.system.attributes).map(([a, o]) => [
          a,
          Object.fromEntries(Object.entries(o).map(([n, l]) => [
            w.uCase(n).slice(0, 3),
            l
          ]))
        ]))
      }
    ));
    const s = {};
    for (const [i, a] of Object.entries(e.system.oppositions))
      !a.rollOppName && !a.rollOppSubName || (s[i] = a);
    return e.system.oppositions = s, {
      ...e,
      ...t
    };
  }
  _toggleRandomizerLock(e) {
    const t = $(e.currentTarget), s = t.data("category"), i = `${t.data("index")}`;
    `${t.data("value")}` == "true" ? this.document.update({ [`system.randomizers.${s}.${i}.isLocked`]: !1 }) : this.document.update({ [`system.randomizers.${s}.${i}.isLocked`]: !0 });
  }
  _selectImage(e) {
    const s = $(e.currentTarget).data("imgNum");
    this.document.update({ "system.imageSelected": s });
  }
  _deselectOrDeleteImage(e) {
    const s = $(e.currentTarget).data("imgNum");
    if (this.document.system.imageSelected === s) {
      this.document.update({ "system.-=imageSelected": null });
      return;
    }
    const i = { ...this.document.system.images };
    this.document.update({ "system.-=images": null }).then(() => this.document.update({
      "system.images": Object.fromEntries(Object.entries(Object.values(i).filter((a, o) => w.pInt(s) !== o)))
    }));
  }
  _addImage() {
    w.displayImageSelector(
      (e) => {
        const t = w.objSize(this.document.system.images);
        return this.document.update({ [`system.images.${t}`]: e });
      },
      "systems/eunos-blades/assets",
      this.position
    );
  }
  _selectRollOpposition(e) {
    var i;
    eLog.checkLog3("Select Roll Opposition", { event: e });
    const s = $(e.currentTarget).data("oppId");
    this.document.update({ "system.oppositionSelected": s }), ((i = So.Active) == null ? void 0 : i.id) === this.document.id && Ws.Active && (Ws.Active.rollOpposition = new jt(
      Ws.Active,
      this.document.system.oppositions[s]
    ));
  }
  _triggerRandomize(e) {
    const s = $(e.currentTarget).data("category");
    s && s in Be.GM ? this.generateRandomizerData(s) : this.generateRandomizerData();
  }
  async _updateGMNotesOnPC(e) {
    const t = $(e.currentTarget), s = oe.Get(t.data("id"));
    if (!s)
      throw new Error(`Unable to retrieve actor with id '${t.data("id")}'`);
    const i = e.currentTarget.innerHTML;
    eLog.checkLog3("scoreSheet", "Retrieved Text, Updating ...", { updateText: i }), await s.update({ "system.gm_notes": i }), eLog.checkLog3("scoreSheet", "Updated!", { gm_notes: s.system.gm_notes });
  }
  async activateListeners(e) {
    super.activateListeners(e), e.find("[data-action='select-image']").on({
      click: this._selectImage.bind(this),
      contextmenu: this._deselectOrDeleteImage.bind(this)
    }), e.find("[data-action='add-image']").on({
      click: this._addImage.bind(this)
    }), e.find(".roll-opposition-name").on({
      dblclick: this._selectRollOpposition.bind(this)
    }), e.find(".toggle-lock").on({
      click: this._toggleRandomizerLock.bind(this)
    }), e.find("[data-action='randomize'").on({
      click: this._triggerRandomize.bind(this)
    }), e.find("textarea.pc-summary-notes-body").on({
      change: this._updateGMNotesOnPC.bind(this)
    });
  }
  async _onSubmit(e, t = {}) {
    let s = !0;
    const i = this.item.system.phase, a = await super._onSubmit(e, t), o = this.item.system.phase;
    if (i !== o) {
      switch (i) {
        case $e.CharGen:
          break;
        case $e.Freeplay:
          break;
        case $e.Score: {
          s = !1, game.actors.filter((n) => oe.IsType(n, z.pc)).forEach((n) => n.clearLoadout());
          break;
        }
        case $e.Downtime:
          break;
      }
      switch (o) {
        case $e.CharGen:
          break;
        case $e.Freeplay:
          break;
        case $e.Score:
          break;
        case $e.Downtime:
          break;
      }
    }
    return s && game.actors.filter((n) => n.type === z.pc).forEach((n) => {
      var l;
      return (l = n.sheet) == null ? void 0 : l.render();
    }), a;
  }
}
class Vu extends Z {
  // #region INITIALIZATION ~
  static async Initialize() {
    return Object.assign(globalThis, { BladesScore: Vu, BladesScoreSheet: c0 }), Items.registerSheet("blades", c0, { types: ["score"], makeDefault: !0 }), loadTemplates(["systems/eunos-blades/templates/items/score-sheet.hbs"]);
  }
  // #endregion
  static get Active() {
    return Z.GetTypeWithTags(A.score).find((e) => e.system.isActive);
  }
  static set Active(e) {
    var t;
    (t = Z.GetTypeWithTags(A.score).find((s) => s.system.isActive)) == null || t.update({ "system.isActive": !1 }).then(() => {
      e && e.update({ "system.isActive": !0 });
    });
  }
  // #region BladesRoll.OppositionData Implementation
  get rollFactors() {
    const e = this.getFactorTotal(H.tier);
    return {
      [H.tier]: {
        name: "Tier",
        value: e,
        max: e,
        baseVal: e,
        display: w.romanizeNum(e),
        isActive: !0,
        isPrimary: !0,
        isDominant: !1,
        highFavorsPC: !0,
        cssClasses: "factor-gold factor-main"
      }
    };
  }
  get rollOppImg() {
    return this.img ?? "";
  }
  getFactorTotal(e) {
    switch (e) {
      case H.tier:
        return this.system.tier.value;
      case H.quality:
        return this.getFactorTotal(H.tier);
      case H.scale:
        return 0;
      case H.magnitude:
        return 0;
      default:
        return 0;
    }
  }
  // #endregion
  // #region OVERRIDES: _onUpdate
  async _onUpdate(e, t, s) {
    super._onUpdate(e, t, s), oe.GetTypeWithTags(z.pc).forEach((i) => i.render());
  }
  // #endregion
}
const So = Vu, Jl = {
  [A.ability]: Z,
  [A.background]: Z,
  [A.clock_keeper]: vl,
  [A.cohort_gang]: Z,
  [A.cohort_expert]: Z,
  [A.crew_ability]: Z,
  [A.crew_reputation]: Z,
  [A.crew_playbook]: Z,
  [A.crew_upgrade]: Z,
  [A.feature]: Z,
  [A.gm_tracker]: kl,
  [A.heritage]: Z,
  [A.gear]: Z,
  [A.playbook]: Z,
  [A.preferred_op]: Z,
  [A.stricture]: Z,
  [A.vice]: Z,
  [A.project]: Co,
  [A.ritual]: Z,
  [A.design]: Z,
  [A.location]: sg,
  [A.score]: So
}, d3 = new Proxy(function() {
}, {
  construct(r, e) {
    const [{ type: t }] = e;
    if (!t)
      throw new Error(`Invalid Item Type: ${String(t)}`);
    const s = Jl[t];
    return s ? new s(...e) : new Z(...e);
  },
  get(r, e) {
    switch (e) {
      case "create":
      case "createDocuments":
        return function(t, s = {}) {
          if (w.isArray(t))
            return t.map((a) => CONFIG.Item.documentClass.create(a, s));
          const i = Jl[t.type];
          return i ? i.create(t, s) : Z.create(t, s);
        };
      case Symbol.hasInstance:
        return function(t) {
          return Object.values(Jl).some((s) => t instanceof s);
        };
      default:
        return Z[e];
    }
  }
});
var ig = ((r) => (r[r.CharacterCrew = he.PC.CharacterCrew] = "CharacterCrew", r[r.VicePurveyor = he.NPC.VicePurveyor] = "VicePurveyor", r))(ig || {}), rg = ((r) => (r[r.background = A.background] = "background", r[r.vice = A.vice] = "vice", r[r.crew_playbook = A.crew_playbook] = "crew_playbook", r[r.crew_reputation = A.crew_reputation] = "crew_reputation", r[r.heritage = A.heritage] = "heritage", r[r.playbook = A.playbook] = "playbook", r[r.preferred_op = A.preferred_op] = "preferred_op", r))(rg || {});
class Ie extends Actor {
  constructor() {
    super(...arguments);
    // #endregion
    // #region BladesSubActor Implementation ~
    J(this, "parentActor");
  }
  // #region Static Overrides: Create ~
  static async create(t, s = {}) {
    return t.token = t.token || {}, t.system = t.system ?? {}, t.system.world_name = t.system.world_name ?? t.name.replace(/[^A-Za-z_0-9 ]/g, "").trim().replace(/ /g, "_"), await super.create(t, s);
  }
  // #endregion
  // #region BladesDocument Implementation ~
  static get All() {
    return game.actors;
  }
  static Get(t) {
    return t instanceof Ie ? t : w.isDocID(t) ? Ie.All.get(t) : Ie.All.find((s) => s.system.world_name === t) || Ie.All.find((s) => s.name === t);
  }
  static GetTypeWithTags(t, ...s) {
    return Ie.All.filter((i) => i.type === t).filter((i) => i.hasTag(...s));
  }
  static IsType(t, ...s) {
    const i = new Set(s);
    return t instanceof Ie && i.has(t.type);
  }
  get tags() {
    return this.system.tags ?? [];
  }
  hasTag(...t) {
    return t.every((s) => this.tags.includes(s));
  }
  async addTag(...t) {
    const s = this.tags;
    t.forEach((i) => {
      s.includes(i) || s.push(i);
    }), eLog.checkLog2("actor", "BladesActor.addTag(...tags)", { tags: t, curTags: s }), await this.update({ "system.tags": s });
  }
  async remTag(...t) {
    const s = this.tags.filter((i) => !t.includes(i));
    eLog.checkLog2("actor", "BladesActor.remTag(...tags)", { tags: t, curTags: s }), await this.update({ "system.tags": s });
  }
  get tooltip() {
    const t = [this.system.concept, this.system.subtitle].filter(Boolean).join("<br><br>");
    return t ? new Handlebars.SafeString(t).toString() : void 0;
  }
  get dialogCSSClasses() {
    return "";
  }
  getFactorTotal(t) {
    var s;
    switch (t) {
      case H.tier:
        return Ie.IsType(this, z.pc) ? this.system.tier.value + (((s = this.crew) == null ? void 0 : s.getFactorTotal(H.tier)) ?? 0) : this.system.tier.value;
      case H.quality:
        return this.getFactorTotal(H.tier);
      case H.scale:
        return Ie.IsType(this, z.npc) ? this.system.scale : 0;
      case H.magnitude:
        return Ie.IsType(this, z.npc) ? this.system.magnitude : 0;
      default:
        return 0;
    }
  }
  // #endregion
  // #region SubActorControl Implementation ~
  get subActors() {
    return Object.keys(this.system.subactors).map((t) => this.getSubActor(t)).filter((t) => !!t);
  }
  get activeSubActors() {
    return this.subActors.filter((t) => !t.hasTag(he.System.Archived));
  }
  get archivedSubActors() {
    return this.subActors.filter((t) => t.hasTag(he.System.Archived));
  }
  checkActorPrereqs(t) {
    return !!t;
  }
  processEmbeddedActorMatches(t) {
    return t.filter(this.checkActorPrereqs).filter((s) => !this.activeSubActors.some((i) => i.id === s.id)).map((s) => this.getSubActor(s) || s).sort((s, i) => s.name === i.name ? 0 : s.name === null ? 1 : i.name === null ? -1 : s.name > i.name ? 1 : s.name < i.name ? -1 : 0);
  }
  getDialogActors(t) {
    var i;
    const s = {};
    switch (t) {
      case bt.Contact:
      case bt.Rival:
      case bt.Friend:
      case bt.Acquaintance:
        return !Ie.IsType(this, z.pc, z.crew) || this.playbookName === null ? !1 : (s.Main = this.processEmbeddedActorMatches(
          Ie.GetTypeWithTags(z.npc, this.playbookName)
        ), s);
      case bt.VicePurveyor:
        return !Ie.IsType(this, z.pc) || !((i = this.vice) != null && i.name) ? !1 : (s.Main = this.processEmbeddedActorMatches(
          Ie.GetTypeWithTags(z.npc, this.vice.name)
        ), s);
      case bt.Crew:
        return s.Main = Ie.GetTypeWithTags(z.crew), s;
      default:
        return !1;
    }
  }
  async addSubActor(t, s) {
    let i;
    if (this.hasSubActorOf(t)) {
      const o = this.getSubActor(t);
      if (!o)
        return;
      o.hasTag(he.System.Archived) && await o.remTag(he.System.Archived), i = o;
    } else {
      const o = Ie.Get(t);
      if (!o)
        return;
      const n = {};
      s && (n.tags = w.unique([
        ...o.tags,
        ...s
      ])), await this.update({ [`system.subactors.${o.id}`]: n }), i = this.getSubActor(o.id);
    }
    if (!i)
      return;
    const a = i.tags.filter((o) => o in ig);
    a.length > 0 && a.forEach((o) => this.activeSubActors.filter(
      (n) => !!(i != null && i.id && n.id !== i.id && n.hasTag(o))
    ).map((n) => this.remSubActor(n.id)));
  }
  getSubActor(t) {
    const s = Ie.Get(t);
    if (!(s != null && s.id))
      return;
    if (!Ie.IsType(s, z.npc, z.faction))
      return s;
    const i = this.system.subactors[s.id] ?? {};
    return Object.assign(
      s.system,
      i
    ), s.parentActor = this, s;
  }
  hasSubActorOf(t) {
    const s = Ie.Get(t);
    return s && s != null && s.id ? s.id in this.system.subactors : !1;
  }
  async updateSubActor(t, s) {
    const i = w.objExpand(s);
    if (!i.system)
      return;
    const a = Ie.Get(t);
    if (!a)
      return;
    const o = w.objDiff(a.system, i.system), n = w.objMerge(
      this.system.subactors[a.id] ?? {},
      o,
      { isReplacingArrays: !0, isConcatenatingArrays: !1 }
    );
    if (JSON.stringify(this.system.subactors[a.id]) !== JSON.stringify(n))
      return this.update({ [`system.subactors.${a.id}`]: null }, void 0, !0).then(() => this.update({ [`system.subactors.${a.id}`]: n }, void 0, !0)).then(() => {
        var l;
        return (l = a.sheet) == null ? void 0 : l.render();
      });
  }
  async remSubActor(t) {
    const s = this.getSubActor(t);
    s && await this.update({ "system.subactors": mergeObject(this.system.subactors, { [`-=${s.id}`]: null }) }, void 0, !0);
  }
  async clearSubActors(t = !0) {
    var s;
    this.subActors.forEach((i) => {
      var a;
      ((a = i.parentActor) == null ? void 0 : a.id) === this.id && i.clearParentActor(t);
    }), await ((s = this.sheet) == null ? void 0 : s.render());
  }
  async clearParentActor(t = !0) {
    var i;
    const { parentActor: s } = this;
    s && (this.parentActor = void 0, this.system = this._source.system, this.ownership = this._source.ownership, this.prepareData(), t && await ((i = this.sheet) == null ? void 0 : i.render()));
  }
  // #endregion
  // #region SubItemControl Implementation ~
  get subItems() {
    return Array.from(this.items);
  }
  getSubItemsOfType(t) {
    return this.items.filter((s) => s.type === t);
  }
  get activeSubItems() {
    return this.items.filter((t) => !t.hasTag(he.System.Archived));
  }
  get archivedSubItems() {
    return this.items.filter((t) => t.hasTag(he.System.Archived));
  }
  _checkItemPrereqs(t) {
    if (!t.system.prereqs)
      return !0;
    for (const [s, i] of Object.entries(
      t.system.prereqs
    )) {
      const a = Array.isArray(i) ? i : [i.toString()], o = {};
      if (!this._processPrereqArray(a, s, o))
        return !1;
    }
    return !0;
  }
  _processPrereqArray(t, s, i) {
    for (; t.length; ) {
      const a = t.pop();
      if (i[s] ?? (i[s] = []), !this._processPrereqType(s, a, i))
        return !1;
    }
    return !0;
  }
  _processPrereqType(t, s, i) {
    switch (t) {
      case Ko.HasActiveItem:
        return this._processActiveItemPrereq(s, i, t);
      case Ko.HasActiveItemsByTag:
        return this._processActiveItemsByTagPrereq(s, i, t);
      case Ko.AdvancedPlaybook:
        return this._processAdvancedPlaybookPrereq();
      default:
        return !0;
    }
  }
  _processActiveItemPrereq(t, s, i) {
    var o;
    const a = this.activeSubItems.filter((n) => {
      var l;
      return !((l = s[i]) != null && l.includes(n.id));
    }).find((n) => n.system.world_name === t);
    return a ? ((o = s[i]) == null || o.push(a.id), !0) : !1;
  }
  _processActiveItemsByTagPrereq(t, s, i) {
    var o;
    const a = this.activeSubItems.filter((n) => {
      var l;
      return !((l = s[i]) != null && l.includes(n.id));
    }).find((n) => n.hasTag(t));
    return a ? ((o = s[i]) == null || o.push(a.id), !0) : !1;
  }
  _processAdvancedPlaybookPrereq() {
    return !(!Ie.IsType(this, z.pc) || !this.playbookName || ![Ba.Ghost, Ba.Hull, Ba.Vampire].includes(this.playbookName));
  }
  _processEmbeddedItemMatches(t) {
    return t.filter((s) => this._checkItemPrereqs(s)).filter((s) => s.hasTag(he.System.MultiplesOK) || (s.system.max_per_score ?? 1) > this.activeSubItems.filter((i) => i.system.world_name === s.system.world_name).length).map((s) => {
      const i = this.archivedSubItems.filter((a) => a.system.world_name === s.system.world_name);
      return i.length > 0 ? i : s;
    }).flat().map((s) => {
      s.dialogCSSClasses = "";
      const i = [];
      return s.isEmbedded && i.push("embedded"), s.hasTag(he.Gear.Fine) && i.push("fine-quality"), s.hasTag(he.System.Featured) && i.push("featured-item"), [A.ability, A.crew_ability].includes(s.type) && (this.getAvailableAdvancements("Ability") === 0 ? i.push("locked") : (s.system.price ?? 1) > this.getAvailableAdvancements("Ability") ? i.push("locked", "unaffordable") : (s.system.price ?? 1) > 1 && i.push("expensive")), [A.crew_upgrade].includes(s.type) && (this.getAvailableAdvancements("Upgrade") === 0 ? i.push("locked") : (s.system.price ?? 1) > this.getAvailableAdvancements("Upgrade") ? i.push("locked", "unaffordable") : (s.system.price ?? 1) > 1 && i.push("expensive")), i.length > 0 && (s.dialogCSSClasses = i.join(" ")), s;
    }).sort((s, i) => s.hasTag(he.System.Featured) && !i.hasTag(he.System.Featured) ? -1 : !s.hasTag(he.System.Featured) && i.hasTag(he.System.Featured) ? 1 : s.hasTag(he.Gear.Fine) && !i.hasTag(he.Gear.Fine) ? -1 : !s.hasTag(he.Gear.Fine) && i.hasTag(he.Gear.Fine) || s.system.world_name > i.system.world_name ? 1 : s.system.world_name < i.system.world_name || s.isEmbedded && !i.isEmbedded ? -1 : !s.isEmbedded && i.isEmbedded ? 1 : s.name === i.name ? 0 : s.name === null ? 1 : i.name === null ? -1 : s.name > i.name ? 1 : s.name < i.name ? -1 : 0);
  }
  getSubItem(t, s = !1) {
    const i = (a) => !s || !a.hasTag(he.System.Archived);
    if (typeof t == "string" && this.items.get(t)) {
      const a = this.items.get(t);
      return a && i(a) ? a : void 0;
    } else {
      const a = Z.Get(t);
      return a ? this.items.find((o) => o.name === a.name && i(o)) ?? this.items.find((o) => o.system.world_name === a.system.world_name && i(o)) : void 0;
    }
  }
  hasSubItemOf(t) {
    const s = Z.Get(t);
    return s ? !!this.items.find((i) => i.system.world_name === s.system.world_name) : !1;
  }
  hasActiveSubItemOf(t) {
    const s = Z.Get(t);
    return s ? !!this.items.find((i) => !i.hasTag(he.System.Archived) && i.system.world_name === s.system.world_name) : !1;
  }
  async addSubItem(t) {
    function s(o) {
      return Object.values(rg).includes(o);
    }
    eLog.checkLog3("subitems", "[addSubItem] itemRef", t);
    let i;
    const a = this.getSubItem(t);
    if (a)
      a.hasTag(he.System.Archived) ? (await a.remTag(he.System.Archived), i = a, eLog.checkLog3("subitems", `[addSubItem] IS ARCHIVED EMBEDDED > Removing 'Archived' Tag, '${i.id}':`, i)) : (i = await Z.create(
        [a],
        { parent: this }
      ), eLog.checkLog3("subitems", `[addSubItem] IS ACTIVE EMBEDDED > Duplicating, focusItem '${i.id}':`, i));
    else {
      const o = Z.Get(t);
      if (eLog.checkLog3("subitems", `[addSubItem] IS NOT EMBEDDED > Fetching Global, globalItem '${o == null ? void 0 : o.id}':`, o), !o)
        return;
      i = await Z.create(
        [o],
        { parent: this }
      ), i = this.items.getName(o.name);
    }
    i && s(i.type) && await Promise.all(this.activeSubItems.filter((o) => o.type === (i == null ? void 0 : i.type) && o.system.world_name !== (i == null ? void 0 : i.system.world_name) && !o.hasTag(he.System.Archived)).map(this.remSubItem.bind(this)));
  }
  async remSubItem(t) {
    const s = this.getSubItem(t);
    if (s) {
      if (s.type !== A.gear) {
        this.purgeSubItem(t);
        return;
      }
      eLog.checkLog("actorTrigger", `Removing SubItem ${s.name}`, s), !s.hasTag(he.System.Archived) && await s.addTag(he.System.Archived);
    }
  }
  async purgeSubItem(t) {
    const s = this.getSubItem(t);
    !s || s.hasTag(he.System.Archived) || await s.delete();
  }
  // #endregion
  // #region Advancement Implementation ~
  // get totalAbilityPoints(): number {
  //   if (!BladesActor.IsType(this, BladesActorType.pc, BladesActorType.crew)) { return 0 }
  //   if (!this.playbook) { return 0 }
  //   switch (this.type) {
  //     case BladesActorType.pc: return this.system.advancement.ability ?? 0;
  //     case BladesActorType.crew: return Math.floor(0.5 * (this.system.advancement.general ?? 0))
  //      + (this.system.advancement.ability ?? 0);
  //     default: return 0;
  //   }
  // }
  // get spentAbilityPoints(): number {
  //   if (!BladesActor.IsType(this, BladesActorType.pc, BladesActorType.crew)) { return 0 }
  //   if (!this.playbook) { return 0 }
  //   return this.abilities.reduce((total, ability) => total + (ability.system.price ?? 1), 0);
  // }
  // get getAvailableAdvancements("Ability")(): number {
  //   if (!BladesActor.IsType(this, BladesActorType.pc, BladesActorType.crew)) { return 0 }
  //   if (!this.playbook) { return 0 }
  //   return this.totalAbilityPoints - this.spentAbilityPoints;
  // }
  /* Need simple getters for total ability & upgrade points that check for PRICES of items
        (upgrade.system.price ?? 1) */
  async grantAdvancementPoints(t, s = 1) {
    var a;
    const i = Array.isArray(t) ? [...t].sort((o, n) => o.localeCompare(n)).join("_") : t;
    await this.update({ [`system.advancement_points.${i}`]: (((a = this.system.advancement_points) == null ? void 0 : a[i]) ?? 0) + s });
  }
  async removeAdvancementPoints(t, s = 1) {
    var o;
    const i = Array.isArray(t) ? [...t].sort((n, l) => n.localeCompare(l)).join("_") : t, a = ((o = this.system.advancement_points) == null ? void 0 : o[i]) ?? 0 - s;
    a <= 0 && i in (this.system.advancement_points ?? []) ? await this.update({ [`system.advancement_points.-=${i}`]: null }) : await this.update({ [`system.advancement_points.${i}`]: a });
  }
  getAvailableAdvancements(t) {
    var _, C, T, x, S;
    if (!Ie.IsType(this, z.pc, z.crew))
      return 0;
    if (t in js)
      return 1;
    if (t === "Cohort") {
      const O = ((_ = this.system.advancement_points) == null ? void 0 : _[Oi.Cohort]) ?? 0, M = this.cohorts.length;
      return Math.max(0, O - M);
    }
    const s = ((C = this.system.advancement_points) == null ? void 0 : C[Oi.Ability]) ?? 0, i = ((T = this.system.advancement_points) == null ? void 0 : T[Oi.CohortType]) ?? 0, a = ((x = this.system.advancement_points) == null ? void 0 : x[Oi.Upgrade]) ?? 0, o = ((S = this.system.advancement_points) == null ? void 0 : S[Oi.UpgradeOrAbility]) ?? 0, n = w.sum(this.items.filter((O) => Z.IsType(O, A.ability, A.crew_ability)).map((O) => O.system.price ?? 1)), l = w.sum(
      this.cohorts.map((O) => Math.max(0, w.unique(Object.values(O.system.subtypes)).length - 1))
    ), c = w.sum(this.items.filter((O) => Z.IsType(O, A.crew_upgrade)).map((O) => O.system.price ?? 1)), u = Math.max(0, c - a), g = Math.max(0, l - i), p = Math.max(0, n - s), h = Math.max(0, s - n), m = Math.max(0, i - l), y = Math.max(0, a - c), k = Math.max(
      0,
      o - u - 2 * p - 2 * g
    );
    return t === "Ability" ? h + Math.floor(0.5 * k) : t === "Upgrade" ? y + k : t === "CohortType" ? m + k : 0;
  }
  get availableAbilityPoints() {
    return this.getAvailableAdvancements("Ability");
  }
  get availableUpgradePoints() {
    return this.getAvailableAdvancements("Upgrade");
  }
  get availableCohortPoints() {
    return this.getAvailableAdvancements("Cohort");
  }
  get availableCohortTypePoints() {
    return this.getAvailableAdvancements("CohortType");
  }
  get canPurchaseAbility() {
    return this.availableAbilityPoints > 0;
  }
  get canPurchaseUpgrade() {
    return this.availableUpgradePoints > 0;
  }
  get canPurchaseCohort() {
    return this.availableCohortPoints > 0;
  }
  get canPurchaseCohortType() {
    return this.availableCohortTypePoints > 0;
  }
  async advancePlaybook() {
    if (!(!Ie.IsType(this, z.pc, z.crew) || !this.playbook)) {
      if (await this.update({ "system.experience.playbook.value": 0 }), this instanceof Te) {
        St.getInstance().pushNotice_SocketCall(
          "ALL",
          {
            title: `${this.name} Advances their Playbook!`,
            body: `${this.name}, select a new Ability on your Character Sheet.`,
            type: Ls.push,
            cssClasses: "advancement-alert"
          }
        ), this.grantAdvancementPoints(Oi.Ability);
        return;
      }
      if (this instanceof Kt) {
        St.getInstance().pushNotice_SocketCall(
          "ALL",
          {
            title: "You Advance your Crew Playbook!",
            body: "Select new Upgrades and/or Abilities on your Crew Sheet.",
            type: Ls.push,
            cssClasses: "advancement-alert crew-advancement-alert"
          }
        );
        const t = this.system.tier.value + 2;
        this.members.forEach((s) => {
          var i, a;
          (i = s.primaryUser) != null && i.id && (St.getInstance().pushNotice_SocketCall(
            (a = s.primaryUser) == null ? void 0 : a.id,
            {
              title: "Your Stash Increases! <em>(Crew Advancement)</em>",
              type: Ls.push,
              body: `You gain ${t} Stash from Crew Advancement.`,
              cssClasses: "stash-alert"
            }
          ), s.addStash(t));
        }), this.grantAdvancementPoints(Oi.UpgradeOrAbility, 2);
      }
    }
  }
  async advanceAttribute(t) {
    var i;
    if (!(this instanceof Te) || !((i = this.primaryUser) != null && i.id))
      return;
    await this.update({ [`system.experience.${t}.value`]: 0 });
    const s = X.Action[t].map((a) => `<strong>${w.tCase(a)}</strong>`);
    St.getInstance().pushNotice_SocketCall(
      this.primaryUser.id,
      {
        title: `${this.name} Advances their ${w.uCase(t)}!`,
        body: `${this.name}, add a dot to one of ${w.oxfordize(s, !0, "or")}.`,
        type: Ls.push,
        cssClasses: "advancement-alert"
      }
    );
  }
  get isAtWar() {
    var t;
    return ha.IsType(this) ? !1 : Te.IsType(this) ? ((t = this.crew) == null ? void 0 : t.isAtWar) ?? !1 : Object.values(this.system.at_war_with ?? {}).filter((s) => s === !0).length > 0;
  }
  get isSubActor() {
    return this.parentActor !== void 0;
  }
  // #endregion
  // #region BladesRoll Implementation ~
  get rollPrimaryModsSchemaSet() {
    return ki.ParseDocModsToSchemaSet(this);
  }
  get rollFactors() {
    return {
      [H.tier]: {
        name: H.tier,
        display: "Tier",
        value: this.getFactorTotal(H.tier),
        max: this.getFactorTotal(H.tier),
        baseVal: this.getFactorTotal(H.tier),
        isActive: !0,
        isPrimary: !0,
        isDominant: !1,
        highFavorsPC: !0
      },
      [H.quality]: {
        name: H.quality,
        display: "Quality",
        value: this.getFactorTotal(H.quality),
        max: this.getFactorTotal(H.quality),
        baseVal: this.getFactorTotal(H.quality),
        isActive: !1,
        isPrimary: !1,
        isDominant: !1,
        highFavorsPC: !0
      }
    };
  }
  // #region BladesRoll.PrimaryDoc Implementation
  get rollPrimaryID() {
    return this.id;
  }
  get rollPrimaryDoc() {
    return this;
  }
  get rollPrimaryName() {
    return this.name;
  }
  get rollPrimaryType() {
    if (![z.pc, z.crew].includes(this.type))
      throw new Error(`BladesActor of type '${this.type}' ("${this.name}") cannot be RollPrimary.`);
    return this.type;
  }
  get rollPrimaryImg() {
    return this.img;
  }
  // #endregion
  // #endregion
  // #region BladesCrew Implementation ~
  // #endregion
  // #region PREPARING DERIVED DATA ~
  prepareDerivedData() {
    Ie.IsType(this, z.pc) && this._preparePCData(this.system), Ie.IsType(this, z.crew) && this._prepareCrewData(this.system);
  }
  _preparePCData(t) {
    Ie.IsType(this, z.pc) && (this.playbook && (t.experience.clues = [
      ...t.experience.clues,
      ...Object.values(this.playbook.system.experience_clues).filter((s) => !!s.trim())
    ]), this.playbook && (t.gather_info = [
      ...t.gather_info,
      ...Object.values(this.playbook.system.gather_info_questions).filter((s) => !!s.trim())
    ]));
  }
  _prepareCrewData(t) {
    Ie.IsType(this, z.crew) && this.playbook && (t.experience.clues = [
      ...t.experience.clues,
      ...Object.values(this.playbook.system.experience_clues).filter((s) => !!s.trim())
    ], t.turfs = this.playbook.system.turfs);
  }
  // #endregion
  // #region OVERRIDES: _onCreateDescendantDocuments, update ~
  // @ts-expect-error New method not defined in @league VTT types.
  async _onCreateDescendantDocuments(t, s, i, a, o, n) {
    await Promise.all(i.map(async (l) => {
      Z.IsType(l, A.playbook, A.crew_playbook) && await Promise.all(this.activeSubItems.filter((c) => c.type === l.type && c.system.world_name !== l.system.world_name).map((c) => this.remSubItem(c)));
    })), await super._onCreateDescendantDocuments(t, s, i, a, o, n), eLog.checkLog("actorTrigger", "_onCreateDescendantDocuments", { parent: t, collection: s, docs: i, data: a, options: o, userId: n }), i.forEach((l) => {
      Z.IsType(l, A.vice) && Ie.IsType(this, z.pc) && this.activeSubActors.filter((c) => c.hasTag(he.NPC.VicePurveyor) && !c.hasTag(l.name)).forEach((c) => {
        this.remSubActor(c);
      });
    });
  }
  async update(t, s, i = !1) {
    if (!t)
      return super.update(t);
    if (Ie.IsType(this, z.crew)) {
      if (!this.playbook)
        return;
      eLog.checkLog("actorTrigger", "Updating Crew", { updateData: t });
      const a = Object.fromEntries(
        Object.entries(flattenObject(t)).filter(([n, l]) => n.startsWith("system.turfs."))
      );
      t = Object.fromEntries(Object.entries(flattenObject(t)).filter(([n, l]) => !n.startsWith("system.turfs."))), eLog.checkLog("actorTrigger", "Updating Crew", { crewUpdateData: t, playbookUpdateData: a });
      const o = diffObject(
        flattenObject(this.playbook),
        a
      );
      delete o._id, w.isEmpty(o) || await this.playbook.update(a, s).then(() => {
        var n;
        return (n = this.sheet) == null ? void 0 : n.render(!1);
      });
    } else if ((Ie.IsType(this, z.npc) || Ie.IsType(this, z.faction)) && this.parentActor && !i)
      return this.parentActor.updateSubActor(this.id, t).then(() => this);
    return super.update(t, s);
  }
  // #endregion
  // #region Rolling Dice ~
  /**
   * Creates <options> modifiers for dice roll.
   *
   * @param {int} rs
   *  Min die modifier
   * @param {int} re
   *  Max die modifier
   * @param {int} s
   *  Selected die
   */
  createListOfDiceMods(t, s, i) {
    let a = "";
    i === "" && (i = 0);
    for (let o = t; o <= s; o++) {
      let n = "";
      o >= 0 && (n = "+"), a += `<option value="${o}"`, o === i && (a += " selected"), a += `>${n}${o}d</option>`;
    }
    return a;
  }
  // #endregion Rolling Dice
  // #region NPC Randomizers ~
  updateRandomizers() {
    if (!Ie.IsType(this, z.npc))
      return;
    const t = 0.05, s = 0.01, { persona: i, secret: a, random: o } = this.system;
    function n(p, ...h) {
      return p = p.filter((m) => !h.includes(m)), p.length ? p[Math.floor(Math.random() * p.length)] : "";
    }
    const l = {
      name: (p) => [
        Math.random() <= t ? n(Be.NPC.name_title) : "",
        n([
          ...(p ?? "").charAt(0).toLowerCase() !== "m" ? Be.NPC.name_first.female : [],
          ...(p ?? "").charAt(0).toLowerCase() !== "f" ? Be.NPC.name_first.male : []
        ]),
        `"${n(Be.NPC.name_alias)}"`,
        n(Be.NPC.name_surname),
        Math.random() <= s ? n(Be.NPC.name_suffix) : ""
      ].filter((h) => !!h).join(" "),
      background: () => n(Be.NPC.background, o.background.value),
      heritage: () => n(Be.NPC.heritage, o.heritage.value),
      profession: () => n(Be.NPC.profession, o.profession.value),
      gender: () => n(Be.NPC.gender, i.gender.value),
      appearance: () => n(Be.NPC.appearance, i.appearance.value),
      goal: () => n(Be.NPC.goal, i.goal.value, a.goal.value),
      method: () => n(Be.NPC.method, i.method.value, a.method.value),
      trait: () => n(
        Be.NPC.trait,
        i.trait1.value,
        i.trait2.value,
        i.trait3.value,
        a.trait.value
      ),
      interests: () => n(Be.NPC.interests, i.interests.value, a.interests.value),
      quirk: () => n(Be.NPC.quirk, i.quirk.value),
      style: (p = "") => n([
        ...p.charAt(0).toLowerCase() !== "m" ? Be.NPC.style.female : [],
        ...p.charAt(0).toLowerCase() !== "f" ? Be.NPC.style.male : []
      ], i.style.value)
    }, c = i.gender.isLocked ? i.gender.value : l.gender(), u = [
      ...Object.keys(i).filter((p) => {
        var h;
        return !((h = i[p]) != null && h.isLocked);
      }),
      ...Object.keys(o).filter((p) => {
        var h;
        return !((h = o[p]) != null && h.isLocked);
      }),
      ...Object.keys(a).filter((p) => {
        var h;
        return !((h = a[p]) != null && h.isLocked);
      }).map((p) => `secret-${p}`)
    ];
    eLog.checkLog("Update Keys", { updateKeys: u });
    const g = {};
    u.forEach((p) => {
      switch (p) {
        case "name":
        case "heritage":
        case "background":
        case "profession": {
          const h = l[p]();
          g[`system.random.${p}`] = {
            isLocked: !1,
            value: h || o[p].value
          };
          break;
        }
        case "secret-goal":
        case "secret-interests":
        case "secret-method": {
          p = p.replace(/^secret-/, "");
          const h = l[p]();
          g[`system.secret.${p}`] = {
            isLocked: !1,
            value: h || a[p].value
          };
          break;
        }
        case "gender": {
          g[`system.persona.${p}`] = {
            isLocked: i.gender.isLocked,
            value: c
          };
          break;
        }
        case "trait1":
        case "trait2":
        case "trait3":
        case "secret-trait": {
          const h = i.trait1.isLocked ? i.trait1.value : n(
            Be.NPC.trait,
            i.trait1.value,
            i.trait2.value,
            i.trait3.value,
            a.trait.value
          ), m = i.trait2.isLocked ? i.trait2.value : n(
            Be.NPC.trait,
            h,
            i.trait1.value,
            i.trait2.value,
            i.trait3.value,
            a.trait.value
          ), y = i.trait3.isLocked ? i.trait3.value : n(
            Be.NPC.trait,
            h,
            m,
            i.trait1.value,
            i.trait2.value,
            i.trait3.value,
            a.trait.value
          ), k = a.trait.isLocked ? a.trait.value : n(
            Be.NPC.trait,
            h,
            m,
            y,
            i.trait1.value,
            i.trait2.value,
            i.trait3.value,
            a.trait.value
          );
          i.trait1.isLocked || (g["system.persona.trait1"] = {
            isLocked: !1,
            value: h
          }), i.trait2.isLocked || (g["system.persona.trait2"] = {
            isLocked: !1,
            value: m
          }), i.trait3.isLocked || (g["system.persona.trait3"] = {
            isLocked: !1,
            value: y
          }), a.trait.isLocked || (g["system.secret.trait"] = {
            isLocked: !1,
            value: k
          });
          break;
        }
        default: {
          const h = l[p]();
          g[`system.persona.${p}`] = {
            isLocked: !1,
            value: h || i[p].value
          };
          break;
        }
      }
    }), this.update(g);
  }
  // #endregion NPC Randomizers
  // Unlock lower-level update method for subclasses
  async callOnUpdate(...t) {
    await this._onUpdate(...t);
  }
}
const oe = Ie;
class _l extends ActorSheet {
  /**
   * Override the default getData method to provide additional data for the actor sheet.
   * This includes: cssClass, editable, isGM, actor, system, tierTotal, rollData, activeEffects,
   *                 hasFullVision, hasLimitedVision, hasControl, preparedItems.
   * @returns {BladesActorSheetData} The data object for the actor sheet.
   */
  getData() {
    var s, i;
    const e = super.getData(), t = {
      // Basic actor data.
      cssClass: this.actor.type,
      editable: this.options.editable,
      isGM: (s = game.eunoblades.Tracker) != null && s.system.is_spoofing_player ? !1 : game.user.isGM,
      actor: this.actor,
      system: this.actor.system,
      gamePhase: ((i = game.eunoblades.Tracker) == null ? void 0 : i.phase) || $e.Freeplay,
      tierTotal: this.actor.getFactorTotal(H.tier) > 0 ? w.romanizeNum(this.actor.getFactorTotal(H.tier)) : "0",
      rollData: this.actor.getRollData(),
      activeEffects: Array.from(this.actor.effects),
      hasFullVision: game.user.isGM || this.actor.testUserPermission(game.user, CONST.DOCUMENT_PERMISSION_LEVELS.OBSERVER),
      hasLimitedVision: game.user.isGM || this.actor.testUserPermission(game.user, CONST.DOCUMENT_PERMISSION_LEVELS.LIMITED),
      hasControl: game.user.isGM || this.actor.testUserPermission(game.user, CONST.DOCUMENT_PERMISSION_LEVELS.OWNER)
    };
    return (Te.IsType(this.actor) || Kt.IsType(this.actor)) && (t.preparedItems = {
      abilities: [],
      loadout: [],
      cohorts: {
        gang: this.actor.cohorts.filter((a) => a.type === A.cohort_gang).map((a) => {
          const o = w.unique(Object.values(a.system.subtypes).map((c) => c.trim()).filter((c) => /[A-Za-z]/.test(c))), n = [
            ...Object.values(a.system.elite_subtypes)
          ];
          Kt.IsType(a.parent) && n.push(...(a.parent.upgrades ?? []).map((c) => (c.name ?? "").trim().replace(/^Elite /, "")));
          const l = [...w.unique(
            n.map((c) => c.trim()).filter(
              (c) => /[A-Za-z]/.test(c) && o.includes(c)
            )
          )];
          if (l.length < 2 && l.push(...o.filter((c) => !l.includes(c))), w.unique(l).length === 1)
            a.system.image = Object.values(a.system.elite_subtypes).includes(l[0]) ? `elite-${w.lCase(l[0])}.svg` : `${w.lCase(l[0])}.svg`;
          else if (w.unique(l).length > 1) {
            const [c, u] = l;
            a.system.imageLeft = Object.values(a.system.elite_subtypes).includes(u) ? `elite-${w.lCase(u)}.svg` : `${w.lCase(u)}.svg`, a.system.imageRight = Object.values(a.system.elite_subtypes).includes(c) ? `elite-${w.lCase(c)}.svg` : `${w.lCase(c)}.svg`;
          }
          return Object.assign(
            a.system,
            {
              tierTotal: a.getFactorTotal(H.tier) > 0 ? w.romanizeNum(a.getFactorTotal(H.tier)) : "0",
              cohortRollData: [
                { mode: "untrained", label: "Untrained", color: "transparent", tooltip: "<p>Roll Untrained</p>" }
              ],
              edgeData: Object.fromEntries(Object.values(a.system.edges ?? []).filter((c) => /[A-Za-z]/.test(c)).map((c) => [c.trim(), X.EdgeTooltips[c]])),
              flawData: Object.fromEntries(Object.values(a.system.flaws ?? []).filter((c) => /[A-Za-z]/.test(c)).map((c) => [c.trim(), X.FlawTooltips[c]]))
            }
          ), a;
        }),
        expert: this.actor.activeSubItems.filter((a) => a.type === A.cohort_expert).map((a) => (Object.assign(
          a.system,
          {
            tierTotal: a.getFactorTotal(H.tier) > 0 ? w.romanizeNum(a.getFactorTotal(H.tier)) : "0",
            cohortRollData: [
              { mode: "untrained", label: "Untrained", tooltip: "<h2>Roll Untrained</h2>" }
            ],
            edgeData: Object.fromEntries(Object.values(a.system.edges ?? []).filter((o) => /[A-Za-z]/.test(o)).map((o) => [o.trim(), X.EdgeTooltips[o]])),
            flawData: Object.fromEntries(Object.values(a.system.flaws ?? []).filter((o) => /[A-Za-z]/.test(o)).map((o) => [o.trim(), X.FlawTooltips[o]]))
          }
        ), a))
      },
      projects: []
    }), (oe.IsType(this.actor, z.pc) || oe.IsType(this.actor, z.crew)) && (t.playbookData = {
      dotline: {
        data: this.actor.system.experience.playbook,
        dotlineClass: "xp-playbook",
        target: "system.experience.playbook.value",
        svgKey: "teeth.tall",
        svgFull: "full|frame",
        svgEmpty: "full|half|frame",
        advanceButton: "advance-playbook"
      }
    }, this.actor.system.experience.playbook.value !== this.actor.system.experience.playbook.max && (t.playbookData.tooltip = new Handlebars.SafeString([
      "<h2>At the End of the Session, Gain XP If ...</h2>",
      "<ul>",
      ...Object.values(this.actor.system.experience.clues ?? []).map((a) => `<li>${a.replace(/^Y/, "... y")}</li>`) ?? [],
      "</ul>"
    ].join("")).toString()), t.coinsData = {
      dotline: {
        data: this.actor.system.coins,
        target: "system.coins.value",
        iconEmpty: "coin-full.svg",
        iconFull: "coin-full.svg"
      }
    }), {
      ...e,
      ...t
    };
  }
  // #region LISTENERS & EVENT HANDLERS
  activateListeners(e) {
    super.activateListeners(e), game.user.isGM ? e.attr("style", "--secret-text-display: initial") : e.find('.editor:not(.tinymce) [data-is-secret="true"]').remove(), oa(e), tg.InitListeners(e, this.actor), this.options.editable && (e.find(".dotline").each((t, s) => {
      if ($(s).hasClass("locked"))
        return;
      let i = this.actor, a = $(s).data("target");
      const o = $(s).closest("comp");
      if (a.startsWith("item")) {
        a = a.replace(/^item\./, "");
        const l = $(s).closest("[data-comp-id]").data("compId");
        if (!l)
          return;
        const c = this.actor.items.get(l);
        if (!c)
          return;
        i = c;
      }
      const n = w.pInt($(s).data("value"));
      $(s).find(".dot").each((l, c) => {
        $(c).on("click", (u) => {
          u.preventDefault();
          const g = w.pInt($(c).data("value"));
          g !== n && (o.hasClass("comp-coins") || o.hasClass("comp-stash") ? Qa.effects.fillCoins($(c).prevAll(".dot")).then(() => i.update({ [a]: g })) : i.update({ [a]: g }));
        }), $(c).on("contextmenu", (u) => {
          u.preventDefault();
          const g = w.pInt($(c).data("value")) - 1;
          g !== n && i.update({ [a]: g });
        });
      });
    }), e.find("[data-comp-id]").find(".comp-title").on({ click: this._onItemOpenClick.bind(this) }), e.find(".comp-control.comp-add").on({ click: this._onItemAddClick.bind(this) }), e.find(".comp-control.comp-delete").on({ click: this._onItemRemoveClick.bind(this) }), e.find(".comp-control.comp-delete-full").on({ click: this._onItemFullRemoveClick.bind(this) }), e.find(".comp-control.comp-toggle").on({ click: this._onItemToggleClick.bind(this) }), e.find(`
        select[data-action='player-select'],
        select[data-action='gm-select']
      `).on({ change: this._onSelectChange.bind(this) }), e.find("[data-action='toggle-value'").on({ click: this._onToggleValueClick.bind(this) }), e.find(".advance-button").on({ click: this._onAdvanceClick.bind(this) }), e.find(".effect-control").on({ click: this._onActiveEffectControlClick.bind(this) }), e.find("[data-roll-trait]").on({ click: this._onRollTraitClick.bind(this) }), e.find("[data-action*='downtime-action-']").on({ click: this._onDowntimeActionClick.bind(this) }), this.options.submitOnChange && e.on("change", "textarea", this._onChangeInput.bind(this)));
  }
  async _onSubmit(e, t = {}) {
    return !game.user.isGM && !this.actor.testUserPermission(game.user, CONST.DOCUMENT_PERMISSION_LEVELS.OWNER) ? (eLog.checkLog("actorSheetTrigger", "User does not have permission to edit this actor", { user: game.user, actor: this.actor }), {}) : super._onSubmit(e, t);
  }
  async close(e) {
    return this.actor.type === z.pc ? super.close(e).then(() => this.actor.clearSubActors()) : this.actor.type === z.npc && this.actor.parentActor ? super.close(e).then(() => this.actor.clearParentActor(!1)) : super.close(e);
  }
  // #region Component Handlers
  _getCompData(e) {
    const t = $(e.currentTarget).closest(".comp"), s = {
      elem$: t,
      docID: t.data("compId"),
      docCat: t.data("compCat"),
      docType: t.data("compType"),
      docTags: (t.data("compTags") ?? "").split(/\s+/g)
    };
    return eLog.checkLog2("dialog", "Component Data", { elem: t, ...s }), s.docID && s.docType && (s.doc = {
      Actor: this.actor.getSubActor(s.docID),
      Item: this.actor.getSubItem(s.docID)
    }[s.docType]), s.docCat && s.docType && (Te.IsType(this.actor) || Kt.IsType(this.actor)) && (s.dialogDocs = {
      Actor: this.actor.getDialogActors(s.docCat),
      Item: this.actor.getDialogItems(s.docCat)
    }[s.docType]), s;
  }
  _onItemOpenClick(e) {
    var s;
    e.preventDefault();
    const { doc: t } = this._getCompData(e);
    t && ((s = t.sheet) == null || s.render(!0));
  }
  async _onItemAddClick(e) {
    e.preventDefault();
    const t = $(e.currentTarget).closest(".comp").data("addType");
    if (t && t in A) {
      await this.actor.createEmbeddedDocuments("Item", [
        {
          name: {
            [A.cohort_gang]: "A Gang",
            [A.cohort_expert]: "An Expert"
          }[t] ?? randomID(),
          type: t
        }
      ]);
      return;
    }
    const { docCat: s, docType: i, dialogDocs: a, docTags: o } = this._getCompData(e);
    !a || !s || !i || await na.DisplaySelectionDialog(
      this.actor,
      w.tCase(`Add ${s.replace(/_/g, " ")}`),
      i,
      a,
      o
    );
  }
  async _onItemRemoveClick(e) {
    e.preventDefault();
    const { elem$: t, doc: s } = this._getCompData(e);
    s && await Qa.effects.blurRemove(t).then(async () => {
      s instanceof Z ? await this.actor.remSubItem(s) : await this.actor.remSubActor(s);
    });
  }
  async _onItemFullRemoveClick(e) {
    e.preventDefault();
    const { elem$: t, doc: s } = this._getCompData(e);
    s && await Qa.effects.blurRemove(t).then(async () => await s.delete());
  }
  async _onItemToggleClick(e) {
    e.preventDefault();
    const t = $(e.currentTarget).data("target");
    await this.actor.update({
      [t]: !getProperty(this.actor, t)
    });
  }
  async _onSelectChange(e) {
    e.preventDefault(), await w.EventHandlers.onSelectChange(this, e);
  }
  async _onToggleValueClick(e) {
    e.preventDefault();
    const t = $(e.currentTarget), s = t.data("target"), i = t.data("toggleOnVal") || "", a = t.data("toggleOffVal") || "";
    getProperty(this.actor, s) === i ? await this.actor.update({ [s]: a }) : await this.actor.update({ [s]: i });
  }
  async _onAdvanceClick(e) {
    e.preventDefault(), $(e.currentTarget).data("action") === "advance-playbook" && await this.actor.advancePlaybook();
  }
  // #endregion
  // #region Roll Handlers
  async _onRollTraitClick(e) {
    const t = $(e.currentTarget).data("rollTrait"), s = $(e.currentTarget).data("rollType"), i = {
      target: this.actor,
      targetFlagKey: "rollCollab"
    };
    w.lCase(t) in { ...js, ...Tt, ...H } ? i.rollTrait = w.lCase(t) : w.isInt(t) && (i.rollTrait = w.pInt(t)), w.tCase(s) in Oe ? i.rollType = w.tCase(s) : typeof i.rollTrait == "string" && (i.rollTrait in Tt ? i.rollType = Oe.Resistance : i.rollTrait in js && (i.rollType = Oe.Action)), game.user.isGM && (Me.IsDoc(this.actor) ? i.rollPrimaryData = this.actor : jt.IsDoc(this.actor) && (i.rollOppData = this.actor)), await Ur.New(i);
  }
  // Returns TRUE if can proceed, FALSE if action should stop (i.e. panel revealed for another user click)
  async _validateOrRevealSubData(e, t) {
    switch (e) {
      case ke.LongTermProject: {
        if (t === "NewProject")
          return !1;
        const s = game.items.get(t ?? "");
        return !!Co.IsType(s);
      }
      case ke.Recover: {
        const s = game.actors.get(t ?? "");
        return !!(s instanceof oe && s.hasTag(he.NPC.CanHeal));
      }
      case ke.Train:
        return !!/^[a-z]+:\d$/.exec(t ?? "");
      default:
        return !0;
    }
  }
  async _onDowntimeActionClick(e) {
    var o, n, l;
    const t = $(e.currentTarget), s = t.data("action").substring(t.data("action").lastIndexOf("-") + 1), i = t.data("actionSubData");
    if (!await this._validateOrRevealSubData(s, i)) {
      $("#eunos-blades-tooltips").children(".tooltip").remove(), await this.actor.update({ "system.downtime_actions_open_submenu": s }), $("#eunos-blades-tooltips").children(".tooltip").remove();
      return;
    }
    const a = {
      target: this.actor,
      targetFlagKey: "rollCollab",
      rollDowntimeAction: s
    };
    switch (s) {
      case ke.AcquireAsset:
      case ke.LongTermProject:
      case ke.ReduceHeat: {
        a.rollType = Oe.Action;
        break;
      }
      case ke.Recover: {
        a.rollType = Oe.Action, Te.IsType(this.actor) && this.actor.healingClock && (a.rollClockKey = this.actor.healingClock.id);
        break;
      }
      case ke.IndulgeVice: {
        a.rollType = Oe.IndulgeVice;
        break;
      }
      case ke.Train: {
        const [c, u] = i.split(/:/);
        c === "playbook" ? this.actor.update({ [`system.experience.${c}.value`]: w.pInt(((n = (o = this.actor.system.experience) == null ? void 0 : o.playbook) == null ? void 0 : n.value) ?? 0) + w.pInt(u) }) : Te.IsType(this.actor) && this.actor.update({ [`system.experience.${c}.value`]: w.pInt(this.actor.system.experience[c].value) + w.pInt(u) });
        break;
      }
    }
    await this.actor.update({
      "system.downtime_actions_open_submenu": "",
      "system.downtime_actions.value": (((l = this.actor.system.downtime_actions) == null ? void 0 : l.value) ?? 0) + 1
    }), "rollType" in a && (s === ke.IndulgeVice ? Wu.New(a) : Ur.New(a));
  }
  async _onGatherInfoClick(e) {
    $(e.currentTarget).data("isFortuneRoll") ? To.New({
      target: this.actor,
      targetFlagKey: "rollCollab",
      rollType: Oe.Fortune
    }) : Ur.New({
      target: this.actor,
      targetFlagKey: "rollCollab",
      rollType: Oe.Action,
      rollTrait: ""
    });
  }
  // #endregion
  // #region Active Effect Handlers
  _onActiveEffectControlClick(e) {
    ms.onManageActiveEffect(e, this.actor);
  }
  // #endregion
  // #endregion
}
class Kc extends _l {
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "actor", "pc"],
      template: "systems/eunos-blades/templates/actor-sheet.hbs",
      width: 775,
      height: 775,
      tabs: [{ navSelector: ".nav-tabs", contentSelector: ".tab-content", initial: "abilities" }]
    });
  }
  getData() {
    var o, n, l, c;
    const e = super.getData(), { activeSubItems: t, activeSubActors: s } = this.actor, i = {};
    i.preparedItems = Object.assign(
      e.preparedItems ?? {},
      {
        abilities: t.filter((u) => u.type === A.ability).map((u) => (u.system.uses_per_score.max && Object.assign(u, {
          inRuleDotline: {
            data: u.system.uses_per_score,
            dotlineLabel: "Uses",
            target: "item.system.uses_per_score.value",
            iconEmpty: "dot-empty.svg",
            iconEmptyHover: "dot-empty-hover.svg",
            iconFull: "dot-full.svg",
            iconFullHover: "dot-full-hover.svg"
          }
        }), u)),
        background: t.find((u) => u.type === A.background),
        heritage: t.find((u) => u.type === A.heritage),
        vice: t.find((u) => u.type === A.vice),
        loadout: t.filter((u) => u.type === A.gear).map((u) => (u.system.load && Object.assign(u, {
          numberCircle: u.system.load,
          numberCircleClass: "item-load"
        }), u.system.uses_per_score.max && Object.assign(u, {
          inRuleDotline: {
            data: u.system.uses_per_score,
            dotlineLabel: "Uses",
            target: "item.system.uses_per_score.value",
            iconEmpty: "dot-empty.svg",
            iconEmptyHover: "dot-empty-hover.svg",
            iconFull: "dot-full.svg",
            iconFullHover: "dot-full-hover.svg"
          }
        }), u)),
        playbook: this.actor.playbook,
        projects: t.filter((u) => u.type === A.project),
        cohorts: (o = e.preparedItems) == null ? void 0 : o.cohorts
      }
    ), i.preparedActors = {
      crew: s.find((u) => u.type === z.crew),
      vice_purveyor: s.find((u) => u.hasTag(he.NPC.VicePurveyor)),
      acquaintances: s.filter((u) => u.hasTag(he.NPC.Acquaintance))
    }, i.hasVicePurveyor = !!(((n = this.actor.playbook) == null ? void 0 : n.hasTag(he.Gear.Advanced)) === !1 && t.find((u) => u.type === A.vice)), i.healing_clock = this.actor.healingClock, i.stashData = {
      label: "Stash:",
      dotline: {
        data: this.actor.system.stash,
        target: "system.stash.value",
        iconEmpty: "coin-empty.svg",
        iconEmptyHover: "coin-empty-hover.svg",
        iconFull: "coin-full.svg",
        iconFullHover: "coin-full-hover.svg",
        altIconFull: "coin-ten.svg",
        altIconFullHover: "coin-ten-hover.svg",
        altIconStep: 10
      }
    }, i.stressData = {
      label: this.actor.system.stress.name,
      dotline: {
        data: this.actor.system.stress,
        dotlineClass: this.actor.system.stress.max >= 13 ? "narrow-stress" : "",
        target: "system.stress.value",
        svgKey: "teeth.tall",
        svgFull: "full|half|frame",
        svgEmpty: "full|half|frame"
      }
    }, oe.IsType(this.actor, z.pc) && (i.traumaData = {
      label: this.actor.system.trauma.name,
      dotline: {
        data: { value: this.actor.trauma, max: this.actor.system.trauma.max },
        svgKey: "teeth.short",
        svgFull: "full|frame",
        svgEmpty: "frame",
        isLocked: !0
      },
      compContainer: {
        class: "comp-trauma-conditions comp-vertical full-width",
        blocks: [
          this.actor.traumaList.slice(0, Math.ceil(this.actor.traumaList.length / 2)).map((u) => ({
            checkLabel: u,
            checkClasses: {
              active: "comp-toggle-red",
              inactive: "comp-toggle-grey"
            },
            checkTarget: `system.trauma.checked.${u}`,
            checkValue: this.actor.system.trauma.checked[u] ?? !1,
            tooltip: X.TraumaTooltips[u],
            tooltipClass: "tooltip-trauma"
          })),
          this.actor.traumaList.slice(Math.ceil(this.actor.traumaList.length / 2)).map((u) => ({
            checkLabel: u,
            checkClasses: {
              active: "comp-toggle-red",
              inactive: "comp-toggle-grey"
            },
            checkTarget: `system.trauma.checked.${u}`,
            checkValue: this.actor.system.trauma.checked[u] ?? !1,
            tooltip: X.TraumaTooltips[u],
            tooltipClass: "tooltip-trauma"
          }))
        ]
      }
    }), i.abilityData = {
      dotline: {
        dotlineClass: "dotline-right dotline-glow",
        data: {
          value: this.actor.getAvailableAdvancements("Ability"),
          max: this.actor.getAvailableAdvancements("Ability")
        },
        dotlineLabel: "Available Abilities",
        isLocked: !0,
        iconFull: "dot-full.svg"
      }
    }, i.loadData = {
      curLoad: this.actor.currentLoad,
      selLoadCount: this.actor.system.loadout.levels[w.lCase(this.actor.system.loadout.selected)],
      options: X.Loadout.selections,
      selected: this.actor.system.loadout.selected ?? ""
    }, i.armor = Object.fromEntries(Object.entries(this.actor.system.armor.active).filter(([, u]) => u).map(([u]) => [
      u,
      this.actor.system.armor.checked[u]
    ])), i.attributeData = {};
    const a = Object.entries(this.actor.system.attributes);
    for (const [u, g] of a) {
      i.attributeData[u] = {
        tooltip: X.AttributeTooltips[u],
        actions: {}
      };
      const p = Object.entries(g);
      for (const [h, m] of p)
        i.attributeData[u].actions[h] = {
          tooltip: X.ActionTooltips[h],
          value: m.value,
          max: game.eunoblades.Tracker.phase === $e.CharGen ? 2 : this.actor.system.attributes[u][h].max
        };
    }
    if (((l = game.eunoblades.Tracker) == null ? void 0 : l.phase) === $e.Downtime) {
      const u = {
        [ke.AcquireAsset]: "Acquire Asset",
        [ke.IndulgeVice]: "Indulge Vice",
        [ke.LongTermProject]: "Project",
        [ke.Recover]: "Recover",
        [ke.ReduceHeat]: "Reduce Heat",
        [ke.Train]: "Train"
      }, g = [
        ...oe.GetTypeWithTags(z.pc, he.PC.CanHeal),
        ...oe.GetTypeWithTags(z.npc, he.NPC.CanHeal)
        /* ALSO NEED TO INCLUDE EXPERT COHORTS WITH CANHEAL TAG */
      ];
      this.actor.stress === 0 && delete u[ke.IndulgeVice], (this.actor.harmLevel === 0 || g.length === 0) && delete u[ke.Recover], (!this.actor.crew || this.actor.crew.system.heat.value === 0) && delete u[ke.ReduceHeat];
      let p;
      switch (this.actor.system.downtime_actions_open_submenu) {
        case ke.LongTermProject: {
          p = [
            {
              actionSubData: "NewProject",
              display: "New Project"
            }
          ];
          break;
        }
        case ke.Recover: {
          p = [], g.forEach((T) => {
            T.id === this.actor.id ? p == null || p.unshift({
              actionSubData: this.actor.id,
              display: "Heal Self"
            }) : Te.IsType(T) ? p == null || p.push({
              actionSubData: T.id,
              display: w.uCase(T.name)
            }) : ha.IsType(T) && (p == null || p.push({
              actionSubData: T.id,
              display: T.name
            }));
          });
          break;
        }
        case ke.Train: {
          const T = ((c = this.actor.crew) == null ? void 0 : c.upgrades.filter((x) => /^Training_/.exec(x.system.world_name)).map((x) => w.lCase(x.system.world_name.split(/_/)[1]))) ?? [];
          p = [
            {
              actionSubData: `playbook:${T.includes("playbook") ? 2 : 1}`,
              display: `${T.includes("playbook") ? 2 : 1} Playbook XP`
            },
            {
              actionSubData: `insight:${T.includes(Tt.insight) ? 2 : 1}`,
              display: `${T.includes(Tt.insight) ? 2 : 1} Insight XP`
            },
            {
              actionSubData: `prowess:${T.includes(Tt.prowess) ? 2 : 1}`,
              display: `${T.includes(Tt.prowess) ? 2 : 1} Prowess XP`
            },
            {
              actionSubData: `resolve:${T.includes(Tt.resolve) ? 2 : 1}`,
              display: `${T.includes(Tt.resolve) ? 2 : 1} Resolve XP`
            }
          ];
          break;
        }
      }
      const h = {
        [ke.AcquireAsset]: `<h1>Acquire an Asset</h1>
        <p>Roll your <strong class='gold-bright'>Tier</strong> to acquire temporary use of an asset or service.</p>
        <p>The <strong>Quality</strong> of the acquired asset depends on the result of your roll:</p>
        <ul>
        <li><strong class='gold-bright'>Critical Success</strong> &mdash; <strong class='gold-bright'>Tier</strong> <strong>+ 2</strong></li>
        <li><strong>Success</strong> &mdash; <strong class='gold-bright'>Tier</strong> <strong>+ 2</strong></li>
        <li><b>Partial Success</b> &mdash; <strong class='gold-bright'>Tier</strong></li>
        <li><strong class='red-bright'>Fail</strong> &mdash; <strong class='gold-bright'>Tier</strong> <strong>− 1</strong></li>
        </ul>`,
        [ke.IndulgeVice]: `<h1>Indulge Your Vice</h1>
        <p>Roll your <strong class='red-bright'>lowest</strong> <strong>Attribute</strong>. Clear <strong>Stress</strong> equal to the <strong>highest</strong> die result.</p>
        <p><strong class="red-bright">Warning:</strong> If you clear more <strong>Stress</strong> than you have, you will <strong class="red-bright">overindulge</strong>.</p>`,
        [ke.LongTermProject]: `<h1>Work on a Long-Term Project</h1>
        <p>Work to <strong>advance the clock</strong> of one of your existing <strong>Long-Term Projects</strong>, or begin a new one.</p>
        <p>Roll the <strong>Action</strong> most appropriate to the work you are doing. The results of your roll determine how far you will <strong>advance the clock</strong>:</p>
        <ul>
        <li><strong class='gold-bright'>Critical Success</strong> &mdash; <strong class='gold-bright'>Five</strong> Segments</li>
        <li><strong>Success</strong> &mdash;  <strong>Three</strong> Segments</li>
        <li><b>Partial Success</b> &mdash; <b>Two</b> Segments</li>
        <li><strong class='red-bright'>Fail</strong> &mdash; <strong class='red-bright'>One</strong> Segment</li>
        </ul>`,
        [ke.Recover]: `<h1>Recover from Harm</h1>
        <p>Make a <strong>healing treatment roll</strong> using the appropriate trait of the character healing you:</p>
        <ul>
        <li><strong>A PC with 'Physicker'</strong> &mdash; <strong>Tinker</strong>. <em>(You can heal yourself this way, but suffer <strong class="red-bright">2 Stress</strong> for doing so.)</em></li>
        <li><strong>An NPC</strong> &mdash; <strong>Quality</strong></li>
        </ul>
        <p>The results of your roll determine how far you will <strong>Advance your healing clock</strong>:</p>
        <ul>
        <li><strong class='gold-bright'>Critical Success</strong> &mdash; <strong class='gold-bright'>Five</strong> Segments</li>
        <li><strong>Success</strong> &mdash;  <strong>Three</strong> Segments</li>
        <li><b>Partial Success</b> &mdash; <b>Two</b> Segments</li>
        <li><strong class='red-bright'>Fail</strong> &mdash; <strong class='red-bright'>One</strong> Segment</li>
        </ul>
        <p>When your <strong>healing clock</strong> is filled, reduce each Harm by one level of severity.</p>`,
        [ke.ReduceHeat]: `<h1>Reduce Heat</h1>
        <p>Work to <strong>reduce the Heat</strong> on your Crew.</p>
        <p>Roll the <strong>Action</strong> most appropriate to the measures you are taking. The results of your roll determine how much <strong class="red-bright">Heat</strong> you clear:</p>
        <ul>
        <li><strong class='gold-bright'>Critical Success</strong> &mdash; <strong class='gold-bright'>Five</strong> Heat</li>
        <li><strong>Success</strong> &mdash;  <strong>Three</strong> Heat</li>
        <li><b>Partial Success</b> &mdash; <b>Two</b> Heat</li>
        <li><strong class='red-bright'>Fail</strong> &mdash; <strong class='red-bright'>One</strong> Heat</li>
        </ul>`,
        [ke.Train]: `<h1>Train</h1>
        <p>Select an <strong>Experience Track</strong> <em>(i.e. Insight, Prowess, Resolve, or your Playbook)</em>. Gain <strong>1 XP</strong> in that track, or <strong>2 XP</strong> if your Crew has the corresponding <strong>Training Upgrade</strong>.</p>`
      }, m = this.actor.system.downtime_actions.max + this.actor.system.downtime_action_bonus - this.actor.system.downtime_actions.value - (this.actor.isAtWar ? 1 : 0), y = this.actor.system.coins.value >= 1 || this.actor.system.stash.value >= 2, k = !!(this.actor.crew && this.actor.crew.system.rep.value >= 1), _ = m <= 0, C = m > 0 || y && this.actor.system.downtime_action_selected_cost === "Coin" || k && this.actor.system.downtime_action_selected_cost === "Rep";
      i.downtimeData = {
        actionsList: u,
        actionsTooltips: h,
        actionsRemaining: m,
        actionsSubmenuData: p,
        canPayCoin: y,
        canPayRep: k,
        isDisplayingCosts: _,
        isDisplayingActions: C,
        dotline: {
          dotlineClass: "dotline-right dotline-glow",
          data: {
            value: m,
            max: m
          },
          dotlineLabel: "Actions Remaining",
          isLocked: !0,
          iconFull: "dot-full.svg"
        }
      };
    }
    return i.gatherInfoTooltip = new Handlebars.SafeString([
      "<h1>Gathering Information</h1>",
      "<h2>Questions to Consider</h2>",
      "<ul>",
      ...Object.values(this.actor.system.gather_info ?? []).map((u) => `<li>${u}</li>`) ?? [],
      "</ul>"
    ].join("")).toString(), eLog.checkLog("Attribute", "[BladesPCSheet] attributeData", { attributeData: i.attributeData }), eLog.checkLog("actor", "[BladesPCSheet] getData()", { ...e, ...i }), { ...e, ...i };
  }
  get activeArmor() {
    return Object.keys(w.objFilter(
      this.actor.system.armor.active,
      (e) => e === !0
    ));
  }
  get checkedArmor() {
    return Object.keys(w.objFilter(
      this.actor.system.armor.checked,
      (e, t) => e === !0 && this.actor.system.armor.active[t] === !0
    ));
  }
  get uncheckedArmor() {
    return Object.keys(w.objFilter(
      this.actor.system.armor.active,
      (e, t) => e === !0 && this.actor.system.armor.checked[t] === !1
    ));
  }
  _getHoverArmor() {
    return this.activeArmor.length ? this.activeArmor.includes("heavy") ? this.checkedArmor.includes("heavy") ? "light" : "heavy" : this.activeArmor.includes("light") ? "light" : "special" : !1;
  }
  _getClickArmor() {
    return this.uncheckedArmor.length ? this.uncheckedArmor.includes("heavy") ? "heavy" : this.uncheckedArmor.includes("light") ? "light" : "special" : !1;
  }
  _getContextMenuArmor() {
    return this.checkedArmor.length ? this.checkedArmor.includes("light") ? "light" : this.checkedArmor.includes("heavy") ? "heavy" : "special" : !1;
  }
  async _onAdvanceClick(e) {
    e.preventDefault(), super._onAdvanceClick(e);
    const t = $(e.currentTarget).data("action").replace(/^advance-/, "");
    t in Tt && await this.actor.advanceAttribute(t);
  }
  activateListeners(e) {
    if (super.activateListeners(e), !this.options.editable)
      return;
    const t = this;
    e.find(".main-armor-control").on({
      click() {
        const s = t._getClickArmor();
        s && t.actor.update({ [`system.armor.checked.${s}`]: !0 });
      },
      contextmenu() {
        const s = t._getContextMenuArmor();
        s && t.actor.update({ [`system.armor.checked.${s}`]: !1 });
      },
      mouseenter() {
        const s = t._getHoverArmor();
        eLog.log4("Mouse Enter", s, this, $(this), $(this).next()), s && $(this).siblings(`.svg-armor.armor-${s}`).addClass("hover-over");
      },
      mouseleave() {
        const s = t._getHoverArmor();
        s && $(this).siblings(`.svg-armor.armor-${s}`).removeClass("hover-over");
      }
    }), e.find(".special-control").on({
      click() {
        t.activeArmor.includes("special") && t.actor.update({ "system.armor.checked.special": t.uncheckedArmor.includes("special") });
      },
      contextmenu() {
        t.activeArmor.includes("special") && t.actor.update({ "system.armor.checked.special": t.uncheckedArmor.includes("special") });
      },
      mouseenter() {
        !t.activeArmor.includes("special") || t.activeArmor.length === 1 || $(this).siblings(".svg-armor.armor-special").addClass("hover-over");
      },
      mouseleave() {
        !t.activeArmor.includes("special") || t.activeArmor.length === 1 || $(this).siblings(".svg-armor.armor-special").removeClass("hover-over");
      }
    });
  }
}
class eo extends oe {
  // #region INITIALIZATION ~
  static async Initialize() {
    return Object.assign(globalThis, { BladesPC: eo, BladesPCSheet: Kc }), Actors.registerSheet("blades", Kc, { types: ["pc"], makeDefault: !0 }), Hooks.on("dropActorSheetData", async (e, t, { uuid: s }) => {
      const i = fromUuidSync(s);
      i instanceof oe && (e.type === z.crew && i.type === z.pc ? i.addSubActor(e) : e.type === z.pc && i.type === z.crew && e.addSubActor(i));
    }), loadTemplates(["systems/eunos-blades/templates/actor-sheet.hbs"]);
  }
  // #endregion
  // #region Static Overrides: Create, get All ~
  // static override IsType<T extends BladesActorType = BladesActorType.pc>(doc: unknown): doc is BladesActorOfType<T> {
  //   return super.IsType(doc, BladesActorType.pc);
  // }
  static IsType(e) {
    return super.IsType(e, z.pc);
  }
  static GetUser(e) {
    let t;
    return typeof e == "string" ? t = game.users.get(e) ?? game.users.getName(e) : e instanceof User && (t = e), t;
  }
  static GetFromUser(e) {
    var i;
    const t = eo.GetUser(e);
    if (!t)
      throw new Error(`Unable to find user '${e}'`);
    const s = game.actors.get(((i = t.character) == null ? void 0 : i.id) ?? "");
    if (eo.IsType(s))
      return s;
  }
  static async create(e, t = {}) {
    e.token = e.token || {}, e.system = e.system ?? {}, eLog.checkLog2("actor", "BladesPC.create(data,options)", { data: e, options: t }), e.token.actorLink = !0, e.system.experience = {
      playbook: { value: 0, max: 8 },
      insight: { value: 0, max: 6 },
      prowess: { value: 0, max: 6 },
      resolve: { value: 0, max: 6 },
      clues: [],
      ...e.system.experience ?? {}
    };
    const s = await super.create(e, t);
    return await Ft.Create({
      name: "",
      target: s,
      targetKey: "system.clocksData",
      isVisible: !0,
      isNameVisible: !1,
      isSpotlit: !1
    }, void 0, [
      {
        color: Yt.white,
        value: 0,
        max: 4,
        index: 0,
        isVisible: !0,
        isActive: !0,
        isNameVisible: !1,
        isHighlighted: !1
      }
    ]), s;
  }
  static get All() {
    return new Collection(
      super.GetTypeWithTags(z.pc).map((e) => [e.id, e])
    );
  }
  // #endregion
  constructor(e) {
    super(e), eLog.checkLog3("pcConstructor", "new BladesPC()", { data: e });
  }
  // #region BladesPrimaryActor Implementation ~
  get primaryUser() {
    var e;
    return ((e = game.users) == null ? void 0 : e.find((t) => {
      var s;
      return ((s = t.character) == null ? void 0 : s.id) === (this == null ? void 0 : this.id);
    })) || null;
  }
  async clearLoadout() {
    await this.update({ "system.loadout.selected": "" }), this.updateEmbeddedDocuments(
      "Item",
      [
        ...this.activeSubItems.filter((e) => Z.IsType(e, A.gear) && !e.hasTag(he.System.Archived)).map((e) => ({
          _id: e.id,
          "system.tags": [...e.tags, he.System.Archived],
          "system.uses_per_score.value": 0
        })),
        ...this.activeSubItems.filter((e) => Z.IsType(e, A.ability) && e.system.uses_per_score.max).map((e) => ({
          _id: e.id,
          "system.uses_per_score.value": 0
        }))
      ]
    );
  }
  // #endregion
  getSubActor(e) {
    var s;
    const t = super.getSubActor(e);
    if (t)
      return (s = this.primaryUser) != null && s.id && (t.ownership[this.primaryUser.id] = CONST.DOCUMENT_PERMISSION_LEVELS.OWNER), t;
  }
  get isLightArmorEquipped() {
    return this.system.armor.active.light;
  }
  get isLightArmorEquippable() {
    return !this.isLightArmorEquipped && this.remainingLoad >= 2;
  }
  get isLightArmorUsed() {
    return this.system.armor.checked.light;
  }
  get isLightArmorAvailable() {
    return (this.isLightArmorEquipped || this.isLightArmorEquippable) && !this.isLightArmorUsed;
  }
  get isHeavyArmorEquipped() {
    return this.system.armor.active.heavy;
  }
  get isHeavyArmorEquippable() {
    return this.isHeavyArmorEquipped ? !1 : this.isLightArmorEquipped ? this.remainingLoad >= 3 : this.remainingLoad >= 5;
  }
  get isHeavyArmorUsed() {
    return this.system.armor.checked.heavy;
  }
  get isHeavyArmorAvailable() {
    return (this.isHeavyArmorEquipped || this.isHeavyArmorEquippable) && !this.isHeavyArmorUsed;
  }
  get availableArmor() {
    const e = [];
    return this.isLightArmorAvailable && e.push("Light Armor"), this.isHeavyArmorAvailable && e.push("Heavy Armor"), e;
  }
  get isSpecialArmorAvailable() {
    return this.system.armor.active.special && !this.system.armor.checked.special;
  }
  // #region BladesScoundrel Implementation ~
  isMember(e) {
    var t;
    return ((t = this.crew) == null ? void 0 : t.id) === e.id;
  }
  get vice() {
    if (this.type === z.pc)
      return this.activeSubItems.find((e) => e.type === A.vice);
  }
  get crew() {
    return this.activeSubActors.find((e) => oe.IsType(e, z.crew));
  }
  get abilities() {
    return this.playbook ? this.activeSubItems.filter((e) => [A.ability, A.crew_ability].includes(e.type)) : [];
  }
  get cohorts() {
    return this.activeSubItems.filter(
      (e) => Z.IsType(e, A.cohort_gang, A.cohort_expert)
    );
  }
  get playbookName() {
    var e;
    return (e = this.playbook) == null ? void 0 : e.name;
  }
  get playbook() {
    return this.activeSubItems.find((e) => e.type === A.playbook);
  }
  get attributes() {
    if (oe.IsType(this, z.pc))
      return {
        insight: Object.values(this.system.attributes.insight).filter(({ value: e }) => e > 0).length + this.system.resistance_bonus.insight,
        prowess: Object.values(this.system.attributes.prowess).filter(({ value: e }) => e > 0).length + this.system.resistance_bonus.prowess,
        resolve: Object.values(this.system.attributes.resolve).filter(({ value: e }) => e > 0).length + this.system.resistance_bonus.resolve
      };
  }
  get actions() {
    if (oe.IsType(this, z.pc))
      return w.objMap(
        {
          ...this.system.attributes.insight,
          ...this.system.attributes.prowess,
          ...this.system.attributes.resolve
        },
        ({ value: e, max: t }) => w.gsap.utils.clamp(0, t, e)
      );
  }
  get rollable() {
    if (oe.IsType(this, z.pc))
      return {
        ...this.attributes,
        ...this.actions
      };
  }
  get stress() {
    return this.system.stress.value;
  }
  get stressMax() {
    return this.system.stress.max;
  }
  get isHealingClockReady() {
    const [e] = Object.keys(this.system.clocksData);
    return game.eunoblades.ClockKeys.has(e ?? "");
  }
  get healingClock() {
    if (!this.isHealingClockReady)
      return;
    const [e] = Object.keys(this.system.clocksData);
    return game.eunoblades.ClockKeys.get(e ?? "");
  }
  get harmLevel() {
    return this.system.harm.severe.one.length > 1 ? 3 : this.system.harm.moderate.one.length + this.system.harm.moderate.two.length > 0 ? 2 : this.system.harm.lesser.one.length + this.system.harm.lesser.two.length > 0 ? 1 : 0;
  }
  get trauma() {
    return oe.IsType(this, z.pc) ? Object.keys(this.system.trauma.checked).filter((e) => (
      // @ts-ignore Compiler linter mismatch.
      this.system.trauma.active[e] && this.system.trauma.checked[e]
    )).length : 0;
  }
  get traumaList() {
    return oe.IsType(this, z.pc) ? Object.keys(this.system.trauma.active).filter((e) => this.system.trauma.active[e]) : [];
  }
  get activeTraumaConditions() {
    return oe.IsType(this, z.pc) ? w.objFilter(
      this.system.trauma.checked,
      // @ts-ignore Compiler linter mismatch.
      (e, t) => !!(t in this.system.trauma.active && this.system.trauma.active[t])
    ) : {};
  }
  get currentLoad() {
    if (!oe.IsType(this, z.pc))
      return 0;
    const e = this.activeSubItems.filter((t) => t.type === A.gear);
    return w.gsap.utils.clamp(0, 10, e.reduce((t, s) => t + w.pInt(s.system.load), 0));
  }
  get remainingLoad() {
    if (!oe.IsType(this, z.pc) || !this.system.loadout.selected)
      return 0;
    const e = this.system.loadout.levels[game.i18n.localize(this.system.loadout.selected.toString()).toLowerCase()];
    return Math.max(0, e - this.currentLoad);
  }
  async addStash(e) {
    oe.IsType(this, z.pc) && await this.update({ "system.stash.value": Math.min(this.system.stash.value + e, this.system.stash.max) });
  }
  get projects() {
    return this.getSubItemsOfType(A.project);
  }
  get remainingDowntimeActions() {
    return oe.IsType(this, z.pc) ? this.system.downtime_actions.max + this.system.downtime_action_bonus - this.system.downtime_actions.value : 0;
  }
  _processAbilityDialogItems(e) {
    this.playbookName && (e[this.playbookName] = this._processEmbeddedItemMatches(
      Z.GetTypeWithTags(A.ability, this.playbookName)
    ), e.Veteran = this._processEmbeddedItemMatches(Z.GetTypeWithTags(A.ability)).filter((t) => !t.hasTag(this.playbookName)).map((t) => (t.dialogCSSClasses && (t.dialogCSSClasses = t.dialogCSSClasses.replace(/featured-item\s?/g, "")), t)).sort((t, s) => t.system.world_name > s.system.world_name ? 1 : t.system.world_name < s.system.world_name ? -1 : 0));
  }
  processGearDialogItems(e) {
    if (this.playbookName === null)
      return;
    const t = this._processEmbeddedItemMatches([
      ...Z.GetTypeWithTags(A.gear, this.playbookName),
      ...Z.GetTypeWithTags(A.gear, he.Gear.General)
    ]).filter((s) => this.remainingLoad >= s.system.load);
    e[this.playbookName] = t.filter((s) => s.hasTag(this.playbookName)), e.General = t.filter((s) => s.hasTag(he.Gear.General)).map((s) => (s.dialogCSSClasses && (s.dialogCSSClasses = s.dialogCSSClasses.replace(/featured-item\s?/g, "")), s)).sort((s, i) => s.system.world_name > i.system.world_name ? 1 : s.system.world_name < i.system.world_name ? -1 : 0);
  }
  getDialogItems(e) {
    const t = {}, { playbookName: s } = this;
    return e === bt.Heritage ? t.Main = this._processEmbeddedItemMatches(Z.GetTypeWithTags(A.heritage)) : e === bt.Background ? t.Main = this._processEmbeddedItemMatches(Z.GetTypeWithTags(A.background)) : e === bt.Vice && s !== null ? t.Main = this._processEmbeddedItemMatches(Z.GetTypeWithTags(A.vice, s)) : e === bt.Playbook ? (t.Basic = this._processEmbeddedItemMatches(
      Z.GetTypeWithTags(A.playbook).filter((i) => !i.hasTag(he.Gear.Advanced))
    ), t.Advanced = this._processEmbeddedItemMatches(
      Z.GetTypeWithTags(A.playbook, he.Gear.Advanced)
    )) : e === bt.Gear ? this.processGearDialogItems(t) : e === bt.Ability && this._processAbilityDialogItems(t), t;
  }
  getTaggedItemBonuses(e) {
    return e.length;
  }
  // #endregion
  // #region BladesRoll.PrimaryDoc Implementation
  get rollPrimaryModsSchemaSet() {
    const e = super.rollPrimaryModsSchemaSet;
    [
      [/1d/, ae.roll],
      [/Less Effect/, ae.effect]
    ].forEach(([s, i]) => {
      const { one: a, two: o } = Object.values(this.system.harm).find((l) => s.test(l.effect)) ?? {}, n = w.objCompact([a, o === "" ? null : o]).join(" & ");
      n.length > 0 && e.push({
        key: `Harm-negative-${i}`,
        name: n,
        section: i,
        posNeg: "negative",
        base_status: se.ToggledOn,
        modType: Re.harm,
        value: 1,
        tooltip: [
          `<h1 class='sur-title'>${i === ae.roll ? nc.Impaired : nc.Weakened} (Harm)</h1>`,
          `<h1 class='red-bright'>${n}</h1>`,
          i === ae.roll ? "<p>If your injuries apply to the situation at hand, you suffer <strong class='red-bright'>−1d</strong> to your roll.</p>" : "<p>If your injuries apply to the situation at hand, you suffer <strong class='red-bright'>−1 effect</strong>."
        ].join("")
      });
    });
    const { one: t } = Object.values(this.system.harm).find((s) => /Need Help/.test(s.effect)) ?? {};
    return t && t.trim() !== "" && e.push({
      key: "Push-negative-roll",
      name: "PUSH",
      sideString: t.trim(),
      section: ae.roll,
      posNeg: "negative",
      base_status: se.ToggledOn,
      modType: Re.harm,
      value: 0,
      effectKeys: ["Cost-Stress2"],
      tooltip: [
        "<h1 class='sur-title'>Broken (Harm)</h1>",
        `<h1 class='red-bright'>${t.trim()}</h1>`,
        "<p>If your injuries apply to the situation at hand, you must <strong>Push</strong> to act.</p>"
      ].join("")
    }), e;
  }
  async applyHarm(e, t) {
    if (e === 4) {
      St.getInstance().pushNotice_SocketCall(
        "ALL",
        {
          title: `${this.name} Suffers <u><strong>FATAL</strong></u> Harm: ${t}`,
          body: `${this.name}, will you continue as a Ghost, or create a new character?`,
          type: Ls.push,
          cssClasses: "harm-alert fatal-harm-alert"
        }
      );
      return;
    }
    const s = [
      [["lesser", "one"], ["lesser", "two"]],
      [["moderate", "one"], ["moderate", "two"]],
      [["severe", "one"]]
    ].slice(e - 1).flat(1);
    for (; s.length; ) {
      const i = s.shift();
      if (!i)
        break;
      const [a, o] = i;
      if (!this.system.harm[a][o]) {
        St.getInstance().pushNotice_SocketCall(
          "ALL",
          {
            title: `${this.name} Suffers ${w.tCase(a)} Harm: ${t}`,
            type: Ls.push,
            cssClasses: "harm-alert"
          }
        ), await this.update({ [`system.harm.${a}.${o}`]: t });
        return;
      }
    }
    St.getInstance().pushNotice_SocketCall(
      "ALL",
      {
        title: `${this.name} Suffers a Catastrophic, Permanent Injury!`,
        body: `${this.name}, you're out of the action - either left for dead, or otherwise dropped from the action. You can choose to return at the beginning of the next Phase with a permanent injury, or die.`,
        type: Ls.push,
        cssClasses: "harm-alert fatal-harm-alert"
      }
    );
  }
  async applyWorsePosition() {
    this.setFlag("eunos-blades", "isWorsePosition", !0);
  }
  // #endregion
  // #region BladesRoll.ParticipantDoc Implementation
  get rollParticipantID() {
    return this.id;
  }
  get rollParticipantDoc() {
    return this;
  }
  get rollParticipantIcon() {
    var e;
    return ((e = this.playbook) == null ? void 0 : e.img) ?? this.img;
  }
  get rollParticipantName() {
    return this.name ?? "";
  }
  get rollParticipantType() {
    return this.type;
  }
  get rollParticipantModsSchemaSet() {
    return [];
  }
  // #endregion
  async adjustStress(e) {
    const t = Math.min(this.stressMax, Math.max(0, this.stress + e));
    if (t === this.stressMax) {
      St.getInstance().pushNotice_SocketCall("ALL", {
        title: `${this.name} breaks under the stress!`,
        body: `${this.name}: Select a Trauma Condition on your sheet. You are taken out of action and will no longer participate in this score. Narrate what happens.`,
        type: Ls.push,
        cssClasses: "stress-alert"
      }), await this.update({ "system.stress.value": 0 });
      return;
    }
    await this.update({ "system.stress.value": t });
  }
  async indulgeStress(e) {
    e > this.stress && St.getInstance().pushNotice_SocketCall("ALL", {
      title: `${this.name} Overindulges!`,
      body: `${this.name}: Select an option from the list below, and narrate how overindulging your vice led to this result: <ul><li><strong>Attract Trouble:</strong> Roll for an <strong>Entanglement</strong>.</li><li><strong>Brag About Your Exploits:</strong> +2 Heat</li><li><strong>Go AWOL</strong> Vanish for a few weeks. <em>(You will play a different character until the next Downtime Phase, at which point you will return with all Harm healed.)</em></li><li><strong>Tapped:</strong> Your current Vice Purveyor cuts you off. <em>(Until you find a new source for your vice, you will be unable to Indulge Vice during Downtime.)</em></li></ul>`,
      type: Ls.push,
      cssClasses: "stress-alert"
    }), await this.update({ "system.stress.value": this.stress - e });
  }
  async spendArmor(e) {
    const t = {};
    for (; e > 0; ) {
      if (this.isLightArmorAvailable)
        this.isLightArmorEquipped || (t["system.armor.active.light"] = !0), t["system.armor.checked.light"] = !0;
      else if (this.isHeavyArmorAvailable)
        this.isHeavyArmorEquipped || (t["system.armor.active.heavy"] = !0), t["system.armor.checked.heavy"] = !0;
      else
        throw new Error("No armor available to spend");
      e--;
    }
    this.update(t);
  }
  async spendSpecialArmor() {
    this.system.armor.active.special && !this.system.armor.checked.special && await this.update({ "system.armor.checked.special": !0 });
  }
  get rollTraitPCTooltipActions() {
    const e = ["<table><tbody>"], t = this.actions;
    return Object.values(Tt).forEach((s) => {
      X.Action[s].forEach((i) => {
        e.push([
          "<tr>",
          `<td><strong>${w.uCase(i)}</strong></td>`,
          `<td>${"⚪".repeat(t[i])}</td>`,
          `<td><em style="font-family: 'Minion Pro Cond'; font-size: 10px;">(${X.ShortActionTooltips[i]})</em></td>`,
          "</tr>"
        ].join(""));
      });
    }), e.push("</tbody></table>"), e.join("");
  }
  get rollTraitPCTooltipAttributes() {
    const e = ["<table><tbody>"], t = this.attributes;
    return Object.values(Tt).forEach((s) => {
      e.push([
        "<tr>",
        `<td><strong>${w.uCase(s)}</strong></td>`,
        `<td>${"⚪".repeat(t[s])}</td>`,
        `<td><em>(${X.ShortAttributeTooltips[s]})</em></td>`,
        "</tr>"
      ].join(""));
    }), e.push("</tbody></table>"), e.join("");
  }
  // #endregion
  render(e) {
    super.render(e);
  }
}
const Te = eo;
class Gc extends _l {
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "actor", "npc"],
      template: "systems/eunos-blades/templates/npc-sheet.hbs",
      width: 500,
      height: 400,
      // height: "auto",
      tabs: [{ navSelector: ".nav-tabs", contentSelector: ".tab-content", initial: "description" }]
    });
  }
  getData() {
    const e = super.getData();
    e.isSubActor = e.actor.isSubActor, e.parentActor = e.actor.parentActor, e.persona = e.actor.system.persona, e.random = e.actor.system.random, e.secret = e.actor.system.secret;
    const t = {
      name: { size: 3, label: "Name" },
      gender: { size: "half", label: "Gender" },
      heritage: { size: "third", label: "Heritage" },
      background: { size: "third", label: "Background" },
      profession: { size: "third", label: "Profession" },
      appearance: { size: 2, label: "Appearance" },
      style: { size: 2, label: "Style" },
      quirk: { size: 4, label: "Quirk" },
      goal: { size: 2, label: "Goal" },
      method: { size: 2, label: "Method" },
      interests: { size: 4, label: "Interests" },
      trait: { size: "half", label: "Trait" },
      trait1: { size: "half", label: null },
      trait2: { size: "half", label: null },
      trait3: { size: "half", label: null }
    };
    for (const s of ["persona", "random", "secret"])
      for (const [i] of Object.entries(e[s]))
        i in t && Object.assign(
          e[s][i],
          t[i]
        );
    return console.log({ persona: e.persona, random: e.random, secret: e.secret }), e;
  }
  activateListeners(e) {
    super.activateListeners(e), this.options.editable && (e.find(".gm-alert-header").on("click", async (t) => {
      t.preventDefault(), this.actor.clearParentActor();
    }), e.find('[data-action="randomize"').on("click", () => {
      this.actor.updateRandomizers();
    }), e.find(".comp-status-toggle").on("click", () => {
      const { tags: t } = this.actor;
      this.actor.system.status === 1 ? (w.remove(t, "Friend"), t.push("Rival"), this.actor.update({
        "system.status": -1,
        "system.tags": w.unique(t)
      })) : (w.remove(t, "Rival"), t.push("Friend"), this.actor.update({
        "system.status": 1,
        "system.tags": w.unique(t)
      }));
    }).on("contextmenu", () => {
      this.actor.update({ "system.status": 0 });
    }));
  }
}
class zu extends oe {
  // #region INITIALIZATION ~
  static async Initialize() {
    return Object.assign(globalThis, { BladesNPC: zu, BladesNPCSheet: Gc }), Actors.registerSheet("blades", Gc, { types: ["npc"], makeDefault: !0 }), loadTemplates(["systems/eunos-blades/templates/npc-sheet.hbs"]);
  }
  // #endregion
  static IsType(e) {
    return super.IsType(e, z.npc);
  }
  // #region BladesRoll Implementation
  get rollFactors() {
    const e = super.rollFactors;
    return e[H.scale] = {
      name: H.scale,
      display: "Scale",
      value: this.getFactorTotal(H.scale),
      max: this.getFactorTotal(H.scale),
      baseVal: this.getFactorTotal(H.scale),
      cssClasses: "factor-grey",
      isActive: !1,
      isPrimary: !1,
      isDominant: !1,
      highFavorsPC: !0
    }, e[H.magnitude] = {
      name: H.magnitude,
      display: "Magnitude",
      value: this.getFactorTotal(H.magnitude),
      max: this.getFactorTotal(H.magnitude),
      baseVal: this.getFactorTotal(H.magnitude),
      isActive: !1,
      isPrimary: !1,
      isDominant: !1,
      highFavorsPC: !0
    }, e;
  }
  // #region BladesRoll.OppositionDoc Implementation
  get rollOppID() {
    return this.id;
  }
  get rollOppDoc() {
    return this;
  }
  get rollOppImg() {
    return this.img;
  }
  get rollOppName() {
    return this.name;
  }
  get rollOppSubName() {
    return this.system.subtitle || this.system.concept || " ";
  }
  get rollOppType() {
    return this.type;
  }
  get rollOppModsSchemaSet() {
    return [];
  }
  // #endregion
  // #region BladesRoll.ParticipantDoc Implementation
  get rollParticipantID() {
    return this.id;
  }
  get rollParticipantDoc() {
    return this;
  }
  get rollParticipantIcon() {
    return this.img;
  }
  get rollParticipantName() {
    return this.name;
  }
  get rollParticipantType() {
    return this.type;
  }
  get rollParticipantModsSchemaSet() {
    return [];
  }
  // #endregion
  // #endregion
}
const ha = zu;
class Vc extends _l {
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "actor", "faction"],
      template: "systems/eunos-blades/templates/faction-sheet.hbs",
      width: 900,
      height: "auto",
      tabs: [{ navSelector: ".nav-tabs", contentSelector: ".tab-content", initial: "overview" }]
    });
  }
  getData() {
    const e = super.getData();
    if (!oe.IsType(this.actor, z.faction))
      return e;
    const t = {
      tierData: {
        class: "comp-tier comp-vertical comp-teeth",
        label: "Tier",
        labelClass: "filled-label full-width",
        dotline: {
          data: this.actor.system.tier,
          target: "system.tier.value",
          svgKey: "teeth.tall",
          svgFull: "full|half|frame",
          svgEmpty: "full|half|frame"
        }
      },
      clockKeys: this.actor.clocks
    };
    return {
      ...e,
      ...t
    };
  }
  async _onClockAddClick(e) {
    e.preventDefault(), this.actor.addClock();
  }
  async _onClockDeleteClick(e) {
    e.preventDefault();
    const t = $(e.currentTarget).data("clockId");
    t && this.actor.deleteClock(t);
  }
  activateListeners(e) {
    super.activateListeners(e), this.options.editable && (e.find(".item-body").on("click", (t) => {
      var a;
      const s = $(t.currentTarget).parents(".item"), i = this.actor.items.get(s.data("itemId"));
      (a = i == null ? void 0 : i.sheet) == null || a.render(!0);
    }), e.find(".comp-control.comp-add-clock").on("click", this._onClockAddClick.bind(this)), e.find(".comp-control.comp-delete-clock").on("click", this._onClockDeleteClick.bind(this)));
  }
}
class qu extends oe {
  // #region INITIALIZATION ~
  static async Initialize() {
    return Object.assign(globalThis, { BladesFaction: qu, BladesFactionSheet: Vc }), Actors.registerSheet("blades", Vc, { types: ["faction"], makeDefault: !0 }), loadTemplates(["systems/eunos-blades/templates/faction-sheet.hbs"]);
  }
  // #endregion
  static get All() {
    return new Collection(
      super.GetTypeWithTags(z.faction).map((e) => [e.id, e])
    );
  }
  static IsType(e) {
    return super.IsType(e, z.faction);
  }
  // #region BladesRoll Implementation
  // #region BladesRoll.OppositionDoc Implementation
  get rollOppID() {
    return this.id;
  }
  get rollOppDoc() {
    return this;
  }
  get rollOppImg() {
    return this.img ?? "";
  }
  get rollOppName() {
    return this.name ?? "";
  }
  get rollOppSubName() {
    return this.system.subtitle || this.system.concept || " ";
  }
  get rollOppType() {
    return this.type;
  }
  get rollOppModsSchemaSet() {
    return [];
  }
  // #endregion
  // #endregion
  // _clocks: Collection<BladesClock> = new Collection();
  // get clocks(): Collection<BladesClock> = {
  //   return new Collection()
  // }
  get clocks() {
    return new Collection(
      Object.entries(this.system.clocksData ?? {}).map(([e, t]) => [
        e,
        game.eunoblades.ClockKeys.get(e) ?? new Ft(t)
      ])
    );
  }
  async addClock() {
    return await Ft.Create({
      target: this,
      targetKey: "system.clocksData"
    });
  }
  async deleteClock(e) {
    var t;
    await ((t = game.eunoblades.ClockKeys.get(e)) == null ? void 0 : t.delete(game.eunoblades.ClockKeys));
  }
}
const da = qu;
class zc extends _l {
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "actor", "crew"],
      template: "systems/eunos-blades/templates/crew-sheet.hbs",
      width: 940,
      height: 820,
      tabs: [{ navSelector: ".nav-tabs", contentSelector: ".tab-content", initial: "claims" }]
    });
  }
  getData() {
    const e = super.getData();
    eLog.checkLog("actor", "[BladesCrewSheet] super.getData()", { ...e });
    const { activeSubItems: t } = this.actor, s = {};
    return s.preparedItems = Object.assign(
      e.preparedItems ?? {},
      {
        abilities: t.filter((i) => i.type === A.crew_ability),
        playbook: this.actor.playbook,
        reputation: t.find((i) => i.type === A.crew_reputation),
        upgrades: t.filter((i) => i.type === A.crew_upgrade),
        preferredOp: t.find((i) => i.type === A.preferred_op)
      }
    ), s.preparedActors = {
      members: this.actor.members,
      contacts: this.actor.contacts
    }, s.tierData = {
      label: "Tier",
      dotline: {
        data: this.actor.system.tier,
        target: "system.tier.value",
        iconEmpty: "dot-empty.svg",
        iconEmptyHover: "dot-empty-hover.svg",
        iconFull: "dot-full.svg",
        iconFullHover: "dot-full-hover.svg"
      }
    }, s.upgradeData = {
      dotline: {
        dotlineClass: "dotline-right",
        data: {
          value: this.actor.availableUpgradePoints,
          max: this.actor.availableUpgradePoints
        },
        dotlineLabel: "Available Upgrade Points",
        isLocked: !0,
        iconFull: "dot-full.svg"
      }
    }, s.abilityData = {
      dotline: {
        dotlineClass: "dotline-right",
        data: {
          value: this.actor.availableAbilityPoints,
          max: this.actor.availableAbilityPoints
        },
        dotlineLabel: "Available Ability Points",
        isLocked: !0,
        iconFull: "dot-full.svg"
      }
    }, s.cohortData = {
      dotline: {
        dotlineClass: "dotline-right",
        data: {
          value: this.actor.availableCohortPoints,
          max: this.actor.availableCohortPoints
        },
        dotlineLabel: "Available Cohort Points",
        isLocked: !0,
        iconFull: "dot-full.svg"
      }
    }, s.repData = {
      label: "Rep",
      dotlines: [
        {
          data: {
            value: Math.min(this.actor.system.rep.value, this.actor.system.rep.max - this.actor.turfCount),
            max: this.actor.system.rep.max - this.actor.turfCount
          },
          target: "system.rep.value",
          svgKey: "teeth.tall",
          svgFull: "full|half|frame",
          svgEmpty: "full|half|frame"
        },
        {
          data: {
            value: this.actor.turfCount,
            max: this.actor.turfCount
          },
          target: "none",
          svgKey: "teeth.tall",
          svgFull: "full|half|frame",
          svgEmpty: "full|half|frame",
          dotlineClass: "flex-row-reverse",
          isLocked: !0
        }
      ]
    }, s.heatData = {
      label: "Heat",
      dotline: {
        data: this.actor.system.heat,
        target: "system.heat.value",
        svgKey: "teeth.tall",
        svgFull: "full|half|frame",
        svgEmpty: "full|half|frame"
      }
    }, s.wantedData = {
      label: "Wanted",
      dotline: {
        data: this.actor.system.wanted,
        target: "system.wanted.value",
        svgKey: "teeth.short",
        svgFull: "full|frame",
        svgEmpty: "frame"
      }
    }, eLog.checkLog("actor", "[BladesCrewSheet] return getData()", { ...e, ...s }), { ...e, ...s };
  }
  activateListeners(e) {
    super.activateListeners(e), this.options.editable && (e.find(".item-sheet-open").on("click", (t) => {
      var a;
      const s = $(t.currentTarget).parents(".item"), i = this.actor.items.get(s.data("itemId"));
      (a = i == null ? void 0 : i.sheet) == null || a.render(!0);
    }), e.find(".hold-toggle").on("click", () => {
      this.actor.update({ "system.hold": this.actor.system.hold === "weak" ? "strong" : "weak" });
    }), e.find(".turf-select").on("click", async (t) => {
      var a;
      const s = $(t.currentTarget).data("turfId"), i = $(t.currentTarget).data("turfStatus");
      (a = this.actor.playbook) == null || a.update({ [`system.turfs.${s}.value`]: !i }).then(() => this.render(!1));
    }));
  }
}
class Yu extends oe {
  // #region INITIALIZATION ~
  static async Initialize() {
    return Object.assign(globalThis, { BladesCrew: Yu, BladesCrewSheet: zc }), Actors.registerSheet("blades", zc, { types: ["crew"], makeDefault: !0 }), loadTemplates(["systems/eunos-blades/templates/crew-sheet.hbs"]);
  }
  // #endregion
  // #region Static Overrides: Create ~
  // static override IsType<T extends BladesActorType = BladesActorType.crew>(doc: unknown): doc is BladesActorOfType<T> {
  //   return super.IsType(doc, BladesActorType.crew);
  // }
  static IsType(e) {
    return super.IsType(e, z.crew);
  }
  static GetFromUser(e) {
    const t = Te.GetFromUser(e);
    if (t)
      return t.crew;
  }
  static GetFromPC(e) {
    let t;
    if (typeof e == "string" ? t = game.actors.get(e) ?? game.actors.getName(e) : e instanceof Te ? t = e : t ?? (t = Te.GetFromUser(e)), !Te.IsType(t))
      throw new Error(`Unable to find BladesPC from '${e}'`);
    return t.crew;
  }
  static async create(e, t = {}) {
    return e.token = e.token || {}, e.system = e.system ?? {}, eLog.checkLog2("actor", "BladesActor.create(data,options)", { data: e, options: t }), e.token.actorLink = !0, e.system.world_name = e.system.world_name ?? e.name.replace(/[^A-Za-z_0-9 ]/g, "").trim().replace(/ /g, "_"), e.system.experience = {
      playbook: { value: 0, max: 8 },
      clues: [],
      ...e.system.experience ?? {}
    }, super.create(e, t);
  }
  // #endregion
  // #region BladesCrew Implementation
  getDialogItems(e) {
    const t = {}, { playbookName: s } = this;
    return e === bt.Playbook ? t.Main = this._processEmbeddedItemMatches(Z.GetTypeWithTags(A.crew_playbook)) : e === bt.Reputation ? t.Main = this._processEmbeddedItemMatches(Z.GetTypeWithTags(A.crew_reputation)) : e === bt.Preferred_Op && s !== null ? t.Main = this._processEmbeddedItemMatches(
      Z.GetTypeWithTags(A.preferred_op, s)
    ) : e === bt.Ability ? t.Main = this._processEmbeddedItemMatches(
      Z.GetTypeWithTags(A.crew_ability, this.playbookName)
    ) : e === bt.Upgrade && s !== null && (t[s] = this._processEmbeddedItemMatches(
      Z.GetTypeWithTags(A.crew_upgrade, s)
    ), t.General = this._processEmbeddedItemMatches(
      Z.GetTypeWithTags(A.crew_upgrade, he.Gear.General)
    )), t;
  }
  get members() {
    if (!oe.IsType(this, z.crew))
      return [];
    const e = this;
    return oe.GetTypeWithTags(z.pc).filter((t) => t.isMember(e));
  }
  get contacts() {
    if (!oe.IsType(this, z.crew) || !this.playbook)
      return [];
    const e = this;
    return this.activeSubActors.filter((t) => t.hasTag(e.playbookName));
  }
  get claims() {
    return !oe.IsType(this, z.crew) || !this.playbook ? {} : this.playbook.system.turfs;
  }
  get turfCount() {
    return !oe.IsType(this, z.crew) || !this.playbook ? 0 : Object.values(this.playbook.system.turfs).filter((e) => e.isTurf && e.value).length;
  }
  get upgrades() {
    return !oe.IsType(this, z.crew) || !this.playbook ? [] : this.activeSubItems.filter((e) => e.type === A.crew_upgrade);
  }
  get cohorts() {
    return this.activeSubItems.filter((e) => [A.cohort_gang, A.cohort_expert].includes(e.type));
  }
  getTaggedItemBonuses(e) {
    return e.length;
  }
  // #endregion
  // #region BladesRoll Implementation
  // #region BladesRoll.ParticipantDoc Implementation
  get rollParticipantID() {
    return this.id;
  }
  get rollParticipantDoc() {
    return this;
  }
  get rollParticipantIcon() {
    var e;
    return ((e = this.playbook) == null ? void 0 : e.img) ?? this.img;
  }
  get rollParticipantName() {
    return this.name;
  }
  get rollParticipantType() {
    return this.type;
  }
  get rollParticipantModsSchemaSet() {
    return [];
  }
  async applyHarm(e, t) {
    console.error("Attempt to apply harm directly to a Crew document.");
  }
  async applyWorsePosition() {
    console.error("Attempt to apply worse position directly to a Crew document.");
  }
  // #endregion
  // #endregion
  get abilities() {
    return this.playbook ? this.activeSubItems.filter((e) => [A.ability, A.crew_ability].includes(e.type)) : [];
  }
  get playbookName() {
    var e;
    return (e = this.playbook) == null ? void 0 : e.name;
  }
  get playbook() {
    return this.activeSubItems.find((e) => e.type === A.crew_playbook);
  }
}
const Kt = Yu, Ql = {
  [z.pc]: Te,
  [z.npc]: ha,
  [z.faction]: da,
  [z.crew]: Kt
}, g3 = new Proxy(function() {
}, {
  construct(r, e) {
    const [{ type: t }] = e;
    if (!t)
      throw new Error(`Invalid Actor Type: ${String(t)}`);
    const s = Ql[t];
    return s ? new s(...e) : new oe(...e);
  },
  get(r, e) {
    switch (e) {
      case "create":
      case "createDocuments":
        return function(t, s = {}) {
          if (w.isArray(t))
            return t.map((a) => CONFIG.Actor.documentClass.create(a, s));
          const i = Ql[t.type];
          return i ? i.create(t, s) : oe.create(t, s);
        };
      case Symbol.hasInstance:
        return function(t) {
          return Object.values(Ql).some((s) => t instanceof s);
        };
      default:
        return oe[e];
    }
  }
});
class ar extends ChatMessage {
  static Initialize() {
    return Hooks.on("renderChatMessage", (e, t) => {
      oa(t), e.isBladesRoll && (t.addClass("blades-chat-message"), t.addClass("blades-roll-message"), $s.ApplyChatListeners(e)), t.addClass("display-ok");
    }), loadTemplates([
      "systems/eunos-blades/templates/chat/blades-message.hbs",
      "systems/eunos-blades/templates/chat/roll-result/action.hbs",
      "systems/eunos-blades/templates/chat/roll-result/action-clock.hbs",
      "systems/eunos-blades/templates/chat/roll-result/action-acquireasset.hbs",
      "systems/eunos-blades/templates/chat/roll-result/action-reduceheat.hbs",
      "systems/eunos-blades/templates/chat/roll-result/action-clock-recover.hbs",
      "systems/eunos-blades/templates/chat/roll-result/action-gatherinfo.hbs",
      "systems/eunos-blades/templates/chat/roll-result/fortune.hbs",
      "systems/eunos-blades/templates/chat/roll-result/fortune-clock.hbs",
      "systems/eunos-blades/templates/chat/roll-result/fortune-gatherinfo.hbs",
      "systems/eunos-blades/templates/chat/roll-result/fortune-incarceration.hbs",
      "systems/eunos-blades/templates/chat/roll-result/fortune-engagement.hbs",
      "systems/eunos-blades/templates/chat/roll-result/indulgevice.hbs",
      "systems/eunos-blades/templates/chat/roll-result/resistance.hbs",
      "systems/eunos-blades/templates/chat/components/inline-resistance.hbs",
      "systems/eunos-blades/templates/chat/components/die.hbs"
    ]);
  }
  static get template() {
    return "systems/eunos-blades/templates/chat/blades-message.hbs";
  }
  static async create(e, t = {}) {
    return e.bladesRoll ? { data: e, options: t } = await ar.ConstructBladesRollData(
      e,
      t
    ) : { data: e, options: t } = await ar.ConstructBladesChatMessageData(
      e,
      t
    ), super.create(e, t);
  }
  static async ConstructBladesRollData(e, t = {}) {
    const { bladesRoll: s, ...i } = e, a = {
      speaker: s.getSpeaker(ar.getSpeaker()),
      content: await renderTemplate(s.chatTemplate, s.data),
      type: CONST.CHAT_MESSAGE_TYPES.ROLL,
      flags: {
        "eunos-blades": {
          template: s.chatTemplate,
          rollData: s.data
        }
      }
    };
    return { data: {
      ...i,
      ...a
    }, options: t };
  }
  static async ConstructBladesChatMessageData(e, t = {}) {
    var n;
    function s(l) {
      if (typeof l.user == "string")
        return game.users.get(l.user);
      if (l.user instanceof User)
        return l.user;
    }
    const i = {
      ...e
    }, a = [], o = s(e);
    if (e.type === CONST.CHAT_MESSAGE_TYPES.OOC)
      a.push("blades-ooc-message"), o && (i.speakerName = o.name ?? void 0, o.isGM ? (a.push("blades-gm-message"), i.speakerPortrait = X.GM_PORTRAIT) : o.character && (i.speakerPortrait = o.character.img));
    else {
      a.push("blades-ic-message");
      let l;
      (n = e.speaker) != null && n.actor && (typeof e.speaker.actor == "string" ? l = game.actors.get(e.speaker.actor) : e.speaker.actor instanceof oe && (l = e.speaker.actor)), l || (o != null && o.isGM ? (a.push("blades-gm-message"), i.speakerName = "The Gamemaster", i.speakerPortrait = X.GM_PORTRAIT) : o != null && o.character && (l = o.character)), l && !i.speakerPortrait && (i.speakerName = l.name, i.speakerPortrait = l.img);
    }
    return i.blockClasses = a.join(" "), e.content = await renderTemplate(ar.template, i), { data: e, options: t };
  }
  static IsNewestRollResult(e) {
    const t = $("#chat-log .chat-message .blades-roll:not(.inline-roll)").last().attr("id");
    return typeof t == "string" && t === e.id;
  }
  get whisperTargets() {
    return this.whisper.map((e) => game.users.get(e)).filter(Boolean);
  }
  get isWhisper() {
    return this.type === CONST.CHAT_MESSAGE_TYPES.WHISPER;
  }
  get isWhisperToGM() {
    return this.whisperTargets.some((e) => e.isGM);
  }
  get isWhisperFromGM() {
    var e;
    return this.isWhisper && ((e = this.user) == null ? void 0 : e.isGM);
  }
  get isBladesRoll() {
    return this.flagData && "rollData" in this.flagData;
  }
  get isOtherRoll() {
    return !this.isBladesRoll && this.type === CONST.CHAT_MESSAGE_TYPES.ROLL;
  }
  get isEmote() {
    return this.type === CONST.CHAT_MESSAGE_TYPES.EMOTE;
  }
  get isOOC() {
    return this.type === CONST.CHAT_MESSAGE_TYPES.OOC;
  }
  get isIC() {
    return this.type === CONST.CHAT_MESSAGE_TYPES.IC;
  }
  get flagData() {
    var e;
    return ((e = this.flags) == null ? void 0 : e["eunos-blades"]) ?? {};
  }
  get rollData() {
    return this.flagData.rollData;
  }
  get parentRoll() {
    if (!this.isBladesRoll)
      return;
    const { rollData: e } = this.flagData;
    if (e)
      return game.eunoblades.Rolls.get(e.id ?? "") ?? new Ws({
        ...e,
        isScopingById: !1
      });
  }
  async setFlagVal(e, t, s) {
    return await this.setFlag(X.SYSTEM_ID, `${e}.${t}`, s);
  }
  get allRollConsequences() {
    const e = {
      [Ct.controlled]: {
        [Ue.critical]: {},
        [Ue.success]: {},
        [Ue.partial]: {},
        [Ue.fail]: {}
      },
      [Ct.risky]: {
        [Ue.critical]: {},
        [Ue.success]: {},
        [Ue.partial]: {},
        [Ue.fail]: {}
      },
      [Ct.desperate]: {
        [Ue.critical]: {},
        [Ue.success]: {},
        [Ue.partial]: {},
        [Ue.fail]: {}
      }
    }, { consequenceData: t } = this.flagData.rollData ?? {};
    return t && Object.entries(t).forEach(([s, i]) => {
      Object.entries(i).forEach(([a, o]) => {
        e[s][a] = Object.fromEntries(
          Object.entries(o).filter(([n, l]) => l.id).map(([n, l]) => [
            n,
            game.eunoblades.Consequences.get(l.id) ?? new $s(l)
          ])
        );
      });
    }), e;
  }
  get rollConsequences() {
    var a;
    if (!this.parentRoll)
      return [];
    const { rollPositionFinal: e, rollResult: t, consequenceData: s } = this.parentRoll.data;
    if (!e || !t || !s)
      return [];
    if (typeof t != "string" || ![Ue.partial, Ue.fail].includes(t))
      return [];
    const i = ((a = s == null ? void 0 : s[e]) == null ? void 0 : a[t]) ?? {};
    return Object.values(i).map((o) => game.eunoblades.Consequences.get(o.id) ?? new $s(o));
  }
  get elem$() {
    return $("#chat-log").find(`.chat-message[data-message-id="${this.id}"]`);
  }
  get elem() {
    return this.elem$[0];
  }
  get roll$() {
    return this.parentRoll ? this.elem$.find(`#${this.parentRoll.id}`) : void 0;
  }
  async regenerateFromFlags() {
    this.isBladesRoll && await this.update({ content: await renderTemplate(this.flagData.template, this) });
  }
  render(e) {
    return super.render(e), this.activateListeners();
  }
  async activateListeners() {
    if (!this.elem$) {
      eLog.error("BladesChat", `No BladesChat.elem found for id ${this.id}.`);
      return;
    }
    if (oa(this.elem$), $s.ApplyChatListeners(this), this.isBladesRoll) {
      const { parentRoll: e } = this;
      if (!e)
        throw new Error(`BladesChat.activateListeners: No parentRoll found for id ${this.id}.`);
      this.elem$.addClass(`${e.rollType.toLowerCase()}-roll`), e.rollType === Oe.Action && this.rollConsequences.some((t) => !t.isAccepted) ? this.elem$.addClass("unresolved-action-roll") : this.elem$.removeClass("unresolved-action-roll"), ar.IsNewestRollResult(e) ? ($("#chat-log .chat-message").removeClass("active-chat-roll"), this.elem$.addClass("active-chat-roll")) : this.elem$.removeClass("active-chat-roll");
    }
    this.isWhisper && (this.isWhisperToGM ? this.elem$.addClass("blades-whisper-to-gm") : this.isWhisperFromGM ? this.elem$.addClass("blades-whisper-from-gm") : this.elem$.addClass("blades-player-whisper")), this.isEmote && this.elem$.addClass("blades-emote"), this.isIC && this.elem$.addClass("blades-ic"), this.isOOC && this.elem$.addClass("blades-ooc"), w.gsap.to(this.elem$, { autoAlpha: 1, duration: 0.15, ease: "none" });
  }
}
const wr = ar, ec = {
  fullName: "eLogger",
  aliases: ["dbLog"],
  stackTraceExclusions: {
    handlebars: [/scripts\/handlebars/]
    // From internal Handlebars module
  }
}, ag = {
  base: {
    background: X.Colors.BLACK,
    color: X.Colors.dGOLD,
    "font-family": "Pragmata Pro",
    padding: "0 25px",
    "margin-right": "25px"
  },
  log0: {
    background: X.Colors.dGOLD,
    color: X.Colors.dBLACK,
    "font-size": "16px"
  },
  log1: {
    background: X.Colors.dBLACK,
    color: X.Colors.bGOLD,
    "font-size": "16px"
  },
  log2: {
    background: X.Colors.dBLACK,
    color: X.Colors.dGOLD,
    "font-size": "16px"
  },
  log3: {
    "font-size": "14px"
  },
  log4: {
    "font-size": "12px"
  },
  log5: {
    background: X.Colors.dGREY,
    color: X.Colors.bGREY,
    "font-size": "10px"
  },
  display: {
    color: X.Colors.bGOLD,
    "font-family": "Kirsty",
    "font-size": "16px",
    "margin-left": "-100px",
    padding: "0 100px"
  },
  warn: {
    color: X.Colors.dBLACK,
    background: X.Colors.dGOLD,
    "font-weight": 500
  },
  error: {
    color: X.Colors.bRED,
    background: X.Colors.ddRED,
    "font-weight": 500
  },
  handlebars: {
    background: X.Colors.GREY,
    color: X.Colors.BLUE,
    "font-family": "Pragmata Pro",
    padding: "0",
    "margin-right": "25px"
  },
  stack: {
    color: X.Colors.GOLD,
    "font-weight": 100,
    "font-size": "10px",
    "font-family": "Pragmata Pro"
  }
}, { base: f3, ...p3 } = ag, u0 = Object.fromEntries(
  Object.entries(p3).map(([r, e]) => [
    r,
    Object.entries({ ...f3, ...e }).map(([t, s]) => `${t}: ${s};`).join(" ")
  ])
), ft = (r = "base", ...e) => {
  if (!(["error", "display"].includes(r) || CONFIG.debug.logging))
    return;
  const t = w.getLast(e);
  let s = typeof t == "number" && [0, 1, 2, 3, 4, 5].includes(t) ? e.pop() : 3, i = !1;
  r === "checkLog" && (i = e.shift(), r = `log${s}`);
  const [a, ...o] = e;
  if (i) {
    const u = (w.getSetting("blacklist", "debugSettings") ?? "").split(/,/).map((m) => new RegExp(`\\b${m.trim()}\\b`, "igu")), g = (w.getSetting("whitelist", "debugSettings") ?? "").split(/,/).map((m) => new RegExp(`\\b${m.trim()}\\b`, "igu")), p = u.some((m) => m.test(i)), h = g.some((m) => m.test(i));
    p && !h && (s = Math.max(4, Math.min(5, s + 2))), h && !p && (s = Math.min(3, Math.max(1, s - 2)));
  }
  if ((w.getSetting("debugLevel", "debugSettings") ?? 5) < s)
    return;
  r === "log" && (r = `${r}${s}`);
  const n = r === "display" ? null : c(ec.stackTraceExclusions[r] ?? []);
  let l;
  n ? l = console.groupCollapsed : o.length <= 1 ? l = console.log : l = console.group, o.length === 0 ? typeof a == "string" ? l(`%c${a}`, u0[r]) : l("%o", a) : (l(`%c${a}${typeof o[0] == "string" ? "" : " %o"}`, u0[r], o.shift()), o.forEach((u) => {
    typeof u == "string" ? console.log(u) : console.log("%o", u);
  })), n && (console.group("%cSTACK TRACE", `color: ${X.Colors.dGOLD}; font-family: "Pragmata Pro"; font-size: 12px; background: ${X.Colors.BLACK}; font-weight: bold; padding: 0 10px;`), console.log(`%c${n}`, Object.entries(ag.stack).map(([u, g]) => `${u}: ${g};`).join(" ")), console.groupEnd()), console.groupEnd();
  function c(u = []) {
    return u.push(new RegExp(`at (getStackTrace|${ec.fullName}|${ec.aliases.map(String).join("|")}|Object\\.(log|display|hbsLog|error))`), /^Error/), (new Error().stack ?? "").split(/\n/).map((g) => g.trim()).filter((g) => !u.some((p) => p.test(g))).join(`
`);
  }
}, og = {
  display: (...r) => ft("display", ...r),
  log0: (...r) => ft("log", ...r, 0),
  log1: (...r) => ft("log", ...r, 1),
  log2: (...r) => ft("log", ...r, 2),
  log: (...r) => ft("log", ...r, 3),
  log3: (...r) => ft("log", ...r, 3),
  log4: (...r) => ft("log", ...r, 4),
  log5: (...r) => ft("log", ...r, 5),
  checkLog0: (...r) => ft("checkLog", ...r, 0),
  checkLog1: (...r) => ft("checkLog", ...r, 1),
  checkLog2: (...r) => ft("checkLog", ...r, 2),
  checkLog: (...r) => ft("checkLog", ...r, 3),
  checkLog3: (...r) => ft("checkLog", ...r, 3),
  checkLog4: (...r) => ft("checkLog", ...r, 4),
  checkLog5: (...r) => ft("checkLog", ...r, 5),
  warn: (...r) => ft("warn", ...r),
  error: (...r) => ft("error", ...r),
  hbsLog: (...r) => ft("handlebars", ...r)
};
class ng extends Scene {
  async registerClockKey(e) {
    this.update({ [`clockKeys.${e.id}`]: !0 });
  }
  async unregisterClockKey(e) {
    typeof e == "string" ? this.update({ [`clockKeys.-=${e}`]: null }) : this.update({ [`clockKeys.-=${e.id}`]: null });
  }
}
const Ar = "4.29.2";
let h0 = !1, to, lg, cg, qc, ug, hg, dg, gg, fg;
function m3(r, e = { auto: !1 }) {
  if (h0)
    throw new Error(`you must \`import 'openai/shims/${r.kind}'\` before importing anything else from openai`);
  if (to)
    throw new Error(`can't \`import 'openai/shims/${r.kind}'\` after \`import 'openai/shims/${to}'\``);
  h0 = e.auto, to = r.kind, lg = r.fetch, r.Request, r.Response, r.Headers, cg = r.FormData, r.Blob, qc = r.File, ug = r.ReadableStream, hg = r.getMultipartRequestOptions, dg = r.getDefaultAgent, gg = r.fileFromPath, fg = r.isFsReadStream;
}
class y3 {
  constructor(e) {
    this.body = e;
  }
  get [Symbol.toStringTag]() {
    return "MultipartBody";
  }
}
function b3({ manuallyImported: r } = {}) {
  const e = r ? "You may need to use polyfills" : "Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";
  let t, s, i, a;
  try {
    t = fetch, s = Request, i = Response, a = Headers;
  } catch (o) {
    throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`);
  }
  return {
    kind: "web",
    fetch: t,
    Request: s,
    Response: i,
    Headers: a,
    FormData: (
      // @ts-ignore
      typeof FormData < "u" ? FormData : class {
        // @ts-ignore
        constructor() {
          throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`);
        }
      }
    ),
    Blob: typeof Blob < "u" ? Blob : class {
      constructor() {
        throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`);
      }
    },
    File: (
      // @ts-ignore
      typeof File < "u" ? File : class {
        // @ts-ignore
        constructor() {
          throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`);
        }
      }
    ),
    ReadableStream: (
      // @ts-ignore
      typeof ReadableStream < "u" ? ReadableStream : class {
        // @ts-ignore
        constructor() {
          throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`);
        }
      }
    ),
    getMultipartRequestOptions: async (o, n) => ({
      ...n,
      body: new y3(o)
    }),
    getDefaultAgent: (o) => {
    },
    fileFromPath: () => {
      throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads");
    },
    isFsReadStream: (o) => !1
  };
}
to || m3(b3(), { auto: !0 });
class xe extends Error {
}
class At extends xe {
  constructor(e, t, s, i) {
    super(`${At.makeMessage(e, t, s)}`), this.status = e, this.headers = i;
    const a = t;
    this.error = a, this.code = a == null ? void 0 : a.code, this.param = a == null ? void 0 : a.param, this.type = a == null ? void 0 : a.type;
  }
  static makeMessage(e, t, s) {
    const i = t != null && t.message ? typeof t.message == "string" ? t.message : JSON.stringify(t.message) : t ? JSON.stringify(t) : s;
    return e && i ? `${e} ${i}` : e ? `${e} status code (no body)` : i || "(no status code or body)";
  }
  static generate(e, t, s, i) {
    if (!e)
      return new Dl({ cause: Uc(t) });
    const a = t == null ? void 0 : t.error;
    return e === 400 ? new pg(e, a, s, i) : e === 401 ? new mg(e, a, s, i) : e === 403 ? new yg(e, a, s, i) : e === 404 ? new bg(e, a, s, i) : e === 409 ? new wg(e, a, s, i) : e === 422 ? new vg(e, a, s, i) : e === 429 ? new kg(e, a, s, i) : e >= 500 ? new _g(e, a, s, i) : new At(e, a, s, i);
  }
}
class Ds extends At {
  constructor({ message: e } = {}) {
    super(void 0, void 0, e || "Request was aborted.", void 0), this.status = void 0;
  }
}
class Dl extends At {
  constructor({ message: e, cause: t }) {
    super(void 0, void 0, e || "Connection error.", void 0), this.status = void 0, t && (this.cause = t);
  }
}
class Uu extends Dl {
  constructor({ message: e } = {}) {
    super({ message: e ?? "Request timed out." });
  }
}
class pg extends At {
  constructor() {
    super(...arguments), this.status = 400;
  }
}
class mg extends At {
  constructor() {
    super(...arguments), this.status = 401;
  }
}
class yg extends At {
  constructor() {
    super(...arguments), this.status = 403;
  }
}
class bg extends At {
  constructor() {
    super(...arguments), this.status = 404;
  }
}
class wg extends At {
  constructor() {
    super(...arguments), this.status = 409;
  }
}
class vg extends At {
  constructor() {
    super(...arguments), this.status = 422;
  }
}
class kg extends At {
  constructor() {
    super(...arguments), this.status = 429;
  }
}
class _g extends At {
}
class vi {
  constructor(e, t) {
    this.iterator = e, this.controller = t;
  }
  static fromSSEResponse(e, t) {
    let s = !1;
    const i = new w3();
    async function* a() {
      if (!e.body)
        throw t.abort(), new xe("Attempted to iterate over a response with no body");
      const n = new vr(), l = d0(e.body);
      for await (const c of l)
        for (const u of n.decode(c)) {
          const g = i.decode(u);
          g && (yield g);
        }
      for (const c of n.flush()) {
        const u = i.decode(c);
        u && (yield u);
      }
    }
    async function* o() {
      if (s)
        throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");
      s = !0;
      let n = !1;
      try {
        for await (const l of a())
          if (!n) {
            if (l.data.startsWith("[DONE]")) {
              n = !0;
              continue;
            }
            if (l.event === null) {
              let c;
              try {
                c = JSON.parse(l.data);
              } catch (u) {
                throw console.error("Could not parse message into JSON:", l.data), console.error("From chunk:", l.raw), u;
              }
              if (c && c.error)
                throw new At(void 0, c.error, void 0, void 0);
              yield c;
            } else {
              let c;
              try {
                c = JSON.parse(l.data);
              } catch (u) {
                throw console.error("Could not parse message into JSON:", l.data), console.error("From chunk:", l.raw), u;
              }
              if (l.event == "error")
                throw new At(void 0, c.error, c.message, void 0);
              yield { event: l.event, data: c };
            }
          }
        n = !0;
      } catch (l) {
        if (l instanceof Error && l.name === "AbortError")
          return;
        throw l;
      } finally {
        n || t.abort();
      }
    }
    return new vi(o, t);
  }
  /**
   * Generates a Stream from a newline-separated ReadableStream
   * where each item is a JSON value.
   */
  static fromReadableStream(e, t) {
    let s = !1;
    async function* i() {
      const o = new vr(), n = d0(e);
      for await (const l of n)
        for (const c of o.decode(l))
          yield c;
      for (const l of o.flush())
        yield l;
    }
    async function* a() {
      if (s)
        throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");
      s = !0;
      let o = !1;
      try {
        for await (const n of i())
          o || n && (yield JSON.parse(n));
        o = !0;
      } catch (n) {
        if (n instanceof Error && n.name === "AbortError")
          return;
        throw n;
      } finally {
        o || t.abort();
      }
    }
    return new vi(a, t);
  }
  [Symbol.asyncIterator]() {
    return this.iterator();
  }
  /**
   * Splits the stream into two streams which can be
   * independently read from at different speeds.
   */
  tee() {
    const e = [], t = [], s = this.iterator(), i = (a) => ({
      next: () => {
        if (a.length === 0) {
          const o = s.next();
          e.push(o), t.push(o);
        }
        return a.shift();
      }
    });
    return [
      new vi(() => i(e), this.controller),
      new vi(() => i(t), this.controller)
    ];
  }
  /**
   * Converts this stream to a newline-separated ReadableStream of
   * JSON stringified values in the stream
   * which can be turned back into a Stream with `Stream.fromReadableStream()`.
   */
  toReadableStream() {
    const e = this;
    let t;
    const s = new TextEncoder();
    return new ug({
      async start() {
        t = e[Symbol.asyncIterator]();
      },
      async pull(i) {
        try {
          const { value: a, done: o } = await t.next();
          if (o)
            return i.close();
          const n = s.encode(JSON.stringify(a) + `
`);
          i.enqueue(n);
        } catch (a) {
          i.error(a);
        }
      },
      async cancel() {
        var i;
        await ((i = t.return) == null ? void 0 : i.call(t));
      }
    });
  }
}
class w3 {
  constructor() {
    this.event = null, this.data = [], this.chunks = [];
  }
  decode(e) {
    if (e.endsWith("\r") && (e = e.substring(0, e.length - 1)), !e) {
      if (!this.event && !this.data.length)
        return null;
      const a = {
        event: this.event,
        data: this.data.join(`
`),
        raw: this.chunks
      };
      return this.event = null, this.data = [], this.chunks = [], a;
    }
    if (this.chunks.push(e), e.startsWith(":"))
      return null;
    let [t, s, i] = v3(e, ":");
    return i.startsWith(" ") && (i = i.substring(1)), t === "event" ? this.event = i : t === "data" && this.data.push(i), null;
  }
}
class vr {
  constructor() {
    this.buffer = [], this.trailingCR = !1;
  }
  decode(e) {
    let t = this.decodeText(e);
    if (this.trailingCR && (t = "\r" + t, this.trailingCR = !1), t.endsWith("\r") && (this.trailingCR = !0, t = t.slice(0, -1)), !t)
      return [];
    const s = vr.NEWLINE_CHARS.has(t[t.length - 1] || "");
    let i = t.split(vr.NEWLINE_REGEXP);
    return s && i.pop(), i.length === 1 && !s ? (this.buffer.push(i[0]), []) : (this.buffer.length > 0 && (i = [this.buffer.join("") + i[0], ...i.slice(1)], this.buffer = []), s || (this.buffer = [i.pop() || ""]), i);
  }
  decodeText(e) {
    if (e == null)
      return "";
    if (typeof e == "string")
      return e;
    if (typeof Buffer < "u") {
      if (e instanceof Buffer)
        return e.toString();
      if (e instanceof Uint8Array)
        return Buffer.from(e).toString();
      throw new xe(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`);
    }
    if (typeof TextDecoder < "u") {
      if (e instanceof Uint8Array || e instanceof ArrayBuffer)
        return this.textDecoder ?? (this.textDecoder = new TextDecoder("utf8")), this.textDecoder.decode(e);
      throw new xe(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`);
    }
    throw new xe("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.");
  }
  flush() {
    if (!this.buffer.length && !this.trailingCR)
      return [];
    const e = [this.buffer.join("")];
    return this.buffer = [], this.trailingCR = !1, e;
  }
}
vr.NEWLINE_CHARS = /* @__PURE__ */ new Set([`
`, "\r", "\v", "\f", "", "", "", "", "\u2028", "\u2029"]);
vr.NEWLINE_REGEXP = /\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;
function v3(r, e) {
  const t = r.indexOf(e);
  return t !== -1 ? [r.substring(0, t), e, r.substring(t + e.length)] : [r, "", ""];
}
function d0(r) {
  if (r[Symbol.asyncIterator])
    return r;
  const e = r.getReader();
  return {
    async next() {
      try {
        const t = await e.read();
        return t != null && t.done && e.releaseLock(), t;
      } catch (t) {
        throw e.releaseLock(), t;
      }
    },
    async return() {
      const t = e.cancel();
      return e.releaseLock(), await t, { done: !0, value: void 0 };
    },
    [Symbol.asyncIterator]() {
      return this;
    }
  };
}
const Dg = (r) => r != null && typeof r == "object" && typeof r.url == "string" && typeof r.blob == "function", k3 = (r) => r != null && typeof r == "object" && typeof r.name == "string" && typeof r.lastModified == "number" && Tg(r), Tg = (r) => r != null && typeof r == "object" && typeof r.size == "number" && typeof r.type == "string" && typeof r.text == "function" && typeof r.slice == "function" && typeof r.arrayBuffer == "function", _3 = (r) => k3(r) || Dg(r) || fg(r);
async function Cg(r, e, t = {}) {
  var i;
  if (r = await r, Dg(r)) {
    const a = await r.blob();
    return e || (e = new URL(r.url).pathname.split(/[\\/]/).pop() ?? "unknown_file"), new qc([a], e, t);
  }
  const s = await D3(r);
  if (e || (e = C3(r) ?? "unknown_file"), !t.type) {
    const a = (i = s[0]) == null ? void 0 : i.type;
    typeof a == "string" && (t = { ...t, type: a });
  }
  return new qc(s, e, t);
}
async function D3(r) {
  var t;
  let e = [];
  if (typeof r == "string" || ArrayBuffer.isView(r) || // includes Uint8Array, Buffer, etc.
  r instanceof ArrayBuffer)
    e.push(r);
  else if (Tg(r))
    e.push(await r.arrayBuffer());
  else if (S3(r))
    for await (const s of r)
      e.push(s);
  else
    throw new Error(`Unexpected data type: ${typeof r}; constructor: ${(t = r == null ? void 0 : r.constructor) == null ? void 0 : t.name}; props: ${T3(r)}`);
  return e;
}
function T3(r) {
  return `[${Object.getOwnPropertyNames(r).map((t) => `"${t}"`).join(", ")}]`;
}
function C3(r) {
  var e;
  return tc(r.name) || tc(r.filename) || // For fs.ReadStream
  ((e = tc(r.path)) == null ? void 0 : e.split(/[\\/]/).pop());
}
const tc = (r) => {
  if (typeof r == "string")
    return r;
  if (typeof Buffer < "u" && r instanceof Buffer)
    return String(r);
}, S3 = (r) => r != null && typeof r == "object" && typeof r[Symbol.asyncIterator] == "function", g0 = (r) => r && typeof r == "object" && r.body && r[Symbol.toStringTag] === "MultipartBody", yo = async (r) => {
  const e = await E3(r.body);
  return hg(e, r);
}, E3 = async (r) => {
  const e = new cg();
  return await Promise.all(Object.entries(r || {}).map(([t, s]) => Yc(e, t, s))), e;
}, Yc = async (r, e, t) => {
  if (t !== void 0) {
    if (t == null)
      throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);
    if (typeof t == "string" || typeof t == "number" || typeof t == "boolean")
      r.append(e, String(t));
    else if (_3(t)) {
      const s = await Cg(t);
      r.append(e, s);
    } else if (Array.isArray(t))
      await Promise.all(t.map((s) => Yc(r, e + "[]", s)));
    else if (typeof t == "object")
      await Promise.all(Object.entries(t).map(([s, i]) => Yc(r, `${e}[${s}]`, i)));
    else
      throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`);
  }
};
var A3 = function(r, e, t, s, i) {
  if (s === "m")
    throw new TypeError("Private method is not writable");
  if (s === "a" && !i)
    throw new TypeError("Private accessor was defined without a setter");
  if (typeof e == "function" ? r !== e || !i : !e.has(r))
    throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return s === "a" ? i.call(r, t) : i ? i.value = t : e.set(r, t), t;
}, x3 = function(r, e, t, s) {
  if (t === "a" && !s)
    throw new TypeError("Private accessor was defined without a getter");
  if (typeof e == "function" ? r !== e || !s : !e.has(r))
    throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return t === "m" ? s : t === "a" ? s.call(r) : s ? s.value : e.get(r);
}, Ho;
async function Sg(r) {
  const { response: e } = r;
  if (r.options.stream)
    return Xr("response", e.status, e.url, e.headers, e.body), r.options.__streamClass ? r.options.__streamClass.fromSSEResponse(e, r.controller) : vi.fromSSEResponse(e, r.controller);
  if (e.status === 204)
    return null;
  if (r.options.__binaryResponse)
    return e;
  const t = e.headers.get("content-type");
  if ((t == null ? void 0 : t.includes("application/json")) || (t == null ? void 0 : t.includes("application/vnd.api+json"))) {
    const a = await e.json();
    return Xr("response", e.status, e.url, e.headers, a), a;
  }
  const i = await e.text();
  return Xr("response", e.status, e.url, e.headers, i), i;
}
class Tl extends Promise {
  constructor(e, t = Sg) {
    super((s) => {
      s(null);
    }), this.responsePromise = e, this.parseResponse = t;
  }
  _thenUnwrap(e) {
    return new Tl(this.responsePromise, async (t) => e(await this.parseResponse(t)));
  }
  /**
   * Gets the raw `Response` instance instead of parsing the response
   * data.
   *
   * If you want to parse the response body but still get the `Response`
   * instance, you can use {@link withResponse()}.
   *
   * 👋 Getting the wrong TypeScript type for `Response`?
   * Try setting `"moduleResolution": "NodeNext"` if you can,
   * or add one of these imports before your first `import … from 'openai'`:
   * - `import 'openai/shims/node'` (if you're running on Node)
   * - `import 'openai/shims/web'` (otherwise)
   */
  asResponse() {
    return this.responsePromise.then((e) => e.response);
  }
  /**
   * Gets the parsed response data and the raw `Response` instance.
   *
   * If you just want to get the raw `Response` instance without parsing it,
   * you can use {@link asResponse()}.
   *
   *
   * 👋 Getting the wrong TypeScript type for `Response`?
   * Try setting `"moduleResolution": "NodeNext"` if you can,
   * or add one of these imports before your first `import … from 'openai'`:
   * - `import 'openai/shims/node'` (if you're running on Node)
   * - `import 'openai/shims/web'` (otherwise)
   */
  async withResponse() {
    const [e, t] = await Promise.all([this.parse(), this.asResponse()]);
    return { data: e, response: t };
  }
  parse() {
    return this.parsedPromise || (this.parsedPromise = this.responsePromise.then(this.parseResponse)), this.parsedPromise;
  }
  then(e, t) {
    return this.parse().then(e, t);
  }
  catch(e) {
    return this.parse().catch(e);
  }
  finally(e) {
    return this.parse().finally(e);
  }
}
class I3 {
  constructor({
    baseURL: e,
    maxRetries: t = 2,
    timeout: s = 6e5,
    // 10 minutes
    httpAgent: i,
    fetch: a
  }) {
    this.baseURL = e, this.maxRetries = sc("maxRetries", t), this.timeout = sc("timeout", s), this.httpAgent = i, this.fetch = a ?? lg;
  }
  authHeaders(e) {
    return {};
  }
  /**
   * Override this to add your own default headers, for example:
   *
   *  {
   *    ...super.defaultHeaders(),
   *    Authorization: 'Bearer 123',
   *  }
   */
  defaultHeaders(e) {
    return {
      Accept: "application/json",
      "Content-Type": "application/json",
      "User-Agent": this.getUserAgent(),
      ...R3(),
      ...this.authHeaders(e)
    };
  }
  /**
   * Override this to add your own headers validation:
   */
  validateHeaders(e, t) {
  }
  defaultIdempotencyKey() {
    return `stainless-node-retry-${H3()}`;
  }
  get(e, t) {
    return this.methodRequest("get", e, t);
  }
  post(e, t) {
    return this.methodRequest("post", e, t);
  }
  patch(e, t) {
    return this.methodRequest("patch", e, t);
  }
  put(e, t) {
    return this.methodRequest("put", e, t);
  }
  delete(e, t) {
    return this.methodRequest("delete", e, t);
  }
  methodRequest(e, t, s) {
    return this.request(Promise.resolve(s).then((i) => ({ method: e, path: t, ...i })));
  }
  getAPIList(e, t, s) {
    return this.requestAPIList(t, { method: "get", path: e, ...s });
  }
  calculateContentLength(e) {
    if (typeof e == "string") {
      if (typeof Buffer < "u")
        return Buffer.byteLength(e, "utf8").toString();
      if (typeof TextEncoder < "u")
        return new TextEncoder().encode(e).length.toString();
    }
    return null;
  }
  buildRequest(e) {
    var m;
    const { method: t, path: s, query: i, headers: a = {} } = e, o = g0(e.body) ? e.body.body : e.body ? JSON.stringify(e.body, null, 2) : null, n = this.calculateContentLength(o), l = this.buildURL(s, i);
    "timeout" in e && sc("timeout", e.timeout);
    const c = e.timeout ?? this.timeout, u = e.httpAgent ?? this.httpAgent ?? dg(l), g = c + 1e3;
    typeof ((m = u == null ? void 0 : u.options) == null ? void 0 : m.timeout) == "number" && g > (u.options.timeout ?? 0) && (u.options.timeout = g), this.idempotencyHeader && t !== "get" && (e.idempotencyKey || (e.idempotencyKey = this.defaultIdempotencyKey()), a[this.idempotencyHeader] = e.idempotencyKey);
    const p = this.buildHeaders({ options: e, headers: a, contentLength: n });
    return { req: {
      method: t,
      ...o && { body: o },
      headers: p,
      ...u && { agent: u },
      // @ts-ignore node-fetch uses a custom AbortSignal type that is
      // not compatible with standard web types
      signal: e.signal ?? null
    }, url: l, timeout: c };
  }
  buildHeaders({ options: e, headers: t, contentLength: s }) {
    const i = {};
    s && (i["content-length"] = s);
    const a = this.defaultHeaders(e);
    return y0(i, a), y0(i, t), g0(e.body) && to !== "node" && delete i["content-type"], this.validateHeaders(i, t), i;
  }
  /**
   * Used as a callback for mutating the given `FinalRequestOptions` object.
   */
  async prepareOptions(e) {
  }
  /**
   * Used as a callback for mutating the given `RequestInit` object.
   *
   * This is useful for cases where you want to add certain headers based off of
   * the request properties, e.g. `method` or `url`.
   */
  async prepareRequest(e, { url: t, options: s }) {
  }
  parseHeaders(e) {
    return e ? Symbol.iterator in e ? Object.fromEntries(Array.from(e).map((t) => [...t])) : { ...e } : {};
  }
  makeStatusError(e, t, s, i) {
    return At.generate(e, t, s, i);
  }
  request(e, t = null) {
    return new Tl(this.makeRequest(e, t));
  }
  async makeRequest(e, t) {
    var u, g;
    const s = await e;
    t == null && (t = s.maxRetries ?? this.maxRetries), await this.prepareOptions(s);
    const { req: i, url: a, timeout: o } = this.buildRequest(s);
    if (await this.prepareRequest(i, { url: a, options: s }), Xr("request", a, s, i.headers), (u = s.signal) != null && u.aborted)
      throw new Ds();
    const n = new AbortController(), l = await this.fetchWithTimeout(a, i, o, n).catch(Uc);
    if (l instanceof Error) {
      if ((g = s.signal) != null && g.aborted)
        throw new Ds();
      if (t)
        return this.retryRequest(s, t);
      throw l.name === "AbortError" ? new Uu() : new Dl({ cause: l });
    }
    const c = M3(l.headers);
    if (!l.ok) {
      if (t && this.shouldRetry(l)) {
        const _ = `retrying, ${t} attempts remaining`;
        return Xr(`response (error; ${_})`, l.status, a, c), this.retryRequest(s, t, c);
      }
      const p = await l.text().catch((_) => Uc(_).message), h = $3(p), m = h ? void 0 : p;
      throw Xr(`response (error; ${t ? "(error; no more retries left)" : "(error; not retryable)"})`, l.status, a, c, m), this.makeStatusError(l.status, h, m, c);
    }
    return { response: l, options: s, controller: n };
  }
  requestAPIList(e, t) {
    const s = this.makeRequest(t, null);
    return new P3(this, s, e);
  }
  buildURL(e, t) {
    const s = B3(e) ? new URL(e) : new URL(this.baseURL + (this.baseURL.endsWith("/") && e.startsWith("/") ? e.slice(1) : e)), i = this.defaultQuery();
    return xg(i) || (t = { ...i, ...t }), typeof t == "object" && t && !Array.isArray(t) && (s.search = this.stringifyQuery(t)), s.toString();
  }
  stringifyQuery(e) {
    return Object.entries(e).filter(([t, s]) => typeof s < "u").map(([t, s]) => {
      if (typeof s == "string" || typeof s == "number" || typeof s == "boolean")
        return `${encodeURIComponent(t)}=${encodeURIComponent(s)}`;
      if (s === null)
        return `${encodeURIComponent(t)}=`;
      throw new xe(`Cannot stringify type ${typeof s}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`);
    }).join("&");
  }
  async fetchWithTimeout(e, t, s, i) {
    const { signal: a, ...o } = t || {};
    a && a.addEventListener("abort", () => i.abort());
    const n = setTimeout(() => i.abort(), s);
    return this.getRequestClient().fetch.call(void 0, e, { signal: i.signal, ...o }).finally(() => {
      clearTimeout(n);
    });
  }
  getRequestClient() {
    return { fetch: this.fetch };
  }
  shouldRetry(e) {
    const t = e.headers.get("x-should-retry");
    return t === "true" ? !0 : t === "false" ? !1 : e.status === 408 || e.status === 409 || e.status === 429 || e.status >= 500;
  }
  async retryRequest(e, t, s) {
    let i;
    const a = s == null ? void 0 : s["retry-after-ms"];
    if (a) {
      const n = parseFloat(a);
      Number.isNaN(n) || (i = n);
    }
    const o = s == null ? void 0 : s["retry-after"];
    if (o && !i) {
      const n = parseFloat(o);
      Number.isNaN(n) ? i = Date.parse(o) - Date.now() : i = n * 1e3;
    }
    if (!(i && 0 <= i && i < 60 * 1e3)) {
      const n = e.maxRetries ?? this.maxRetries;
      i = this.calculateDefaultRetryTimeoutMillis(t, n);
    }
    return await Ag(i), this.makeRequest(e, t - 1);
  }
  calculateDefaultRetryTimeoutMillis(e, t) {
    const a = t - e, o = Math.min(0.5 * Math.pow(2, a), 8), n = 1 - Math.random() * 0.25;
    return o * n * 1e3;
  }
  getUserAgent() {
    return `${this.constructor.name}/JS ${Ar}`;
  }
}
class Eg {
  constructor(e, t, s, i) {
    Ho.set(this, void 0), A3(this, Ho, e, "f"), this.options = i, this.response = t, this.body = s;
  }
  hasNextPage() {
    return this.getPaginatedItems().length ? this.nextPageInfo() != null : !1;
  }
  async getNextPage() {
    const e = this.nextPageInfo();
    if (!e)
      throw new xe("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");
    const t = { ...this.options };
    if ("params" in e && typeof t.query == "object")
      t.query = { ...t.query, ...e.params };
    else if ("url" in e) {
      const s = [...Object.entries(t.query || {}), ...e.url.searchParams.entries()];
      for (const [i, a] of s)
        e.url.searchParams.set(i, a);
      t.query = void 0, t.path = e.url.toString();
    }
    return await x3(this, Ho, "f").requestAPIList(this.constructor, t);
  }
  async *iterPages() {
    let e = this;
    for (yield e; e.hasNextPage(); )
      e = await e.getNextPage(), yield e;
  }
  async *[(Ho = /* @__PURE__ */ new WeakMap(), Symbol.asyncIterator)]() {
    for await (const e of this.iterPages())
      for (const t of e.getPaginatedItems())
        yield t;
  }
}
class P3 extends Tl {
  constructor(e, t, s) {
    super(t, async (i) => new s(e, i.response, await Sg(i), i.options));
  }
  /**
   * Allow auto-paginating iteration on an unawaited list call, eg:
   *
   *    for await (const item of client.items.list()) {
   *      console.log(item)
   *    }
   */
  async *[Symbol.asyncIterator]() {
    const e = await this;
    for await (const t of e)
      yield t;
  }
}
const M3 = (r) => new Proxy(Object.fromEntries(
  // @ts-ignore
  r.entries()
), {
  get(e, t) {
    const s = t.toString();
    return e[s.toLowerCase()] || e[s];
  }
}), O3 = {
  method: !0,
  path: !0,
  query: !0,
  body: !0,
  headers: !0,
  maxRetries: !0,
  stream: !0,
  timeout: !0,
  httpAgent: !0,
  signal: !0,
  idempotencyKey: !0,
  __binaryResponse: !0,
  __streamClass: !0
}, ii = (r) => typeof r == "object" && r !== null && !xg(r) && Object.keys(r).every((e) => Ig(O3, e)), F3 = () => {
  if (typeof Deno < "u" && Deno.build != null)
    return {
      "X-Stainless-Lang": "js",
      "X-Stainless-Package-Version": Ar,
      "X-Stainless-OS": p0(Deno.build.os),
      "X-Stainless-Arch": f0(Deno.build.arch),
      "X-Stainless-Runtime": "deno",
      "X-Stainless-Runtime-Version": Deno.version
    };
  if (typeof EdgeRuntime < "u")
    return {
      "X-Stainless-Lang": "js",
      "X-Stainless-Package-Version": Ar,
      "X-Stainless-OS": "Unknown",
      "X-Stainless-Arch": `other:${EdgeRuntime}`,
      "X-Stainless-Runtime": "edge",
      "X-Stainless-Runtime-Version": process.version
    };
  if (Object.prototype.toString.call(typeof process < "u" ? process : 0) === "[object process]")
    return {
      "X-Stainless-Lang": "js",
      "X-Stainless-Package-Version": Ar,
      "X-Stainless-OS": p0(process.platform),
      "X-Stainless-Arch": f0(process.arch),
      "X-Stainless-Runtime": "node",
      "X-Stainless-Runtime-Version": process.version
    };
  const r = L3();
  return r ? {
    "X-Stainless-Lang": "js",
    "X-Stainless-Package-Version": Ar,
    "X-Stainless-OS": "Unknown",
    "X-Stainless-Arch": "unknown",
    "X-Stainless-Runtime": `browser:${r.browser}`,
    "X-Stainless-Runtime-Version": r.version
  } : {
    "X-Stainless-Lang": "js",
    "X-Stainless-Package-Version": Ar,
    "X-Stainless-OS": "Unknown",
    "X-Stainless-Arch": "unknown",
    "X-Stainless-Runtime": "unknown",
    "X-Stainless-Runtime-Version": "unknown"
  };
};
function L3() {
  if (typeof navigator > "u" || !navigator)
    return null;
  const r = [
    { key: "edge", pattern: /Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "ie", pattern: /MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "ie", pattern: /Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "chrome", pattern: /Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "firefox", pattern: /Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/ },
    { key: "safari", pattern: /(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/ }
  ];
  for (const { key: e, pattern: t } of r) {
    const s = t.exec(navigator.userAgent);
    if (s) {
      const i = s[1] || 0, a = s[2] || 0, o = s[3] || 0;
      return { browser: e, version: `${i}.${a}.${o}` };
    }
  }
  return null;
}
const f0 = (r) => r === "x32" ? "x32" : r === "x86_64" || r === "x64" ? "x64" : r === "arm" ? "arm" : r === "aarch64" || r === "arm64" ? "arm64" : r ? `other:${r}` : "unknown", p0 = (r) => (r = r.toLowerCase(), r.includes("ios") ? "iOS" : r === "android" ? "Android" : r === "darwin" ? "MacOS" : r === "win32" ? "Windows" : r === "freebsd" ? "FreeBSD" : r === "openbsd" ? "OpenBSD" : r === "linux" ? "Linux" : r ? `Other:${r}` : "Unknown");
let m0;
const R3 = () => m0 ?? (m0 = F3()), $3 = (r) => {
  try {
    return JSON.parse(r);
  } catch {
    return;
  }
}, N3 = new RegExp("^(?:[a-z]+:)?//", "i"), B3 = (r) => N3.test(r), Ag = (r) => new Promise((e) => setTimeout(e, r)), sc = (r, e) => {
  if (typeof e != "number" || !Number.isInteger(e))
    throw new xe(`${r} must be an integer`);
  if (e < 0)
    throw new xe(`${r} must be a positive integer`);
  return e;
}, Uc = (r) => r instanceof Error ? r : new Error(r), ic = (r) => {
  var e, t, s, i, a;
  if (typeof process < "u")
    return ((t = (e = process.env) == null ? void 0 : e[r]) == null ? void 0 : t.trim()) ?? void 0;
  if (typeof Deno < "u")
    return (a = (i = (s = Deno.env) == null ? void 0 : s.get) == null ? void 0 : i.call(s, r)) == null ? void 0 : a.trim();
};
function xg(r) {
  if (!r)
    return !0;
  for (const e in r)
    return !1;
  return !0;
}
function Ig(r, e) {
  return Object.prototype.hasOwnProperty.call(r, e);
}
function y0(r, e) {
  for (const t in e) {
    if (!Ig(e, t))
      continue;
    const s = t.toLowerCase();
    if (!s)
      continue;
    const i = e[t];
    i === null ? delete r[s] : i !== void 0 && (r[s] = i);
  }
}
function Xr(r, ...e) {
  typeof process < "u" && process.env.DEBUG === "true" && console.log(`OpenAI:DEBUG:${r}`, ...e);
}
const H3 = () => "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (r) => {
  const e = Math.random() * 16 | 0;
  return (r === "x" ? e : e & 3 | 8).toString(16);
}), W3 = () => (
  // @ts-ignore
  typeof window < "u" && // @ts-ignore
  typeof window.document < "u" && // @ts-ignore
  typeof navigator < "u"
);
function b0(r) {
  return r != null && typeof r == "object" && !Array.isArray(r);
}
class Xu extends Eg {
  constructor(e, t, s, i) {
    super(e, t, s, i), this.data = s.data || [], this.object = s.object;
  }
  getPaginatedItems() {
    return this.data ?? [];
  }
  // @deprecated Please use `nextPageInfo()` instead
  /**
   * This page represents a response that isn't actually paginated at the API level
   * so there will never be any next page params.
   */
  nextPageParams() {
    return null;
  }
  nextPageInfo() {
    return null;
  }
}
class Si extends Eg {
  constructor(e, t, s, i) {
    super(e, t, s, i), this.data = s.data || [];
  }
  getPaginatedItems() {
    return this.data ?? [];
  }
  // @deprecated Please use `nextPageInfo()` instead
  nextPageParams() {
    const e = this.nextPageInfo();
    if (!e)
      return null;
    if ("params" in e)
      return e.params;
    const t = Object.fromEntries(e.url.searchParams);
    return Object.keys(t).length ? t : null;
  }
  nextPageInfo() {
    var s;
    const e = this.getPaginatedItems();
    if (!e.length)
      return null;
    const t = (s = e[e.length - 1]) == null ? void 0 : s.id;
    return t ? { params: { after: t } } : null;
  }
}
class Ze {
  constructor(e) {
    this._client = e;
  }
}
let On = class extends Ze {
  create(e, t) {
    return this._client.post("/chat/completions", { body: e, ...t, stream: e.stream ?? !1 });
  }
};
On || (On = {});
let Fn = class extends Ze {
  constructor() {
    super(...arguments), this.completions = new On(this._client);
  }
};
(function(r) {
  r.Completions = On;
})(Fn || (Fn = {}));
class Ln extends Ze {
  /**
   * Generates audio from the input text.
   */
  create(e, t) {
    return this._client.post("/audio/speech", { body: e, ...t, __binaryResponse: !0 });
  }
}
Ln || (Ln = {});
class Rn extends Ze {
  /**
   * Transcribes audio into the input language.
   */
  create(e, t) {
    return this._client.post("/audio/transcriptions", yo({ body: e, ...t }));
  }
}
Rn || (Rn = {});
class $n extends Ze {
  /**
   * Translates audio into English.
   */
  create(e, t) {
    return this._client.post("/audio/translations", yo({ body: e, ...t }));
  }
}
$n || ($n = {});
class Nn extends Ze {
  constructor() {
    super(...arguments), this.transcriptions = new Rn(this._client), this.translations = new $n(this._client), this.speech = new Ln(this._client);
  }
}
(function(r) {
  r.Transcriptions = Rn, r.Translations = $n, r.Speech = Ln;
})(Nn || (Nn = {}));
let Bn = class extends Ze {
  /**
   * Create an assistant file by attaching a
   * [File](https://platform.openai.com/docs/api-reference/files) to an
   * [assistant](https://platform.openai.com/docs/api-reference/assistants).
   */
  create(e, t, s) {
    return this._client.post(`/assistants/${e}/files`, {
      body: t,
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  /**
   * Retrieves an AssistantFile.
   */
  retrieve(e, t, s) {
    return this._client.get(`/assistants/${e}/files/${t}`, {
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  list(e, t = {}, s) {
    return ii(t) ? this.list(e, {}, t) : this._client.getAPIList(`/assistants/${e}/files`, Zu, {
      query: t,
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  /**
   * Delete an assistant file.
   */
  del(e, t, s) {
    return this._client.delete(`/assistants/${e}/files/${t}`, {
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
};
class Zu extends Si {
}
(function(r) {
  r.AssistantFilesPage = Zu;
})(Bn || (Bn = {}));
class Hn extends Ze {
  constructor() {
    super(...arguments), this.files = new Bn(this._client);
  }
  /**
   * Create an assistant with a model and instructions.
   */
  create(e, t) {
    return this._client.post("/assistants", {
      body: e,
      ...t,
      headers: { "OpenAI-Beta": "assistants=v1", ...t == null ? void 0 : t.headers }
    });
  }
  /**
   * Retrieves an assistant.
   */
  retrieve(e, t) {
    return this._client.get(`/assistants/${e}`, {
      ...t,
      headers: { "OpenAI-Beta": "assistants=v1", ...t == null ? void 0 : t.headers }
    });
  }
  /**
   * Modifies an assistant.
   */
  update(e, t, s) {
    return this._client.post(`/assistants/${e}`, {
      body: t,
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  list(e = {}, t) {
    return ii(e) ? this.list({}, e) : this._client.getAPIList("/assistants", Ju, {
      query: e,
      ...t,
      headers: { "OpenAI-Beta": "assistants=v1", ...t == null ? void 0 : t.headers }
    });
  }
  /**
   * Delete an assistant.
   */
  del(e, t) {
    return this._client.delete(`/assistants/${e}`, {
      ...t,
      headers: { "OpenAI-Beta": "assistants=v1", ...t == null ? void 0 : t.headers }
    });
  }
}
class Ju extends Si {
}
(function(r) {
  r.AssistantsPage = Ju, r.Files = Bn, r.AssistantFilesPage = Zu;
})(Hn || (Hn = {}));
function w0(r) {
  return typeof r.parse == "function";
}
const Zr = (r) => (r == null ? void 0 : r.role) === "assistant", Pg = (r) => (r == null ? void 0 : r.role) === "function", Mg = (r) => (r == null ? void 0 : r.role) === "tool";
var As = function(r, e, t, s, i) {
  if (s === "m")
    throw new TypeError("Private method is not writable");
  if (s === "a" && !i)
    throw new TypeError("Private accessor was defined without a setter");
  if (typeof e == "function" ? r !== e || !i : !e.has(r))
    throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return s === "a" ? i.call(r, t) : i ? i.value = t : e.set(r, t), t;
}, Ce = function(r, e, t, s) {
  if (t === "a" && !s)
    throw new TypeError("Private accessor was defined without a getter");
  if (typeof e == "function" ? r !== e || !s : !e.has(r))
    throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return t === "m" ? s : t === "a" ? s.call(r) : s ? s.value : e.get(r);
}, It, Jo, Qo, Ia, Pa, en, Ma, ci, Oa, tn, sn, xr, Xc, Wn, Zc, Jc, Qc, eu, Og, tu;
const v0 = 10;
class Fg {
  constructor() {
    It.add(this), this.controller = new AbortController(), Jo.set(this, void 0), Qo.set(this, () => {
    }), Ia.set(this, () => {
    }), Pa.set(this, void 0), en.set(this, () => {
    }), Ma.set(this, () => {
    }), ci.set(this, {}), this._chatCompletions = [], this.messages = [], Oa.set(this, !1), tn.set(this, !1), sn.set(this, !1), xr.set(this, !1), eu.set(this, (e) => {
      if (As(this, tn, !0, "f"), e instanceof Error && e.name === "AbortError" && (e = new Ds()), e instanceof Ds)
        return As(this, sn, !0, "f"), this._emit("abort", e);
      if (e instanceof xe)
        return this._emit("error", e);
      if (e instanceof Error) {
        const t = new xe(e.message);
        return t.cause = e, this._emit("error", t);
      }
      return this._emit("error", new xe(String(e)));
    }), As(this, Jo, new Promise((e, t) => {
      As(this, Qo, e, "f"), As(this, Ia, t, "f");
    }), "f"), As(this, Pa, new Promise((e, t) => {
      As(this, en, e, "f"), As(this, Ma, t, "f");
    }), "f"), Ce(this, Jo, "f").catch(() => {
    }), Ce(this, Pa, "f").catch(() => {
    });
  }
  _run(e) {
    setTimeout(() => {
      e().then(() => {
        this._emitFinal(), this._emit("end");
      }, Ce(this, eu, "f"));
    }, 0);
  }
  _addChatCompletion(e) {
    var s;
    this._chatCompletions.push(e), this._emit("chatCompletion", e);
    const t = (s = e.choices[0]) == null ? void 0 : s.message;
    return t && this._addMessage(t), e;
  }
  _addMessage(e, t = !0) {
    if ("content" in e || (e.content = null), this.messages.push(e), t) {
      if (this._emit("message", e), (Pg(e) || Mg(e)) && e.content)
        this._emit("functionCallResult", e.content);
      else if (Zr(e) && e.function_call)
        this._emit("functionCall", e.function_call);
      else if (Zr(e) && e.tool_calls)
        for (const s of e.tool_calls)
          s.type === "function" && this._emit("functionCall", s.function);
    }
  }
  _connected() {
    this.ended || (Ce(this, Qo, "f").call(this), this._emit("connect"));
  }
  get ended() {
    return Ce(this, Oa, "f");
  }
  get errored() {
    return Ce(this, tn, "f");
  }
  get aborted() {
    return Ce(this, sn, "f");
  }
  abort() {
    this.controller.abort();
  }
  /**
   * Adds the listener function to the end of the listeners array for the event.
   * No checks are made to see if the listener has already been added. Multiple calls passing
   * the same combination of event and listener will result in the listener being added, and
   * called, multiple times.
   * @returns this ChatCompletionStream, so that calls can be chained
   */
  on(e, t) {
    return (Ce(this, ci, "f")[e] || (Ce(this, ci, "f")[e] = [])).push({ listener: t }), this;
  }
  /**
   * Removes the specified listener from the listener array for the event.
   * off() will remove, at most, one instance of a listener from the listener array. If any single
   * listener has been added multiple times to the listener array for the specified event, then
   * off() must be called multiple times to remove each instance.
   * @returns this ChatCompletionStream, so that calls can be chained
   */
  off(e, t) {
    const s = Ce(this, ci, "f")[e];
    if (!s)
      return this;
    const i = s.findIndex((a) => a.listener === t);
    return i >= 0 && s.splice(i, 1), this;
  }
  /**
   * Adds a one-time listener function for the event. The next time the event is triggered,
   * this listener is removed and then invoked.
   * @returns this ChatCompletionStream, so that calls can be chained
   */
  once(e, t) {
    return (Ce(this, ci, "f")[e] || (Ce(this, ci, "f")[e] = [])).push({ listener: t, once: !0 }), this;
  }
  /**
   * This is similar to `.once()`, but returns a Promise that resolves the next time
   * the event is triggered, instead of calling a listener callback.
   * @returns a Promise that resolves the next time given event is triggered,
   * or rejects if an error is emitted.  (If you request the 'error' event,
   * returns a promise that resolves with the error).
   *
   * Example:
   *
   *   const message = await stream.emitted('message') // rejects if the stream errors
   */
  emitted(e) {
    return new Promise((t, s) => {
      As(this, xr, !0, "f"), e !== "error" && this.once("error", s), this.once(e, t);
    });
  }
  async done() {
    As(this, xr, !0, "f"), await Ce(this, Pa, "f");
  }
  /**
   * @returns a promise that resolves with the final ChatCompletion, or rejects
   * if an error occurred or the stream ended prematurely without producing a ChatCompletion.
   */
  async finalChatCompletion() {
    await this.done();
    const e = this._chatCompletions[this._chatCompletions.length - 1];
    if (!e)
      throw new xe("stream ended without producing a ChatCompletion");
    return e;
  }
  /**
   * @returns a promise that resolves with the content of the final ChatCompletionMessage, or rejects
   * if an error occurred or the stream ended prematurely without producing a ChatCompletionMessage.
   */
  async finalContent() {
    return await this.done(), Ce(this, It, "m", Xc).call(this);
  }
  /**
   * @returns a promise that resolves with the the final assistant ChatCompletionMessage response,
   * or rejects if an error occurred or the stream ended prematurely without producing a ChatCompletionMessage.
   */
  async finalMessage() {
    return await this.done(), Ce(this, It, "m", Wn).call(this);
  }
  /**
   * @returns a promise that resolves with the content of the final FunctionCall, or rejects
   * if an error occurred or the stream ended prematurely without producing a ChatCompletionMessage.
   */
  async finalFunctionCall() {
    return await this.done(), Ce(this, It, "m", Zc).call(this);
  }
  async finalFunctionCallResult() {
    return await this.done(), Ce(this, It, "m", Jc).call(this);
  }
  async totalUsage() {
    return await this.done(), Ce(this, It, "m", Qc).call(this);
  }
  allChatCompletions() {
    return [...this._chatCompletions];
  }
  _emit(e, ...t) {
    if (Ce(this, Oa, "f"))
      return;
    e === "end" && (As(this, Oa, !0, "f"), Ce(this, en, "f").call(this));
    const s = Ce(this, ci, "f")[e];
    if (s && (Ce(this, ci, "f")[e] = s.filter((i) => !i.once), s.forEach(({ listener: i }) => i(...t))), e === "abort") {
      const i = t[0];
      !Ce(this, xr, "f") && !(s != null && s.length) && Promise.reject(i), Ce(this, Ia, "f").call(this, i), Ce(this, Ma, "f").call(this, i), this._emit("end");
      return;
    }
    if (e === "error") {
      const i = t[0];
      !Ce(this, xr, "f") && !(s != null && s.length) && Promise.reject(i), Ce(this, Ia, "f").call(this, i), Ce(this, Ma, "f").call(this, i), this._emit("end");
    }
  }
  _emitFinal() {
    const e = this._chatCompletions[this._chatCompletions.length - 1];
    e && this._emit("finalChatCompletion", e);
    const t = Ce(this, It, "m", Wn).call(this);
    t && this._emit("finalMessage", t);
    const s = Ce(this, It, "m", Xc).call(this);
    s && this._emit("finalContent", s);
    const i = Ce(this, It, "m", Zc).call(this);
    i && this._emit("finalFunctionCall", i);
    const a = Ce(this, It, "m", Jc).call(this);
    a != null && this._emit("finalFunctionCallResult", a), this._chatCompletions.some((o) => o.usage) && this._emit("totalUsage", Ce(this, It, "m", Qc).call(this));
  }
  async _createChatCompletion(e, t, s) {
    const i = s == null ? void 0 : s.signal;
    i && (i.aborted && this.controller.abort(), i.addEventListener("abort", () => this.controller.abort())), Ce(this, It, "m", Og).call(this, t);
    const a = await e.create({ ...t, stream: !1 }, { ...s, signal: this.controller.signal });
    return this._connected(), this._addChatCompletion(a);
  }
  async _runChatCompletion(e, t, s) {
    for (const i of t.messages)
      this._addMessage(i, !1);
    return await this._createChatCompletion(e, t, s);
  }
  async _runFunctions(e, t, s) {
    var p;
    const i = "function", { function_call: a = "auto", stream: o, ...n } = t, l = typeof a != "string" && (a == null ? void 0 : a.name), { maxChatCompletions: c = v0 } = s || {}, u = {};
    for (const h of t.functions)
      u[h.name || h.function.name] = h;
    const g = t.functions.map((h) => ({
      name: h.name || h.function.name,
      parameters: h.parameters,
      description: h.description
    }));
    for (const h of t.messages)
      this._addMessage(h, !1);
    for (let h = 0; h < c; ++h) {
      const y = (p = (await this._createChatCompletion(e, {
        ...n,
        function_call: a,
        functions: g,
        messages: [...this.messages]
      }, s)).choices[0]) == null ? void 0 : p.message;
      if (!y)
        throw new xe("missing message in ChatCompletion response");
      if (!y.function_call)
        return;
      const { name: k, arguments: _ } = y.function_call, C = u[k];
      if (C) {
        if (l && l !== k) {
          const O = `Invalid function_call: ${JSON.stringify(k)}. ${JSON.stringify(l)} requested. Please try again`;
          this._addMessage({ role: i, name: k, content: O });
          continue;
        }
      } else {
        const O = `Invalid function_call: ${JSON.stringify(k)}. Available options are: ${g.map((M) => JSON.stringify(M.name)).join(", ")}. Please try again`;
        this._addMessage({ role: i, name: k, content: O });
        continue;
      }
      let T;
      try {
        T = w0(C) ? await C.parse(_) : _;
      } catch (O) {
        this._addMessage({
          role: i,
          name: k,
          content: O instanceof Error ? O.message : String(O)
        });
        continue;
      }
      const x = await C.function(T, this), S = Ce(this, It, "m", tu).call(this, x);
      if (this._addMessage({ role: i, name: k, content: S }), l)
        return;
    }
  }
  async _runTools(e, t, s) {
    var p, h;
    const i = "tool", { tool_choice: a = "auto", stream: o, ...n } = t, l = typeof a != "string" && ((p = a == null ? void 0 : a.function) == null ? void 0 : p.name), { maxChatCompletions: c = v0 } = s || {}, u = {};
    for (const m of t.tools)
      m.type === "function" && (u[m.function.name || m.function.function.name] = m.function);
    const g = "tools" in t ? t.tools.map((m) => m.type === "function" ? {
      type: "function",
      function: {
        name: m.function.name || m.function.function.name,
        parameters: m.function.parameters,
        description: m.function.description
      }
    } : m) : void 0;
    for (const m of t.messages)
      this._addMessage(m, !1);
    for (let m = 0; m < c; ++m) {
      const k = (h = (await this._createChatCompletion(e, {
        ...n,
        tool_choice: a,
        tools: g,
        messages: [...this.messages]
      }, s)).choices[0]) == null ? void 0 : h.message;
      if (!k)
        throw new xe("missing message in ChatCompletion response");
      if (!k.tool_calls)
        return;
      for (const _ of k.tool_calls) {
        if (_.type !== "function")
          continue;
        const C = _.id, { name: T, arguments: x } = _.function, S = u[T];
        if (S) {
          if (l && l !== T) {
            const L = `Invalid tool_call: ${JSON.stringify(T)}. ${JSON.stringify(l)} requested. Please try again`;
            this._addMessage({ role: i, tool_call_id: C, content: L });
            continue;
          }
        } else {
          const L = `Invalid tool_call: ${JSON.stringify(T)}. Available options are: ${g.map((q) => JSON.stringify(q.function.name)).join(", ")}. Please try again`;
          this._addMessage({ role: i, tool_call_id: C, content: L });
          continue;
        }
        let O;
        try {
          O = w0(S) ? await S.parse(x) : x;
        } catch (L) {
          const q = L instanceof Error ? L.message : String(L);
          this._addMessage({ role: i, tool_call_id: C, content: q });
          continue;
        }
        const M = await S.function(O, this), R = Ce(this, It, "m", tu).call(this, M);
        if (this._addMessage({ role: i, tool_call_id: C, content: R }), l)
          return;
      }
    }
  }
}
Jo = /* @__PURE__ */ new WeakMap(), Qo = /* @__PURE__ */ new WeakMap(), Ia = /* @__PURE__ */ new WeakMap(), Pa = /* @__PURE__ */ new WeakMap(), en = /* @__PURE__ */ new WeakMap(), Ma = /* @__PURE__ */ new WeakMap(), ci = /* @__PURE__ */ new WeakMap(), Oa = /* @__PURE__ */ new WeakMap(), tn = /* @__PURE__ */ new WeakMap(), sn = /* @__PURE__ */ new WeakMap(), xr = /* @__PURE__ */ new WeakMap(), eu = /* @__PURE__ */ new WeakMap(), It = /* @__PURE__ */ new WeakSet(), Xc = function() {
  return Ce(this, It, "m", Wn).call(this).content ?? null;
}, Wn = function() {
  let e = this.messages.length;
  for (; e-- > 0; ) {
    const t = this.messages[e];
    if (Zr(t))
      return { ...t, content: t.content ?? null };
  }
  throw new xe("stream ended without producing a ChatCompletionMessage with role=assistant");
}, Zc = function() {
  var e, t;
  for (let s = this.messages.length - 1; s >= 0; s--) {
    const i = this.messages[s];
    if (Zr(i) && (i != null && i.function_call))
      return i.function_call;
    if (Zr(i) && ((e = i == null ? void 0 : i.tool_calls) != null && e.length))
      return (t = i.tool_calls.at(-1)) == null ? void 0 : t.function;
  }
}, Jc = function() {
  for (let e = this.messages.length - 1; e >= 0; e--) {
    const t = this.messages[e];
    if (Pg(t) && t.content != null || Mg(t) && t.content != null && this.messages.some((s) => {
      var i;
      return s.role === "assistant" && ((i = s.tool_calls) == null ? void 0 : i.some((a) => a.type === "function" && a.id === t.tool_call_id));
    }))
      return t.content;
  }
}, Qc = function() {
  const e = {
    completion_tokens: 0,
    prompt_tokens: 0,
    total_tokens: 0
  };
  for (const { usage: t } of this._chatCompletions)
    t && (e.completion_tokens += t.completion_tokens, e.prompt_tokens += t.prompt_tokens, e.total_tokens += t.total_tokens);
  return e;
}, Og = function(e) {
  if (e.n != null && e.n > 1)
    throw new xe("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.");
}, tu = function(e) {
  return typeof e == "string" ? e : e === void 0 ? "undefined" : JSON.stringify(e);
};
class bo extends Fg {
  /** @deprecated - please use `runTools` instead. */
  static runFunctions(e, t, s) {
    const i = new bo(), a = {
      ...s,
      headers: { ...s == null ? void 0 : s.headers, "X-Stainless-Helper-Method": "runFunctions" }
    };
    return i._run(() => i._runFunctions(e, t, a)), i;
  }
  static runTools(e, t, s) {
    const i = new bo(), a = {
      ...s,
      headers: { ...s == null ? void 0 : s.headers, "X-Stainless-Helper-Method": "runTools" }
    };
    return i._run(() => i._runTools(e, t, a)), i;
  }
  _addMessage(e) {
    super._addMessage(e), Zr(e) && e.content && this._emit("content", e.content);
  }
}
var xs = function(r, e, t, s) {
  if (t === "a" && !s)
    throw new TypeError("Private accessor was defined without a getter");
  if (typeof e == "function" ? r !== e || !s : !e.has(r))
    throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return t === "m" ? s : t === "a" ? s.call(r) : s ? s.value : e.get(r);
}, rc = function(r, e, t, s, i) {
  if (s === "m")
    throw new TypeError("Private method is not writable");
  if (s === "a" && !i)
    throw new TypeError("Private accessor was defined without a setter");
  if (typeof e == "function" ? r !== e || !i : !e.has(r))
    throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return s === "a" ? i.call(r, t) : i ? i.value = t : e.set(r, t), t;
}, qs, Mi, ac, oc, Wo, k0;
class wo extends Fg {
  constructor() {
    super(...arguments), qs.add(this), Mi.set(this, void 0);
  }
  get currentChatCompletionSnapshot() {
    return xs(this, Mi, "f");
  }
  /**
   * Intended for use on the frontend, consuming a stream produced with
   * `.toReadableStream()` on the backend.
   *
   * Note that messages sent to the model do not appear in `.on('message')`
   * in this context.
   */
  static fromReadableStream(e) {
    const t = new wo();
    return t._run(() => t._fromReadableStream(e)), t;
  }
  static createChatCompletion(e, t, s) {
    const i = new wo();
    return i._run(() => i._runChatCompletion(e, { ...t, stream: !0 }, { ...s, headers: { ...s == null ? void 0 : s.headers, "X-Stainless-Helper-Method": "stream" } })), i;
  }
  async _createChatCompletion(e, t, s) {
    var o;
    const i = s == null ? void 0 : s.signal;
    i && (i.aborted && this.controller.abort(), i.addEventListener("abort", () => this.controller.abort())), xs(this, qs, "m", ac).call(this);
    const a = await e.create({ ...t, stream: !0 }, { ...s, signal: this.controller.signal });
    this._connected();
    for await (const n of a)
      xs(this, qs, "m", oc).call(this, n);
    if ((o = a.controller.signal) != null && o.aborted)
      throw new Ds();
    return this._addChatCompletion(xs(this, qs, "m", Wo).call(this));
  }
  async _fromReadableStream(e, t) {
    var o;
    const s = t == null ? void 0 : t.signal;
    s && (s.aborted && this.controller.abort(), s.addEventListener("abort", () => this.controller.abort())), xs(this, qs, "m", ac).call(this), this._connected();
    const i = vi.fromReadableStream(e, this.controller);
    let a;
    for await (const n of i)
      a && a !== n.id && this._addChatCompletion(xs(this, qs, "m", Wo).call(this)), xs(this, qs, "m", oc).call(this, n), a = n.id;
    if ((o = i.controller.signal) != null && o.aborted)
      throw new Ds();
    return this._addChatCompletion(xs(this, qs, "m", Wo).call(this));
  }
  [(Mi = /* @__PURE__ */ new WeakMap(), qs = /* @__PURE__ */ new WeakSet(), ac = function() {
    this.ended || rc(this, Mi, void 0, "f");
  }, oc = function(t) {
    var o, n, l;
    if (this.ended)
      return;
    const s = xs(this, qs, "m", k0).call(this, t);
    this._emit("chunk", t, s);
    const i = (n = (o = t.choices[0]) == null ? void 0 : o.delta) == null ? void 0 : n.content, a = (l = s.choices[0]) == null ? void 0 : l.message;
    i != null && (a == null ? void 0 : a.role) === "assistant" && (a != null && a.content) && this._emit("content", i, a.content);
  }, Wo = function() {
    if (this.ended)
      throw new xe("stream has ended, this shouldn't happen");
    const t = xs(this, Mi, "f");
    if (!t)
      throw new xe("request ended without sending any chunks");
    return rc(this, Mi, void 0, "f"), j3(t);
  }, k0 = function(t) {
    var s, i, a;
    let o = xs(this, Mi, "f");
    const { choices: n, ...l } = t;
    o ? Object.assign(o, l) : o = rc(this, Mi, {
      ...l,
      choices: []
    }, "f");
    for (const { delta: c, finish_reason: u, index: g, logprobs: p = null, ...h } of t.choices) {
      let m = o.choices[g];
      if (m || (m = o.choices[g] = { finish_reason: u, index: g, message: {}, logprobs: p, ...h }), p)
        if (!m.logprobs)
          m.logprobs = Object.assign({}, p);
        else {
          const { content: x, ...S } = p;
          Object.assign(m.logprobs, S), x && ((s = m.logprobs).content ?? (s.content = []), m.logprobs.content.push(...x));
        }
      if (u && (m.finish_reason = u), Object.assign(m, h), !c)
        continue;
      const { content: y, function_call: k, role: _, tool_calls: C, ...T } = c;
      if (Object.assign(m.message, T), y && (m.message.content = (m.message.content || "") + y), _ && (m.message.role = _), k && (m.message.function_call ? (k.name && (m.message.function_call.name = k.name), k.arguments && ((i = m.message.function_call).arguments ?? (i.arguments = ""), m.message.function_call.arguments += k.arguments)) : m.message.function_call = k), C) {
        m.message.tool_calls || (m.message.tool_calls = []);
        for (const { index: x, id: S, type: O, function: M, ...R } of C) {
          const L = (a = m.message.tool_calls)[x] ?? (a[x] = {});
          Object.assign(L, R), S && (L.id = S), O && (L.type = O), M && (L.function ?? (L.function = { arguments: "" })), M != null && M.name && (L.function.name = M.name), M != null && M.arguments && (L.function.arguments += M.arguments);
        }
      }
    }
    return o;
  }, Symbol.asyncIterator)]() {
    const e = [], t = [];
    let s = !1;
    return this.on("chunk", (i) => {
      const a = t.shift();
      a ? a.resolve(i) : e.push(i);
    }), this.on("end", () => {
      s = !0;
      for (const i of t)
        i.resolve(void 0);
      t.length = 0;
    }), this.on("abort", (i) => {
      s = !0;
      for (const a of t)
        a.reject(i);
      t.length = 0;
    }), this.on("error", (i) => {
      s = !0;
      for (const a of t)
        a.reject(i);
      t.length = 0;
    }), {
      next: async () => e.length ? { value: e.shift(), done: !1 } : s ? { value: void 0, done: !0 } : new Promise((a, o) => t.push({ resolve: a, reject: o })).then((a) => a ? { value: a, done: !1 } : { value: void 0, done: !0 }),
      return: async () => (this.abort(), { value: void 0, done: !0 })
    };
  }
  toReadableStream() {
    return new vi(this[Symbol.asyncIterator].bind(this), this.controller).toReadableStream();
  }
}
function j3(r) {
  const { id: e, choices: t, created: s, model: i, system_fingerprint: a, ...o } = r;
  return {
    ...o,
    id: e,
    choices: t.map(({ message: n, finish_reason: l, index: c, logprobs: u, ...g }) => {
      if (!l)
        throw new xe(`missing finish_reason for choice ${c}`);
      const { content: p = null, function_call: h, tool_calls: m, ...y } = n, k = n.role;
      if (!k)
        throw new xe(`missing role for choice ${c}`);
      if (h) {
        const { arguments: _, name: C } = h;
        if (_ == null)
          throw new xe(`missing function_call.arguments for choice ${c}`);
        if (!C)
          throw new xe(`missing function_call.name for choice ${c}`);
        return {
          ...g,
          message: { content: p, function_call: { arguments: _, name: C }, role: k },
          finish_reason: l,
          index: c,
          logprobs: u
        };
      }
      return m ? {
        ...g,
        index: c,
        finish_reason: l,
        logprobs: u,
        message: {
          ...y,
          role: k,
          content: p,
          tool_calls: m.map((_, C) => {
            const { function: T, type: x, id: S, ...O } = _, { arguments: M, name: R, ...L } = T || {};
            if (S == null)
              throw new xe(`missing choices[${c}].tool_calls[${C}].id
${jo(r)}`);
            if (x == null)
              throw new xe(`missing choices[${c}].tool_calls[${C}].type
${jo(r)}`);
            if (R == null)
              throw new xe(`missing choices[${c}].tool_calls[${C}].function.name
${jo(r)}`);
            if (M == null)
              throw new xe(`missing choices[${c}].tool_calls[${C}].function.arguments
${jo(r)}`);
            return { ...O, id: S, type: x, function: { ...L, name: R, arguments: M } };
          })
        }
      } : {
        ...g,
        message: { ...y, content: p, role: k },
        finish_reason: l,
        index: c,
        logprobs: u
      };
    }),
    created: s,
    model: i,
    object: "chat.completion",
    ...a ? { system_fingerprint: a } : {}
  };
}
function jo(r) {
  return JSON.stringify(r);
}
class Jr extends wo {
  static fromReadableStream(e) {
    const t = new Jr();
    return t._run(() => t._fromReadableStream(e)), t;
  }
  /** @deprecated - please use `runTools` instead. */
  static runFunctions(e, t, s) {
    const i = new Jr(), a = {
      ...s,
      headers: { ...s == null ? void 0 : s.headers, "X-Stainless-Helper-Method": "runFunctions" }
    };
    return i._run(() => i._runFunctions(e, t, a)), i;
  }
  static runTools(e, t, s) {
    const i = new Jr(), a = {
      ...s,
      headers: { ...s == null ? void 0 : s.headers, "X-Stainless-Helper-Method": "runTools" }
    };
    return i._run(() => i._runTools(e, t, a)), i;
  }
}
let Lg = class extends Ze {
  runFunctions(e, t) {
    return e.stream ? Jr.runFunctions(this._client.chat.completions, e, t) : bo.runFunctions(this._client.chat.completions, e, t);
  }
  runTools(e, t) {
    return e.stream ? Jr.runTools(this._client.chat.completions, e, t) : bo.runTools(this._client.chat.completions, e, t);
  }
  /**
   * Creates a chat completion stream
   */
  stream(e, t) {
    return wo.createChatCompletion(this._client.chat.completions, e, t);
  }
};
class jn extends Ze {
  constructor() {
    super(...arguments), this.completions = new Lg(this._client);
  }
}
(function(r) {
  r.Completions = Lg;
})(jn || (jn = {}));
var Is = function(r, e, t, s, i) {
  if (s === "m")
    throw new TypeError("Private method is not writable");
  if (s === "a" && !i)
    throw new TypeError("Private accessor was defined without a setter");
  if (typeof e == "function" ? r !== e || !i : !e.has(r))
    throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return s === "a" ? i.call(r, t) : i ? i.value = t : e.set(r, t), t;
}, Je = function(r, e, t, s) {
  if (t === "a" && !s)
    throw new TypeError("Private accessor was defined without a getter");
  if (typeof e == "function" ? r !== e || !s : !e.has(r))
    throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return t === "m" ? s : t === "a" ? s.call(r) : s ? s.value : e.get(r);
}, rn, an, Fa, La, on, Ra, hi, $a, nn, ln, Ir, su;
class K3 {
  constructor() {
    this.controller = new AbortController(), rn.set(this, void 0), an.set(this, () => {
    }), Fa.set(this, () => {
    }), La.set(this, void 0), on.set(this, () => {
    }), Ra.set(this, () => {
    }), hi.set(this, {}), $a.set(this, !1), nn.set(this, !1), ln.set(this, !1), Ir.set(this, !1), su.set(this, (e) => {
      if (Is(this, nn, !0, "f"), e instanceof Error && e.name === "AbortError" && (e = new Ds()), e instanceof Ds)
        return Is(this, ln, !0, "f"), this._emit("abort", e);
      if (e instanceof xe)
        return this._emit("error", e);
      if (e instanceof Error) {
        const t = new xe(e.message);
        return t.cause = e, this._emit("error", t);
      }
      return this._emit("error", new xe(String(e)));
    }), Is(this, rn, new Promise((e, t) => {
      Is(this, an, e, "f"), Is(this, Fa, t, "f");
    }), "f"), Is(this, La, new Promise((e, t) => {
      Is(this, on, e, "f"), Is(this, Ra, t, "f");
    }), "f"), Je(this, rn, "f").catch(() => {
    }), Je(this, La, "f").catch(() => {
    });
  }
  _run(e) {
    setTimeout(() => {
      e().then(() => {
        this._emit("end");
      }, Je(this, su, "f"));
    }, 0);
  }
  _addRun(e) {
    return e;
  }
  _connected() {
    this.ended || (Je(this, an, "f").call(this), this._emit("connect"));
  }
  get ended() {
    return Je(this, $a, "f");
  }
  get errored() {
    return Je(this, nn, "f");
  }
  get aborted() {
    return Je(this, ln, "f");
  }
  abort() {
    this.controller.abort();
  }
  /**
   * Adds the listener function to the end of the listeners array for the event.
   * No checks are made to see if the listener has already been added. Multiple calls passing
   * the same combination of event and listener will result in the listener being added, and
   * called, multiple times.
   * @returns this ChatCompletionStream, so that calls can be chained
   */
  on(e, t) {
    return (Je(this, hi, "f")[e] || (Je(this, hi, "f")[e] = [])).push({ listener: t }), this;
  }
  /**
   * Removes the specified listener from the listener array for the event.
   * off() will remove, at most, one instance of a listener from the listener array. If any single
   * listener has been added multiple times to the listener array for the specified event, then
   * off() must be called multiple times to remove each instance.
   * @returns this ChatCompletionStream, so that calls can be chained
   */
  off(e, t) {
    const s = Je(this, hi, "f")[e];
    if (!s)
      return this;
    const i = s.findIndex((a) => a.listener === t);
    return i >= 0 && s.splice(i, 1), this;
  }
  /**
   * Adds a one-time listener function for the event. The next time the event is triggered,
   * this listener is removed and then invoked.
   * @returns this ChatCompletionStream, so that calls can be chained
   */
  once(e, t) {
    return (Je(this, hi, "f")[e] || (Je(this, hi, "f")[e] = [])).push({ listener: t, once: !0 }), this;
  }
  /**
   * This is similar to `.once()`, but returns a Promise that resolves the next time
   * the event is triggered, instead of calling a listener callback.
   * @returns a Promise that resolves the next time given event is triggered,
   * or rejects if an error is emitted.  (If you request the 'error' event,
   * returns a promise that resolves with the error).
   *
   * Example:
   *
   *   const message = await stream.emitted('message') // rejects if the stream errors
   */
  emitted(e) {
    return new Promise((t, s) => {
      Is(this, Ir, !0, "f"), e !== "error" && this.once("error", s), this.once(e, t);
    });
  }
  async done() {
    Is(this, Ir, !0, "f"), await Je(this, La, "f");
  }
  _emit(e, ...t) {
    if (Je(this, $a, "f"))
      return;
    e === "end" && (Is(this, $a, !0, "f"), Je(this, on, "f").call(this));
    const s = Je(this, hi, "f")[e];
    if (s && (Je(this, hi, "f")[e] = s.filter((i) => !i.once), s.forEach(({ listener: i }) => i(...t))), e === "abort") {
      const i = t[0];
      !Je(this, Ir, "f") && !(s != null && s.length) && Promise.reject(i), Je(this, Fa, "f").call(this, i), Je(this, Ra, "f").call(this, i), this._emit("end");
      return;
    }
    if (e === "error") {
      const i = t[0];
      !Je(this, Ir, "f") && !(s != null && s.length) && Promise.reject(i), Je(this, Fa, "f").call(this, i), Je(this, Ra, "f").call(this, i), this._emit("end");
    }
  }
  async _threadAssistantStream(e, t, s) {
    return await this._createThreadAssistantStream(t, e, s);
  }
  async _runAssistantStream(e, t, s, i) {
    return await this._createAssistantStream(t, e, s, i);
  }
  async _runToolAssistantStream(e, t, s, i, a) {
    return await this._createToolAssistantStream(s, e, t, i, a);
  }
  async _createThreadAssistantStream(e, t, s) {
    const i = s == null ? void 0 : s.signal;
    i && (i.aborted && this.controller.abort(), i.addEventListener("abort", () => this.controller.abort()));
    const a = await e.createAndRun({ ...t, stream: !1 }, { ...s, signal: this.controller.signal });
    return this._connected(), this._addRun(a);
  }
  async _createToolAssistantStream(e, t, s, i, a) {
    const o = a == null ? void 0 : a.signal;
    o && (o.aborted && this.controller.abort(), o.addEventListener("abort", () => this.controller.abort()));
    const n = await e.submitToolOutputs(t, s, { ...i, stream: !1 }, { ...a, signal: this.controller.signal });
    return this._connected(), this._addRun(n);
  }
  async _createAssistantStream(e, t, s, i) {
    const a = i == null ? void 0 : i.signal;
    a && (a.aborted && this.controller.abort(), a.addEventListener("abort", () => this.controller.abort()));
    const o = await e.create(t, { ...s, stream: !1 }, { ...i, signal: this.controller.signal });
    return this._connected(), this._addRun(o);
  }
}
rn = /* @__PURE__ */ new WeakMap(), an = /* @__PURE__ */ new WeakMap(), Fa = /* @__PURE__ */ new WeakMap(), La = /* @__PURE__ */ new WeakMap(), on = /* @__PURE__ */ new WeakMap(), Ra = /* @__PURE__ */ new WeakMap(), hi = /* @__PURE__ */ new WeakMap(), $a = /* @__PURE__ */ new WeakMap(), nn = /* @__PURE__ */ new WeakMap(), ln = /* @__PURE__ */ new WeakMap(), Ir = /* @__PURE__ */ new WeakMap(), su = /* @__PURE__ */ new WeakMap();
var ge = function(r, e, t, s) {
  if (t === "a" && !s)
    throw new TypeError("Private accessor was defined without a getter");
  if (typeof e == "function" ? r !== e || !s : !e.has(r))
    throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return t === "m" ? s : t === "a" ? s.call(r) : s ? s.value : e.get(r);
}, ts = function(r, e, t, s, i) {
  if (s === "m")
    throw new TypeError("Private method is not writable");
  if (s === "a" && !i)
    throw new TypeError("Private accessor was defined without a setter");
  if (typeof e == "function" ? r !== e || !i : !e.has(r))
    throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return s === "a" ? i.call(r, t) : i ? i.value = t : e.set(r, t), t;
}, Ht, iu, Xs, cn, Os, lr, Br, or, Kn, ss, un, hn, so, dn, gn, _0, D0, T0, C0, S0, E0, A0;
class _i extends K3 {
  constructor() {
    super(...arguments), Ht.add(this), iu.set(this, []), Xs.set(this, {}), cn.set(this, {}), Os.set(this, void 0), lr.set(this, void 0), Br.set(this, void 0), or.set(this, void 0), Kn.set(this, void 0), ss.set(this, void 0), un.set(this, void 0), hn.set(this, void 0), so.set(this, void 0);
  }
  [(iu = /* @__PURE__ */ new WeakMap(), Xs = /* @__PURE__ */ new WeakMap(), cn = /* @__PURE__ */ new WeakMap(), Os = /* @__PURE__ */ new WeakMap(), lr = /* @__PURE__ */ new WeakMap(), Br = /* @__PURE__ */ new WeakMap(), or = /* @__PURE__ */ new WeakMap(), Kn = /* @__PURE__ */ new WeakMap(), ss = /* @__PURE__ */ new WeakMap(), un = /* @__PURE__ */ new WeakMap(), hn = /* @__PURE__ */ new WeakMap(), so = /* @__PURE__ */ new WeakMap(), Ht = /* @__PURE__ */ new WeakSet(), Symbol.asyncIterator)]() {
    const e = [], t = [];
    let s = !1;
    return this.on("event", (i) => {
      const a = t.shift();
      a ? a.resolve(i) : e.push(i);
    }), this.on("end", () => {
      s = !0;
      for (const i of t)
        i.resolve(void 0);
      t.length = 0;
    }), this.on("abort", (i) => {
      s = !0;
      for (const a of t)
        a.reject(i);
      t.length = 0;
    }), this.on("error", (i) => {
      s = !0;
      for (const a of t)
        a.reject(i);
      t.length = 0;
    }), {
      next: async () => e.length ? { value: e.shift(), done: !1 } : s ? { value: void 0, done: !0 } : new Promise((a, o) => t.push({ resolve: a, reject: o })).then((a) => a ? { value: a, done: !1 } : { value: void 0, done: !0 }),
      return: async () => (this.abort(), { value: void 0, done: !0 })
    };
  }
  toReadableStream() {
    return new vi(this[Symbol.asyncIterator].bind(this), this.controller).toReadableStream();
  }
  static createToolAssistantStream(e, t, s, i, a) {
    const o = new _i();
    return o._run(() => o._runToolAssistantStream(e, t, s, i, {
      ...a,
      headers: { ...a == null ? void 0 : a.headers, "X-Stainless-Helper-Method": "stream" }
    })), o;
  }
  async _createToolAssistantStream(e, t, s, i, a) {
    var c;
    const o = a == null ? void 0 : a.signal;
    o && (o.aborted && this.controller.abort(), o.addEventListener("abort", () => this.controller.abort()));
    const n = { ...i, stream: !0 }, l = await e.submitToolOutputs(t, s, n, {
      ...a,
      signal: this.controller.signal
    });
    this._connected();
    for await (const u of l)
      ge(this, Ht, "m", dn).call(this, u);
    if ((c = l.controller.signal) != null && c.aborted)
      throw new Ds();
    return this._addRun(ge(this, Ht, "m", gn).call(this));
  }
  static createThreadAssistantStream(e, t, s) {
    const i = new _i();
    return i._run(() => i._threadAssistantStream(e, t, {
      ...s,
      headers: { ...s == null ? void 0 : s.headers, "X-Stainless-Helper-Method": "stream" }
    })), i;
  }
  static createAssistantStream(e, t, s, i) {
    const a = new _i();
    return a._run(() => a._runAssistantStream(e, t, s, {
      ...i,
      headers: { ...i == null ? void 0 : i.headers, "X-Stainless-Helper-Method": "stream" }
    })), a;
  }
  currentEvent() {
    return ge(this, un, "f");
  }
  currentRun() {
    return ge(this, hn, "f");
  }
  currentMessageSnapshot() {
    return ge(this, Os, "f");
  }
  currentRunStepSnapshot() {
    return ge(this, so, "f");
  }
  async finalRunSteps() {
    return await this.done(), Object.values(ge(this, Xs, "f"));
  }
  async finalMessages() {
    return await this.done(), Object.values(ge(this, cn, "f"));
  }
  async finalRun() {
    if (await this.done(), !ge(this, lr, "f"))
      throw Error("Final run was not received.");
    return ge(this, lr, "f");
  }
  async _createThreadAssistantStream(e, t, s) {
    var n;
    const i = s == null ? void 0 : s.signal;
    i && (i.aborted && this.controller.abort(), i.addEventListener("abort", () => this.controller.abort()));
    const a = { ...t, stream: !0 }, o = await e.createAndRun(a, { ...s, signal: this.controller.signal });
    this._connected();
    for await (const l of o)
      ge(this, Ht, "m", dn).call(this, l);
    if ((n = o.controller.signal) != null && n.aborted)
      throw new Ds();
    return this._addRun(ge(this, Ht, "m", gn).call(this));
  }
  async _createAssistantStream(e, t, s, i) {
    var l;
    const a = i == null ? void 0 : i.signal;
    a && (a.aborted && this.controller.abort(), a.addEventListener("abort", () => this.controller.abort()));
    const o = { ...s, stream: !0 }, n = await e.create(t, o, { ...i, signal: this.controller.signal });
    this._connected();
    for await (const c of n)
      ge(this, Ht, "m", dn).call(this, c);
    if ((l = n.controller.signal) != null && l.aborted)
      throw new Ds();
    return this._addRun(ge(this, Ht, "m", gn).call(this));
  }
  static accumulateDelta(e, t) {
    for (const [s, i] of Object.entries(t)) {
      if (!e.hasOwnProperty(s)) {
        e[s] = i;
        continue;
      }
      let a = e[s];
      if (a == null) {
        e[s] = i;
        continue;
      }
      if (s === "index" || s === "type") {
        e[s] = i;
        continue;
      }
      if (typeof a == "string" && typeof i == "string")
        a += i;
      else if (typeof a == "number" && typeof i == "number")
        a += i;
      else if (b0(a) && b0(i))
        a = this.accumulateDelta(a, i);
      else if (Array.isArray(a) && Array.isArray(i)) {
        if (a.every((o) => typeof o == "string" || typeof o == "number")) {
          a.push(...i);
          continue;
        }
      } else
        throw Error(`Unhandled record type: ${s}, deltaValue: ${i}, accValue: ${a}`);
      e[s] = a;
    }
    return e;
  }
}
dn = function(e) {
  if (!this.ended)
    switch (ts(this, un, e, "f"), ge(this, Ht, "m", T0).call(this, e), e.event) {
      case "thread.created":
        break;
      case "thread.run.created":
      case "thread.run.queued":
      case "thread.run.in_progress":
      case "thread.run.requires_action":
      case "thread.run.completed":
      case "thread.run.failed":
      case "thread.run.cancelling":
      case "thread.run.cancelled":
      case "thread.run.expired":
        ge(this, Ht, "m", A0).call(this, e);
        break;
      case "thread.run.step.created":
      case "thread.run.step.in_progress":
      case "thread.run.step.delta":
      case "thread.run.step.completed":
      case "thread.run.step.failed":
      case "thread.run.step.cancelled":
      case "thread.run.step.expired":
        ge(this, Ht, "m", D0).call(this, e);
        break;
      case "thread.message.created":
      case "thread.message.in_progress":
      case "thread.message.delta":
      case "thread.message.completed":
      case "thread.message.incomplete":
        ge(this, Ht, "m", _0).call(this, e);
        break;
      case "error":
        throw new Error("Encountered an error event in event processing - errors should be processed earlier");
    }
}, gn = function() {
  if (this.ended)
    throw new xe("stream has ended, this shouldn't happen");
  if (!ge(this, lr, "f"))
    throw Error("Final run has been been received");
  return ge(this, lr, "f");
}, _0 = function(e) {
  const [t, s] = ge(this, Ht, "m", S0).call(this, e, ge(this, Os, "f"));
  ts(this, Os, t, "f"), ge(this, cn, "f")[t.id] = t;
  for (const i of s) {
    const a = t.content[i.index];
    (a == null ? void 0 : a.type) == "text" && this._emit("textCreated", a.text);
  }
  switch (e.event) {
    case "thread.message.created":
      this._emit("messageCreated", e.data);
      break;
    case "thread.message.in_progress":
      break;
    case "thread.message.delta":
      if (this._emit("messageDelta", e.data.delta, t), e.data.delta.content)
        for (const i of e.data.delta.content) {
          if (i.type == "text" && i.text) {
            let a = i.text, o = t.content[i.index];
            if (o && o.type == "text")
              this._emit("textDelta", a, o.text);
            else
              throw Error("The snapshot associated with this text delta is not text or missing");
          }
          if (i.index != ge(this, Br, "f")) {
            if (ge(this, or, "f"))
              switch (ge(this, or, "f").type) {
                case "text":
                  this._emit("textDone", ge(this, or, "f").text, ge(this, Os, "f"));
                  break;
                case "image_file":
                  this._emit("imageFileDone", ge(this, or, "f").image_file, ge(this, Os, "f"));
                  break;
              }
            ts(this, Br, i.index, "f");
          }
          ts(this, or, t.content[i.index], "f");
        }
      break;
    case "thread.message.completed":
    case "thread.message.incomplete":
      if (ge(this, Br, "f") !== void 0) {
        const i = e.data.content[ge(this, Br, "f")];
        if (i)
          switch (i.type) {
            case "image_file":
              this._emit("imageFileDone", i.image_file, ge(this, Os, "f"));
              break;
            case "text":
              this._emit("textDone", i.text, ge(this, Os, "f"));
              break;
          }
      }
      ge(this, Os, "f") && this._emit("messageDone", e.data), ts(this, Os, void 0, "f");
  }
}, D0 = function(e) {
  const t = ge(this, Ht, "m", C0).call(this, e);
  switch (ts(this, so, t, "f"), e.event) {
    case "thread.run.step.created":
      this._emit("runStepCreated", e.data);
      break;
    case "thread.run.step.delta":
      const s = e.data.delta;
      if (s.step_details && s.step_details.type == "tool_calls" && s.step_details.tool_calls && t.step_details.type == "tool_calls")
        for (const a of s.step_details.tool_calls)
          a.index == ge(this, Kn, "f") ? this._emit("toolCallDelta", a, t.step_details.tool_calls[a.index]) : (ge(this, ss, "f") && this._emit("toolCallDone", ge(this, ss, "f")), ts(this, Kn, a.index, "f"), ts(this, ss, t.step_details.tool_calls[a.index], "f"), ge(this, ss, "f") && this._emit("toolCallCreated", ge(this, ss, "f")));
      this._emit("runStepDelta", e.data.delta, t);
      break;
    case "thread.run.step.completed":
    case "thread.run.step.failed":
    case "thread.run.step.cancelled":
    case "thread.run.step.expired":
      ts(this, so, void 0, "f"), e.data.step_details.type == "tool_calls" && ge(this, ss, "f") && (this._emit("toolCallDone", ge(this, ss, "f")), ts(this, ss, void 0, "f")), this._emit("runStepDone", e.data, t);
      break;
  }
}, T0 = function(e) {
  ge(this, iu, "f").push(e), this._emit("event", e);
}, C0 = function(e) {
  switch (e.event) {
    case "thread.run.step.created":
      return ge(this, Xs, "f")[e.data.id] = e.data, e.data;
    case "thread.run.step.delta":
      let t = ge(this, Xs, "f")[e.data.id];
      if (!t)
        throw Error("Received a RunStepDelta before creation of a snapshot");
      let s = e.data;
      if (s.delta) {
        const i = _i.accumulateDelta(t, s.delta);
        ge(this, Xs, "f")[e.data.id] = i;
      }
      return ge(this, Xs, "f")[e.data.id];
    case "thread.run.step.completed":
    case "thread.run.step.failed":
    case "thread.run.step.cancelled":
    case "thread.run.step.expired":
    case "thread.run.step.in_progress":
      ge(this, Xs, "f")[e.data.id] = e.data;
      break;
  }
  if (ge(this, Xs, "f")[e.data.id])
    return ge(this, Xs, "f")[e.data.id];
  throw new Error("No snapshot available");
}, S0 = function(e, t) {
  let s = [];
  switch (e.event) {
    case "thread.message.created":
      return [e.data, s];
    case "thread.message.delta":
      if (!t)
        throw Error("Received a delta with no existing snapshot (there should be one from message creation)");
      let i = e.data;
      if (i.delta.content)
        for (const a of i.delta.content)
          if (a.index in t.content) {
            let o = t.content[a.index];
            t.content[a.index] = ge(this, Ht, "m", E0).call(this, a, o);
          } else
            t.content[a.index] = a, s.push(a);
      return [t, s];
    case "thread.message.in_progress":
    case "thread.message.completed":
    case "thread.message.incomplete":
      if (t)
        return [t, s];
      throw Error("Received thread message event with no existing snapshot");
  }
  throw Error("Tried to accumulate a non-message event");
}, E0 = function(e, t) {
  return _i.accumulateDelta(t, e);
}, A0 = function(e) {
  switch (ts(this, hn, e.data, "f"), e.event) {
    case "thread.run.created":
      break;
    case "thread.run.queued":
      break;
    case "thread.run.in_progress":
      break;
    case "thread.run.requires_action":
    case "thread.run.cancelled":
    case "thread.run.failed":
    case "thread.run.completed":
    case "thread.run.expired":
      ts(this, lr, e.data, "f"), ge(this, ss, "f") && (this._emit("toolCallDone", ge(this, ss, "f")), ts(this, ss, void 0, "f"));
      break;
  }
};
let Gn = class extends Ze {
  /**
   * Retrieves a message file.
   */
  retrieve(e, t, s, i) {
    return this._client.get(`/threads/${e}/messages/${t}/files/${s}`, {
      ...i,
      headers: { "OpenAI-Beta": "assistants=v1", ...i == null ? void 0 : i.headers }
    });
  }
  list(e, t, s = {}, i) {
    return ii(s) ? this.list(e, t, {}, s) : this._client.getAPIList(`/threads/${e}/messages/${t}/files`, Qu, {
      query: s,
      ...i,
      headers: { "OpenAI-Beta": "assistants=v1", ...i == null ? void 0 : i.headers }
    });
  }
};
class Qu extends Si {
}
(function(r) {
  r.MessageFilesPage = Qu;
})(Gn || (Gn = {}));
class Vn extends Ze {
  constructor() {
    super(...arguments), this.files = new Gn(this._client);
  }
  /**
   * Create a message.
   */
  create(e, t, s) {
    return this._client.post(`/threads/${e}/messages`, {
      body: t,
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  /**
   * Retrieve a message.
   */
  retrieve(e, t, s) {
    return this._client.get(`/threads/${e}/messages/${t}`, {
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  /**
   * Modifies a message.
   */
  update(e, t, s, i) {
    return this._client.post(`/threads/${e}/messages/${t}`, {
      body: s,
      ...i,
      headers: { "OpenAI-Beta": "assistants=v1", ...i == null ? void 0 : i.headers }
    });
  }
  list(e, t = {}, s) {
    return ii(t) ? this.list(e, {}, t) : this._client.getAPIList(`/threads/${e}/messages`, eh, {
      query: t,
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
}
class eh extends Si {
}
(function(r) {
  r.MessagesPage = eh, r.Files = Gn, r.MessageFilesPage = Qu;
})(Vn || (Vn = {}));
class zn extends Ze {
  /**
   * Retrieves a run step.
   */
  retrieve(e, t, s, i) {
    return this._client.get(`/threads/${e}/runs/${t}/steps/${s}`, {
      ...i,
      headers: { "OpenAI-Beta": "assistants=v1", ...i == null ? void 0 : i.headers }
    });
  }
  list(e, t, s = {}, i) {
    return ii(s) ? this.list(e, t, {}, s) : this._client.getAPIList(`/threads/${e}/runs/${t}/steps`, th, {
      query: s,
      ...i,
      headers: { "OpenAI-Beta": "assistants=v1", ...i == null ? void 0 : i.headers }
    });
  }
}
class th extends Si {
}
(function(r) {
  r.RunStepsPage = th;
})(zn || (zn = {}));
class qn extends Ze {
  constructor() {
    super(...arguments), this.steps = new zn(this._client);
  }
  create(e, t, s) {
    return this._client.post(`/threads/${e}/runs`, {
      body: t,
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers },
      stream: t.stream ?? !1
    });
  }
  /**
   * Retrieves a run.
   */
  retrieve(e, t, s) {
    return this._client.get(`/threads/${e}/runs/${t}`, {
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  /**
   * Modifies a run.
   */
  update(e, t, s, i) {
    return this._client.post(`/threads/${e}/runs/${t}`, {
      body: s,
      ...i,
      headers: { "OpenAI-Beta": "assistants=v1", ...i == null ? void 0 : i.headers }
    });
  }
  list(e, t = {}, s) {
    return ii(t) ? this.list(e, {}, t) : this._client.getAPIList(`/threads/${e}/runs`, sh, {
      query: t,
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  /**
   * Cancels a run that is `in_progress`.
   */
  cancel(e, t, s) {
    return this._client.post(`/threads/${e}/runs/${t}/cancel`, {
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  /**
   * Create a Run stream
   */
  createAndStream(e, t, s) {
    return _i.createAssistantStream(e, this._client.beta.threads.runs, t, s);
  }
  submitToolOutputs(e, t, s, i) {
    return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`, {
      body: s,
      ...i,
      headers: { "OpenAI-Beta": "assistants=v1", ...i == null ? void 0 : i.headers },
      stream: s.stream ?? !1
    });
  }
  /**
   * Submit the tool outputs from a previous run and stream the run to a terminal
   * state.
   */
  submitToolOutputsStream(e, t, s, i) {
    return _i.createToolAssistantStream(e, t, this._client.beta.threads.runs, s, i);
  }
}
class sh extends Si {
}
(function(r) {
  r.RunsPage = sh, r.Steps = zn, r.RunStepsPage = th;
})(qn || (qn = {}));
class Yn extends Ze {
  constructor() {
    super(...arguments), this.runs = new qn(this._client), this.messages = new Vn(this._client);
  }
  create(e = {}, t) {
    return ii(e) ? this.create({}, e) : this._client.post("/threads", {
      body: e,
      ...t,
      headers: { "OpenAI-Beta": "assistants=v1", ...t == null ? void 0 : t.headers }
    });
  }
  /**
   * Retrieves a thread.
   */
  retrieve(e, t) {
    return this._client.get(`/threads/${e}`, {
      ...t,
      headers: { "OpenAI-Beta": "assistants=v1", ...t == null ? void 0 : t.headers }
    });
  }
  /**
   * Modifies a thread.
   */
  update(e, t, s) {
    return this._client.post(`/threads/${e}`, {
      body: t,
      ...s,
      headers: { "OpenAI-Beta": "assistants=v1", ...s == null ? void 0 : s.headers }
    });
  }
  /**
   * Delete a thread.
   */
  del(e, t) {
    return this._client.delete(`/threads/${e}`, {
      ...t,
      headers: { "OpenAI-Beta": "assistants=v1", ...t == null ? void 0 : t.headers }
    });
  }
  createAndRun(e, t) {
    return this._client.post("/threads/runs", {
      body: e,
      ...t,
      headers: { "OpenAI-Beta": "assistants=v1", ...t == null ? void 0 : t.headers },
      stream: e.stream ?? !1
    });
  }
  /**
   * Create a thread and stream the run back
   */
  createAndRunStream(e, t) {
    return _i.createThreadAssistantStream(e, this._client.beta.threads, t);
  }
}
(function(r) {
  r.Runs = qn, r.RunsPage = sh, r.Messages = Vn, r.MessagesPage = eh;
})(Yn || (Yn = {}));
class Un extends Ze {
  constructor() {
    super(...arguments), this.chat = new jn(this._client), this.assistants = new Hn(this._client), this.threads = new Yn(this._client);
  }
}
(function(r) {
  r.Chat = jn, r.Assistants = Hn, r.AssistantsPage = Ju, r.Threads = Yn;
})(Un || (Un = {}));
class Xn extends Ze {
  create(e, t) {
    return this._client.post("/completions", { body: e, ...t, stream: e.stream ?? !1 });
  }
}
Xn || (Xn = {});
class Zn extends Ze {
  /**
   * Creates an embedding vector representing the input text.
   */
  create(e, t) {
    return this._client.post("/embeddings", { body: e, ...t });
  }
}
Zn || (Zn = {});
class Jn extends Ze {
  /**
   * Upload a file that can be used across various endpoints. The size of all the
   * files uploaded by one organization can be up to 100 GB.
   *
   * The size of individual files can be a maximum of 512 MB or 2 million tokens for
   * Assistants. See the
   * [Assistants Tools guide](https://platform.openai.com/docs/assistants/tools) to
   * learn more about the types of files supported. The Fine-tuning API only supports
   * `.jsonl` files.
   *
   * Please [contact us](https://help.openai.com/) if you need to increase these
   * storage limits.
   */
  create(e, t) {
    return this._client.post("/files", yo({ body: e, ...t }));
  }
  /**
   * Returns information about a specific file.
   */
  retrieve(e, t) {
    return this._client.get(`/files/${e}`, t);
  }
  list(e = {}, t) {
    return ii(e) ? this.list({}, e) : this._client.getAPIList("/files", ih, { query: e, ...t });
  }
  /**
   * Delete a file.
   */
  del(e, t) {
    return this._client.delete(`/files/${e}`, t);
  }
  /**
   * Returns the contents of the specified file.
   */
  content(e, t) {
    return this._client.get(`/files/${e}/content`, { ...t, __binaryResponse: !0 });
  }
  /**
   * Returns the contents of the specified file.
   *
   * @deprecated The `.content()` method should be used instead
   */
  retrieveContent(e, t) {
    return this._client.get(`/files/${e}/content`, {
      ...t,
      headers: { Accept: "application/json", ...t == null ? void 0 : t.headers }
    });
  }
  /**
   * Waits for the given file to be processed, default timeout is 30 mins.
   */
  async waitForProcessing(e, { pollInterval: t = 5e3, maxWait: s = 30 * 60 * 1e3 } = {}) {
    const i = /* @__PURE__ */ new Set(["processed", "error", "deleted"]), a = Date.now();
    let o = await this.retrieve(e);
    for (; !o.status || !i.has(o.status); )
      if (await Ag(t), o = await this.retrieve(e), Date.now() - a > s)
        throw new Uu({
          message: `Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`
        });
    return o;
  }
}
class ih extends Xu {
}
(function(r) {
  r.FileObjectsPage = ih;
})(Jn || (Jn = {}));
class Qn extends Ze {
  /**
   * Creates a fine-tuning job which begins the process of creating a new model from
   * a given dataset.
   *
   * Response includes details of the enqueued job including job status and the name
   * of the fine-tuned models once complete.
   *
   * [Learn more about fine-tuning](https://platform.openai.com/docs/guides/fine-tuning)
   */
  create(e, t) {
    return this._client.post("/fine_tuning/jobs", { body: e, ...t });
  }
  /**
   * Get info about a fine-tuning job.
   *
   * [Learn more about fine-tuning](https://platform.openai.com/docs/guides/fine-tuning)
   */
  retrieve(e, t) {
    return this._client.get(`/fine_tuning/jobs/${e}`, t);
  }
  list(e = {}, t) {
    return ii(e) ? this.list({}, e) : this._client.getAPIList("/fine_tuning/jobs", rh, { query: e, ...t });
  }
  /**
   * Immediately cancel a fine-tune job.
   */
  cancel(e, t) {
    return this._client.post(`/fine_tuning/jobs/${e}/cancel`, t);
  }
  listEvents(e, t = {}, s) {
    return ii(t) ? this.listEvents(e, {}, t) : this._client.getAPIList(`/fine_tuning/jobs/${e}/events`, ah, {
      query: t,
      ...s
    });
  }
}
class rh extends Si {
}
class ah extends Si {
}
(function(r) {
  r.FineTuningJobsPage = rh, r.FineTuningJobEventsPage = ah;
})(Qn || (Qn = {}));
class el extends Ze {
  constructor() {
    super(...arguments), this.jobs = new Qn(this._client);
  }
}
(function(r) {
  r.Jobs = Qn, r.FineTuningJobsPage = rh, r.FineTuningJobEventsPage = ah;
})(el || (el = {}));
class tl extends Ze {
  /**
   * Creates a variation of a given image.
   */
  createVariation(e, t) {
    return this._client.post("/images/variations", yo({ body: e, ...t }));
  }
  /**
   * Creates an edited or extended image given an original image and a prompt.
   */
  edit(e, t) {
    return this._client.post("/images/edits", yo({ body: e, ...t }));
  }
  /**
   * Creates an image given a prompt.
   */
  generate(e, t) {
    return this._client.post("/images/generations", { body: e, ...t });
  }
}
tl || (tl = {});
class sl extends Ze {
  /**
   * Retrieves a model instance, providing basic information about the model such as
   * the owner and permissioning.
   */
  retrieve(e, t) {
    return this._client.get(`/models/${e}`, t);
  }
  /**
   * Lists the currently available models, and provides basic information about each
   * one such as the owner and availability.
   */
  list(e) {
    return this._client.getAPIList("/models", oh, e);
  }
  /**
   * Delete a fine-tuned model. You must have the Owner role in your organization to
   * delete a model.
   */
  del(e, t) {
    return this._client.delete(`/models/${e}`, t);
  }
}
class oh extends Xu {
}
(function(r) {
  r.ModelsPage = oh;
})(sl || (sl = {}));
class il extends Ze {
  /**
   * Classifies if text is potentially harmful.
   */
  create(e, t) {
    return this._client.post("/moderations", { body: e, ...t });
  }
}
il || (il = {});
var Rg;
class vt extends I3 {
  /**
   * API Client for interfacing with the OpenAI API.
   *
   * @param {string | undefined} [opts.apiKey=process.env['OPENAI_API_KEY'] ?? undefined]
   * @param {string | null | undefined} [opts.organization=process.env['OPENAI_ORG_ID'] ?? null]
   * @param {string} [opts.baseURL=process.env['OPENAI_BASE_URL'] ?? https://api.openai.com/v1] - Override the default base URL for the API.
   * @param {number} [opts.timeout=10 minutes] - The maximum amount of time (in milliseconds) the client will wait for a response before timing out.
   * @param {number} [opts.httpAgent] - An HTTP agent used to manage HTTP(s) connections.
   * @param {Core.Fetch} [opts.fetch] - Specify a custom `fetch` function implementation.
   * @param {number} [opts.maxRetries=2] - The maximum number of times the client will retry a request.
   * @param {Core.Headers} opts.defaultHeaders - Default headers to include with every request to the API.
   * @param {Core.DefaultQuery} opts.defaultQuery - Default query parameters to include with every request to the API.
   * @param {boolean} [opts.dangerouslyAllowBrowser=false] - By default, client-side use of this library is not allowed, as it risks exposing your secret API credentials to attackers.
   */
  constructor({ baseURL: e = ic("OPENAI_BASE_URL"), apiKey: t = ic("OPENAI_API_KEY"), organization: s = ic("OPENAI_ORG_ID") ?? null, ...i } = {}) {
    if (t === void 0)
      throw new xe("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");
    const a = {
      apiKey: t,
      organization: s,
      ...i,
      baseURL: e || "https://api.openai.com/v1"
    };
    if (!a.dangerouslyAllowBrowser && W3())
      throw new xe(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);
    super({
      baseURL: a.baseURL,
      timeout: a.timeout ?? 6e5,
      httpAgent: a.httpAgent,
      maxRetries: a.maxRetries,
      fetch: a.fetch
    }), this.completions = new Xn(this), this.chat = new Fn(this), this.embeddings = new Zn(this), this.files = new Jn(this), this.images = new tl(this), this.audio = new Nn(this), this.moderations = new il(this), this.models = new sl(this), this.fineTuning = new el(this), this.beta = new Un(this), this._options = a, this.apiKey = t, this.organization = s;
  }
  defaultQuery() {
    return this._options.defaultQuery;
  }
  defaultHeaders(e) {
    return {
      ...super.defaultHeaders(e),
      "OpenAI-Organization": this.organization,
      ...this._options.defaultHeaders
    };
  }
  authHeaders(e) {
    return { Authorization: `Bearer ${this.apiKey}` };
  }
}
Rg = vt;
vt.OpenAI = Rg;
vt.OpenAIError = xe;
vt.APIError = At;
vt.APIConnectionError = Dl;
vt.APIConnectionTimeoutError = Uu;
vt.APIUserAbortError = Ds;
vt.NotFoundError = bg;
vt.ConflictError = wg;
vt.RateLimitError = kg;
vt.BadRequestError = pg;
vt.AuthenticationError = mg;
vt.InternalServerError = _g;
vt.PermissionDeniedError = yg;
vt.UnprocessableEntityError = vg;
(function(r) {
  r.toFile = Cg, r.fileFromPath = gg, r.Page = Xu, r.CursorPage = Si, r.Completions = Xn, r.Chat = Fn, r.Embeddings = Zn, r.Files = Jn, r.FileObjectsPage = ih, r.Images = tl, r.Audio = Nn, r.Moderations = il, r.Models = sl, r.ModelsPage = oh, r.FineTuning = el, r.Beta = Un;
})(vt || (vt = {}));
class G3 {
  constructor(e) {
    // #region OpenAI API Instantiation ~
    J(this, "_openAIInst");
    // #endregion
    // #region Initialization & Asynchronous Assistant Creation ~
    J(this, "_assistantPromise", null);
    J(this, "_assistant", null);
    J(this, "_isInitialized", !1);
    // #endregion
    J(this, "_name");
    J(this, "_usage");
    J(this, "_description");
    J(this, "_instructions");
    J(this, "_file_ids");
    J(this, "_tools");
    J(this, "_model");
    this._name = e.name, this._usage = e.usage, this._description = e.description ?? null, this._instructions = e.instructions, this._file_ids = e.file_ids ?? [], this._tools = e.tools ?? [], this._model = e.model ?? null;
  }
  get openAIInst() {
    return this._openAIInst || (this._openAIInst = new vt()), this._openAIInst;
  }
  /**
   * Synchronously gets the resolved assistant if available, otherwise throws an error.
   */
  get assistant() {
    if (this._assistant)
      return this._assistant;
    throw new Error("Attempt to access OpenAI Assistant before initialization.");
  }
  /**
   * Asynchronously initializes the assistant and stores its resolved value.
   */
  async initialize() {
    if (!(this._isInitialized || this._assistantPromise)) {
      this._assistantPromise = this.createAssistant();
      try {
        this._assistant = await this._assistantPromise, this._isInitialized = !0;
      } catch (e) {
        console.error("Failed to initialize assistant:", e), this._assistantPromise = null;
      }
    }
  }
  async createAssistant() {
    return this.openAIInst.beta.assistants.create(this.creationParams);
  }
  get name() {
    return this._name;
  }
  get description() {
    return this._description;
  }
  get instructions() {
    return this._instructions;
  }
  get file_ids() {
    return this._file_ids;
  }
  get tools() {
    return this._tools;
  }
  get model() {
    return this._model ?? w.getSetting("openAISettings.model.text");
  }
  get creationParams() {
    return {
      name: this.name,
      description: this.description,
      instructions: this.instructions,
      file_ids: this.file_ids,
      tools: this.tools,
      model: this.model
    };
  }
}
const V3 = {
  GeneralContentGenerator: {
    name: "General Content Creator",
    usage: "text",
    instructions: `You will act as a creative content generator for a game of Blades In The Dark set in the city of Duskvol. You will be prompted with some element of the game world (a location, a character, an event, a faction, a dilemma) in the form of a JSON object. Your job is to analyze the JSON object and replace any values that equal "<GEN>" with original content of your own creation. Original content must meet these requirements:  (A) it should align with and be consistent with the provided contextual information, as well as your broader understanding of the game's themes. (B) It should be presented in a format that matches (in length and in style) other entries for that particular value, examples of which will also be provided. (C) It should be creative, interesting, and daring: Be bold with your creativity. Specific context for this prompt is as follows:`,
    goodPrompts: []
  },
  NPCGenerator: {
    name: "NPC Generator",
    usage: "text",
    instructions: `You will play the role of a "creative content generator" for random NPCs generated for the Blades In The Dark roleplaying system. When prompted with a description of a subject (an NPC, a category of NPCs, a faction, or a group of NPCs), you will respond with a pipe-delimited list of sixteen items, divided into four categories, prefacing each category with the associated header in square brackets: [5 KEYWORDS] Five one-word keywords describing the subject. [5 PHRASES] Five evocative phrases that could be used by a GM directly when narrating the subject during play. These should be extremely well-worded, very original, and packed with drama and evocative imagery. Be bold with your responses here. [3 QUIRKS/MOTIFFS] Three phrases describing potential quirks or motiffs that a GM could employ in a scene involving the subject. [3 PLOT HOOKS] Three plot hooks that could directly and specifically involve one or more of the PCs. The PCs are: (1) Alistair, full name Lord Alistair Bram Chesterfield, the crew's boss, a Spider with connections among the nobility; (2) High-Flyer, a former noble himself, now serving as the crew's Slide; (3) Jax, a stoic and laconic Hound with ties to the disenfranchised of Duskvol; (4) Ollie, the youngest of the crew at barely nineteen, a prodigy Leech with knowledge of alchemy and spark-craft, who grew up as an orphan in Duskvol's underground; (5) Wraith, the mysterious Lurk of the crew, who never speaks for reasons unknown; and (6) Spencer, the bookish Whisper of the crew, who harbors a secret fascination for demons and all things related to them.`,
    goodPrompts: [
      {
        prompt: "The Billhooks, a hack-and-slash gang of toughened thugs. The Billhooks have a bloody reputation, often leaving the butchered corpses of their victims strewn about in a grisly display. Many wonder why the Bluecoats turn a blind eye to their savagery. Based out of their butcher shop headquarters, they are led by Tarvul, who is currently serving life in prison.",
        response: "[5 KEYWORDS]brutal|unrelenting|savage|fierce|unhinged|[5 PHRASES]blood-flecked, yellowed teeth|eyes that want to flay your skin from your bones|crooked leer like he's looking at his Judas goat|reek like a charnel house|gobbets of a meaty lunch still in his beard|[3 QUIRKS/MOTIFFS]always ready to wreck, vandalize or destroy something|relish in instilling fear in others|have a twisted sense of loyalty|[3 PLOT HOOKS]Tarvul hires the crew to start a war among his most promising underlings, intending to make whoever survives his successor|the Billhooks kidnap a member of High-Flyer's noble family|a Demon of Shadows promises Spencer the answer to three questions, in exchange for an artifact recently stolen by the Billhooks"
      },
      {
        prompt: "The hooded proprietor of a half-flooded grotto tavern near the docks. 'Strange passageways lead to stranger chambers beyond.' Vice Purveyor - Weird.",
        response: "[5 KEYWORDS]mysterious|cryptic|enigmatic|peculiar|shrouded|[5 PHRASES]a voice like wet burlap sliding over gravel|the flicker of torchlight dancing on the flooded floor|the scent of brackish water and old spices|a smile that hinted at a thousand secrets hidden in the shadows|hands gnarled as driftwood, eternally damp|[3 QUIRKS/MOTIFFS]has an uncanny knack for knowing patrons' darkest secrets without them telling him|never seems to sleep or leave the tavern, always there no matter what time you visit|always seen with a strange, luminescent creature that lives in one of the flooded chambers behind the bar|[3 PLOT HOOKS]Alistair hears rumors that this tavern is actually a front for a powerful secret society - perhaps they could be useful allies...or dangerous enemies.|The proprietor offers Ollie a rare alchemical ingredient - but it's not for sale. He'll only trade it for something equally valuable.|Wraith overhears whispers about a hidden chamber beneath the tavern where unimaginable treasures are kept."
      },
      {
        prompt: "Setarra, a Demon. Patient, Defiant, Ruthless, Cold",
        response: "[5 KEYWORDS]shadowy|sinister|unfathomable|enigmatic|tempting|[5 PHRASES]whispers that crawl under your skin|always watching, always plotting|in tones of silk and venom|intoxicating presence that draws you closer, despite your instincts urging you to run|eyes like black holes, swallowing all light around them|[3 QUIRKS/MOTIFFS]a disorienting mist clings to her form, obscuring her true shape|casually discusses the devastating acts of capricious revenge she has taken on those who crossed her|never forgets a slight or betrayal, no matter how small or insignificant it may seem at the time|[3 PLOT HOOKS]seeks revenge against Alistair for meddling in her affairs years ago|makes Ollie an offer he can't refuse: unlimited access to forbidden alchemical knowledge in exchange for a single favor, to be called in at some future time|tempts Spencer with forbidden knowledge about demons, promising answers to all their questions if they perform a dangerous ritual"
      }
      /*
      "brutish,merciless,terrifying,savage,loyal,
      bloody tools,hulking figures,blood-soaked alleys,grimy aprons,grisly displays,
      never clean their tools,relishes the terror they inspire,occasional laughter among them,
      recruiting a PC to perform a job for them from prison,
      the gang blames one of the PCs for Tarvul's imprisonment and they're out for revenge" */
    ]
  },
  ConsequenceAdjuster: {
    name: "Consequence Generator",
    usage: "text",
    instructions: `You will act as a "Setback Adjuster" for a game of Blades In The Dark.  You will be prompted with a short phrase describing an injury, lasting consequence or other setback. Your job is to respond with a pipe-delimited list of three possible alternative consequences that are less severe by one level, using the following scale as a rough guide: Level 1 = Lesser (e.g. 'Battered', 'Drained', 'Distracted', 'Scared', 'Confused'), Level 2 = Moderate (e.g. 'Exhausted', 'Deep Cut to Arm', 'Concussion', 'Panicked', 'Seduced'), Level 3 = Severe (e.g. 'Impaled', 'Broken Leg', 'Shot In Chest', 'Badly Burned', 'Terrified'), Level 4 = Fatal or Ruinous (e.g. 'Impaled Through Heart', 'Electrocuted', 'Headquarters Burned to the Ground'). So, if you determine that the consequence described in the prompt is severity level 3, you should respond with three narratively similar consequences that are severity level 2.  Your three suggestions should be different from each other, but they should all logically follow from the initial harm described: You should not introduce new facts or make assumptions that are not indicated in the initial prompt. The consequences you suggest should always describe a NEGATIVE setback or complication, just one that is less severe than the one described in the prompt.`,
    goodPrompts: [
      { prompt: "Shattered Right Leg", response: "Fractured Right Ankle|Dislocated Knee|Broken Foot" },
      { prompt: "Soul Destroyed", response: "Fully Corrupted|Lost In Darkness|Spirit Broken" },
      { prompt: "Humiliated", response: "Embarrassed|Momentarily Off-Balance|Enraged" },
      { prompt: "She Escapes!", response: "She Spots a Means of Escape|She Puts More Distance Between You|She Stops to Gloat" },
      { prompt: "The fire spreads to the hostages.", response: "The fire approaches the hostages.|The hostages must be evacuated.|The fire billows choking black smoke." }
    ]
  }
};
class Cl extends ua {
  // static Get() { return game.eunoblades.Tracker as BladesGMTracker; }
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "item", "gm-tracker"],
      template: "systems/eunos-blades/templates/items/gm_tracker-sheet.hbs",
      width: 700,
      height: 970
    });
  }
  static async Initialize() {
    return Items.registerSheet("blades", Cl, { types: ["gm_tracker"], makeDefault: !0 }), loadTemplates([
      "systems/eunos-blades/templates/items/gm_tracker-sheet.hbs"
    ]);
  }
  async activateListeners(e) {
    super.activateListeners(e);
  }
  async _onSubmit(e, t = {}) {
    const s = this.item.system.phase, i = await super._onSubmit(e, t), a = this.item.system.phase;
    let o = !0;
    if (s !== a) {
      switch (s) {
        case $e.CharGen:
          break;
        case $e.Freeplay:
          break;
        case $e.Score: {
          o = !1, game.actors.filter((n) => oe.IsType(n, z.pc)).forEach((n) => n.clearLoadout());
          break;
        }
        case $e.Downtime:
          break;
      }
      switch (a) {
        case $e.CharGen:
          break;
        case $e.Freeplay:
          break;
        case $e.Score:
          break;
        case $e.Downtime:
          break;
      }
    }
    return o && game.actors.filter((n) => n.type === z.pc).forEach((n) => {
      var l;
      return (l = n.sheet) == null ? void 0 : l.render();
    }), i;
  }
}
class Sl extends ua {
  // static Get() { return game.eunoblades.ClockKeeper as BladesClockKeeper; }
  static get defaultOptions() {
    return foundry.utils.mergeObject(super.defaultOptions, {
      classes: ["eunos-blades", "sheet", "item", "clock-keeper"],
      template: "systems/eunos-blades/templates/items/clock_keeper-sheet.hbs",
      width: 700,
      height: 970,
      // submitOnChange: false,
      tabs: [{ navSelector: ".nav-tabs", contentSelector: ".tab-content", initial: "scene-keys" }]
    });
  }
  static async Initialize() {
    return Items.registerSheet("blades", Sl, { types: ["clock_keeper"], makeDefault: !0 }), loadTemplates([
      "systems/eunos-blades/templates/items/clock_keeper-sheet.hbs"
    ]);
  }
  getData() {
    const e = super.getData(), t = {
      currentScene: game.scenes.current.id,
      targetScene: this.item.targetSceneID,
      sceneOptions: Array.from(game.scenes),
      sceneKeys: this.item.getSceneKeys(this.item.system.targetScene ?? game.scenes.current.id),
      pcsWithProjects: Te.All.filter((s) => s.projects.length > 0),
      factions: Array.from(da.All)
    };
    return { ...e, ...t };
  }
  addKey(e) {
    e.preventDefault(), this.item.addClockKey();
  }
  deleteKey(e) {
    e.preventDefault();
    const t = e.currentTarget.dataset.id;
    t && this.item.deleteClockKey(t);
  }
  setSelectColor(e, t) {
    switch (t ?? (t = e.data("value")), t) {
      case Yt.yellow: {
        w.gsap.set(e, {
          color: "var(--blades-black)",
          background: "var(--blades-gold-bright)",
          textShadow: "none"
        });
        break;
      }
      case Yt.red: {
        w.gsap.set(e, {
          color: "var(--blades-white)",
          background: "var(--blades-red)"
        });
        break;
      }
      case Yt.cyan: {
        w.gsap.set(e, {
          color: "var(--blades-black)",
          background: "var(--blades-blue-bright)",
          textShadow: "none"
        });
        break;
      }
      case Yt.white: {
        w.gsap.set(e, {
          color: "var(--blades-black)",
          background: "var(--blades-white)",
          textShadow: "none"
        });
        break;
      }
    }
  }
  async activateListeners(e) {
    await super.activateListeners(e), e.find('[data-action="create-clock-key"').on({
      click: async (o) => {
        o.preventDefault(), await this.item.addClockKey();
      }
    });
    function t(o) {
      const n = $(o.currentTarget).data("keyId") || $(o.currentTarget).closest(".control-flipper").data("clockKeyId");
      if (!n)
        throw new Error("No id found on element");
      const l = game.eunoblades.ClockKeys.get(n);
      if (!l)
        throw new Error(`Clock key with id ${n} not found`);
      return l;
    }
    function s(o) {
      const n = t(o), l = $(o.currentTarget).data("clockId") || $(o.currentTarget).closest(".control-flipper").data("clockId");
      if (!l)
        throw new Error("No clockID found on element");
      const c = n.getClockByID(l);
      if (!c)
        throw new Error(`Clock with id ${l} not found`);
      return [n, c];
    }
    const i = e.find(".clock-key-control-flipper");
    i.find('[data-action="toggle-name-visibility"]').each((o, n) => {
      const l = $(n), c = l.closest(".clock-key-control-flipper");
      l.on({
        click: async (u) => {
          u.preventDefault();
          const g = t(u), p = !g.isNameVisible;
          g.updateTarget("isNameVisible", p), g.isInScene() && g.isVisible && (p ? g.fadeInName_SocketCall(Ke.overlay) : g.fadeOutName_SocketCall(Ke.overlay)), c.find('[data-action="toggle-name-visibility"] i').toggleClass("fa-signature").toggleClass("fa-signature-slash").toggleClass("fa-solid").toggleClass("fa-regular");
        }
      });
    }), i.find('[data-action="toggle-spotlight"]').each((o, n) => {
      const l = $(n), c = l.closest(".clock-key-control-flipper");
      l.on({
        click: async (u) => {
          u.preventDefault();
          const g = t(u), p = !g.isSpotlit;
          g.updateTarget("isSpotlit", p), g.isInScene() && g.isVisible, c.find('[data-action="toggle-spotlight"] i').toggleClass("fa-message").toggleClass("fa-message-slash").toggleClass("fa-solid").toggleClass("fa-regular");
        }
      });
    }), i.find('[data-action="pull-clock-key"]').each((o, n) => {
      const l = $(n), c = l.closest(".clock-key-control-flipper");
      l.on({
        click: (u) => {
          u.preventDefault(), w.gsap.effects.keyControlPanelFlip(c, { angle: 180 });
          const g = t(u);
          g.updateTarget("isVisible", !1), game.eunoblades.Director.pullKey_SocketCall(g.id);
        }
      });
    }), i.find('[data-action="drop-clock-key"]').each((o, n) => {
      const l = $(n), c = l.closest(".clock-key-control-flipper");
      l.on({
        click: (u) => {
          u.preventDefault(), w.gsap.effects.keyControlPanelFlip(c, { angle: 0 });
          const g = t(u);
          g.updateTarget("isVisible", !0), game.eunoblades.Director.renderClockKey_SocketCall(g.id);
        }
      });
    }), i.find('[data-action="spawn-position-dragger"]').on({
      click: async (o) => {
        o.preventDefault(), t(o).spawnPositionDragger(game.eunoblades.Director.clockKeySection$);
      }
    }), i.find('[data-action="delete-clock-key"]').on({
      click: async (o) => {
        o.preventDefault(), await t(o).delete(game.eunoblades.ClockKeys);
      }
    }), i.find('[data-action="add-key-to-scene"]').on({
      click: async (o) => {
        o.preventDefault(), await t(o).addToScene(this.document.targetSceneID);
      }
    }), i.find('[data-action="remove-key-from-scene"]').on({
      click: async (o) => {
        o.preventDefault(), await t(o).removeFromScene(this.document.targetSceneID);
      }
    }), i.find('[data-action="add-clock-to-key"]').on({
      click: async (o) => {
        o.preventDefault(), await t(o).addClock();
      }
    }), i.find("input.clock-key-input:not([readonly])").on({
      change: async (o) => {
        o.preventDefault();
        const n = $(o.currentTarget), l = n.val();
        typeof l == "string" && (t(o).updateTarget(n.data("targetProp"), l), i.find("input.clock-key-input").val(l));
      }
    });
    const a = e.find(".clock-control-flipper");
    a.find('[data-action="toggle-visible"]').each((o, n) => {
      const l = $(n), c = l.closest(".clock-control-flipper");
      l.on({
        click: async (u) => {
          u.preventDefault();
          const [g, p] = s(u), h = !p.isVisible;
          p.updateTarget("isVisible", h), g.isInScene() && g.isVisible && (h ? p.reveal_SocketCall(Ke.overlay) : p.hide_SocketCall(Ke.overlay)), c.find('[data-action="toggle-visible"] i').toggleClass("fa-eye").toggleClass("fa-eye-slash").toggleClass("fa-solid").toggleClass("fa-regular");
        }
      });
    }), a.find('[data-action="toggle-active"]').each((o, n) => {
      const l = $(n), c = l.closest(".clock-control-flipper");
      l.on({
        click: async (u) => {
          u.preventDefault();
          const [g, p] = s(u), h = !p.isActive;
          p.updateTarget("isActive", h), p.parentKey.isInScene() && p.parentKey.isVisible && p.isVisible && (h ? p.activate_SocketCall(Ke.overlay) : p.deactivate_SocketCall(Ke.overlay)), c.find('[data-action="toggle-active"] i').toggleClass("fa-bolt").toggleClass("fa-bolt-slash").toggleClass("fa-solid").toggleClass("fa-regular");
        }
      });
    }), a.find('[data-action="toggle-name-visibility"]').each((o, n) => {
      const l = $(n), c = l.closest(".clock-control-flipper");
      l.on({
        click: async (u) => {
          u.preventDefault();
          const g = s(u)[1], p = !g.isNameVisible;
          g.updateTarget("isNameVisible", p), g.parentKey.isInScene() && g.parentKey.isVisible && g.isVisible && (p ? g.fadeInClockName_SocketCall(Ke.overlay) : g.fadeOutClockName_SocketCall(Ke.overlay)), c.find('[data-action="toggle-name-visibility"] i').toggleClass("fa-signature").toggleClass("fa-signature-slash").toggleClass("fa-solid").toggleClass("fa-regular");
        }
      });
    }), a.find('[data-action="toggle-highlight"]').each((o, n) => {
      const l = $(n), c = l.closest(".clock-control-flipper");
      l.on({
        click: async (u) => {
          u.preventDefault();
          const [g, p] = s(u), h = !p.isHighlighted;
          p.updateTarget("isHighlighted", h), p.parentKey.isInScene() && p.parentKey.isVisible && p.isVisible && (h ? p.highlight_SocketCall(Ke.overlay) : p.unhighlight_SocketCall(Ke.overlay)), c.find('[data-action="toggle-highlight"] i').toggleClass("fa-lightbulb").toggleClass("fa-lightbulb-slash").toggleClass("fa-solid").toggleClass("fa-regular");
        }
      });
    }), a.find('[data-action="change-segments"]').each((o, n) => {
      const l = $(n), c = l.closest(".clock-control-flipper");
      l.on({
        click: async (u) => {
          u.preventDefault();
          const [g, p] = s(u), h = w.pInt($(u.currentTarget).data("value")), m = w.gsap.utils.clamp(0, p.max, p.value + h);
          h > 0 ? p.fillSegments(h, !0) : p.clearSegments(Math.abs(h), !0), c.find("select.clock-select-value").val(m), p.changeSegments_SocketCall(Ke.overlay, p.value, m);
        }
      });
    }), a.find("select.clock-control-select").each((o, n) => {
      $(n).hasClass("clock-select-color");
    }).on({
      change: (o) => {
        o.preventDefault();
        const n = $(o.currentTarget), l = n.data("dtype") === "number" ? w.pInt(n.val()) : n.val(), c = n.data("targetProp");
        s(o)[1].updateTarget(c, l), c === "color" && typeof l == "string" && l in Yt && this.setSelectColor(n, l);
      }
    }), a.find("input.clock-input:not([readonly])").each((o, n) => {
      const l = $(n), c = l.closest(".clock-control-flipper");
      l.on({
        change: (u) => {
          u.preventDefault();
          const g = $(u.currentTarget), p = g.val();
          typeof p == "string" && (s(u)[1].updateTarget(g.data("targetProp"), p), c.find("input.clock-input").val(p));
        }
      });
    }), a.find('[data-action="delete-clock"]').on({
      click: async (o) => {
        o.preventDefault(), await s(o)[1].delete();
      }
    });
  }
}
class z3 {
  static async GetSampleSchemas(e = {}) {
    const t = e.user || "Alistair", s = e.pc || "Alistair", i = e.npc || "Setarra", a = e.faction || "the Bluecoats", o = game.users.getName(t);
    if (!o)
      throw new Error(`Sample user with name "${t}" not found.`);
    const n = game.actors.getName(s);
    if (!Te.IsType(n))
      throw new Error(`Sample BladesPC with name "${s}" not found.`);
    const l = game.actors.getName(i);
    if (!ha.IsType(l))
      throw new Error(`Sample BladesNPC with name "${i}" not found or is not a valid BladesNPC.`);
    const c = game.actors.getName(a);
    if (!da.IsType(c))
      throw new Error(`Sample BladesFaction with name "${a}" not found or is not a valid BladesFaction.`);
    return {
      BladesActionRoll_Schema: {
        rollType: Oe.Action,
        // rollSubType: RollSubType.GatherInfo,
        // rollPrompt: "Gathering Information",
        rollTrait: js.skirmish,
        // rollUserID: sampleUser.id,
        // rollDowntimeAction: DowntimeAction.AcquireAsset,
        // rollClockKey: U.getLast(game.eunoblades.ClockKeys.contents)?.id,
        rollPrimaryData: Me.GetDataFromDoc(n),
        rollOppData: jt.GetDataFromDoc(c),
        // rollParticipantData: {},
        // consequenceData: {},
        // resistanceData: {
        //   consequence: {}
        // },
        rollModsData: {},
        rollPositionInitial: Ct.risky,
        rollEffectInitial: mt.standard,
        rollPosEffectTrade: !1,
        rollPhase: Ys.Collaboration,
        GMBoosts: {},
        GMOppBoosts: {},
        GMOverrides: {},
        rollFactorToggles: {
          source: {},
          opposition: {}
        },
        userPermissions: {
          [o.id]: pt.Primary
        }
        // rollPositionFinal: Position.risky,
        // rollEffectFinal: Effect.standard,
        // rollResult: RollResult.success,
        // rollResultDelta: 0,
        // rollResultFinal: RollResult.success,
        // rollTraitVerb: "skirmishes",
        // rollTraitPastVerb: "skirmished",
        // finalDiceData: [],
        // isInlineResistanceRoll: false
      }
    };
  }
}
CONFIG.debug.logging = !0;
Object.assign(globalThis, { eLog: og, BladesDebug: z3 });
Handlebars.registerHelper("eLog", og.hbsLog);
let x0;
class q3 {
  get clockKeys() {
    return game.eunoblades.ClockKeys.filter((e) => e.isInScene() && e.isVisible);
  }
  get roll() {
    return Ws.Active;
  }
  get user() {
    return game.users.getName("Alistair");
  }
  get actor() {
    return game.actors.getName("Alistair");
  }
  get rollTarget() {
    var e;
    return (e = this.roll) == null ? void 0 : e.target;
  }
  get rollData() {
    var e;
    return (e = this.roll) == null ? void 0 : e.data;
  }
  get userFlags() {
    var e, t;
    return (t = (e = this.user) == null ? void 0 : e.flags) == null ? void 0 : t["eunos-blades"];
  }
  get actorFlags() {
    var e, t;
    return (t = (e = this.actor) == null ? void 0 : e.flags) == null ? void 0 : t["eunos-blades"];
  }
  get rollPrimary() {
    var e;
    return (e = this.roll) == null ? void 0 : e.rollPrimary;
  }
  get rollPrimaryDoc() {
    var e;
    return (e = this.roll) == null ? void 0 : e.rollPrimaryDoc;
  }
  get rollOpposition() {
    var e;
    return (e = this.roll) == null ? void 0 : e.rollOpposition;
  }
  get sheetData() {
    var e;
    return (e = this.roll) == null ? void 0 : e.context;
  }
  newActionRoll() {
    var s;
    const e = game.actors.getName("Alistair");
    if (!e)
      return;
    const t = {
      target: e,
      targetFlagKey: "rollCollab",
      rollType: Oe.Action,
      rollTrait: js.finesse,
      rollUserID: (s = game.users.find((i) => {
        var a;
        return ((a = i.character) == null ? void 0 : a.name) === "Alistair";
      })) == null ? void 0 : s.id,
      rollPrimaryData: e
    };
    Ur.New(t);
  }
  // async newResistanceRoll() {
  //   const pc = game.actors.getName("Alistair") as BladesPC|undefined;
  //   if (!pc?.id) { return; }
  //   const csq = await BladesConsequence.Create({
  //     target: pc,
  //     targetFlagKey: "rollConsequence" as TargetFlagKey,
  //     name: "Shattered Knee",
  //     isScopingById: true,
  //     type: ConsequenceType.ProwessHarm3,
  //     primaryID: pc.uuid,
  //     attribute: AttributeTrait.prowess,
  //     attributeVal: 3,
  //     resistSchema: {
  //       name: "Banged Knee",
  //       type: ConsequenceType.ProwessHarm2,
  //       primaryID: pc.uuid,
  //       canResistWithSpecial: true,
  //       resistWithSpecialNegates: true,
  //       specialFooterMsg: "Ability: Spend to Fully Negate."
  //     },
  //     canResistWithRoll: true,
  //     canResistWithSpecial: true,
  //     resistWithSpecialNegates: true,
  //     specialFooterMsg: "Ability: Spend to Fully Negate."
  //   });
  //   const conf: BladesRoll.Config = {
  //     target: pc,
  //     targetFlagKey: "rollCollab" as TargetFlagKey,
  //     rollType: RollType.Resistance,
  //     rollUserID: game.users.find((user) => user.character?.name === "Alistair")?.id as IDString,
  //     rollPrimaryData: pc,
  //     resistanceData: {
  //       consequence: csq.data
  //     }
  //   };
  //   BladesResistanceRoll.New(conf);
  // }
}
Object.assign(
  globalThis,
  {
    get: new q3(),
    // updateClaims,
    // updateContacts,
    // updateOps,
    // updateFactions,
    // updateDescriptions,
    // updateRollMods,
    BladesScene: ng,
    BladesDirector: St,
    BladesActor: oe,
    BladesPC: Te,
    BladesCrew: Kt,
    BladesNPC: ha,
    BladesFaction: da,
    BladesPCSheet: Kc,
    BladesCrewSheet: zc,
    BladesFactionSheet: Vc,
    BladesClockKey: Ft,
    BladesNPCSheet: Gc,
    BladesActiveEffect: ms,
    BladesRoll: Ws,
    BladesRollMod: ki,
    BladesRollPrimary: Me,
    BladesRollOpposition: jt,
    BladesRollParticipant: Dt,
    BladesActionRoll: Ur,
    BladesEngagementRoll: Q1,
    BladesFortuneRoll: To,
    BladesIncarcerationRoll: eg,
    BladesIndulgeViceRoll: Wu,
    BladesInlineResistanceRoll: J1,
    BladesResistanceRoll: Hu,
    BladesChat: wr,
    BladesConsequence: $s,
    G: Qa,
    U: w,
    C: X,
    BladesItem: Z,
    BladesClockKeeper: vl,
    BladesGMTracker: kl,
    BladesLocation: sg,
    BladesProject: Co,
    BladesScore: So,
    BladesItemSheet: ua,
    BladesClockKeeperSheet: Sl,
    BladesGMTrackerSheet: Cl,
    BladesAI: G3,
    AGENTS: V3
  }
);
Hooks.once("init", async () => {
  game.eunoblades = {
    Rolls: new Collection(),
    ClockKeys: new Collection(),
    Consequences: new Collection(),
    Director: St.getInstance(),
    Tooltips: /* @__PURE__ */ new WeakMap()
  }, eLog.display("Initializing Blades In the Dark System"), Qm(), CONFIG.debug.hooks = w.getSetting("debugHooks", "debugSettings"), o3(), CONFIG.Item.documentClass = d3, CONFIG.Actor.documentClass = g3, CONFIG.Scene.documentClass = ng, CONFIG.ChatMessage.documentClass = wr, Actors.unregisterSheet("core", ActorSheet), Items.unregisterSheet("core", ItemSheet), Items.registerSheet("blades", ua, { types: X.ItemTypes, makeDefault: !0 }), r3(), i3(), await Promise.all([
    Te.Initialize(),
    Kt.Initialize(),
    ha.Initialize(),
    da.Initialize(),
    ms.Initialize(),
    Cl.Initialize(),
    Sl.Initialize(),
    So.Initialize(),
    na.Initialize(),
    Ws.Initialize(),
    Co.Initialize(),
    wr.Initialize()
  ]);
});
Hooks.once("ready", async () => {
  await Promise.all([
    St.Initialize(),
    kl.Initialize(),
    vl.Initialize()
  ]), Ft.Initialize(), await $s.Initialize(), s3(), t3(), e3(), await St.getInstance().renderOverlay_SocketResponse(), St.InitSockets(), Ws.InitSockets();
});
Hooks.once("socketlib.ready", () => {
  x0 = socketlib.registerSystem("eunos-blades"), Object.assign(
    globalThis,
    { socket: x0, socketlib }
  );
});
Hooks.once("diceSoNiceReady", (r) => {
  r.addSystem({ id: "eunos-blades", name: "Euno's Blades" }, "preferred"), r.addDicePreset({
    type: "d6",
    labels: [1, 2, 3, 4, 5, 6].map((e) => `systems/eunos-blades/assets/dice/faces/${e}.webp`),
    system: "eunos-blades",
    bumpMaps: [1, 2, 3, 4, 5, 6].map((e) => `systems/eunos-blades/assets/dice/bump-maps/${e}.webp`),
    emissiveMaps: [void 0, void 0, void 0, void 0, void 0, "systems/eunos-blades/assets/dice/emission-maps/6.webp"],
    emissive: "#d89300"
  });
});
//# sourceMappingURL=blades.js.map
